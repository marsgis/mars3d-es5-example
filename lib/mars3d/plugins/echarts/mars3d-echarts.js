/**
 * Mars3D平台插件,结合echarts可视化功能插件  mars3d-echarts
 *
 * 版本信息：v3.7.7
 * 编译日期：2024-03-19 15:39:39
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2024-01-15
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.echarts || require('echarts')), (window.mars3d || require('mars3d'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'echarts', 'mars3d'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-echarts"] = {}, global.echarts, global.mars3d));
})(this, (function (exports, echarts, mars3d) { 
'use strict';const _0x135642=_0x2f08;(function(_0x28f70e,_0x3db058){const _0xd98464={_0xfcbe9a:0x1b6,_0x188dd2:0x174,_0x58e998:0x1b4,_0x2f1c5f:0x19d,_0x169f2c:0x17c,_0x1693d5:0x199,_0x284bfc:0x195},_0x1b2c9d=_0x2f08,_0x2600a2=_0x28f70e();while(!![]){try{const _0x19295e=-parseInt(_0x1b2c9d(_0xd98464._0xfcbe9a))/0x1*(parseInt(_0x1b2c9d(_0xd98464._0x188dd2))/0x2)+parseInt(_0x1b2c9d(0x1a1))/0x3*(parseInt(_0x1b2c9d(0x188))/0x4)+-parseInt(_0x1b2c9d(0x1a7))/0x5*(-parseInt(_0x1b2c9d(_0xd98464._0x58e998))/0x6)+-parseInt(_0x1b2c9d(_0xd98464._0x2f1c5f))/0x7*(parseInt(_0x1b2c9d(0x1ae))/0x8)+-parseInt(_0x1b2c9d(0x1b1))/0x9*(parseInt(_0x1b2c9d(0x1b2))/0xa)+-parseInt(_0x1b2c9d(_0xd98464._0x169f2c))/0xb*(parseInt(_0x1b2c9d(_0xd98464._0x1693d5))/0xc)+-parseInt(_0x1b2c9d(0x1a9))/0xd*(-parseInt(_0x1b2c9d(_0xd98464._0x284bfc))/0xe);if(_0x19295e===_0x3db058)break;else _0x2600a2['push'](_0x2600a2['shift']());}catch(_0x56e591){_0x2600a2['push'](_0x2600a2['shift']());}}}(_0x3558,0x78852));function _interopNamespace(_0x114b51){const _0x4b2de1={_0x49a6f9:0x19e},_0x296cce={_0x3d59f4:0x178},_0x4a2dac=_0x2f08;if(_0x114b51&&_0x114b51['__esModule'])return _0x114b51;var _0x3c82ea=Object['create'](null);return _0x114b51&&Object['keys'](_0x114b51)[_0x4a2dac(_0x4b2de1._0x49a6f9)](function(_0x4bc20a){const _0x2793e6=_0x4a2dac;if(_0x4bc20a!=='default'){var _0x2183a0=Object[_0x2793e6(_0x296cce._0x3d59f4)](_0x114b51,_0x4bc20a);Object['defineProperty'](_0x3c82ea,_0x4bc20a,_0x2183a0['get']?_0x2183a0:{'enumerable':!![],'get':function(){return _0x114b51[_0x4bc20a];}});}}),_0x3c82ea['default']=_0x114b51,_0x3c82ea;}var echarts__namespace=_interopNamespace(echarts),mars3d__namespace=_interopNamespace(mars3d);function _0x3558(){const _0x4e768b=['forEach','mode','getWidth','395985yLwwZr','clientHeight','pointerEvents','ecInstance','dimensions','mars3dMap','245705KUtLAF','data','260nnXGEk','left','globe','_echartsInstance','visible','466240weJldY','_removedHook','keys','9RGrVDs','1054390pxTTEs','min','18ZfgDcm','setMapOffset','8sMVYnb','getAttrVal','setEchartsOption','moveHandler','_map','BoundingRect','128538EiVMHN','fromDegrees','removeChild','onByQuery','getOwnPropertyDescriptor','echarts','_mars3d_scene','create','11zakGbP','lng','default','LayerUtil','coords','scene','register','width','postRender','_echartsContainer','_api','off','4vaWGPY','_mountedHook','Cartographic','isPointVisible','isFormat','options','style','clear','extendComponentView','eachSeries','hasOwnProperty','zIndex','canvas','1795304ReXUTk','resize','dispatchAction','Util','11679084aSEYsQ','0px','container','visibility','91KuGKhN'];_0x3558=function(){return _0x4e768b;};return _0x3558();}function _0x2f08(_0xfe6ff,_0x2010cf){const _0x3558a8=_0x3558();return _0x2f08=function(_0x2f0822,_0x498880){_0x2f0822=_0x2f0822-0x171;let _0xbf2225=_0x3558a8[_0x2f0822];return _0xbf2225;},_0x2f08(_0xfe6ff,_0x2010cf);}const Cesium$1=mars3d__namespace['Cesium'];class CompositeCoordinateSystem{constructor(_0x57e96e,_0x2de508){const _0x5ef7e9={_0x56a2dc:0x1a5,_0x441976:0x17d},_0x4ae71e=_0x2f08;this['_mars3d_scene']=_0x57e96e,this[_0x4ae71e(_0x5ef7e9._0x56a2dc)]=[_0x4ae71e(_0x5ef7e9._0x441976),'lat'],this['_mapOffset']=[0x0,0x0],this['_api']=_0x2de508;}['setMapOffset'](_0x4dbe81){this['_mapOffset']=_0x4dbe81;}['getBMap'](){const _0x207c50={_0x244d1:0x17a},_0x4f3fab=_0x2f08;return this[_0x4f3fab(_0x207c50._0x244d1)];}['dataToPoint'](_0x4aec29){const _0x165650={_0x56aa90:0x19f,_0x1876ea:0x1ab},_0x1b3982=_0x2f08,_0x46d1f3=this[_0x1b3982(0x17a)],_0x168945=[NaN,NaN];let _0x1640d8=_0x46d1f3['echartsFixedHeight'];_0x46d1f3['echartsAutoHeight']&&(_0x1640d8=_0x46d1f3['getHeight'](Cesium$1[_0x1b3982(0x18a)]['fromDegrees'](_0x4aec29[0x0],_0x4aec29[0x1])));const _0x2fdea7=Cesium$1['Cartesian3'][_0x1b3982(0x175)](_0x4aec29[0x0],_0x4aec29[0x1],_0x1640d8);if(!_0x2fdea7)return _0x168945;const _0x14f5bf=Cesium$1['SceneTransforms']['wgs84ToWindowCoordinates'](_0x46d1f3,_0x2fdea7);if(!_0x14f5bf)return _0x168945;if(_0x46d1f3['echartsDepthTest']&&_0x46d1f3[_0x1b3982(_0x165650._0x56aa90)]===Cesium$1['SceneMode']['SCENE3D']){const _0x542e0a=new Cesium$1['EllipsoidalOccluder'](_0x46d1f3[_0x1b3982(_0x165650._0x1876ea)]['ellipsoid'],_0x46d1f3['camera']['positionWC']),_0x5cb23b=_0x542e0a[_0x1b3982(0x18b)](_0x2fdea7);if(!_0x5cb23b)return _0x168945;}return[_0x14f5bf['x']-this['_mapOffset'][0x0],_0x14f5bf['y']-this['_mapOffset'][0x1]];}['getViewRect'](){const _0x38367b={_0x2f0bd9:0x1a0},_0x5ca0a3=_0x2f08,_0x563cfc=this[_0x5ca0a3(0x186)];return new echarts__namespace['graphic'][(_0x5ca0a3(0x173))](0x0,0x0,_0x563cfc[_0x5ca0a3(_0x38367b._0x2f0bd9)](),_0x563cfc['getHeight']());}['getRoamTransform'](){const _0x37841d={_0x4fcd11:0x17b},_0x1873e6=_0x2f08;return echarts__namespace['matrix'][_0x1873e6(_0x37841d._0x4fcd11)]();}}CompositeCoordinateSystem[_0x135642(0x1a5)]=[_0x135642(0x17d),'lat'],CompositeCoordinateSystem['create']=function(_0x814942,_0x480cb7){const _0x5b27e7={_0x362fa2:0x1a4,_0x52a6cb:0x1a6},_0x469b39={_0x36b0b4:0x1b5},_0x53f631=_0x135642;let _0x1916ff;const _0x3f419d=_0x814942['scheduler'][_0x53f631(_0x5b27e7._0x362fa2)]['_mars3d_scene'];_0x814942['eachComponent'](_0x53f631(_0x5b27e7._0x52a6cb),function(_0x1fa2ee){const _0x5df550=_0x53f631,_0x480c1c=_0x480cb7['getZr']()['painter'];if(!_0x480c1c)return;!_0x1916ff&&(_0x1916ff=new CompositeCoordinateSystem(_0x3f419d,_0x480cb7)),_0x1fa2ee['coordinateSystem']=_0x1916ff,_0x1916ff[_0x5df550(_0x469b39._0x36b0b4)](_0x1fa2ee['__mapOffset']||[0x0,0x0]);}),_0x814942[_0x53f631(0x191)](function(_0x47f23b){_0x47f23b['get']('coordinateSystem')==='mars3dMap'&&(!_0x1916ff&&(_0x1916ff=new CompositeCoordinateSystem(_0x3f419d,_0x480cb7)),_0x47f23b['coordinateSystem']=_0x1916ff);});};if(echarts__namespace!==null&&echarts__namespace!==void 0x0&&echarts__namespace['init'])echarts__namespace['registerCoordinateSystem']('mars3dMap',CompositeCoordinateSystem),echarts__namespace['registerAction']({'type':'mars3dMapRoam','event':'mars3dMapRoam','update':'updateLayout'},function(_0x1899fa,_0x327bd9){}),echarts__namespace['extendComponentModel']({'type':'mars3dMap','getBMap':function(){return this['_mars3d_scene'];},'defaultOption':{'roam':![]}}),echarts__namespace[_0x135642(0x190)]({'type':_0x135642(0x1a6),'init':function(_0x2c3821,_0x56876c){const _0x5c284b={_0xc464a9:0x181},_0x42bfc9=_0x135642;this['api']=_0x56876c,this['scene']=_0x2c3821['scheduler']['ecInstance']['_mars3d_scene'],this[_0x42bfc9(_0x5c284b._0xc464a9)]['postRender']['addEventListener'](this['moveHandler'],this);},'moveHandler':function(_0x2ab59f,_0x266bcd){const _0x32679a=_0x135642;this['api'][_0x32679a(0x197)]({'type':'mars3dMapRoam'});},'render':function(_0x497259,_0x2f9ee3,_0x9edff2){},'dispose':function(_0x324f14){const _0x143a3d={_0x24a28d:0x171},_0x14d059=_0x135642;this['scene'][_0x14d059(0x184)]['removeEventListener'](this[_0x14d059(_0x143a3d._0x24a28d)],this);}});else throw new Error('请引入\x20echarts\x20库\x20');const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace['layer']['BaseLayer'];class EchartsLayer extends BaseLayer{constructor(_0x4fd678={}){const _0xc24da6=_0x135642;super(_0x4fd678),this['_pointerEvents']=this[_0xc24da6(0x18d)]['pointerEvents'];}get['layer'](){const _0x329c36={_0x113033:0x1ac},_0x917625=_0x135642;return this[_0x917625(_0x329c36._0x113033)];}get['pointerEvents'](){return this['_pointerEvents'];}set[_0x135642(0x1a3)](_0x5f00c5){const _0x184a24=_0x135642;this['_pointerEvents']=_0x5f00c5,this['_echartsContainer']&&(_0x5f00c5?this['_echartsContainer']['style'][_0x184a24(0x1a3)]='all':this['_echartsContainer']['style'][_0x184a24(0x1a3)]='none');}['_setOptionsHook'](_0x55c8c3,_0x56f180){const _0x35468f=_0x135642;this[_0x35468f(0x1b8)](_0x55c8c3);}['_showHook'](_0x415056){const _0x770289=_0x135642;_0x415056?this['_echartsContainer']['style'][_0x770289(0x19c)]=_0x770289(0x1ad):this['_echartsContainer'][_0x770289(0x18e)][_0x770289(0x19c)]='hidden';}[_0x135642(0x189)](){const _0x4e8844={_0x342885:0x172,_0x3e6fb8:0x18d},_0x20bb3f=_0x135642;this['_map']['scene']['echartsDepthTest']=this['options']['depthTest']??!![],this[_0x20bb3f(_0x4e8844._0x342885)]['scene']['echartsAutoHeight']=this['options']['clampToGround']??![],this['_map']['scene']['echartsFixedHeight']=this[_0x20bb3f(_0x4e8844._0x3e6fb8)]['fixedHeight']??0x0;}['_addedHook'](){const _0x354820={_0x3991b6:0x185},_0x351a80=_0x135642;this['_echartsContainer']=this['_createChartOverlay'](),this['_echartsInstance']=echarts__namespace['init'](this[_0x351a80(_0x354820._0x3991b6)]),this[_0x351a80(0x1ac)]['_mars3d_scene']=this['_map'][_0x351a80(0x181)],this['setEchartsOption'](this['options']);}[_0x135642(0x1af)](){const _0x1f11b5=_0x135642;this['_echartsInstance']&&(this['_echartsInstance'][_0x1f11b5(0x18f)](),this['_echartsInstance']['dispose'](),delete this['_echartsInstance']),this['_echartsContainer']&&(this['_map']['container'][_0x1f11b5(0x176)](this['_echartsContainer']),delete this['_echartsContainer']);}['_createChartOverlay'](){const _0x525618={_0x2b6400:0x19b,_0xdf55da:0x18e,_0xd948cc:0x18e,_0x142b94:0x183,_0x5115a1:0x181,_0x1e75b6:0x1a2,_0x6d4da:0x1a3,_0x16baad:0x193},_0x6f1899=_0x135642,_0x43a0da=mars3d__namespace['DomUtil']['create']('div','mars3d-echarts',this['_map'][_0x6f1899(_0x525618._0x2b6400)]);return _0x43a0da['id']=this['id'],_0x43a0da[_0x6f1899(_0x525618._0xdf55da)]['position']='absolute',_0x43a0da['style']['top']=_0x6f1899(0x19a),_0x43a0da['style'][_0x6f1899(0x1aa)]='0px',_0x43a0da[_0x6f1899(_0x525618._0xd948cc)][_0x6f1899(_0x525618._0x142b94)]=this['_map'][_0x6f1899(_0x525618._0x5115a1)]['canvas']['clientWidth']+'px',_0x43a0da['style']['height']=this[_0x6f1899(0x172)][_0x6f1899(_0x525618._0x5115a1)]['canvas'][_0x6f1899(_0x525618._0x1e75b6)]+'px',_0x43a0da[_0x6f1899(0x18e)][_0x6f1899(_0x525618._0x6d4da)]=this['_pointerEvents']?'all':'none',_0x43a0da['style']['zIndex']=this['options'][_0x6f1899(_0x525618._0x16baad)]??0x9,_0x43a0da;}[_0x135642(0x196)](){const _0x2e50e9={_0x37709e:0x1ac,_0x3971eb:0x183,_0x3d41c3:0x181,_0x317df3:0x18e},_0x5efe58=_0x135642;if(!this[_0x5efe58(_0x2e50e9._0x37709e)])return;this['_echartsContainer']['style'][_0x5efe58(_0x2e50e9._0x3971eb)]=this[_0x5efe58(0x172)][_0x5efe58(_0x2e50e9._0x3d41c3)][_0x5efe58(0x194)]['clientWidth']+'px',this['_echartsContainer'][_0x5efe58(_0x2e50e9._0x317df3)]['height']=this[_0x5efe58(0x172)]['scene']['canvas']['clientHeight']+'px',this['_echartsInstance'][_0x5efe58(0x196)]();}['setEchartsOption'](_0x1f1b6f,_0x294a75,_0x2a50fa){const _0x390431={_0x6501c9:0x198,_0x28f3d2:0x1b7},_0x102584=_0x135642;this[_0x102584(0x1ac)]&&(_0x1f1b6f={'mars3dMap':{},...mars3d__namespace[_0x102584(_0x390431._0x6501c9)][_0x102584(_0x390431._0x28f3d2)](_0x1f1b6f,{'onlySimpleType':!![]})},delete _0x1f1b6f['eventParent'],this['_echartsInstance']['setOption'](_0x1f1b6f,_0x294a75,_0x2a50fa));}['getRectangle'](_0x5d4ef4){const _0x1e3b48={_0x4390f1:0x18c},_0x493855={_0x2c1646:0x1a8},_0x33b6dd={_0x4e4a1b:0x180},_0x63384e={_0x39d29e:0x1b3},_0x30022e=_0x135642;let _0x505d31,_0x42e161,_0x16aff5,_0x2cd16a;function _0x24d3ed(_0x37224a){const _0x2b9cde=_0x2f08;if(!Array['isArray'](_0x37224a))return;const _0x5c3dc0=_0x37224a[0x0]||0x0,_0x186ea7=_0x37224a[0x1]||0x0;_0x5c3dc0!==0x0&&_0x186ea7!==0x0&&(_0x505d31===undefined?(_0x505d31=_0x5c3dc0,_0x42e161=_0x5c3dc0,_0x16aff5=_0x186ea7,_0x2cd16a=_0x186ea7):(_0x505d31=Math['min'](_0x505d31,_0x5c3dc0),_0x42e161=Math['max'](_0x42e161,_0x5c3dc0),_0x16aff5=Math[_0x2b9cde(_0x63384e._0x39d29e)](_0x16aff5,_0x186ea7),_0x2cd16a=Math['max'](_0x2cd16a,_0x186ea7)));}const _0x4a0ed2=this['options']['series'];_0x4a0ed2&&_0x4a0ed2['forEach'](_0x30b3be=>{const _0x218f6e=_0x2f08;_0x30b3be['data']&&_0x30b3be[_0x218f6e(_0x493855._0x2c1646)]['forEach'](_0x41766e=>{const _0x592c20=_0x218f6e;if(_0x41766e['value'])_0x24d3ed(_0x41766e['value']);else _0x41766e[_0x592c20(_0x33b6dd._0x4e4a1b)]&&_0x41766e['coords']['forEach'](_0x24bec6=>{_0x24d3ed(_0x24bec6);});});});if(_0x505d31===0x0&&_0x16aff5===0x0&&_0x42e161===0x0&&_0x2cd16a===0x0)return null;return _0x5d4ef4!==null&&_0x5d4ef4!==void 0x0&&_0x5d4ef4[_0x30022e(_0x1e3b48._0x4390f1)]?{'xmin':_0x505d31,'xmax':_0x42e161,'ymin':_0x16aff5,'ymax':_0x2cd16a}:Cesium['Rectangle']['fromDegrees'](_0x505d31,_0x16aff5,_0x42e161,_0x2cd16a);}['on'](_0x1af940,_0x51a727,_0x4502c6){return this['_echartsInstance']['on'](_0x1af940,_0x51a727,_0x4502c6||this),this;}[_0x135642(0x177)](_0x3d6510,_0x1c2554,_0x32b013,_0x23efe7){return this['_echartsInstance']['on'](_0x3d6510,_0x1c2554,_0x32b013,_0x23efe7||this),this;}[_0x135642(0x187)](_0x39b079,_0x259389,_0x440b24){const _0x4efa43={_0x265931:0x187},_0x5cd382=_0x135642;return this['_echartsInstance'][_0x5cd382(_0x4efa43._0x265931)](_0x39b079,_0x259389,_0x440b24||this),this;}}mars3d__namespace[_0x135642(0x17f)][_0x135642(0x182)](_0x135642(0x179),EchartsLayer),mars3d__namespace['layer']['EchartsLayer']=EchartsLayer,mars3d__namespace['echarts']=echarts__namespace,exports['EchartsLayer']=EchartsLayer,Object[_0x135642(0x1b0)](echarts)['forEach'](function(_0x4db763){const _0x21f263={_0x37e2f0:0x17e},_0x254902=_0x135642;if(_0x4db763!==_0x254902(_0x21f263._0x37e2f0)&&!exports[_0x254902(0x192)](_0x4db763))Object['defineProperty'](exports,_0x4db763,{'enumerable':!![],'get':function(){return echarts[_0x4db763];}});}),Object['defineProperty'](exports,'__esModule',{'value':!![]});
}));
