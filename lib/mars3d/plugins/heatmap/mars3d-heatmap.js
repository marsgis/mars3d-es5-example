/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.7.2
 * 编译日期：2024-01-29 17:15:45
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2024-01-15
 */
(function (global, factory) {
	typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d'))) :
	typeof define === 'function' && define.amd ? define(['exports', 'mars3d'], factory) :
	(global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d));
})(this, (function (exports, mars3d) { 
'use strict';function _0x4822(){var _0x4caa25=['renderall','addGraphic','emit','_data','create','replace','bumpMap','_xField','458809JWzkaS','getImageData','_radi','data','ctx','globalAlpha','_map','minCanvasSize','_graphic','_updateGradient','floor','_last_mBounds','DomUtil','type','_max','image','removeData','_graphic2','maxCanvasSize','min','clientWidth','removeLayer','xField','arcRadiusScale','addPosition','exports','apply','value','_mBoundsMax','flyTo','getContext','defaultValueField','RectanglePrimitive','length','keys','StencilFunction','canvas2d','setPositions','Material','rgba(0,0,0,1)','_clear','rectangle','20tQmatM','opacity',';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a','_layer','register','uniforms','extremachange','backgroundColor','getValueAt','rgb(255,0,0)','getRectangle','getData','fillStyle','clearRect','putImageData','rgb(140,140,140)','blue','canvas','_coordinator','plugins','undefined','_getInternalData','_width','520eWkAjM','_rectangle','ymin','EllipsoidSurfaceAppearance','string','addColorStop','146WaRWhT','BlendingState','69769FmmCDw','defineProperty','_templates','_container','LngLatPoint','clientHeight','_height','setDataMin','renderPartial','_organiseData','_min','__esModule','StencilOperation','defaultBlur','setCoordinator','_positions','forEach','lng','diffHeight','radius','1598945IIrPUu','shadowCtx','_renderBoundaries','onExtremaChange','lat','defaultXField','flyToByAnimationEnd','maxOpacity','_renderer','_drawAlpha','options','max','28023eRIsgq','width','KEEP','_heat','in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20','height','addLayer','ALWAYS','minOpacity','3949400IqoXbs','ymax','prototype','fillRect','4645812UYPWQg','PointTrans','className','plugin','heatStyle','_store','default','defaultGradient','defaultRadius','style','yellow','10535067kHOxpT','cStore','call','abs','cssText','lonlat2mercator','_removedHook','positions','xmin','mars3d-heatmap\x20mars3d-hideDiv','_config','isArray','Util','gradient'];_0x4822=function(){return _0x4caa25;};return _0x4822();}var _0x575905=_0x538d;(function(_0x37d6e2,_0x47d011){var _0x42b5e2={_0xab857a:0xf5,_0x39be49:0x13c,_0x2a7868:0xc7,_0x287295:0xd4,_0x8bd413:0x136,_0x209b36:0xdf,_0x5978e1:0x11f},_0x532479=_0x538d,_0x599991=_0x37d6e2();while(!![]){try{var _0x45d0c4=-parseInt(_0x532479(_0x42b5e2._0xab857a))/0x1+-parseInt(_0x532479(_0x42b5e2._0x39be49))/0x2*(-parseInt(_0x532479(_0x42b5e2._0x2a7868))/0x3)+parseInt(_0x532479(0xd0))/0x4+parseInt(_0x532479(0xbb))/0x5+parseInt(_0x532479(_0x42b5e2._0x287295))/0x6+parseInt(_0x532479(0xa7))/0x7*(parseInt(_0x532479(_0x42b5e2._0x8bd413))/0x8)+-parseInt(_0x532479(_0x42b5e2._0x209b36))/0x9*(parseInt(_0x532479(_0x42b5e2._0x5978e1))/0xa);if(_0x45d0c4===_0x47d011)break;else _0x599991['push'](_0x599991['shift']());}catch(_0x52ae22){_0x599991['push'](_0x599991['shift']());}}}(_0x4822,0x953b6));function _interopNamespace(_0x28c482){var _0x20e185={_0x507a8f:0xb2},_0x596e11={_0x1f78f9:0xa8},_0x34fd4f=_0x538d;if(_0x28c482&&_0x28c482[_0x34fd4f(_0x20e185._0x507a8f)])return _0x28c482;var _0x3a01f3=Object['create'](null);return _0x28c482&&Object['keys'](_0x28c482)['forEach'](function(_0x24947e){var _0x5d22ae=_0x34fd4f;if(_0x24947e!=='default'){var _0x3e8af5=Object['getOwnPropertyDescriptor'](_0x28c482,_0x24947e);Object[_0x5d22ae(_0x596e11._0x1f78f9)](_0x3a01f3,_0x24947e,_0x3e8af5['get']?_0x3e8af5:{'enumerable':!![],'get':function(){return _0x28c482[_0x24947e];}});}}),_0x3a01f3[_0x34fd4f(0xda)]=_0x28c482,_0x3a01f3;}function _mergeNamespaces(_0x169ff9,_0x43ae61){var _0x4bd6c7={_0x11b38e:0x13a};return _0x43ae61['forEach'](function(_0x528f01){var _0x30fcec=_0x538d;_0x528f01&&typeof _0x528f01!==_0x30fcec(_0x4bd6c7._0x11b38e)&&!Array[_0x30fcec(0xea)](_0x528f01)&&Object['keys'](_0x528f01)['forEach'](function(_0xe7e32d){if(_0xe7e32d!=='default'&&!(_0xe7e32d in _0x169ff9)){var _0x15cf7a=Object['getOwnPropertyDescriptor'](_0x528f01,_0xe7e32d);Object['defineProperty'](_0x169ff9,_0xe7e32d,_0x15cf7a['get']?_0x15cf7a:{'enumerable':!![],'get':function(){return _0x528f01[_0xe7e32d];}});}});}),_0x169ff9;}var mars3d__namespace=_interopNamespace(mars3d),commonjsGlobal=typeof globalThis!=='undefined'?globalThis:typeof window!==_0x575905(0x133)?window:typeof global!==_0x575905(0x133)?global:typeof self!=='undefined'?self:{},heatmap$1={'exports':{}};(function(_0x3a309d){var _0x3965e8={_0x5571ea:0x119,_0xe31440:0x110};(function(_0x1caecb,_0x111523,_0x277dfa){var _0x47c149=_0x538d;_0x3a309d['exports']?_0x3a309d[_0x47c149(0x10e)]=_0x277dfa():_0x111523[_0x1caecb]=_0x277dfa();}('h337',commonjsGlobal,function(){var _0x32b45d={_0x5b57b2:0xd9},_0xcfbe3f={_0x5fad0f:0xe9,_0x5b570b:0xed},_0x4bef28={_0x34ccc2:0x105,_0x3bfeff:0x10f,_0x562de5:0xd9},_0x5a45ea={_0x5c2184:0xaf},_0x4ef6c9={_0x189b88:0xd2},_0x4a6114={_0x55c7ce:0xbd,_0x5f1e3a:0xbc},_0x1b418b={_0x301cfa:0xc8},_0x155973={_0x1c744f:0xfe},_0xf2a74f={_0x3c9931:0xd6,_0x4aed13:0xc8,_0x28441c:0xc8,_0x57e1a1:0xbc,_0x780b6:0x113,_0x580eac:0xdd,_0x1a49b8:0xe3},_0x592186={_0x44d623:0x130,_0x4d43e9:0x113,_0x2a3a6e:0x12b},_0x147b14={_0x52a936:0xdc},_0x549c04={_0x41f382:0x134},_0x440835={_0x51a746:0xf0,_0x505210:0xb1},_0x29837d={_0x2889b3:0xf0},_0x206519=_0x538d,_0x76ab5={'defaultRadius':0x28,'defaultRenderer':_0x206519(_0x3965e8._0x5571ea),'defaultGradient':{0.25:'rgb(0,0,255)',0.55:'rgb(0,255,0)',0.85:'yellow',0x1:_0x206519(0x128)},'defaultMaxOpacity':0x1,'defaultMinOpacity':0x0,'defaultBlur':0.85,'defaultXField':'x','defaultYField':'y','defaultValueField':_0x206519(_0x3965e8._0xe31440),'plugins':{}},_0x3faa3e=function _0xea7fc9(){var _0xbb1e4a={_0x26d5b8:0x103},_0x4034cd={_0x3de4e8:0x131,_0x3823e5:0xef},_0x21e1ef={_0x1b0f7b:0xf0,_0x55375a:0xf7,_0xbb0717:0xb0,_0xc270f:0x103,_0x37d573:0x134},_0x49aab1={_0x1be4fb:0xe1,_0x483fc9:0xf0,_0x40c567:0xb1},_0x393dc1={_0x47e37e:0xb1},_0x241dc7=_0x206519,_0x42802e=function _0x44e52a(_0x2ce823){var _0x162c01=_0x538d;this['_coordinator']={},this[_0x162c01(_0x29837d._0x2889b3)]=[],this['_radi']=[],this['_min']=0xa,this['_max']=0x1,this[_0x162c01(0xf4)]=_0x2ce823[_0x162c01(0x10b)]||_0x2ce823[_0x162c01(0xc0)],this['_yField']=_0x2ce823['yField']||_0x2ce823['defaultYField'],this['_valueField']=_0x2ce823['valueField']||_0x2ce823[_0x162c01(0x114)],_0x2ce823['radius']&&(this['_cfgRadius']=_0x2ce823['radius']);},_0x146445=_0x76ab5[_0x241dc7(_0x147b14._0x52a936)];return _0x42802e['prototype']={'_organiseData':function(_0x5d80f9,_0x2ef153){var _0x266492=_0x241dc7,_0x3a904a=_0x5d80f9[this['_xField']],_0x12614f=_0x5d80f9[this['_yField']],_0x388bfe=this['_radi'],_0x5b00d0=this[_0x266492(0xf0)],_0x3e303f=this[_0x266492(0x103)],_0x336bd6=this['_min'],_0x351fac=_0x5d80f9[this['_valueField']]||0x1,_0x2c5382=_0x5d80f9[_0x266492(0xba)]||this['_cfgRadius']||_0x146445;!_0x5b00d0[_0x3a904a]&&(_0x5b00d0[_0x3a904a]=[],_0x388bfe[_0x3a904a]=[]);!_0x5b00d0[_0x3a904a][_0x12614f]?(_0x5b00d0[_0x3a904a][_0x12614f]=_0x351fac,_0x388bfe[_0x3a904a][_0x12614f]=_0x2c5382):_0x5b00d0[_0x3a904a][_0x12614f]+=_0x351fac;var _0x577fdc=_0x5b00d0[_0x3a904a][_0x12614f];if(_0x577fdc>_0x3e303f)return!_0x2ef153?this['_max']=_0x577fdc:this['setDataMax'](_0x577fdc),![];else return _0x577fdc<_0x336bd6?(!_0x2ef153?this[_0x266492(_0x393dc1._0x47e37e)]=_0x577fdc:this['setDataMin'](_0x577fdc),![]):{'x':_0x3a904a,'y':_0x12614f,'value':_0x351fac,'radius':_0x2c5382,'min':_0x336bd6,'max':_0x3e303f};},'_unOrganizeData':function(){var _0x2a4016=_0x241dc7,_0x413d7=[],_0x53b71f=this[_0x2a4016(_0x440835._0x51a746)],_0xe087e7=this['_radi'];for(var _0x7d390e in _0x53b71f){for(var _0x3b4b27 in _0x53b71f[_0x7d390e]){_0x413d7['push']({'x':_0x7d390e,'y':_0x3b4b27,'radius':_0xe087e7[_0x7d390e][_0x3b4b27],'value':_0x53b71f[_0x7d390e][_0x3b4b27]});}}return{'min':this[_0x2a4016(_0x440835._0x505210)],'max':this['_max'],'data':_0x413d7};},'_onExtremaChange':function(){this['_coordinator']['emit']('extremachange',{'min':this['_min'],'max':this['_max']});},'addData':function(){var _0xeb404b=_0x241dc7;if(arguments[0x0]['length']>0x0){var _0x46f484=arguments[0x0],_0x963c9=_0x46f484['length'];while(_0x963c9--){this['addData'][_0xeb404b(_0x49aab1._0x1be4fb)](this,_0x46f484[_0x963c9]);}}else{var _0x3501df=this['_organiseData'](arguments[0x0],!![]);_0x3501df&&(this[_0xeb404b(_0x49aab1._0x483fc9)][_0xeb404b(0x116)]===0x0&&(this[_0xeb404b(_0x49aab1._0x40c567)]=this['_max']=_0x3501df['value']),this['_coordinator']['emit']('renderpartial',{'min':this['_min'],'max':this['_max'],'data':[_0x3501df]}));}return this;},'setData':function(_0x1919e8){var _0x48614a=_0x241dc7,_0x83543d=_0x1919e8['data'],_0x180abf=_0x83543d['length'];this[_0x48614a(_0x21e1ef._0x1b0f7b)]=[],this[_0x48614a(_0x21e1ef._0x55375a)]=[];for(var _0x4fe83a=0x0;_0x4fe83a<_0x180abf;_0x4fe83a++){this[_0x48614a(_0x21e1ef._0xbb0717)](_0x83543d[_0x4fe83a],![]);}return this[_0x48614a(_0x21e1ef._0xc270f)]=_0x1919e8['max'],this['_min']=_0x1919e8[_0x48614a(0x108)]||0x0,this['_onExtremaChange'](),this[_0x48614a(0x131)]['emit']('renderall',this[_0x48614a(_0x21e1ef._0x37d573)]()),this;},'removeData':function(){},'setDataMax':function(_0x29e5c1){var _0x433eac=_0x241dc7;return this['_max']=_0x29e5c1,this['_onExtremaChange'](),this['_coordinator']['emit'](_0x433eac(0xed),this[_0x433eac(_0x549c04._0x41f382)]()),this;},'setDataMin':function(_0x2fbfe1){var _0x52992d=_0x241dc7;return this[_0x52992d(0xb1)]=_0x2fbfe1,this['_onExtremaChange'](),this[_0x52992d(_0x4034cd._0x3de4e8)][_0x52992d(_0x4034cd._0x3823e5)]('renderall',this['_getInternalData']()),this;},'setCoordinator':function(_0xf656f7){this['_coordinator']=_0xf656f7;},'_getInternalData':function(){var _0x2f1a2c=_0x241dc7;return{'max':this[_0x2f1a2c(_0xbb1e4a._0x26d5b8)],'min':this[_0x2f1a2c(0xb1)],'data':this['_data'],'radi':this['_radi']};},'getData':function(){return this['_unOrganizeData']();}},_0x42802e;}(),_0x22ecf2=function _0x327200(){var _0x3508f1={_0x712a87:0xf6},_0x138d01={_0x3235fa:0xb1,_0x217cb1:0xba,_0x27a0d3:0x108,_0x38f5e6:0xa9,_0x52abd1:0xfa,_0x20ebee:0xbd},_0x184f8a={_0x1b9eff:0xb4,_0x347129:0xc8,_0x5bb59f:0x120},_0x371c0b={_0x2035fc:0x12c,_0x1cf821:0xad,_0x351984:0xad},_0x36f3dc={_0x4d9fad:0x108},_0x24bfd0={_0x1eab82:0x13b,_0x2d8a11:0x12b,_0x33f3c4:0xd3,_0x5a49f5:0xf6,_0x3cd6de:0xf8},_0x900b6d=function(_0x347ff6){var _0x2b606f=_0x538d,_0xde2d4=_0x347ff6[_0x2b606f(0xec)]||_0x347ff6['defaultGradient'],_0x1362f0=document['createElement']('canvas'),_0x590d01=_0x1362f0['getContext']('2d',{'willReadFrequently':!![]});_0x1362f0['width']=0x100,_0x1362f0[_0x2b606f(0xcc)]=0x1;var _0x2be268=_0x590d01['createLinearGradient'](0x0,0x0,0x100,0x1);for(var _0x59f880 in _0xde2d4){_0x2be268[_0x2b606f(_0x24bfd0._0x1eab82)](_0x59f880,_0xde2d4[_0x59f880]);}return _0x590d01[_0x2b606f(_0x24bfd0._0x2d8a11)]=_0x2be268,_0x590d01[_0x2b606f(_0x24bfd0._0x33f3c4)](0x0,0x0,0x100,0x1),_0x590d01[_0x2b606f(_0x24bfd0._0x5a49f5)](0x0,0x0,0x100,0x1)[_0x2b606f(_0x24bfd0._0x3cd6de)];},_0x4daf78=function(_0x1f6952,_0x256636){var _0x5c422f=_0x538d,_0x22d29a=document['createElement'](_0x5c422f(_0x592186._0x44d623)),_0x6f9ff=_0x22d29a[_0x5c422f(_0x592186._0x4d43e9)]('2d',{'willReadFrequently':!![]}),_0x28d100=_0x1f6952,_0x1bdd73=_0x1f6952;_0x22d29a['width']=_0x22d29a['height']=_0x1f6952*0x2;if(_0x256636==0x1)_0x6f9ff['beginPath'](),_0x6f9ff['arc'](_0x28d100,_0x1bdd73,_0x1f6952,0x0,0x2*Math['PI'],![]),_0x6f9ff[_0x5c422f(_0x592186._0x2a3a6e)]='rgba(0,0,0,1)',_0x6f9ff['fill']();else{var _0x4a4fb0=_0x6f9ff['createRadialGradient'](_0x28d100,_0x1bdd73,_0x1f6952*_0x256636,_0x28d100,_0x1bdd73,_0x1f6952);_0x4a4fb0['addColorStop'](0x0,_0x5c422f(0x11c)),_0x4a4fb0['addColorStop'](0x1,'rgba(0,0,0,0)'),_0x6f9ff['fillStyle']=_0x4a4fb0,_0x6f9ff['fillRect'](0x0,0x0,0x2*_0x1f6952,0x2*_0x1f6952);}return _0x22d29a;},_0x33f171=function(_0x3de81e){var _0x4b4d36=_0x538d,_0x961d29=[],_0xbd573a=_0x3de81e[_0x4b4d36(_0x36f3dc._0x4d9fad)],_0x10454f=_0x3de81e[_0x4b4d36(0xc6)],_0x283098=_0x3de81e['radi'],_0x3de81e=_0x3de81e['data'],_0x5e5338=Object[_0x4b4d36(0x117)](_0x3de81e),_0x4f651c=_0x5e5338['length'];while(_0x4f651c--){var _0x17aed3=_0x5e5338[_0x4f651c],_0x226541=Object['keys'](_0x3de81e[_0x17aed3]),_0x2b9a33=_0x226541['length'];while(_0x2b9a33--){var _0x13e6f3=_0x226541[_0x2b9a33],_0x1d5b37=_0x3de81e[_0x17aed3][_0x13e6f3],_0xb0d4ec=_0x283098[_0x17aed3][_0x13e6f3];_0x961d29['push']({'x':_0x17aed3,'y':_0x13e6f3,'value':_0x1d5b37,'radius':_0xb0d4ec});}}return{'min':_0xbd573a,'max':_0x10454f,'data':_0x961d29};};function _0x17aee7(_0x32264b){var _0x207702=_0x538d,_0x5806cb=_0x32264b['container'],_0x12c36b=this['shadowCanvas']=document['createElement']('canvas'),_0x29d27a=this['canvas']=_0x32264b['canvas']||document['createElement'](_0x207702(0x130));this['_renderBoundaries']=[0x2710,0x2710,0x0,0x0];var _0x1096b7=getComputedStyle(_0x32264b['container'])||{};_0x29d27a[_0x207702(_0xf2a74f._0x3c9931)]='heatmap-canvas',this[_0x207702(0x135)]=_0x29d27a[_0x207702(_0xf2a74f._0x4aed13)]=_0x12c36b['width']=_0x32264b[_0x207702(_0xf2a74f._0x28441c)]||+_0x1096b7['width'][_0x207702(0xf2)](/px/,''),this['_height']=_0x29d27a[_0x207702(0xcc)]=_0x12c36b['height']=_0x32264b['height']||+_0x1096b7[_0x207702(0xcc)]['replace'](/px/,''),this[_0x207702(_0xf2a74f._0x57e1a1)]=_0x12c36b[_0x207702(_0xf2a74f._0x780b6)]('2d',{'willReadFrequently':!![]}),this['ctx']=_0x29d27a[_0x207702(_0xf2a74f._0x780b6)]('2d',{'willReadFrequently':!![]}),_0x29d27a[_0x207702(_0xf2a74f._0x580eac)][_0x207702(0xe3)]=_0x12c36b['style'][_0x207702(_0xf2a74f._0x1a49b8)]='position:absolute;left:0;top:0;',_0x5806cb['style']['position']='relative',_0x5806cb['appendChild'](_0x29d27a),this['_palette']=_0x900b6d(_0x32264b),this[_0x207702(0xa9)]={},this['_setStyles'](_0x32264b);}return _0x17aee7['prototype']={'renderPartial':function(_0x24f627){var _0x4b64c1=_0x538d;_0x24f627['data'][_0x4b64c1(0x116)]>0x0&&(this['_drawAlpha'](_0x24f627),this['_colorize']());},'renderAll':function(_0x36cc66){var _0x1461b4=_0x538d;this[_0x1461b4(0x11d)](),_0x36cc66['data'][_0x1461b4(0x116)]>0x0&&(this[_0x1461b4(0xc4)](_0x33f171(_0x36cc66)),this['_colorize']());},'_updateGradient':function(_0x50f4f0){this['_palette']=_0x900b6d(_0x50f4f0);},'updateConfig':function(_0x5e1426){var _0x1b40a7=_0x538d;_0x5e1426['gradient']&&this[_0x1b40a7(_0x155973._0x1c744f)](_0x5e1426),this['_setStyles'](_0x5e1426);},'setDimensions':function(_0x2b2c5b,_0x3fed90){var _0x5091ac=_0x538d;this['_width']=_0x2b2c5b,this['_height']=_0x3fed90,this['canvas']['width']=this['shadowCanvas'][_0x5091ac(_0x1b418b._0x301cfa)]=_0x2b2c5b,this['canvas']['height']=this['shadowCanvas']['height']=_0x3fed90;},'_clear':function(){var _0x373a8f=_0x538d;this['shadowCtx'][_0x373a8f(_0x371c0b._0x2035fc)](0x0,0x0,this['_width'],this[_0x373a8f(_0x371c0b._0x1cf821)]),this['ctx']['clearRect'](0x0,0x0,this['_width'],this[_0x373a8f(_0x371c0b._0x351984)]);},'_setStyles':function(_0x3c210d){var _0x59e0de=_0x538d;this['_blur']=_0x3c210d['blur']==0x0?0x0:_0x3c210d['blur']||_0x3c210d[_0x59e0de(_0x184f8a._0x1b9eff)],_0x3c210d['backgroundColor']&&(this['canvas']['style'][_0x59e0de(0x126)]=_0x3c210d['backgroundColor']),this[_0x59e0de(0x135)]=this[_0x59e0de(0x130)][_0x59e0de(_0x184f8a._0x347129)]=this['shadowCanvas'][_0x59e0de(0xc8)]=_0x3c210d['width']||this['_width'],this['_height']=this['canvas']['height']=this['shadowCanvas']['height']=_0x3c210d['height']||this['_height'],this['_opacity']=(_0x3c210d[_0x59e0de(_0x184f8a._0x5bb59f)]||0x0)*0xff,this['_maxOpacity']=(_0x3c210d[_0x59e0de(0xc2)]||_0x3c210d['defaultMaxOpacity'])*0xff,this['_minOpacity']=(_0x3c210d[_0x59e0de(0xcf)]||_0x3c210d['defaultMinOpacity'])*0xff,this['_useGradientOpacity']=!!_0x3c210d['useGradientOpacity'];},'_drawAlpha':function(_0x3cebdc){var _0x232815=_0x538d,_0x4d8f01=this[_0x232815(_0x138d01._0x3235fa)]=_0x3cebdc[_0x232815(0x108)],_0x3b1ae8=this['_max']=_0x3cebdc['max'],_0x3cebdc=_0x3cebdc['data']||[],_0x96021=_0x3cebdc[_0x232815(0x116)],_0x59154a=0x1-this['_blur'];while(_0x96021--){var _0x20bfe5=_0x3cebdc[_0x96021],_0x58f0f5=_0x20bfe5['x'],_0x3bbdf0=_0x20bfe5['y'],_0x4960a1=_0x20bfe5[_0x232815(_0x138d01._0x217cb1)],_0x33a391=Math[_0x232815(_0x138d01._0x27a0d3)](_0x20bfe5[_0x232815(0x110)],_0x3b1ae8),_0x2e1128=_0x58f0f5-_0x4960a1,_0x4cd34a=_0x3bbdf0-_0x4960a1,_0xd4eeba=this['shadowCtx'],_0x134200;!this['_templates'][_0x4960a1]?this[_0x232815(0xa9)][_0x4960a1]=_0x134200=_0x4daf78(_0x4960a1,_0x59154a):_0x134200=this[_0x232815(_0x138d01._0x38f5e6)][_0x4960a1];var _0x4791a5=(_0x33a391-_0x4d8f01)/(_0x3b1ae8-_0x4d8f01);_0xd4eeba[_0x232815(_0x138d01._0x52abd1)]=_0x4791a5<0.01?0.01:_0x4791a5,_0xd4eeba['drawImage'](_0x134200,_0x2e1128,_0x4cd34a),_0x2e1128<this[_0x232815(0xbd)][0x0]&&(this['_renderBoundaries'][0x0]=_0x2e1128),_0x4cd34a<this['_renderBoundaries'][0x1]&&(this['_renderBoundaries'][0x1]=_0x4cd34a),_0x2e1128+0x2*_0x4960a1>this[_0x232815(_0x138d01._0x20ebee)][0x2]&&(this['_renderBoundaries'][0x2]=_0x2e1128+0x2*_0x4960a1),_0x4cd34a+0x2*_0x4960a1>this['_renderBoundaries'][0x3]&&(this['_renderBoundaries'][0x3]=_0x4cd34a+0x2*_0x4960a1);}},'_colorize':function(){var _0x2c4124=_0x538d,_0x4789cb=this['_renderBoundaries'][0x0],_0x23dac1=this['_renderBoundaries'][0x1],_0x214c03=this['_renderBoundaries'][0x2]-_0x4789cb,_0x36e9c5=this[_0x2c4124(_0x4a6114._0x55c7ce)][0x3]-_0x23dac1,_0x41b0e3=this['_width'],_0x600b4d=this[_0x2c4124(0xad)],_0xa2adde=this['_opacity'],_0xe1c630=this['_maxOpacity'],_0x4a39eb=this['_minOpacity'],_0x4dad1c=this['_useGradientOpacity'];_0x4789cb<0x0&&(_0x4789cb=0x0);_0x23dac1<0x0&&(_0x23dac1=0x0);_0x4789cb+_0x214c03>_0x41b0e3&&(_0x214c03=_0x41b0e3-_0x4789cb);_0x23dac1+_0x36e9c5>_0x600b4d&&(_0x36e9c5=_0x600b4d-_0x23dac1);var _0x3a39c1=this[_0x2c4124(_0x4a6114._0x5f1e3a)][_0x2c4124(0xf6)](_0x4789cb,_0x23dac1,_0x214c03,_0x36e9c5),_0xab65ed=_0x3a39c1['data'],_0x5c0bb8=_0xab65ed['length'],_0x2ca6f7=this['_palette'];for(var _0x18804a=0x3;_0x18804a<_0x5c0bb8;_0x18804a+=0x4){var _0x21dcac=_0xab65ed[_0x18804a],_0x22f86e=_0x21dcac*0x4;if(!_0x22f86e)continue;var _0x332720;_0xa2adde>0x0?_0x332720=_0xa2adde:_0x21dcac<_0xe1c630?_0x21dcac<_0x4a39eb?_0x332720=_0x4a39eb:_0x332720=_0x21dcac:_0x332720=_0xe1c630,_0xab65ed[_0x18804a-0x3]=_0x2ca6f7[_0x22f86e],_0xab65ed[_0x18804a-0x2]=_0x2ca6f7[_0x22f86e+0x1],_0xab65ed[_0x18804a-0x1]=_0x2ca6f7[_0x22f86e+0x2],_0xab65ed[_0x18804a]=_0x4dad1c?_0x2ca6f7[_0x22f86e+0x3]:_0x332720;}this['ctx'][_0x2c4124(0x12d)](_0x3a39c1,_0x4789cb,_0x23dac1),this[_0x2c4124(0xbd)]=[0x3e8,0x3e8,0x0,0x0];},'getValueAt':function(_0x52c791){var _0x53f057=_0x538d,_0x40b73e,_0x43725f=this['shadowCtx'],_0x319c69=_0x43725f[_0x53f057(_0x3508f1._0x712a87)](_0x52c791['x'],_0x52c791['y'],0x1,0x1),_0x236278=_0x319c69['data'][0x3],_0x564366=this['_max'],_0x22e43a=this[_0x53f057(0xb1)];return _0x40b73e=Math['abs'](_0x564366-_0x22e43a)*(_0x236278/0xff)>>0x0,_0x40b73e;},'getDataURL':function(){return this['canvas']['toDataURL']();}},_0x17aee7;}(),_0x3ee991=function _0x5a1d1c(){var _0x2bba8d=![];return _0x76ab5['defaultRenderer']==='canvas2d'&&(_0x2bba8d=_0x22ecf2),_0x2bba8d;}(),_0xfd01cc={'merge':function(){var _0x19ddbc={},_0x3a5d23=arguments['length'];for(var _0x12e1c0=0x0;_0x12e1c0<_0x3a5d23;_0x12e1c0++){var _0x5cbe5c=arguments[_0x12e1c0];for(var _0xfecc13 in _0x5cbe5c){_0x19ddbc[_0xfecc13]=_0x5cbe5c[_0xfecc13];}}return _0x19ddbc;}},_0x509011=function _0x5d99b1(){var _0x13f972={_0x26495a:0xae,_0x41c823:0x10f},_0x4037fe={_0x3ba8f2:0xd9},_0x3f4401={_0x3a8bbe:0xd9},_0x535211={_0x46c3ef:0xd9},_0xfdb8d0={_0x1a1b64:0xbe,_0x1a6a55:0x108,_0x38805f:0xec},_0xb58b6e={_0x51eda3:0xe0},_0x1bf9d4=function _0x302da6(){var _0x248b01=_0x538d;function _0x51089f(){this['cStore']={};}return _0x51089f[_0x248b01(_0x4ef6c9._0x189b88)]={'on':function(_0x515714,_0x330d3e,_0x838075){var _0x430ef3=_0x248b01,_0x5dabb9=this[_0x430ef3(_0xb58b6e._0x51eda3)];!_0x5dabb9[_0x515714]&&(_0x5dabb9[_0x515714]=[]),_0x5dabb9[_0x515714]['push'](function(_0x462eff){return _0x330d3e['call'](_0x838075,_0x462eff);});},'emit':function(_0x51e3f2,_0x103417){var _0x135579=this['cStore'];if(_0x135579[_0x51e3f2]){var _0x106a7c=_0x135579[_0x51e3f2]['length'];for(var _0x217c52=0x0;_0x217c52<_0x106a7c;_0x217c52++){var _0x246de5=_0x135579[_0x51e3f2][_0x217c52];_0x246de5(_0x103417);}}}},_0x51089f;}(),_0x59466f=function(_0x11745b){var _0x7eb5c4=_0x538d,_0x563baf=_0x11745b['_renderer'],_0x4d51f2=_0x11745b['_coordinator'],_0x4e21e6=_0x11745b['_store'];_0x4d51f2['on']('renderpartial',_0x563baf[_0x7eb5c4(_0x5a45ea._0x5c2184)],_0x563baf),_0x4d51f2['on']('renderall',_0x563baf['renderAll'],_0x563baf),_0x4d51f2['on'](_0x7eb5c4(0x125),function(_0x2dd06e){var _0x561373=_0x7eb5c4;_0x11745b['_config'][_0x561373(_0xfdb8d0._0x1a1b64)]&&_0x11745b['_config']['onExtremaChange']({'min':_0x2dd06e[_0x561373(_0xfdb8d0._0x1a6a55)],'max':_0x2dd06e['max'],'gradient':_0x11745b['_config'][_0x561373(_0xfdb8d0._0x38805f)]||_0x11745b[_0x561373(0xe9)][_0x561373(0xdb)]});}),_0x4e21e6[_0x7eb5c4(0xb5)](_0x4d51f2);};function _0x321595(){var _0x7d252c=_0x538d,_0x486bd1=this['_config']=_0xfd01cc['merge'](_0x76ab5,arguments[0x0]||{});this['_coordinator']=new _0x1bf9d4();if(_0x486bd1['plugin']){var _0x1dbed2=_0x486bd1[_0x7d252c(0xd7)];if(!_0x76ab5[_0x7d252c(0x132)][_0x1dbed2])throw new Error('Plugin\x20\x27'+_0x1dbed2+'\x27\x20not\x20found.\x20Maybe\x20it\x20was\x20not\x20registered.');else{var _0x4eb366=_0x76ab5['plugins'][_0x1dbed2];this['_renderer']=new _0x4eb366['renderer'](_0x486bd1),this['_store']=new _0x4eb366['store'](_0x486bd1);}}else this['_renderer']=new _0x3ee991(_0x486bd1),this['_store']=new _0x3faa3e(_0x486bd1);_0x59466f(this);}return _0x321595['prototype']={'addData':function(){var _0x213927=_0x538d;return this[_0x213927(_0x535211._0x46c3ef)]['addData']['apply'](this['_store'],arguments),this;},'removeData':function(){var _0x56a411=_0x538d;return this['_store']['removeData']&&this['_store'][_0x56a411(_0x4bef28._0x34ccc2)][_0x56a411(_0x4bef28._0x3bfeff)](this[_0x56a411(_0x4bef28._0x562de5)],arguments),this;},'setData':function(){var _0x5f0b81=_0x538d;return this[_0x5f0b81(_0x3f4401._0x3a8bbe)]['setData']['apply'](this['_store'],arguments),this;},'setDataMax':function(){var _0xe03fca=_0x538d;return this['_store']['setDataMax']['apply'](this[_0xe03fca(_0x4037fe._0x3ba8f2)],arguments),this;},'setDataMin':function(){var _0x104fac=_0x538d;return this[_0x104fac(0xd9)][_0x104fac(_0x13f972._0x26495a)][_0x104fac(_0x13f972._0x41c823)](this['_store'],arguments),this;},'configure':function(_0x27ebb3){var _0x38739a=_0x538d;return this['_config']=_0xfd01cc['merge'](this[_0x38739a(_0xcfbe3f._0x5fad0f)],_0x27ebb3),this['_renderer']['updateConfig'](this['_config']),this[_0x38739a(0x131)]['emit'](_0x38739a(_0xcfbe3f._0x5b570b),this['_store']['_getInternalData']()),this;},'repaint':function(){var _0x125603=_0x538d;return this[_0x125603(0x131)][_0x125603(0xef)]('renderall',this[_0x125603(0xd9)]['_getInternalData']()),this;},'getData':function(){var _0x3e5332=_0x538d;return this[_0x3e5332(_0x32b45d._0x5b57b2)][_0x3e5332(0x12a)]();},'getDataURL':function(){return this['_renderer']['getDataURL']();},'getValueAt':function(_0x8ec9e9){var _0x16c80f=_0x538d;if(this['_store']['getValueAt'])return this['_store']['getValueAt'](_0x8ec9e9);else return this['_renderer'][_0x16c80f(0x127)]?this['_renderer']['getValueAt'](_0x8ec9e9):null;}},_0x321595;}(),_0x3bdc11={'create':function(_0x32b85b){return new _0x509011(_0x32b85b);},'register':function(_0x38ba34,_0x138773){_0x76ab5['plugins'][_0x38ba34]=_0x138773;}};return _0x3bdc11;}));}(heatmap$1));function _0x538d(_0x3f1d05,_0x12016e){var _0x4822bb=_0x4822();return _0x538d=function(_0x538d7b,_0x2a4ec2){_0x538d7b=_0x538d7b-0xa7;var _0x31a751=_0x4822bb[_0x538d7b];return _0x31a751;},_0x538d(_0x3f1d05,_0x12016e);}var heatmap=heatmap$1['exports'],h337=_mergeNamespaces({'__proto__':null,'default':heatmap},[heatmap$1['exports']]),HeatMaterial='uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a';if(!heatmap$1[_0x575905(0x10e)]['create'])throw new Error('请引入\x20heatmap.js\x20库\x20');const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace['layer']['BaseLayer'],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:_0x575905(0x12f),0.6:'green',0.8:_0x575905(0xde),0.9:'red'}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium[_0x575905(0x139)]['VERTEX_FORMAT']};class HeatLayer extends BaseLayer{constructor(_0x2fac99={}){var _0x3a32e4={_0x2f71ec:0x107,_0x57035e:0x109,_0x48011c:0xac,_0x28b8b7:0xc5},_0x3c82a3=_0x575905;super(_0x2fac99),this['options'][_0x3c82a3(_0x3a32e4._0x2f71ec)]=this[_0x3c82a3(0xc5)]['maxCanvasSize']??document['body'][_0x3c82a3(_0x3a32e4._0x57035e)],this[_0x3c82a3(0xc5)]['maxCanvasSize']=Math[_0x3c82a3(0x108)](this['options']['maxCanvasSize'],0x1388),this['options']['minCanvasSize']=this['options'][_0x3c82a3(0xfc)]??document['body'][_0x3c82a3(_0x3a32e4._0x48011c)],this[_0x3c82a3(_0x3a32e4._0x28b8b7)][_0x3c82a3(0xfc)]=Math[_0x3c82a3(0xc6)](this['options']['minCanvasSize'],0x2bc),this[_0x3c82a3(0xc5)]['heatStyle']={...DEF_HEATSTYLE,...this['options'][_0x3c82a3(0xd8)]},this['options']['style']={...DEF_STYLE,...this['options']['style']};}get['layer'](){return this['_layer'];}get['heatStyle'](){return this['options']['heatStyle'];}set[_0x575905(0xd8)](_0x4507cf){var _0x4524fa={_0x4dcbf6:0xc5,_0x4f90cb:0xd8,_0x3b0891:0xeb,_0x20f12e:0xc5},_0x5d67f7=_0x575905;this[_0x5d67f7(_0x4524fa._0x4dcbf6)][_0x5d67f7(_0x4524fa._0x4f90cb)]=mars3d__namespace[_0x5d67f7(_0x4524fa._0x3b0891)]['merge'](this[_0x5d67f7(_0x4524fa._0x20f12e)]['heatStyle'],_0x4507cf),this['_heat']&&(this['_heat']['configure'](this[_0x5d67f7(0xc5)]['heatStyle']),this['_updatePositionsHook'](!![]));}get['style'](){return this['options']['style'];}set['style'](_0x3e8326){var _0x5b789a=_0x575905;this[_0x5b789a(0xc5)]['style']=mars3d__namespace['Util']['merge'](this['options'][_0x5b789a(0xdd)],_0x3e8326);}get['positions'](){return this['_positions'];}set['positions'](_0x4b5a3a){var _0x1b6ab1=_0x575905;this[_0x1b6ab1(0x11a)](_0x4b5a3a);}get['coordinates'](){var _0x20664c={_0x3b17fb:0xb7},_0x3b41b2=_0x575905;const _0x321fe9=[];return this['points'][_0x3b41b2(_0x20664c._0x3b17fb)](_0x4d8db9=>{_0x321fe9['push'](_0x4d8db9['toArray']());}),_0x321fe9;}get['rectangle'](){var _0x44b7e6={_0x4f819d:0x137},_0x34e75f=_0x575905;return this[_0x34e75f(_0x44b7e6._0x4f819d)];}['_setOptionsHook'](_0x65223a,_0x7d457c){var _0x111e4f={_0x211533:0xe6},_0x367c26=_0x575905;_0x65223a['positions']&&(this[_0x367c26(_0x111e4f._0x211533)]=_0x65223a['positions']);}['_mountedHook'](){var _0x59262e={_0x4e2934:0x122},_0xa59be5=_0x575905;this['style'][_0xa59be5(0x102)]==='image'?this[_0xa59be5(_0x59262e._0x4e2934)]=new mars3d__namespace['layer']['ImageLayer']({'crs':'EPSG:3857','private':!![]}):this['_layer']=new mars3d__namespace['layer']['GraphicLayer']({'private':!![]});}['_addedHook'](){var _0x2c6f6f={_0x4f1f25:0xfb,_0x7f3da2:0xc5,_0x2c4f14:0xc1},_0x3b5a31=_0x575905;this['_map'][_0x3b5a31(0xcd)](this['_layer']),this[_0x3b5a31(0xaa)]=mars3d__namespace['DomUtil'][_0x3b5a31(0xf1)]('div',_0x3b5a31(0xe8),this[_0x3b5a31(_0x2c6f6f._0x4f1f25)]['container']),this[_0x3b5a31(_0x2c6f6f._0x7f3da2)]['positions']&&(this['positions']=this['options'][_0x3b5a31(0xe6)]),this['options'][_0x3b5a31(0x112)]&&this[_0x3b5a31(_0x2c6f6f._0x2c4f14)]();}[_0x575905(0xe5)](){var _0x57eff0={_0x580c09:0x10a},_0x48a97b=_0x575905;this['_container']&&(mars3d__namespace['DomUtil']['remove'](this['_container']),delete this['_container']),this['clear'](),this['_map'][_0x48a97b(_0x57eff0._0x580c09)](this[_0x48a97b(0x122)]);}[_0x575905(0x10d)](_0x2e16a9,_0x5aa4dd){var _0x457d98=_0x575905;this[_0x457d98(0xb6)]=this['_positions']||[],this['_positions']['push'](_0x2e16a9),this['_updatePositionsHook'](_0x5aa4dd);}['setPositions'](_0x379066,_0x5b95ca){this['_positions']=_0x379066,this['_updatePositionsHook'](_0x5b95ca);}['clear'](){var _0x12e7aa={_0x335915:0xfd},_0x448e5b=_0x575905;this['_graphic']&&(this['_layer']['removeGraphic'](this[_0x448e5b(_0x12e7aa._0x335915)],!![]),delete this['_graphic']),this['_graphic2']&&(this[_0x448e5b(0x122)]['removeGraphic'](this['_graphic2'],!![]),delete this[_0x448e5b(0x106)]);}['_updatePositionsHook'](_0x1d56f4){var _0x30e424={_0x3c9a02:0x104,_0xce2f4:0x137,_0xe2e05:0xfd,_0x1ec701:0x124},_0x942e91=_0x575905;if(!this['show']||!this[_0x942e91(0xfb)]||!this['positions']||this['positions']['length']===0x0)return this;const _0x2071ab=this['_getHeatCanvas']();if(this['style']['type']===_0x942e91(_0x30e424._0x3c9a02))this[_0x942e91(0x122)]['setOptions']({'url':_0x2071ab['toDataURL']('image/png',0x1),'rectangle':this[_0x942e91(_0x30e424._0xce2f4)],'opacity':this['style']['opacity']});else this['style']['arc']?this[_0x942e91(_0x30e424._0xe2e05)]&&_0x1d56f4?(this[_0x942e91(0xfd)]['uniforms']['image']=_0x2071ab,this['_graphic']['uniforms']['bumpMap']=this['_getArcHeatCanvas'](),this['_graphic2']&&(this['_graphic2']['uniforms'][_0x942e91(0x104)]=_0x2071ab,this['_graphic2'][_0x942e91(_0x30e424._0x1ec701)][_0x942e91(0xf3)]=this['_graphic'][_0x942e91(_0x30e424._0x1ec701)]['bumpMap'])):this['_createArcGraphic'](_0x2071ab):this['_graphic']&&_0x1d56f4?this['_graphic']['uniforms']['image']=_0x2071ab:this['_createGraphic'](_0x2071ab);return this;}['_createGraphic'](_0x3256d7){var _0x1866ea={_0x409f5e:0x115,_0x56aab6:0x11b},_0x4e3e36=_0x575905;this['clear'](),this['_graphic']=new mars3d__namespace['graphic'][(_0x4e3e36(_0x1866ea._0x409f5e))]({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium[(_0x4e3e36(0x139))]({'material':new Cesium[(_0x4e3e36(_0x1866ea._0x56aab6))]({'fabric':{'uniforms':{'image':_0x3256d7},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})}),this['_layer']['addGraphic'](this['_graphic']);}['_createArcGraphic'](_0x47b83d){var _0x24238f={_0xc7588f:0xb3,_0x42a284:0xce,_0x53cb1e:0x13d,_0x30c32e:0xb9,_0xa9f4ce:0x115},_0x939ae4=_0x575905;this['clear']();const _0x229763=Cesium['RenderState']['fromCache']({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium['StencilFunction']['ALWAYS'],'frontOperation':{'fail':Cesium['StencilOperation'][_0x939ae4(0xc9)],'zFail':Cesium[_0x939ae4(_0x24238f._0xc7588f)][_0x939ae4(0xc9)],'zPass':Cesium['StencilOperation']['REPLACE']},'backFunction':Cesium[_0x939ae4(0x118)][_0x939ae4(_0x24238f._0x42a284)],'backOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium['StencilOperation']['REPLACE']},'reference':0x2,'mask':0x2},'blending':Cesium[_0x939ae4(_0x24238f._0x53cb1e)]['ALPHA_BLEND']}),_0x4f09f6=Math[_0x939ae4(0xff)](this['style']['diffHeight']??this['_mBoundsMax']*0.02)+0.1;this['style'][_0x939ae4(_0x24238f._0x30c32e)]&&delete this['style']['diffHeight'];const _0xaaf7ad=(this['style']['splitNum'],0x64);let _0x582b90=Math['max'](this['_rectangle'][_0x939ae4(0xcc)],this['_rectangle'][_0x939ae4(0xc8)]);this['style']['granularity']=_0x582b90/=_0xaaf7ad;const _0x523bee=new Cesium[(_0x939ae4(0x11b))]({'fabric':{'uniforms':{'image':_0x47b83d,'repeat':new Cesium['Cartesian2'](0x1,0x1),'color':new Cesium['Color'](0x1,0x1,0x1,0x0),'bumpMap':this['_getArcHeatCanvas']()},'source':HeatMaterial},'translucent':!![]}),_0x28e417=this['style']['arcDirection']||0x1;this['_graphic']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x229763,'material':_0x523bee,'vertexShaderSource':getVertexShaderSource(_0x4f09f6*_0x28e417)})}),this[_0x939ae4(0x122)]['addGraphic'](this['_graphic']),this['style']['arcDirection']===0x0&&(this['_graphic2']=new mars3d__namespace['graphic'][(_0x939ae4(_0x24238f._0xa9f4ce))]({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x229763,'material':_0x523bee,'vertexShaderSource':getVertexShaderSource(-_0x4f09f6)})}),this['_layer'][_0x939ae4(0xee)](this['_graphic2']));}[_0x575905(0x129)](_0x5de4e8){var _0x4e3dc9={_0x74922c:0x137},_0x18d01e=_0x575905;return _0x5de4e8!==null&&_0x5de4e8!==void 0x0&&_0x5de4e8['isFormat']&&this[_0x18d01e(_0x4e3dc9._0x74922c)]?mars3d__namespace['PolyUtil']['formatRectangle'](this['_rectangle']):this['_rectangle'];}['_getHeatCanvas'](){var _0x34aca9={_0x4ac657:0xc5,_0x1c4bdb:0xd1,_0x20f9dc:0x111,_0x28a27d:0xc5,_0x1517a9:0xc5,_0x255aa6:0x138,_0x526baf:0x110,_0x27bbc0:0x108,_0x128ee9:0x100,_0x1b5985:0xe7,_0x1599a5:0x100,_0x29aa79:0xaa,_0x3d799f:0xca},_0x25757d={_0x19459d:0x108},_0x52650c={_0x16e7fc:0xb8,_0x101683:0xbf,_0xabc215:0x108},_0x1d4f5a=_0x575905;const _0xcca186=this['_positions'],_0x1a5d04=[];let _0x3ce33b,_0x55cb21,_0x49805e,_0xdad795;_0xcca186[_0x1d4f5a(0xb7)](_0x3b0184=>{var _0x9516fc=_0x1d4f5a;const _0x367b4b=mars3d__namespace[_0x9516fc(0xab)]['parse'](_0x3b0184);if(!_0x367b4b)return;_0x367b4b['value']=_0x3b0184['value']||0x1,!this['options'][_0x9516fc(0x11e)]&&(_0x3ce33b===undefined?(_0x3ce33b=_0x367b4b[_0x9516fc(_0x52650c._0x16e7fc)],_0x55cb21=_0x367b4b['lng'],_0x49805e=_0x367b4b['lat'],_0xdad795=_0x367b4b[_0x9516fc(_0x52650c._0x101683)]):(_0x3ce33b=Math[_0x9516fc(_0x52650c._0xabc215)](_0x3ce33b,_0x367b4b[_0x9516fc(0xb8)]),_0x55cb21=Math['max'](_0x55cb21,_0x367b4b[_0x9516fc(0xb8)]),_0x49805e=Math['min'](_0x49805e,_0x367b4b[_0x9516fc(_0x52650c._0x101683)]),_0xdad795=Math['max'](_0xdad795,_0x367b4b['lat']))),_0x1a5d04['push'](_0x367b4b);});_0x3ce33b===_0x55cb21&&(_0x3ce33b-=0.000001,_0x55cb21+=0.000001);_0x49805e===_0xdad795&&(_0x49805e-=0.000001,_0xdad795+=0.000001);let _0x39cda1=this[_0x1d4f5a(_0x34aca9._0x4ac657)]['rectangle']||{'xmin':_0x3ce33b,'xmax':_0x55cb21,'ymin':_0x49805e,'ymax':_0xdad795};const _0x1259ee=getMercatorBounds(_0x39cda1),_0x5f0de4=Math['abs'](_0x1259ee['xmax']-_0x1259ee['xmin']),_0x48783f=Math[_0x1d4f5a(0xe2)](_0x1259ee[_0x1d4f5a(_0x34aca9._0x1c4bdb)]-_0x1259ee[_0x1d4f5a(0x138)]),_0x2f4ba1=Math['max'](_0x5f0de4,_0x48783f),_0xb47814=Math['min'](_0x5f0de4,_0x48783f);this[_0x1d4f5a(_0x34aca9._0x20f9dc)]=_0x2f4ba1;let _0x542da8=0x1;if(_0x2f4ba1>this['options'][_0x1d4f5a(0x107)])_0x542da8=_0x2f4ba1/this[_0x1d4f5a(_0x34aca9._0x28a27d)]['maxCanvasSize'],_0xb47814/_0x542da8<this['options']['minCanvasSize']&&(_0x542da8=_0xb47814/this['options']['minCanvasSize']);else _0xb47814<this['options']['minCanvasSize']&&(_0x542da8=_0xb47814/this[_0x1d4f5a(_0x34aca9._0x1517a9)][_0x1d4f5a(0xfc)],_0x2f4ba1/_0x542da8>this['options']['maxCanvasSize']&&(_0x542da8=_0x2f4ba1/this['options']['maxCanvasSize']));const _0x17eccc=this['heatStyle']['radius']*1.5,_0x5a7a9a=_0x5f0de4/_0x542da8+_0x17eccc*0x2,_0x4042ec=_0x48783f/_0x542da8+_0x17eccc*0x2,_0x5db154=_0x17eccc*_0x542da8;_0x1259ee['xmin']-=_0x5db154,_0x1259ee[_0x1d4f5a(_0x34aca9._0x255aa6)]-=_0x5db154,_0x1259ee['xmax']+=_0x5db154,_0x1259ee['ymax']+=_0x5db154,this['_scale']=_0x542da8,_0x39cda1=geLatLngBounds(_0x1259ee),this[_0x1d4f5a(0x137)]=Cesium['Rectangle']['fromDegrees'](_0x39cda1[_0x1d4f5a(0xe7)],_0x39cda1['ymin'],_0x39cda1['xmax'],_0x39cda1[_0x1d4f5a(0xd1)]);let _0x1f0ad6=_0x1a5d04[0x0][_0x1d4f5a(0x110)]??0x1,_0x2c8cb0=_0x1a5d04[0x0][_0x1d4f5a(_0x34aca9._0x526baf)]??0x0;const _0x4d000f=[];_0x1a5d04[_0x1d4f5a(0xb7)](_0x189e6e=>{var _0x2a5838=_0x1d4f5a;const _0x7fd604=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x189e6e['lng'],_0x189e6e['lat']]),_0x74fbaf=_0x189e6e[_0x2a5838(0x110)]||0x1,_0x3c16c6=Math['round']((_0x7fd604[0x0]-_0x1259ee['xmin'])/_0x542da8),_0x143367=Math['round']((_0x1259ee[_0x2a5838(0xd1)]-_0x7fd604[0x1])/_0x542da8);_0x1f0ad6=Math[_0x2a5838(0xc6)](_0x1f0ad6,_0x74fbaf),_0x2c8cb0=Math[_0x2a5838(_0x25757d._0x19459d)](_0x2c8cb0,_0x74fbaf),_0x4d000f['push']({'x':_0x3c16c6,'y':_0x143367,'value':_0x74fbaf});});const _0xc27a1d={'min':this['options'][_0x1d4f5a(_0x34aca9._0x27bbc0)]??_0x2c8cb0,'max':this['options']['max']??_0x1f0ad6,'data':_0x4d000f};this['_last_heatData']=_0xc27a1d;if(!this[_0x1d4f5a(_0x34aca9._0x128ee9)]||_0x1259ee[_0x1d4f5a(_0x34aca9._0x1b5985)]!==this['_last_mBounds']['xmin']||_0x1259ee[_0x1d4f5a(0x138)]!==this[_0x1d4f5a(_0x34aca9._0x1599a5)]['ymin']||_0x1259ee['xmax']!==this[_0x1d4f5a(0x100)]['xmax']||_0x1259ee['ymax']!==this['_last_mBounds']['ymax']){this['_last_mBounds']=_0x1259ee,this[_0x1d4f5a(0xaa)]['style']['cssText']='width:'+_0x5a7a9a+'px;height:'+_0x4042ec+'px;';const _0x582b2c={...this['heatStyle'],'container':this[_0x1d4f5a(_0x34aca9._0x29aa79)]};!this['_heat']?this['_heat']=heatmap$1['exports']['create'](_0x582b2c):this[_0x1d4f5a(_0x34aca9._0x3d799f)]['configure'](_0x582b2c);}this['_heat']['setData'](_0xc27a1d);const _0x4ff216=mars3d__namespace['DomUtil']['copyCanvas'](this[_0x1d4f5a(_0x34aca9._0x3d799f)]['_renderer'][_0x1d4f5a(0x130)]);return _0x4ff216;}['_getArcHeatCanvas'](){var _0x3cfd95={_0x33732a:0xba,_0x550ffb:0x10c,_0x6960ed:0x101,_0x1dcec4:0xc3},_0x223e63=_0x575905;this['_heat']['configure']({'radius':this['heatStyle'][_0x223e63(_0x3cfd95._0x33732a)]*this['style'][_0x223e63(_0x3cfd95._0x550ffb)],'blur':this['heatStyle']['blur']*this['style']['arcBlurScale'],'gradient':this['heatStyle']['gradientArc']||{0.25:'rgb(0,0,0)',0.55:_0x223e63(0x12e),0.85:'rgb(216,216,216)',0x1:'rgb(255,255,255)'}});const _0x7fd214=mars3d__namespace[_0x223e63(_0x3cfd95._0x6960ed)]['copyCanvas'](this['_heat'][_0x223e63(_0x3cfd95._0x1dcec4)]['canvas']);return this['_heat']['configure'](this['options'][_0x223e63(0xd8)]),_0x7fd214;}['getPointData'](_0x2e2f2f){var _0x33808a=_0x575905;const _0x2906da=mars3d__namespace[_0x33808a(0xab)]['parse'](_0x2e2f2f);if(!_0x2906da)return{};const _0x1f608b=mars3d__namespace[_0x33808a(0xd5)]['lonlat2mercator']([_0x2906da[_0x33808a(0xb8)],_0x2906da['lat']]),_0x1b7ca8=this['_last_mBounds'],_0x3bab86=Math['round']((_0x1f608b[0x0]-_0x1b7ca8['xmin'])/this['_scale']),_0x6dad64=Math['round']((_0x1b7ca8['ymax']-_0x1f608b[0x1])/this['_scale']),_0x5f1970=this['_heat']['getValueAt']({'x':_0x3bab86,'y':_0x6dad64}),_0x410414=this['_heat']['_renderer'][_0x33808a(0xf9)]['getImageData'](_0x3bab86-0x1,_0x6dad64-0x1,0x1,0x1)['data'];return{'x':_0x3bab86,'y':_0x6dad64,'value':_0x5f1970,'color':'rgba('+_0x410414[0x0]+','+_0x410414[0x1]+','+_0x410414[0x2]+','+_0x410414[0x3]+')'};}}mars3d__namespace['LayerUtil'][_0x575905(0x123)]('heat',HeatLayer),mars3d__namespace['layer']['HeatLayer']=HeatLayer,mars3d__namespace['h337']=h337;function getMercatorBounds(_0x2a6f68){var _0x55ef4b={_0x27a8d5:0xd5},_0x17bd78=_0x575905;const _0x574eb3=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x2a6f68['xmin'],_0x2a6f68['ymin']]),_0x20467f=mars3d__namespace[_0x17bd78(_0x55ef4b._0x27a8d5)][_0x17bd78(0xe4)]([_0x2a6f68['xmax'],_0x2a6f68[_0x17bd78(0xd1)]]);return{'xmin':_0x574eb3[0x0],'ymin':_0x574eb3[0x1],'xmax':_0x20467f[0x0],'ymax':_0x20467f[0x1]};}function geLatLngBounds(_0x356e0f){const _0x525fd7=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x356e0f['xmin'],_0x356e0f['ymin']]),_0x57d50e=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x356e0f['xmax'],_0x356e0f['ymax']]);return{'xmin':_0x525fd7[0x0],'ymin':_0x525fd7[0x1],'xmax':_0x57d50e[0x0],'ymax':_0x57d50e[0x1]};}function getVertexShaderSource(_0x469617){var _0xc6d552=_0x575905;return _0xc6d552(0xcb)+_0x469617+_0xc6d552(0x121);}exports['HeatLayer']=HeatLayer,Object['defineProperty'](exports,_0x575905(0xb2),{'value':!![]});
}));
