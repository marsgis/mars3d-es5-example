/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.6.10
 * 编译日期：2023-10-23 17:28:33
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';const _0x22622b=_0x3664;(function(_0x60051b,_0x130212){const _0x27886c={_0x25422e:0x1f6,_0x4b0800:0x206,_0x3484ee:0x1da,_0x1f7ad4:0x207},_0x2af9c2=_0x3664,_0x48c105=_0x60051b();while(!![]){try{const _0x5077ad=-parseInt(_0x2af9c2(0x1fc))/0x1+parseInt(_0x2af9c2(_0x27886c._0x25422e))/0x2+parseInt(_0x2af9c2(_0x27886c._0x4b0800))/0x3+-parseInt(_0x2af9c2(0x1d3))/0x4*(parseInt(_0x2af9c2(0x1ef))/0x5)+-parseInt(_0x2af9c2(_0x27886c._0x3484ee))/0x6*(parseInt(_0x2af9c2(_0x27886c._0x1f7ad4))/0x7)+-parseInt(_0x2af9c2(0x20a))/0x8*(parseInt(_0x2af9c2(0x213))/0x9)+parseInt(_0x2af9c2(0x211))/0xa;if(_0x5077ad===_0x130212)break;else _0x48c105['push'](_0x48c105['shift']());}catch(_0x3d290a){_0x48c105['push'](_0x48c105['shift']());}}}(_0x2fc9,0xd1d35));function _0x2fc9(){const _0x2a4553=['xmin','ymin','default','parse','xmax','coordinates','224clVkaM','layer','minCanvasSize','请引入\x20heatmap.js\x20库\x20','_getArcHeatCanvas','configure','_removedHook','612Yyrosl','style','Rectangle','min','removeGraphic','formatRectangle','merge','max','forEach','BlendingState','blue','_positions','_rectangle','lonlat2mercator','uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a','_graphic','StencilOperation','_last_mBounds','_heat','type','heatStyle','138130sRRmQS','uniforms','arcRadiusScale','setPositions','_getHeatCanvas','_layer','arcBlurScale','1157532ViawBQ','_mBoundsMax','rgb(0,0,0)','_setOptionsHook','__esModule','copyCanvas','297862vrYbLZ','GraphicLayer','value','ALPHA_BLEND','lat','remove','KEEP','opacity','_renderer','round','2644524IVROvo','49238oCsftO','toArray','clear','4504RJmztQ','push','image','diffHeight','canvas','_graphic2','DomUtil','25369430sGOuJj','_scale','9198yFpelP','PointTrans','options','Cesium','StencilFunction','positions','_container','_map','graphic','EllipsoidSurfaceAppearance','arcDirection','rectangle','ymax','maxCanvasSize','data','red','setData','_createArcGraphic','radius','flyToByAnimationEnd','abs'];_0x2fc9=function(){return _0x2a4553;};return _0x2fc9();}function _0x3664(_0x22b4e9,_0x1d7bd4){const _0x2fc927=_0x2fc9();return _0x3664=function(_0x3664ce,_0x34ac96){_0x3664ce=_0x3664ce-0x1c7;let _0x16986c=_0x2fc927[_0x3664ce];return _0x16986c;},_0x3664(_0x22b4e9,_0x1d7bd4);}function _interopNamespace(_0x1f4417){const _0x4245ff=_0x3664;if(_0x1f4417&&_0x1f4417[_0x4245ff(0x1fa)])return _0x1f4417;var _0x66b72d=Object['create'](null);return _0x1f4417&&Object['keys'](_0x1f4417)[_0x4245ff(0x1e2)](function(_0x11269f){if(_0x11269f!=='default'){var _0x42035c=Object['getOwnPropertyDescriptor'](_0x1f4417,_0x11269f);Object['defineProperty'](_0x66b72d,_0x11269f,_0x42035c['get']?_0x42035c:{'enumerable':!![],'get':function(){return _0x1f4417[_0x11269f];}});}}),_0x66b72d[_0x4245ff(0x1cf)]=_0x1f4417,_0x66b72d;}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337),HeatMaterial=_0x22622b(0x1e8);if(!h337__namespace['create'])throw new Error(_0x22622b(0x1d6));const Cesium=mars3d__namespace[_0x22622b(0x216)],BaseLayer=mars3d__namespace[_0x22622b(0x1d4)]['BaseLayer'],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:_0x22622b(0x1e4),0.6:'green',0.8:'yellow',0.9:_0x22622b(0x1c7)}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium['EllipsoidSurfaceAppearance']['VERTEX_FORMAT']};class HeatLayer extends BaseLayer{constructor(_0x41f2c2={}){const _0x41d35={_0x5834b0:0x215,_0x24c549:0x220},_0x55988e=_0x22622b;super(_0x41f2c2),this['options']['maxCanvasSize']=this[_0x55988e(_0x41d35._0x5834b0)]['maxCanvasSize']??document['body']['clientWidth'],this['options']['maxCanvasSize']=Math[_0x55988e(0x1dd)](this['options'][_0x55988e(_0x41d35._0x24c549)],0x1388),this[_0x55988e(0x215)][_0x55988e(0x1d5)]=this['options']['minCanvasSize']??document['body']['clientHeight'],this[_0x55988e(0x215)]['minCanvasSize']=Math['max'](this[_0x55988e(0x215)]['minCanvasSize'],0x2bc),this['options']['heatStyle']={...DEF_HEATSTYLE,...this['options']['heatStyle']},this['options'][_0x55988e(0x1db)]={...DEF_STYLE,...this[_0x55988e(0x215)]['style']};}get['layer'](){const _0x27c45f=_0x22622b;return this[_0x27c45f(0x1f4)];}get[_0x22622b(0x1ee)](){const _0x2dbc95=_0x22622b;return this['options'][_0x2dbc95(0x1ee)];}set[_0x22622b(0x1ee)](_0x3a9b7e){const _0x2920a5={_0x4edd36:0x215},_0x48ed93=_0x22622b;this[_0x48ed93(_0x2920a5._0x4edd36)][_0x48ed93(0x1ee)]=mars3d__namespace['Util'][_0x48ed93(0x1e0)](this[_0x48ed93(_0x2920a5._0x4edd36)]['heatStyle'],_0x3a9b7e),this['_heat']&&(this['_heat']['configure'](this['options'][_0x48ed93(0x1ee)]),this['_updatePositionsHook'](!![]));}get[_0x22622b(0x1db)](){const _0x1cf466={_0x29f209:0x1db},_0x494819=_0x22622b;return this['options'][_0x494819(_0x1cf466._0x29f209)];}set['style'](_0x252377){const _0x63a5c=_0x22622b;this['options']['style']=mars3d__namespace['Util']['merge'](this['options'][_0x63a5c(0x1db)],_0x252377);}get['positions'](){return this['_positions'];}set['positions'](_0x160ad6){const _0x5cd834={_0x3fb8c1:0x1f2},_0x2acbf4=_0x22622b;this[_0x2acbf4(_0x5cd834._0x3fb8c1)](_0x160ad6);}get[_0x22622b(0x1d2)](){const _0x31fc50={_0x513ba3:0x20b,_0x5e9a0a:0x208},_0x494ccb=[];return this['points']['forEach'](_0x50aa0c=>{const _0x523b9c=_0x3664;_0x494ccb[_0x523b9c(_0x31fc50._0x513ba3)](_0x50aa0c[_0x523b9c(_0x31fc50._0x5e9a0a)]());}),_0x494ccb;}get[_0x22622b(0x21e)](){return this['_rectangle'];}[_0x22622b(0x1f9)](_0xac244a,_0x303e79){const _0x7022f3=_0x22622b;_0xac244a['positions']&&(this[_0x7022f3(0x218)]=_0xac244a['positions']);}['_mountedHook'](){const _0x1a6d32={_0x5c0c49:0x1fd},_0x42a9b9=_0x22622b;this['style'][_0x42a9b9(0x1ed)]==='image'?this['_layer']=new mars3d__namespace['layer']['ImageLayer']({'crs':'EPSG:3857','private':!![]}):this['_layer']=new mars3d__namespace['layer'][(_0x42a9b9(_0x1a6d32._0x5c0c49))]({'private':!![]});}['_addedHook'](){const _0x411eee={_0x52f80a:0x218,_0x4ba086:0x1cb},_0x58d630=_0x22622b;this['_map']['addLayer'](this['_layer']),this['_container']=mars3d__namespace[_0x58d630(0x210)]['create']('div','mars3d-heatmap\x20mars3d-hideDiv',this['_map']['container']),this['options']['positions']&&(this['positions']=this['options'][_0x58d630(_0x411eee._0x52f80a)]),this['options']['flyTo']&&this[_0x58d630(_0x411eee._0x4ba086)]();}[_0x22622b(0x1d9)](){const _0x16d5a4={_0x497ef5:0x219},_0x35d55f=_0x22622b;this[_0x35d55f(_0x16d5a4._0x497ef5)]&&(mars3d__namespace['DomUtil'][_0x35d55f(0x201)](this[_0x35d55f(0x219)]),delete this['_container']),this['clear'](),this[_0x35d55f(0x21a)]['removeLayer'](this['_layer']);}['addPosition'](_0x36067f,_0x299316){const _0x1396f9=_0x22622b;this['_positions']=this['_positions']||[],this[_0x1396f9(0x1e5)]['push'](_0x36067f),this['_updatePositionsHook'](_0x299316);}['setPositions'](_0x4c2de1,_0x31fea4){this['_positions']=_0x4c2de1,this['_updatePositionsHook'](_0x31fea4);}['clear'](){const _0x5880fa={_0x3d9815:0x1de},_0x5d781f=_0x22622b;this['_graphic']&&(this[_0x5d781f(0x1f4)][_0x5d781f(0x1de)](this['_graphic'],!![]),delete this['_graphic']),this['_graphic2']&&(this['_layer'][_0x5d781f(_0x5880fa._0x3d9815)](this['_graphic2'],!![]),delete this[_0x5d781f(0x20f)]);}['_updatePositionsHook'](_0x31bb08){const _0x42c96f={_0x4b08fb:0x1f3,_0x238d99:0x1ed,_0x26b4ad:0x203,_0x5e07a8:0x1db,_0x1997c8:0x1f0,_0xa4b390:0x1d7,_0x1fad8c:0x20c,_0x4f1798:0x20f,_0x2b585a:0x1e9},_0x2e5990=_0x22622b;if(!this['show']||!this['_map']||!this['positions']||this['positions']['length']===0x0)return this;const _0x2bc0b1=this[_0x2e5990(_0x42c96f._0x4b08fb)]();if(this['style'][_0x2e5990(_0x42c96f._0x238d99)]==='image')this['_layer']['setOptions']({'url':_0x2bc0b1['toDataURL']('image/png'),'rectangle':this['_rectangle'],'opacity':this['style'][_0x2e5990(_0x42c96f._0x26b4ad)]});else this[_0x2e5990(_0x42c96f._0x5e07a8)]['arc']?this['_graphic']&&_0x31bb08?(this['_graphic'][_0x2e5990(_0x42c96f._0x1997c8)]['image']=_0x2bc0b1,this['_graphic']['uniforms']['bumpMap']=this[_0x2e5990(_0x42c96f._0xa4b390)](),this[_0x2e5990(0x20f)]&&(this[_0x2e5990(0x20f)]['uniforms'][_0x2e5990(_0x42c96f._0x1fad8c)]=_0x2bc0b1,this[_0x2e5990(_0x42c96f._0x4f1798)]['uniforms']['bumpMap']=this['_graphic'][_0x2e5990(_0x42c96f._0x1997c8)]['bumpMap'])):this['_createArcGraphic'](_0x2bc0b1):this['_graphic']&&_0x31bb08?this[_0x2e5990(_0x42c96f._0x2b585a)]['uniforms'][_0x2e5990(_0x42c96f._0x1fad8c)]=_0x2bc0b1:this['_createGraphic'](_0x2bc0b1);return this;}['_createGraphic'](_0x549cf4){const _0x47037d={_0x591645:0x209,_0x35bdeb:0x21b},_0x4c16ba=_0x22622b;this[_0x4c16ba(_0x47037d._0x591645)](),this['_graphic']=new mars3d__namespace[(_0x4c16ba(_0x47037d._0x35bdeb))]['RectanglePrimitive']({...this['options'],'rectangle':this[_0x4c16ba(0x1e6)],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'material':new Cesium['Material']({'fabric':{'uniforms':{'image':_0x549cf4},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})}),this['_layer']['addGraphic'](this['_graphic']);}[_0x22622b(0x1c9)](_0x26de6d){const _0x42cbb3={_0x232f59:0x209,_0x44c06d:0x1ea,_0x40b539:0x202,_0x4c0c84:0x1e3,_0x89bd13:0x1e6,_0x3b36de:0x21d,_0x232e5e:0x21c,_0x2f7569:0x1db,_0x30f58e:0x1e6,_0x52f89a:0x20f},_0x396502=_0x22622b;this[_0x396502(_0x42cbb3._0x232f59)]();const _0x230c7f=Cesium['RenderState']['fromCache']({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium[_0x396502(0x217)]['ALWAYS'],'frontOperation':{'fail':Cesium[_0x396502(_0x42cbb3._0x44c06d)]['KEEP'],'zFail':Cesium[_0x396502(0x1ea)]['KEEP'],'zPass':Cesium[_0x396502(0x1ea)]['REPLACE']},'backFunction':Cesium['StencilFunction']['ALWAYS'],'backOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium[_0x396502(0x1ea)][_0x396502(_0x42cbb3._0x40b539)],'zPass':Cesium['StencilOperation']['REPLACE']},'reference':0x2,'mask':0x2},'blending':Cesium[_0x396502(_0x42cbb3._0x4c0c84)][_0x396502(0x1ff)]}),_0x55690c=Math['floor'](this[_0x396502(0x1db)]['diffHeight']??this['_mBoundsMax']*0.02)+0.1;this['style'][_0x396502(0x20d)]&&delete this['style']['diffHeight'];const _0x1ae0a1=(this['style']['splitNum'],0x64);let _0x47735b=Math['max'](this[_0x396502(0x1e6)]['height'],this[_0x396502(_0x42cbb3._0x89bd13)]['width']);this['style']['granularity']=_0x47735b/=_0x1ae0a1;const _0xf9037d=new Cesium['Material']({'fabric':{'uniforms':{'image':_0x26de6d,'repeat':new Cesium['Cartesian2'](0x1,0x1),'color':new Cesium['Color'](0x1,0x1,0x1,0x0),'bumpMap':this['_getArcHeatCanvas']()},'source':HeatMaterial},'translucent':!![]}),_0x58f3f5=this['style'][_0x396502(_0x42cbb3._0x3b36de)]||0x1;this['_graphic']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium[(_0x396502(_0x42cbb3._0x232e5e))]({'flat':!![],'aboveGround':!![],'renderState':_0x230c7f,'material':_0xf9037d,'vertexShaderSource':getVertexShaderSource(_0x55690c*_0x58f3f5)})}),this['_layer']['addGraphic'](this['_graphic']),this[_0x396502(_0x42cbb3._0x2f7569)][_0x396502(0x21d)]===0x0&&(this['_graphic2']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this[_0x396502(_0x42cbb3._0x30f58e)],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x230c7f,'material':_0xf9037d,'vertexShaderSource':getVertexShaderSource(-_0x55690c)})}),this['_layer']['addGraphic'](this[_0x396502(_0x42cbb3._0x52f89a)]));}['getRectangle'](_0x8e9d55){const _0x50e61c={_0x2e3aa1:0x1df},_0x5583e2=_0x22622b;return _0x8e9d55!==null&&_0x8e9d55!==void 0x0&&_0x8e9d55['isFormat']&&this['_rectangle']?mars3d__namespace['PolyUtil'][_0x5583e2(_0x50e61c._0x2e3aa1)](this[_0x5583e2(0x1e6)]):this['_rectangle'];}['_getHeatCanvas'](){const _0x4e32a7={_0x1213cd:0x1d1,_0x4484d2:0x1cc,_0xb43aeb:0x21f,_0x37996b:0x1f7,_0x8fad62:0x220,_0x2aacc3:0x1d5,_0x3a62b3:0x1ca,_0xab43bb:0x21f,_0x4f0304:0x1eb,_0x36d181:0x1cd,_0x4fed80:0x1d1,_0x27fc97:0x1db},_0x185492={_0x35a077:0x1e7,_0x131395:0x1fe},_0x97813={_0x4bb653:0x1fe,_0x2966da:0x200,_0x4d13d5:0x1e1},_0x4fddbf=_0x22622b,_0x415cf3=this[_0x4fddbf(0x1e5)],_0x224553=[];let _0xd110af,_0x1fb537,_0x3e3935,_0x24efa;_0x415cf3['forEach'](_0x22103b=>{const _0x575e03=_0x4fddbf,_0x25f3bf=mars3d__namespace['LngLatPoint'][_0x575e03(0x1d0)](_0x22103b);if(!_0x25f3bf)return;_0x25f3bf[_0x575e03(_0x97813._0x4bb653)]=_0x22103b[_0x575e03(0x1fe)]||0x1,!this[_0x575e03(0x215)]['rectangle']&&(_0xd110af===undefined?(_0xd110af=_0x25f3bf['lng'],_0x1fb537=_0x25f3bf['lng'],_0x3e3935=_0x25f3bf['lat'],_0x24efa=_0x25f3bf['lat']):(_0xd110af=Math['min'](_0xd110af,_0x25f3bf['lng']),_0x1fb537=Math['max'](_0x1fb537,_0x25f3bf['lng']),_0x3e3935=Math[_0x575e03(0x1dd)](_0x3e3935,_0x25f3bf[_0x575e03(_0x97813._0x2966da)]),_0x24efa=Math[_0x575e03(_0x97813._0x4d13d5)](_0x24efa,_0x25f3bf[_0x575e03(_0x97813._0x2966da)]))),_0x224553['push'](_0x25f3bf);});_0xd110af===_0x1fb537&&(_0xd110af-=0.000001,_0x1fb537+=0.000001);_0x3e3935===_0x24efa&&(_0x3e3935-=0.000001,_0x24efa+=0.000001);let _0x536194=this['options'][_0x4fddbf(0x21e)]||{'xmin':_0xd110af,'xmax':_0x1fb537,'ymin':_0x3e3935,'ymax':_0x24efa};const _0xab1094=getMercatorBounds(_0x536194),_0x15d552=Math['abs'](_0xab1094[_0x4fddbf(_0x4e32a7._0x1213cd)]-_0xab1094['xmin']),_0x291394=Math[_0x4fddbf(_0x4e32a7._0x4484d2)](_0xab1094[_0x4fddbf(_0x4e32a7._0xb43aeb)]-_0xab1094[_0x4fddbf(0x1ce)]),_0x2aba63=Math['max'](_0x15d552,_0x291394),_0x38367e=Math['min'](_0x15d552,_0x291394);this[_0x4fddbf(_0x4e32a7._0x37996b)]=_0x2aba63;let _0x36335=0x1;if(_0x2aba63>this['options'][_0x4fddbf(_0x4e32a7._0x8fad62)])_0x36335=_0x2aba63/this['options']['maxCanvasSize'],_0x38367e/_0x36335<this['options']['minCanvasSize']&&(_0x36335=_0x38367e/this['options']['minCanvasSize']);else _0x38367e<this['options'][_0x4fddbf(_0x4e32a7._0x2aacc3)]&&(_0x36335=_0x38367e/this[_0x4fddbf(0x215)]['minCanvasSize'],_0x2aba63/_0x36335>this[_0x4fddbf(0x215)][_0x4fddbf(0x220)]&&(_0x36335=_0x2aba63/this[_0x4fddbf(0x215)]['maxCanvasSize']));const _0x4ddbfa=this['heatStyle'][_0x4fddbf(_0x4e32a7._0x3a62b3)]*1.5,_0x293282=_0x15d552/_0x36335+_0x4ddbfa*0x2,_0x1056d8=_0x291394/_0x36335+_0x4ddbfa*0x2,_0x2f4da8=_0x4ddbfa*_0x36335;_0xab1094['xmin']-=_0x2f4da8,_0xab1094['ymin']-=_0x2f4da8,_0xab1094['xmax']+=_0x2f4da8,_0xab1094[_0x4fddbf(_0x4e32a7._0xab43bb)]+=_0x2f4da8,this['_scale']=_0x36335,_0x536194=geLatLngBounds(_0xab1094),this['_rectangle']=Cesium[_0x4fddbf(0x1dc)]['fromDegrees'](_0x536194['xmin'],_0x536194['ymin'],_0x536194['xmax'],_0x536194['ymax']);let _0x232207=_0x224553[0x0]['value']??0x1,_0x705f4d=_0x224553[0x0][_0x4fddbf(0x1fe)]??0x0;const _0x8a340=[];_0x224553['forEach'](_0x2a5064=>{const _0x51c166=_0x4fddbf,_0x203ed9=mars3d__namespace['PointTrans'][_0x51c166(_0x185492._0x35a077)]([_0x2a5064['lng'],_0x2a5064['lat']]),_0x5211ed=_0x2a5064[_0x51c166(_0x185492._0x131395)]||0x1,_0x4ff17b=Math[_0x51c166(0x205)]((_0x203ed9[0x0]-_0xab1094['xmin'])/_0x36335),_0x3edc21=Math['round']((_0xab1094['ymax']-_0x203ed9[0x1])/_0x36335);_0x232207=Math['max'](_0x232207,_0x5211ed),_0x705f4d=Math['min'](_0x705f4d,_0x5211ed),_0x8a340['push']({'x':_0x4ff17b,'y':_0x3edc21,'value':_0x5211ed});});const _0xc13ee1={'min':this['options']['min']??_0x705f4d,'max':this[_0x4fddbf(0x215)]['max']??_0x232207,'data':_0x8a340};this['_last_heatData']=_0xc13ee1;if(!this[_0x4fddbf(_0x4e32a7._0x4f0304)]||_0xab1094['xmin']!==this[_0x4fddbf(_0x4e32a7._0x4f0304)][_0x4fddbf(_0x4e32a7._0x36d181)]||_0xab1094['ymin']!==this['_last_mBounds'][_0x4fddbf(0x1ce)]||_0xab1094[_0x4fddbf(_0x4e32a7._0x4fed80)]!==this['_last_mBounds']['xmax']||_0xab1094['ymax']!==this['_last_mBounds']['ymax']){this[_0x4fddbf(_0x4e32a7._0x4f0304)]=_0xab1094,this['_container'][_0x4fddbf(_0x4e32a7._0x27fc97)]['cssText']='width:'+_0x293282+'px;height:'+_0x1056d8+'px;';const _0x1121aa={...this['heatStyle'],'container':this['_container']};!this['_heat']?this['_heat']=h337__namespace['create'](_0x1121aa):this['_heat'][_0x4fddbf(0x1d8)](_0x1121aa);}this['_heat'][_0x4fddbf(0x1c8)](_0xc13ee1);const _0x40bbc9=mars3d__namespace['DomUtil']['copyCanvas'](this[_0x4fddbf(0x1ec)][_0x4fddbf(0x204)][_0x4fddbf(0x20e)]);return _0x40bbc9;}['_getArcHeatCanvas'](){const _0x2a4d66={_0x5dd73d:0x1f1,_0x1ba7e:0x1ee,_0x3db246:0x1fb,_0x1425af:0x1ec,_0x1ab6ea:0x215},_0x54b690=_0x22622b;this['_heat']['configure']({'radius':this['heatStyle']['radius']*this['style'][_0x54b690(_0x2a4d66._0x5dd73d)],'blur':this[_0x54b690(0x1ee)]['blur']*this[_0x54b690(0x1db)][_0x54b690(0x1f5)],'gradient':this[_0x54b690(_0x2a4d66._0x1ba7e)]['gradientArc']||{0.25:_0x54b690(0x1f8),0.55:'rgb(140,140,140)',0.85:'rgb(216,216,216)',0x1:'rgb(255,255,255)'}});const _0x39d078=mars3d__namespace['DomUtil'][_0x54b690(_0x2a4d66._0x3db246)](this['_heat']['_renderer']['canvas']);return this[_0x54b690(_0x2a4d66._0x1425af)]['configure'](this[_0x54b690(_0x2a4d66._0x1ab6ea)]['heatStyle']),_0x39d078;}['getPointData'](_0x263a48){const _0x18330e={_0x26c4a0:0x214,_0xad19eb:0x1eb},_0x104fcc=_0x22622b,_0x591e2c=mars3d__namespace['LngLatPoint'][_0x104fcc(0x1d0)](_0x263a48);if(!_0x591e2c)return{};const _0x2848d0=mars3d__namespace[_0x104fcc(_0x18330e._0x26c4a0)]['lonlat2mercator']([_0x591e2c['lng'],_0x591e2c['lat']]),_0xaf4774=this[_0x104fcc(_0x18330e._0xad19eb)],_0x53367a=Math['round']((_0x2848d0[0x0]-_0xaf4774['xmin'])/this[_0x104fcc(0x212)]),_0x1009b9=Math['round']((_0xaf4774['ymax']-_0x2848d0[0x1])/this['_scale']),_0x27a3ed=this['_heat']['getValueAt']({'x':_0x53367a,'y':_0x1009b9}),_0x4e8633=this[_0x104fcc(0x1ec)]['_renderer']['ctx']['getImageData'](_0x53367a-0x1,_0x1009b9-0x1,0x1,0x1)[_0x104fcc(0x221)];return{'x':_0x53367a,'y':_0x1009b9,'value':_0x27a3ed,'color':'rgba('+_0x4e8633[0x0]+','+_0x4e8633[0x1]+','+_0x4e8633[0x2]+','+_0x4e8633[0x3]+')'};}}mars3d__namespace['LayerUtil']['register']('heat',HeatLayer),mars3d__namespace['layer']['HeatLayer']=HeatLayer,mars3d__namespace['h337']=h337__namespace;function getMercatorBounds(_0x5808eb){const _0xea2b73=_0x22622b,_0x38b446=mars3d__namespace[_0xea2b73(0x214)]['lonlat2mercator']([_0x5808eb['xmin'],_0x5808eb[_0xea2b73(0x1ce)]]),_0x294ea9=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x5808eb['xmax'],_0x5808eb['ymax']]);return{'xmin':_0x38b446[0x0],'ymin':_0x38b446[0x1],'xmax':_0x294ea9[0x0],'ymax':_0x294ea9[0x1]};}function geLatLngBounds(_0x21e93b){const _0x3753cb={_0x4c4f1c:0x214},_0x5bfabe=_0x22622b,_0x2e8334=mars3d__namespace[_0x5bfabe(_0x3753cb._0x4c4f1c)]['mercator2lonlat']([_0x21e93b['xmin'],_0x21e93b['ymin']]),_0x2878d6=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x21e93b['xmax'],_0x21e93b['ymax']]);return{'xmin':_0x2e8334[0x0],'ymin':_0x2e8334[0x1],'xmax':_0x2878d6[0x0],'ymax':_0x2878d6[0x1]};}function getVertexShaderSource(_0x3cb025){return'in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20'+_0x3cb025+';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a';}exports['HeatLayer']=HeatLayer,Object['defineProperty'](exports,_0x22622b(0x1fa),{'value':!![]});
}));
