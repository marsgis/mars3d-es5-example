/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.6.18
 * 编译日期：2023-12-28 21:28:48
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';const _0x247fd7=_0xcf6c;function _0xcf6c(_0x10fd94,_0x58a5a5){const _0x122b08=_0x122b();return _0xcf6c=function(_0xcf6c94,_0x8eb489){_0xcf6c94=_0xcf6c94-0x1ba;let _0x5334ce=_0x122b08[_0xcf6c94];return _0x5334ce;},_0xcf6c(_0x10fd94,_0x58a5a5);}(function(_0x159fd4,_0x466722){const _0x2d53d5={_0x54e32a:0x1df,_0x392159:0x1ee,_0x560c18:0x1e2,_0x4f2733:0x1ff},_0x1ca6f3=_0xcf6c,_0x4b32a8=_0x159fd4();while(!![]){try{const _0x3e0a70=parseInt(_0x1ca6f3(0x1fa))/0x1+parseInt(_0x1ca6f3(_0x2d53d5._0x54e32a))/0x2*(parseInt(_0x1ca6f3(0x1e4))/0x3)+parseInt(_0x1ca6f3(0x1f2))/0x4*(parseInt(_0x1ca6f3(0x1be))/0x5)+parseInt(_0x1ca6f3(_0x2d53d5._0x392159))/0x6+parseInt(_0x1ca6f3(_0x2d53d5._0x560c18))/0x7+parseInt(_0x1ca6f3(0x1d0))/0x8+parseInt(_0x1ca6f3(_0x2d53d5._0x4f2733))/0x9*(-parseInt(_0x1ca6f3(0x204))/0xa);if(_0x3e0a70===_0x466722)break;else _0x4b32a8['push'](_0x4b32a8['shift']());}catch(_0xdb9531){_0x4b32a8['push'](_0x4b32a8['shift']());}}}(_0x122b,0x57110));function _interopNamespace(_0xfd32cf){if(_0xfd32cf&&_0xfd32cf['__esModule'])return _0xfd32cf;var _0x599266=Object['create'](null);return _0xfd32cf&&Object['keys'](_0xfd32cf)['forEach'](function(_0x2b2654){const _0x40617e=_0xcf6c;if(_0x2b2654!=='default'){var _0x5f06fe=Object[_0x40617e(0x1e8)](_0xfd32cf,_0x2b2654);Object['defineProperty'](_0x599266,_0x2b2654,_0x5f06fe[_0x40617e(0x207)]?_0x5f06fe:{'enumerable':!![],'get':function(){return _0xfd32cf[_0x2b2654];}});}}),_0x599266['default']=_0xfd32cf,_0x599266;}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337),HeatMaterial=_0x247fd7(0x1c4);if(!h337__namespace['create'])throw new Error('请引入\x20heatmap.js\x20库\x20');const Cesium=mars3d__namespace[_0x247fd7(0x1c9)],BaseLayer=mars3d__namespace['layer']['BaseLayer'],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:'blue',0.6:'green',0.8:'yellow',0.9:'red'}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium['EllipsoidSurfaceAppearance']['VERTEX_FORMAT']};class HeatLayer extends BaseLayer{constructor(_0x4e7cc1={}){const _0x134c62={_0x444022:0x212,_0x4c846b:0x1e3,_0x5c338b:0x1c6},_0x48c450=_0x247fd7;super(_0x4e7cc1),this[_0x48c450(0x212)]['maxCanvasSize']=this['options']['maxCanvasSize']??document['body']['clientWidth'],this[_0x48c450(0x212)]['maxCanvasSize']=Math['min'](this[_0x48c450(_0x134c62._0x444022)]['maxCanvasSize'],0x1388),this['options'][_0x48c450(0x1de)]=this[_0x48c450(0x212)]['minCanvasSize']??document[_0x48c450(_0x134c62._0x4c846b)]['clientHeight'],this['options']['minCanvasSize']=Math['max'](this['options']['minCanvasSize'],0x2bc),this['options'][_0x48c450(_0x134c62._0x5c338b)]={...DEF_HEATSTYLE,...this['options']['heatStyle']},this[_0x48c450(0x212)]['style']={...DEF_STYLE,...this['options']['style']};}get['layer'](){return this['_layer'];}get['heatStyle'](){return this['options']['heatStyle'];}set['heatStyle'](_0x48e7c2){const _0x180a2e={_0x120764:0x216,_0x114574:0x212,_0x2272cb:0x20b},_0x2c492c=_0x247fd7;this['options']['heatStyle']=mars3d__namespace[_0x2c492c(_0x180a2e._0x120764)]['merge'](this[_0x2c492c(_0x180a2e._0x114574)][_0x2c492c(0x1c6)],_0x48e7c2),this['_heat']&&(this[_0x2c492c(0x1fc)][_0x2c492c(_0x180a2e._0x2272cb)](this['options']['heatStyle']),this['_updatePositionsHook'](!![]));}get['style'](){return this['options']['style'];}set['style'](_0x493d57){const _0x37da85={_0x9ba36:0x1ef},_0x4c85b6=_0x247fd7;this['options'][_0x4c85b6(0x1c0)]=mars3d__namespace[_0x4c85b6(0x216)][_0x4c85b6(_0x37da85._0x9ba36)](this['options']['style'],_0x493d57);}get[_0x247fd7(0x1ba)](){return this['_positions'];}set['positions'](_0x131f2a){const _0x2d1f4e=_0x247fd7;this[_0x2d1f4e(0x1f6)](_0x131f2a);}get['coordinates'](){const _0x368914=_0x247fd7,_0x1477d2=[];return this[_0x368914(0x1d2)]['forEach'](_0x5e3a17=>{_0x1477d2['push'](_0x5e3a17['toArray']());}),_0x1477d2;}get[_0x247fd7(0x1f1)](){return this['_rectangle'];}['_setOptionsHook'](_0x565a50,_0x32345c){const _0x2387bd={_0x11e09a:0x1ba},_0x493645=_0x247fd7;_0x565a50[_0x493645(0x1ba)]&&(this[_0x493645(_0x2387bd._0x11e09a)]=_0x565a50['positions']);}[_0x247fd7(0x1c2)](){const _0x3bedec={_0x18a96b:0x1d1,_0x165703:0x213},_0x4d7af1=_0x247fd7;this['style']['type']===_0x4d7af1(_0x3bedec._0x18a96b)?this['_layer']=new mars3d__namespace[(_0x4d7af1(0x20f))][(_0x4d7af1(0x1ea))]({'crs':'EPSG:3857','private':!![]}):this[_0x4d7af1(_0x3bedec._0x165703)]=new mars3d__namespace['layer']['GraphicLayer']({'private':!![]});}[_0x247fd7(0x1e9)](){const _0xe01854=_0x247fd7;this[_0xe01854(0x1f7)]['addLayer'](this[_0xe01854(0x213)]),this[_0xe01854(0x1c3)]=mars3d__namespace['DomUtil']['create']('div','mars3d-heatmap\x20mars3d-hideDiv',this['_map']['container']),this['options']['positions']&&(this['positions']=this['options'][_0xe01854(0x1ba)]),this['options']['flyTo']&&this['flyToByAnimationEnd']();}[_0x247fd7(0x1cd)](){const _0x2ea3e0={_0x33cd66:0x1c3,_0x5825ee:0x1f3,_0x457b39:0x1f4,_0x46d5df:0x1f7},_0x1cd8a0=_0x247fd7;this[_0x1cd8a0(_0x2ea3e0._0x33cd66)]&&(mars3d__namespace['DomUtil'][_0x1cd8a0(_0x2ea3e0._0x5825ee)](this['_container']),delete this[_0x1cd8a0(_0x2ea3e0._0x33cd66)]),this[_0x1cd8a0(_0x2ea3e0._0x457b39)](),this[_0x1cd8a0(_0x2ea3e0._0x46d5df)]['removeLayer'](this['_layer']);}[_0x247fd7(0x20d)](_0x573321,_0x245ee7){const _0x3abd3b=_0x247fd7;this[_0x3abd3b(0x1cc)]=this['_positions']||[],this['_positions']['push'](_0x573321),this['_updatePositionsHook'](_0x245ee7);}['setPositions'](_0xd97108,_0x55e2cc){const _0x496ebd=_0x247fd7;this[_0x496ebd(0x1cc)]=_0xd97108,this[_0x496ebd(0x1f8)](_0x55e2cc);}['clear'](){const _0x54829a={_0x102dc0:0x213,_0x50bc8e:0x1d9,_0x337014:0x210},_0x29781d=_0x247fd7;this['_graphic']&&(this['_layer']['removeGraphic'](this[_0x29781d(0x201)],!![]),delete this['_graphic']),this['_graphic2']&&(this[_0x29781d(_0x54829a._0x102dc0)][_0x29781d(_0x54829a._0x50bc8e)](this[_0x29781d(_0x54829a._0x337014)],!![]),delete this['_graphic2']);}[_0x247fd7(0x1f8)](_0x3c84a8){const _0x22dc3c={_0x522706:0x1cf,_0x4c8af2:0x1da,_0x3f2045:0x1d1,_0x1a8ad1:0x1d8,_0x52f340:0x210,_0x208db9:0x210,_0x3de29f:0x201},_0x53e582=_0x247fd7;if(!this[_0x53e582(0x208)]||!this['_map']||!this['positions']||this['positions']['length']===0x0)return this;const _0x59b979=this[_0x53e582(_0x22dc3c._0x522706)]();if(this['style']['type']===_0x53e582(0x1d1))this[_0x53e582(0x213)]['setOptions']({'url':_0x59b979['toDataURL']('image/png',0x1),'rectangle':this['_rectangle'],'opacity':this['style'][_0x53e582(0x1c1)]});else this['style']['arc']?this['_graphic']&&_0x3c84a8?(this['_graphic'][_0x53e582(_0x22dc3c._0x4c8af2)][_0x53e582(_0x22dc3c._0x3f2045)]=_0x59b979,this['_graphic'][_0x53e582(_0x22dc3c._0x4c8af2)][_0x53e582(_0x22dc3c._0x1a8ad1)]=this['_getArcHeatCanvas'](),this[_0x53e582(_0x22dc3c._0x52f340)]&&(this[_0x53e582(_0x22dc3c._0x208db9)]['uniforms'][_0x53e582(_0x22dc3c._0x3f2045)]=_0x59b979,this['_graphic2']['uniforms'][_0x53e582(0x1d8)]=this['_graphic'][_0x53e582(_0x22dc3c._0x4c8af2)]['bumpMap'])):this['_createArcGraphic'](_0x59b979):this['_graphic']&&_0x3c84a8?this[_0x53e582(_0x22dc3c._0x3de29f)]['uniforms']['image']=_0x59b979:this['_createGraphic'](_0x59b979);return this;}['_createGraphic'](_0xb0f079){const _0x32c2f2=_0x247fd7;this['clear'](),this['_graphic']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'material':new Cesium['Material']({'fabric':{'uniforms':{'image':_0xb0f079},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})}),this['_layer'][_0x32c2f2(0x218)](this['_graphic']);}['_createArcGraphic'](_0x5bd138){const _0x65d423={_0xda5774:0x1f0,_0x1bb920:0x1cb,_0x4423a9:0x1d5,_0x33aae4:0x1fe,_0x1da5fd:0x1e0,_0x13588a:0x1c0,_0x201ed6:0x1fd,_0x29de38:0x1db,_0x11f1b5:0x213,_0x2e4755:0x210,_0x4f46bc:0x211},_0x92bf7e=_0x247fd7;this[_0x92bf7e(0x1f4)]();const _0x3cba15=Cesium[_0x92bf7e(0x1c8)]['fromCache']({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium['StencilFunction'][_0x92bf7e(0x215)],'frontOperation':{'fail':Cesium[_0x92bf7e(_0x65d423._0xda5774)]['KEEP'],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium['StencilOperation']['REPLACE']},'backFunction':Cesium[_0x92bf7e(0x202)]['ALWAYS'],'backOperation':{'fail':Cesium['StencilOperation'][_0x92bf7e(0x1d7)],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium[_0x92bf7e(0x1f0)]['REPLACE']},'reference':0x2,'mask':0x2},'blending':Cesium['BlendingState'][_0x92bf7e(_0x65d423._0x1bb920)]}),_0x3d4435=Math[_0x92bf7e(_0x65d423._0x4423a9)](this['style'][_0x92bf7e(_0x65d423._0x33aae4)]??this[_0x92bf7e(_0x65d423._0x1da5fd)]*0.02)+0.1;this[_0x92bf7e(0x1c0)]['diffHeight']&&delete this['style']['diffHeight'];const _0x3e60d1=(this['style']['splitNum'],0x64);let _0x1de47b=Math['max'](this['_rectangle']['height'],this['_rectangle']['width']);this[_0x92bf7e(0x1c0)]['granularity']=_0x1de47b/=_0x3e60d1;const _0x1588a3=new Cesium['Material']({'fabric':{'uniforms':{'image':_0x5bd138,'repeat':new Cesium['Cartesian2'](0x1,0x1),'color':new Cesium['Color'](0x1,0x1,0x1,0x0),'bumpMap':this['_getArcHeatCanvas']()},'source':HeatMaterial},'translucent':!![]}),_0x5c175a=this[_0x92bf7e(_0x65d423._0x13588a)][_0x92bf7e(0x20e)]||0x1;this['_graphic']=new mars3d__namespace[(_0x92bf7e(_0x65d423._0x201ed6))]['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium[(_0x92bf7e(_0x65d423._0x29de38))]({'flat':!![],'aboveGround':!![],'renderState':_0x3cba15,'material':_0x1588a3,'vertexShaderSource':getVertexShaderSource(_0x3d4435*_0x5c175a)})}),this[_0x92bf7e(_0x65d423._0x11f1b5)][_0x92bf7e(0x218)](this['_graphic']),this[_0x92bf7e(_0x65d423._0x13588a)][_0x92bf7e(0x20e)]===0x0&&(this[_0x92bf7e(_0x65d423._0x2e4755)]=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this[_0x92bf7e(_0x65d423._0x4f46bc)],'appearance':new Cesium[(_0x92bf7e(0x1db))]({'flat':!![],'aboveGround':!![],'renderState':_0x3cba15,'material':_0x1588a3,'vertexShaderSource':getVertexShaderSource(-_0x3d4435)})}),this['_layer'][_0x92bf7e(0x218)](this[_0x92bf7e(0x210)]));}['getRectangle'](_0x23d82a){const _0x5c34ad=_0x247fd7;return _0x23d82a!==null&&_0x23d82a!==void 0x0&&_0x23d82a['isFormat']&&this['_rectangle']?mars3d__namespace['PolyUtil']['formatRectangle'](this[_0x5c34ad(0x211)]):this['_rectangle'];}[_0x247fd7(0x1cf)](){const _0x3ab736={_0x1bd250:0x1e7,_0x1748bc:0x1c7,_0x33119d:0x212,_0x6ac33a:0x1de,_0x2b6b00:0x212,_0x367b80:0x1f5,_0x58fe34:0x203,_0x39c33b:0x212,_0x531568:0x1bc,_0x4929ac:0x1bd,_0x2f59c5:0x1c3,_0x2a9096:0x1dc,_0x5063d5:0x20b,_0x15364d:0x1fc},_0xe7035c={_0x2c4036:0x1ca},_0x4525e3={_0x103a75:0x1f1,_0x4e2fcf:0x1c5,_0x28e4b4:0x1d3,_0x1c652c:0x1e5,_0x1f37f6:0x1c5},_0x463ba7=_0x247fd7,_0x19b959=this[_0x463ba7(0x1cc)],_0x548ff0=[];let _0x4f839a,_0x1d0048,_0x247efe,_0x58e882;_0x19b959[_0x463ba7(_0x3ab736._0x1bd250)](_0x1bcbd7=>{const _0x33d733=_0x463ba7,_0x342571=mars3d__namespace[_0x33d733(0x1d6)]['parse'](_0x1bcbd7);if(!_0x342571)return;_0x342571['value']=_0x1bcbd7['value']||0x1,!this['options'][_0x33d733(_0x4525e3._0x103a75)]&&(_0x4f839a===undefined?(_0x4f839a=_0x342571['lng'],_0x1d0048=_0x342571['lng'],_0x247efe=_0x342571[_0x33d733(0x1c5)],_0x58e882=_0x342571[_0x33d733(_0x4525e3._0x4e2fcf)]):(_0x4f839a=Math['min'](_0x4f839a,_0x342571['lng']),_0x1d0048=Math[_0x33d733(_0x4525e3._0x28e4b4)](_0x1d0048,_0x342571['lng']),_0x247efe=Math[_0x33d733(_0x4525e3._0x1c652c)](_0x247efe,_0x342571[_0x33d733(_0x4525e3._0x1f37f6)]),_0x58e882=Math['max'](_0x58e882,_0x342571['lat']))),_0x548ff0['push'](_0x342571);});_0x4f839a===_0x1d0048&&(_0x4f839a-=0.000001,_0x1d0048+=0.000001);_0x247efe===_0x58e882&&(_0x247efe-=0.000001,_0x58e882+=0.000001);let _0x48a609=this['options'][_0x463ba7(0x1f1)]||{'xmin':_0x4f839a,'xmax':_0x1d0048,'ymin':_0x247efe,'ymax':_0x58e882};const _0x43afe4=getMercatorBounds(_0x48a609),_0x395d79=Math['abs'](_0x43afe4[_0x463ba7(_0x3ab736._0x1748bc)]-_0x43afe4['xmin']),_0x344ed1=Math['abs'](_0x43afe4[_0x463ba7(0x205)]-_0x43afe4['ymin']),_0xf0cc8f=Math['max'](_0x395d79,_0x344ed1),_0x454a8e=Math['min'](_0x395d79,_0x344ed1);this['_mBoundsMax']=_0xf0cc8f;let _0x163f41=0x1;if(_0xf0cc8f>this['options']['maxCanvasSize'])_0x163f41=_0xf0cc8f/this['options']['maxCanvasSize'],_0x454a8e/_0x163f41<this['options']['minCanvasSize']&&(_0x163f41=_0x454a8e/this[_0x463ba7(_0x3ab736._0x33119d)][_0x463ba7(_0x3ab736._0x6ac33a)]);else _0x454a8e<this['options']['minCanvasSize']&&(_0x163f41=_0x454a8e/this['options']['minCanvasSize'],_0xf0cc8f/_0x163f41>this['options']['maxCanvasSize']&&(_0x163f41=_0xf0cc8f/this[_0x463ba7(_0x3ab736._0x2b6b00)]['maxCanvasSize']));const _0x2e9315=this['heatStyle']['radius']*1.5,_0x534c3d=_0x395d79/_0x163f41+_0x2e9315*0x2,_0x41cf6f=_0x344ed1/_0x163f41+_0x2e9315*0x2,_0x125fc1=_0x2e9315*_0x163f41;_0x43afe4['xmin']-=_0x125fc1,_0x43afe4['ymin']-=_0x125fc1,_0x43afe4['xmax']+=_0x125fc1,_0x43afe4['ymax']+=_0x125fc1,this['_scale']=_0x163f41,_0x48a609=geLatLngBounds(_0x43afe4),this[_0x463ba7(0x211)]=Cesium['Rectangle']['fromDegrees'](_0x48a609['xmin'],_0x48a609[_0x463ba7(_0x3ab736._0x367b80)],_0x48a609['xmax'],_0x48a609['ymax']);let _0x89805=_0x548ff0[0x0][_0x463ba7(_0x3ab736._0x58fe34)]??0x1,_0x54a450=_0x548ff0[0x0][_0x463ba7(0x203)]??0x0;const _0x99ad94=[];_0x548ff0['forEach'](_0xe9cf21=>{const _0x4ea4ff=_0x463ba7,_0x3e1827=mars3d__namespace[_0x4ea4ff(0x1f9)]['lonlat2mercator']([_0xe9cf21['lng'],_0xe9cf21['lat']]),_0x5ca5f6=_0xe9cf21['value']||0x1,_0x2b7376=Math['round']((_0x3e1827[0x0]-_0x43afe4['xmin'])/_0x163f41),_0x2ca353=Math[_0x4ea4ff(_0xe7035c._0x2c4036)]((_0x43afe4[_0x4ea4ff(0x205)]-_0x3e1827[0x1])/_0x163f41);_0x89805=Math[_0x4ea4ff(0x1d3)](_0x89805,_0x5ca5f6),_0x54a450=Math['min'](_0x54a450,_0x5ca5f6),_0x99ad94['push']({'x':_0x2b7376,'y':_0x2ca353,'value':_0x5ca5f6});});const _0x692738={'min':this[_0x463ba7(_0x3ab736._0x39c33b)][_0x463ba7(0x1e5)]??_0x54a450,'max':this['options']['max']??_0x89805,'data':_0x99ad94};this['_last_heatData']=_0x692738;if(!this['_last_mBounds']||_0x43afe4['xmin']!==this['_last_mBounds'][_0x463ba7(_0x3ab736._0x531568)]||_0x43afe4['ymin']!==this['_last_mBounds']['ymin']||_0x43afe4[_0x463ba7(0x1c7)]!==this[_0x463ba7(_0x3ab736._0x4929ac)]['xmax']||_0x43afe4['ymax']!==this[_0x463ba7(0x1bd)]['ymax']){this['_last_mBounds']=_0x43afe4,this[_0x463ba7(_0x3ab736._0x2f59c5)]['style']['cssText']='width:'+_0x534c3d+_0x463ba7(_0x3ab736._0x2a9096)+_0x41cf6f+'px;';const _0x4c1082={...this['heatStyle'],'container':this[_0x463ba7(_0x3ab736._0x2f59c5)]};!this[_0x463ba7(0x1fc)]?this['_heat']=h337__namespace['create'](_0x4c1082):this['_heat'][_0x463ba7(_0x3ab736._0x5063d5)](_0x4c1082);}this[_0x463ba7(_0x3ab736._0x15364d)]['setData'](_0x692738);const _0x2898eb=mars3d__namespace['DomUtil']['copyCanvas'](this['_heat']['_renderer'][_0x463ba7(0x1e1)]);return _0x2898eb;}[_0x247fd7(0x217)](){const _0x11752b={_0x4f04c6:0x1ed,_0x5b7ff2:0x200,_0x5b35ee:0x20a,_0x9be82f:0x1fc},_0x44c70c=_0x247fd7;this['_heat']['configure']({'radius':this['heatStyle']['radius']*this['style'][_0x44c70c(0x1d4)],'blur':this['heatStyle']['blur']*this[_0x44c70c(0x1c0)]['arcBlurScale'],'gradient':this['heatStyle']['gradientArc']||{0.25:'rgb(0,0,0)',0.55:_0x44c70c(_0x11752b._0x4f04c6),0.85:_0x44c70c(_0x11752b._0x5b7ff2),0x1:'rgb(255,255,255)'}});const _0x1ceab2=mars3d__namespace[_0x44c70c(_0x11752b._0x5b35ee)]['copyCanvas'](this['_heat']['_renderer']['canvas']);return this[_0x44c70c(_0x11752b._0x9be82f)]['configure'](this['options']['heatStyle']),_0x1ceab2;}[_0x247fd7(0x209)](_0xbfce37){const _0x156eab={_0x13b698:0x1bd,_0xf2429a:0x1eb,_0x214d80:0x1bb},_0x574f7b=_0x247fd7,_0x5f1d4b=mars3d__namespace['LngLatPoint'][_0x574f7b(0x1e6)](_0xbfce37);if(!_0x5f1d4b)return{};const _0x3f52cf=mars3d__namespace[_0x574f7b(0x1f9)][_0x574f7b(0x1dd)]([_0x5f1d4b['lng'],_0x5f1d4b['lat']]),_0x56a31e=this[_0x574f7b(_0x156eab._0x13b698)],_0x5dcdda=Math['round']((_0x3f52cf[0x0]-_0x56a31e['xmin'])/this[_0x574f7b(0x1eb)]),_0x5b6926=Math['round']((_0x56a31e['ymax']-_0x3f52cf[0x1])/this[_0x574f7b(_0x156eab._0xf2429a)]),_0x3ddd8e=this['_heat']['getValueAt']({'x':_0x5dcdda,'y':_0x5b6926}),_0x5449f0=this[_0x574f7b(0x1fc)]['_renderer'][_0x574f7b(_0x156eab._0x214d80)][_0x574f7b(0x1ec)](_0x5dcdda-0x1,_0x5b6926-0x1,0x1,0x1)[_0x574f7b(0x206)];return{'x':_0x5dcdda,'y':_0x5b6926,'value':_0x3ddd8e,'color':'rgba('+_0x5449f0[0x0]+','+_0x5449f0[0x1]+','+_0x5449f0[0x2]+','+_0x5449f0[0x3]+')'};}}mars3d__namespace['LayerUtil']['register']('heat',HeatLayer),mars3d__namespace['layer'][_0x247fd7(0x20c)]=HeatLayer,mars3d__namespace[_0x247fd7(0x1bf)]=h337__namespace;function getMercatorBounds(_0x46ca2a){const _0x4a78c0={_0x583766:0x1f9,_0x5a3f54:0x1f9},_0x241e1a=_0x247fd7,_0x508b0b=mars3d__namespace[_0x241e1a(_0x4a78c0._0x583766)]['lonlat2mercator']([_0x46ca2a[_0x241e1a(0x1bc)],_0x46ca2a['ymin']]),_0x54db8a=mars3d__namespace[_0x241e1a(_0x4a78c0._0x5a3f54)]['lonlat2mercator']([_0x46ca2a[_0x241e1a(0x1c7)],_0x46ca2a['ymax']]);return{'xmin':_0x508b0b[0x0],'ymin':_0x508b0b[0x1],'xmax':_0x54db8a[0x0],'ymax':_0x54db8a[0x1]};}function geLatLngBounds(_0xa4e893){const _0x1c47a8=_0x247fd7,_0xf5b6e4=mars3d__namespace[_0x1c47a8(0x1f9)][_0x1c47a8(0x214)]([_0xa4e893['xmin'],_0xa4e893['ymin']]),_0x593715=mars3d__namespace['PointTrans']['mercator2lonlat']([_0xa4e893['xmax'],_0xa4e893['ymax']]);return{'xmin':_0xf5b6e4[0x0],'ymin':_0xf5b6e4[0x1],'xmax':_0x593715[0x0],'ymax':_0x593715[0x1]};}function _0x122b(){const _0x47154e=['get','show','getPointData','DomUtil','configure','HeatLayer','addPosition','arcDirection','layer','_graphic2','_rectangle','options','_layer','mercator2lonlat','ALWAYS','Util','_getArcHeatCanvas','addGraphic','positions','ctx','xmin','_last_mBounds','5raCysm','h337','style','opacity','_mountedHook','_container','uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a','lat','heatStyle','xmax','RenderState','Cesium','round','ALPHA_BLEND','_positions','_removedHook','in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20','_getHeatCanvas','4290704CFTCxX','image','points','max','arcRadiusScale','floor','LngLatPoint','KEEP','bumpMap','removeGraphic','uniforms','EllipsoidSurfaceAppearance','px;height:','lonlat2mercator','minCanvasSize','66byLvjn','_mBoundsMax','canvas','1133104CSrEkI','body','45582mAvLep','min','parse','forEach','getOwnPropertyDescriptor','_addedHook','ImageLayer','_scale','getImageData','rgb(140,140,140)','3094854ebcaHB','merge','StencilOperation','rectangle','2696104acAiRJ','remove','clear','ymin','setPositions','_map','_updatePositionsHook','PointTrans','66376JHtegu','__esModule','_heat','graphic','diffHeight','18892791tRYKBk','rgb(216,216,216)','_graphic','StencilFunction','value','10RNAZjr','ymax','data'];_0x122b=function(){return _0x47154e;};return _0x122b();}function getVertexShaderSource(_0x2b69f1){const _0x51d314=_0x247fd7;return _0x51d314(0x1ce)+_0x2b69f1+';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a';}exports['HeatLayer']=HeatLayer,Object['defineProperty'](exports,_0x247fd7(0x1fb),{'value':!![]});
}));
