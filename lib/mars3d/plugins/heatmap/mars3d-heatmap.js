/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.6.13
 * 编译日期：2023-11-20 21:13:43
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';const _0x74c750=_0x20ef;(function(_0x1e12f4,_0x500166){const _0x2ef767={_0x667da:0x1b1,_0x40b93a:0x1b8,_0x2e742b:0x17f,_0x12754c:0x1cb},_0x276768=_0x20ef,_0x1ae87c=_0x1e12f4();while(!![]){try{const _0x3cdd71=-parseInt(_0x276768(0x1ac))/0x1*(-parseInt(_0x276768(_0x2ef767._0x667da))/0x2)+parseInt(_0x276768(_0x2ef767._0x40b93a))/0x3*(parseInt(_0x276768(_0x2ef767._0x2e742b))/0x4)+-parseInt(_0x276768(0x1d2))/0x5+parseInt(_0x276768(0x19f))/0x6*(parseInt(_0x276768(_0x2ef767._0x12754c))/0x7)+-parseInt(_0x276768(0x187))/0x8+parseInt(_0x276768(0x1c1))/0x9+parseInt(_0x276768(0x1af))/0xa*(parseInt(_0x276768(0x1b2))/0xb);if(_0x3cdd71===_0x500166)break;else _0x1ae87c['push'](_0x1ae87c['shift']());}catch(_0x5951b7){_0x1ae87c['push'](_0x1ae87c['shift']());}}}(_0x2382,0xe0653));function _0x20ef(_0x420047,_0x12c44a){const _0x2382d5=_0x2382();return _0x20ef=function(_0x20efdf,_0x5d0dda){_0x20efdf=_0x20efdf-0x17a;let _0x32f259=_0x2382d5[_0x20efdf];return _0x32f259;},_0x20ef(_0x420047,_0x12c44a);}function _interopNamespace(_0x1f2d13){const _0x39ff1c={_0x5b9dbc:0x188},_0x6d6870={_0x333820:0x190},_0x2d33e2=_0x20ef;if(_0x1f2d13&&_0x1f2d13[_0x2d33e2(_0x39ff1c._0x5b9dbc)])return _0x1f2d13;var _0x387e0b=Object[_0x2d33e2(0x1cf)](null);return _0x1f2d13&&Object['keys'](_0x1f2d13)['forEach'](function(_0xab1822){const _0x2efaa8=_0x2d33e2;if(_0xab1822!=='default'){var _0x3547e5=Object['getOwnPropertyDescriptor'](_0x1f2d13,_0xab1822);Object['defineProperty'](_0x387e0b,_0xab1822,_0x3547e5[_0x2efaa8(_0x6d6870._0x333820)]?_0x3547e5:{'enumerable':!![],'get':function(){return _0x1f2d13[_0xab1822];}});}}),_0x387e0b[_0x2d33e2(0x1b4)]=_0x1f2d13,_0x387e0b;}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337),HeatMaterial='uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a';function _0x2382(){const _0x573306=['merge','addGraphic','StencilOperation','lng','_mBoundsMax','removeGraphic','setPositions','minCanvasSize','_scale','ALWAYS','push','graphic','opacity','6dwJNlt','max','getImageData','_map','diffHeight','ymin','_renderer','xmin','_createGraphic','lat','layer','_layer','uniforms','42734BbWTsz','width','bumpMap','3921430rIXAMm','KEEP','12aZjXAf','11FdsdXW','options','default','rgb(140,140,140)','LngLatPoint','arcBlurScale','2385654nhUmjm','_getArcHeatCanvas','flyTo','canvas','_container','EllipsoidSurfaceAppearance','style','type','BlendingState','2938644kPQLGs','Color','in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20','arcDirection','heatStyle','VERTEX_FORMAT','toArray','round','StencilFunction','configure','3710147gUpiXR','blur','DomUtil','image','create','_positions','_createArcGraphic','4747660ozQqSq','forEach','ymax','clear','_rectangle','RectanglePrimitive','Util','8paLYLT','coordinates','points','_last_mBounds','positions','_heat','body','xmax','9814920Qghzdq','__esModule','show','rgb(0,0,0)','min','copyCanvas','_graphic','floor','value','get','parse'];_0x2382=function(){return _0x573306;};return _0x2382();}if(!h337__namespace['create'])throw new Error('请引入\x20heatmap.js\x20库\x20');const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace['layer']['BaseLayer'],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:'blue',0.6:'green',0.8:'yellow',0.9:'red'}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium[_0x74c750(0x1bd)][_0x74c750(0x1c6)]};class HeatLayer extends BaseLayer{constructor(_0x17b31c={}){const _0x10e49a={_0x1a0b93:0x1b3,_0x26186d:0x1b3,_0x4c1778:0x1b3},_0x1dcaf7=_0x74c750;super(_0x17b31c),this[_0x1dcaf7(_0x10e49a._0x1a0b93)]['maxCanvasSize']=this[_0x1dcaf7(_0x10e49a._0x26186d)]['maxCanvasSize']??document['body']['clientWidth'],this[_0x1dcaf7(_0x10e49a._0x4c1778)]['maxCanvasSize']=Math['min'](this['options']['maxCanvasSize'],0x1388),this['options']['minCanvasSize']=this['options']['minCanvasSize']??document[_0x1dcaf7(0x185)]['clientHeight'],this[_0x1dcaf7(0x1b3)]['minCanvasSize']=Math[_0x1dcaf7(0x1a0)](this['options']['minCanvasSize'],0x2bc),this['options']['heatStyle']={...DEF_HEATSTYLE,...this[_0x1dcaf7(0x1b3)][_0x1dcaf7(0x1c5)]},this['options']['style']={...DEF_STYLE,...this['options']['style']};}get['layer'](){return this['_layer'];}get['heatStyle'](){const _0x2c0b12={_0x386dc0:0x1c5},_0x35a7b7=_0x74c750;return this['options'][_0x35a7b7(_0x2c0b12._0x386dc0)];}set['heatStyle'](_0x159abc){const _0x55f05b={_0x51e9d7:0x1b3,_0x4eda6e:0x184,_0x2368a1:0x1ca},_0x447682=_0x74c750;this['options']['heatStyle']=mars3d__namespace[_0x447682(0x17e)]['merge'](this[_0x447682(_0x55f05b._0x51e9d7)][_0x447682(0x1c5)],_0x159abc),this[_0x447682(_0x55f05b._0x4eda6e)]&&(this['_heat'][_0x447682(_0x55f05b._0x2368a1)](this['options']['heatStyle']),this['_updatePositionsHook'](!![]));}get['style'](){return this['options']['style'];}set['style'](_0xde86d9){const _0x33fa98={_0x22ff93:0x1be,_0x5d6114:0x1b3},_0x229189=_0x74c750;this['options'][_0x229189(_0x33fa98._0x22ff93)]=mars3d__namespace['Util'][_0x229189(0x192)](this[_0x229189(_0x33fa98._0x5d6114)][_0x229189(0x1be)],_0xde86d9);}get['positions'](){const _0x3465d9=_0x74c750;return this[_0x3465d9(0x1d0)];}set['positions'](_0x2a0e66){const _0x240d63=_0x74c750;this[_0x240d63(0x198)](_0x2a0e66);}get[_0x74c750(0x180)](){const _0x48c1c3={_0x4d3075:0x181},_0x10b6a4=_0x74c750,_0x4f675d=[];return this[_0x10b6a4(_0x48c1c3._0x4d3075)]['forEach'](_0x5f8b9b=>{const _0x2cf8e7=_0x10b6a4;_0x4f675d[_0x2cf8e7(0x19c)](_0x5f8b9b[_0x2cf8e7(0x1c7)]());}),_0x4f675d;}get['rectangle'](){const _0x113a03=_0x74c750;return this[_0x113a03(0x17c)];}['_setOptionsHook'](_0x2fff7e,_0x284403){const _0x757449={_0x4e0532:0x183},_0x2b3f61=_0x74c750;_0x2fff7e['positions']&&(this[_0x2b3f61(_0x757449._0x4e0532)]=_0x2fff7e['positions']);}['_mountedHook'](){const _0x19814d={_0x292229:0x1bf,_0x4f144d:0x1ce},_0x47a693=_0x74c750;this['style'][_0x47a693(_0x19814d._0x292229)]===_0x47a693(_0x19814d._0x4f144d)?this['_layer']=new mars3d__namespace['layer']['ImageLayer']({'crs':'EPSG:3857','private':!![]}):this['_layer']=new mars3d__namespace[(_0x47a693(0x1a9))]['GraphicLayer']({'private':!![]});}['_addedHook'](){const _0x31cb79={_0x5172d1:0x1aa,_0x35234f:0x1cd,_0x58dcca:0x1a2},_0x370c1b=_0x74c750;this['_map']['addLayer'](this[_0x370c1b(_0x31cb79._0x5172d1)]),this['_container']=mars3d__namespace[_0x370c1b(_0x31cb79._0x35234f)]['create']('div','mars3d-heatmap\x20mars3d-hideDiv',this[_0x370c1b(_0x31cb79._0x58dcca)]['container']),this['options']['positions']&&(this['positions']=this['options']['positions']),this[_0x370c1b(0x1b3)][_0x370c1b(0x1ba)]&&this['flyToByAnimationEnd']();}['_removedHook'](){const _0x458d7e={_0x59255d:0x17b},_0x2577b3=_0x74c750;this['_container']&&(mars3d__namespace[_0x2577b3(0x1cd)]['remove'](this['_container']),delete this['_container']),this[_0x2577b3(_0x458d7e._0x59255d)](),this[_0x2577b3(0x1a2)]['removeLayer'](this['_layer']);}['addPosition'](_0x1095c2,_0x582831){this['_positions']=this['_positions']||[],this['_positions']['push'](_0x1095c2),this['_updatePositionsHook'](_0x582831);}['setPositions'](_0x1d979f,_0x25fd94){this['_positions']=_0x1d979f,this['_updatePositionsHook'](_0x25fd94);}['clear'](){const _0x5dc052={_0x3cec3f:0x18d,_0x223728:0x18d},_0x2ae0ca=_0x74c750;this[_0x2ae0ca(_0x5dc052._0x3cec3f)]&&(this['_layer']['removeGraphic'](this[_0x2ae0ca(_0x5dc052._0x223728)],!![]),delete this['_graphic']),this['_graphic2']&&(this['_layer'][_0x2ae0ca(0x197)](this['_graphic2'],!![]),delete this['_graphic2']);}['_updatePositionsHook'](_0x48edea){const _0x23d5d3={_0x584111:0x189,_0x212091:0x18d,_0xc26450:0x1ab,_0x4eedfd:0x1ce,_0x24bc53:0x18d,_0xa48b0d:0x1ab,_0x3e776c:0x1a7},_0x18e9b5=_0x74c750;if(!this[_0x18e9b5(_0x23d5d3._0x584111)]||!this['_map']||!this[_0x18e9b5(0x183)]||this['positions']['length']===0x0)return this;const _0x37d34e=this['_getHeatCanvas']();if(this['style'][_0x18e9b5(0x1bf)]==='image')this[_0x18e9b5(0x1aa)]['setOptions']({'url':_0x37d34e['toDataURL']('image/png'),'rectangle':this['_rectangle'],'opacity':this['style'][_0x18e9b5(0x19e)]});else this['style']['arc']?this['_graphic']&&_0x48edea?(this[_0x18e9b5(_0x23d5d3._0x212091)]['uniforms'][_0x18e9b5(0x1ce)]=_0x37d34e,this['_graphic'][_0x18e9b5(_0x23d5d3._0xc26450)][_0x18e9b5(0x1ae)]=this['_getArcHeatCanvas'](),this['_graphic2']&&(this['_graphic2'][_0x18e9b5(0x1ab)][_0x18e9b5(_0x23d5d3._0x4eedfd)]=_0x37d34e,this['_graphic2']['uniforms']['bumpMap']=this[_0x18e9b5(0x18d)]['uniforms']['bumpMap'])):this[_0x18e9b5(0x1d1)](_0x37d34e):this[_0x18e9b5(_0x23d5d3._0x212091)]&&_0x48edea?this[_0x18e9b5(_0x23d5d3._0x24bc53)][_0x18e9b5(_0x23d5d3._0xa48b0d)][_0x18e9b5(_0x23d5d3._0x4eedfd)]=_0x37d34e:this[_0x18e9b5(_0x23d5d3._0x3e776c)](_0x37d34e);return this;}['_createGraphic'](_0x3a9b1a){const _0x3c8076={_0x6f050c:0x17b,_0x1c781f:0x17d,_0x7eaf73:0x1b3},_0x39d488=_0x74c750;this[_0x39d488(_0x3c8076._0x6f050c)](),this['_graphic']=new mars3d__namespace['graphic'][(_0x39d488(_0x3c8076._0x1c781f))]({...this[_0x39d488(_0x3c8076._0x7eaf73)],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'material':new Cesium['Material']({'fabric':{'uniforms':{'image':_0x3a9b1a},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})}),this['_layer']['addGraphic'](this['_graphic']);}[_0x74c750(0x1d1)](_0x21bbf4){const _0x217a29={_0x45f697:0x194,_0x2f0a2f:0x18e,_0x4c5261:0x196,_0x143317:0x1be,_0x9af50e:0x1ad,_0x304f26:0x1c2,_0x5dcdf9:0x1c4,_0x4942ec:0x17d,_0x4e586e:0x1aa,_0x31a549:0x1bd,_0x3a2600:0x193},_0x56880c=_0x74c750;this['clear']();const _0x486438=Cesium['RenderState']['fromCache']({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium[_0x56880c(0x1c9)][_0x56880c(0x19b)],'frontOperation':{'fail':Cesium['StencilOperation'][_0x56880c(0x1b0)],'zFail':Cesium[_0x56880c(_0x217a29._0x45f697)]['KEEP'],'zPass':Cesium['StencilOperation']['REPLACE']},'backFunction':Cesium['StencilFunction']['ALWAYS'],'backOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium['StencilOperation'][_0x56880c(0x1b0)],'zPass':Cesium['StencilOperation']['REPLACE']},'reference':0x2,'mask':0x2},'blending':Cesium[_0x56880c(0x1c0)]['ALPHA_BLEND']}),_0x8e73be=Math[_0x56880c(_0x217a29._0x2f0a2f)](this['style'][_0x56880c(0x1a3)]??this[_0x56880c(_0x217a29._0x4c5261)]*0.02)+0.1;this[_0x56880c(_0x217a29._0x143317)]['diffHeight']&&delete this['style'][_0x56880c(0x1a3)];const _0x1aee8d=(this['style']['splitNum'],0x64);let _0x865d72=Math['max'](this[_0x56880c(0x17c)]['height'],this['_rectangle'][_0x56880c(_0x217a29._0x9af50e)]);this['style']['granularity']=_0x865d72/=_0x1aee8d;const _0x5ad855=new Cesium['Material']({'fabric':{'uniforms':{'image':_0x21bbf4,'repeat':new Cesium['Cartesian2'](0x1,0x1),'color':new Cesium[(_0x56880c(_0x217a29._0x304f26))](0x1,0x1,0x1,0x0),'bumpMap':this[_0x56880c(0x1b9)]()},'source':HeatMaterial},'translucent':!![]}),_0x2da038=this['style'][_0x56880c(_0x217a29._0x5dcdf9)]||0x1;this['_graphic']=new mars3d__namespace['graphic'][(_0x56880c(_0x217a29._0x4942ec))]({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x486438,'material':_0x5ad855,'vertexShaderSource':getVertexShaderSource(_0x8e73be*_0x2da038)})}),this[_0x56880c(_0x217a29._0x4e586e)][_0x56880c(0x193)](this['_graphic']),this['style'][_0x56880c(0x1c4)]===0x0&&(this['_graphic2']=new mars3d__namespace[(_0x56880c(0x19d))]['RectanglePrimitive']({...this['options'],'rectangle':this[_0x56880c(0x17c)],'appearance':new Cesium[(_0x56880c(_0x217a29._0x31a549))]({'flat':!![],'aboveGround':!![],'renderState':_0x486438,'material':_0x5ad855,'vertexShaderSource':getVertexShaderSource(-_0x8e73be)})}),this['_layer'][_0x56880c(_0x217a29._0x3a2600)](this['_graphic2']));}['getRectangle'](_0x3cb8b0){const _0x1fee0c={_0x2a459b:0x17c},_0x5e2224=_0x74c750;return _0x3cb8b0!==null&&_0x3cb8b0!==void 0x0&&_0x3cb8b0['isFormat']&&this[_0x5e2224(_0x1fee0c._0x2a459b)]?mars3d__namespace['PolyUtil']['formatRectangle'](this['_rectangle']):this['_rectangle'];}['_getHeatCanvas'](){const _0x305e1f={_0x25c267:0x1d3,_0x2611bb:0x1b3,_0x31b2c5:0x199,_0x5df88a:0x1b3,_0x3811db:0x199,_0x5cc467:0x1a6,_0x147ed4:0x19a,_0x4a0706:0x182,_0x4f61a9:0x1a4,_0xc64fb7:0x184,_0x462133:0x1cd,_0x5bc33b:0x18c},_0x13b370={_0x2fee05:0x1c8},_0x5a2b1b={_0x43e6d5:0x1b3,_0x5d4102:0x195,_0x3e1106:0x1a8},_0x151ccb=_0x74c750,_0x2b6adb=this['_positions'],_0x4710d1=[];let _0x50b5f0,_0x367a08,_0x25a943,_0x32d739;_0x2b6adb[_0x151ccb(_0x305e1f._0x25c267)](_0x1982e6=>{const _0x1f654c=_0x151ccb,_0xf3753c=mars3d__namespace['LngLatPoint']['parse'](_0x1982e6);if(!_0xf3753c)return;_0xf3753c[_0x1f654c(0x18f)]=_0x1982e6['value']||0x1,!this[_0x1f654c(_0x5a2b1b._0x43e6d5)]['rectangle']&&(_0x50b5f0===undefined?(_0x50b5f0=_0xf3753c['lng'],_0x367a08=_0xf3753c[_0x1f654c(_0x5a2b1b._0x5d4102)],_0x25a943=_0xf3753c[_0x1f654c(0x1a8)],_0x32d739=_0xf3753c[_0x1f654c(_0x5a2b1b._0x3e1106)]):(_0x50b5f0=Math['min'](_0x50b5f0,_0xf3753c[_0x1f654c(0x195)]),_0x367a08=Math['max'](_0x367a08,_0xf3753c[_0x1f654c(0x195)]),_0x25a943=Math[_0x1f654c(0x18b)](_0x25a943,_0xf3753c['lat']),_0x32d739=Math['max'](_0x32d739,_0xf3753c['lat']))),_0x4710d1['push'](_0xf3753c);});_0x50b5f0===_0x367a08&&(_0x50b5f0-=0.000001,_0x367a08+=0.000001);_0x25a943===_0x32d739&&(_0x25a943-=0.000001,_0x32d739+=0.000001);let _0x17785a=this[_0x151ccb(_0x305e1f._0x2611bb)]['rectangle']||{'xmin':_0x50b5f0,'xmax':_0x367a08,'ymin':_0x25a943,'ymax':_0x32d739};const _0x106253=getMercatorBounds(_0x17785a),_0x5a969f=Math['abs'](_0x106253['xmax']-_0x106253['xmin']),_0xf25f93=Math['abs'](_0x106253['ymax']-_0x106253['ymin']),_0x1ea5bc=Math[_0x151ccb(0x1a0)](_0x5a969f,_0xf25f93),_0x4bf364=Math['min'](_0x5a969f,_0xf25f93);this['_mBoundsMax']=_0x1ea5bc;let _0x24cb96=0x1;if(_0x1ea5bc>this['options']['maxCanvasSize'])_0x24cb96=_0x1ea5bc/this['options']['maxCanvasSize'],_0x4bf364/_0x24cb96<this['options']['minCanvasSize']&&(_0x24cb96=_0x4bf364/this['options'][_0x151ccb(_0x305e1f._0x31b2c5)]);else _0x4bf364<this[_0x151ccb(_0x305e1f._0x5df88a)][_0x151ccb(_0x305e1f._0x3811db)]&&(_0x24cb96=_0x4bf364/this[_0x151ccb(0x1b3)]['minCanvasSize'],_0x1ea5bc/_0x24cb96>this['options']['maxCanvasSize']&&(_0x24cb96=_0x1ea5bc/this['options']['maxCanvasSize']));const _0x35989a=this['heatStyle']['radius']*1.5,_0xb4c26d=_0x5a969f/_0x24cb96+_0x35989a*0x2,_0x510d22=_0xf25f93/_0x24cb96+_0x35989a*0x2,_0xacb330=_0x35989a*_0x24cb96;_0x106253[_0x151ccb(_0x305e1f._0x5cc467)]-=_0xacb330,_0x106253['ymin']-=_0xacb330,_0x106253['xmax']+=_0xacb330,_0x106253['ymax']+=_0xacb330,this[_0x151ccb(_0x305e1f._0x147ed4)]=_0x24cb96,_0x17785a=geLatLngBounds(_0x106253),this['_rectangle']=Cesium['Rectangle']['fromDegrees'](_0x17785a[_0x151ccb(_0x305e1f._0x5cc467)],_0x17785a[_0x151ccb(0x1a4)],_0x17785a['xmax'],_0x17785a['ymax']);let _0x48e85d=_0x4710d1[0x0]['value']??0x1,_0x4f4548=_0x4710d1[0x0]['value']??0x0;const _0x3cc9a6=[];_0x4710d1[_0x151ccb(0x1d3)](_0x4ab888=>{const _0x7caf3b=_0x151ccb,_0x1a1e3e=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x4ab888['lng'],_0x4ab888['lat']]),_0x1dbac2=_0x4ab888['value']||0x1,_0x2e7bc8=Math['round']((_0x1a1e3e[0x0]-_0x106253['xmin'])/_0x24cb96),_0x331074=Math[_0x7caf3b(_0x13b370._0x2fee05)]((_0x106253[_0x7caf3b(0x17a)]-_0x1a1e3e[0x1])/_0x24cb96);_0x48e85d=Math['max'](_0x48e85d,_0x1dbac2),_0x4f4548=Math['min'](_0x4f4548,_0x1dbac2),_0x3cc9a6['push']({'x':_0x2e7bc8,'y':_0x331074,'value':_0x1dbac2});});const _0x3ddba0={'min':this['options']['min']??_0x4f4548,'max':this[_0x151ccb(0x1b3)]['max']??_0x48e85d,'data':_0x3cc9a6};this['_last_heatData']=_0x3ddba0;if(!this['_last_mBounds']||_0x106253['xmin']!==this[_0x151ccb(_0x305e1f._0x4a0706)][_0x151ccb(_0x305e1f._0x5cc467)]||_0x106253['ymin']!==this[_0x151ccb(0x182)][_0x151ccb(_0x305e1f._0x4f61a9)]||_0x106253[_0x151ccb(0x186)]!==this[_0x151ccb(_0x305e1f._0x4a0706)]['xmax']||_0x106253['ymax']!==this['_last_mBounds']['ymax']){this['_last_mBounds']=_0x106253,this[_0x151ccb(0x1bc)]['style']['cssText']='width:'+_0xb4c26d+'px;height:'+_0x510d22+'px;';const _0x4691e3={...this['heatStyle'],'container':this['_container']};!this[_0x151ccb(_0x305e1f._0xc64fb7)]?this['_heat']=h337__namespace['create'](_0x4691e3):this[_0x151ccb(0x184)]['configure'](_0x4691e3);}this['_heat']['setData'](_0x3ddba0);const _0x4e1928=mars3d__namespace[_0x151ccb(_0x305e1f._0x462133)][_0x151ccb(_0x305e1f._0x5bc33b)](this['_heat'][_0x151ccb(0x1a5)][_0x151ccb(0x1bb)]);return _0x4e1928;}[_0x74c750(0x1b9)](){const _0x100cf5={_0x1a6b2d:0x1be,_0x453a19:0x1cc,_0xc899d:0x1b7,_0x1d55bd:0x184,_0x229afa:0x184},_0xdf8280=_0x74c750;this['_heat']['configure']({'radius':this['heatStyle']['radius']*this[_0xdf8280(_0x100cf5._0x1a6b2d)]['arcRadiusScale'],'blur':this['heatStyle'][_0xdf8280(_0x100cf5._0x453a19)]*this['style'][_0xdf8280(_0x100cf5._0xc899d)],'gradient':this[_0xdf8280(0x1c5)]['gradientArc']||{0.25:_0xdf8280(0x18a),0.55:_0xdf8280(0x1b5),0.85:'rgb(216,216,216)',0x1:'rgb(255,255,255)'}});const _0x35f6ef=mars3d__namespace['DomUtil']['copyCanvas'](this[_0xdf8280(_0x100cf5._0x1d55bd)][_0xdf8280(0x1a5)]['canvas']);return this[_0xdf8280(_0x100cf5._0x229afa)]['configure'](this['options']['heatStyle']),_0x35f6ef;}['getPointData'](_0x642944){const _0x1c73ae={_0x388fdc:0x1b6,_0x4b707e:0x1c8,_0x2df18b:0x17a,_0x4be747:0x184},_0x46acec=_0x74c750,_0xf571d6=mars3d__namespace[_0x46acec(_0x1c73ae._0x388fdc)][_0x46acec(0x191)](_0x642944);if(!_0xf571d6)return{};const _0x23776e=mars3d__namespace['PointTrans']['lonlat2mercator']([_0xf571d6['lng'],_0xf571d6['lat']]),_0x1c67d2=this['_last_mBounds'],_0x23c887=Math[_0x46acec(_0x1c73ae._0x4b707e)]((_0x23776e[0x0]-_0x1c67d2[_0x46acec(0x1a6)])/this['_scale']),_0x2b489f=Math['round']((_0x1c67d2[_0x46acec(_0x1c73ae._0x2df18b)]-_0x23776e[0x1])/this['_scale']),_0x57ec63=this['_heat']['getValueAt']({'x':_0x23c887,'y':_0x2b489f}),_0x371895=this[_0x46acec(_0x1c73ae._0x4be747)]['_renderer']['ctx'][_0x46acec(0x1a1)](_0x23c887-0x1,_0x2b489f-0x1,0x1,0x1)['data'];return{'x':_0x23c887,'y':_0x2b489f,'value':_0x57ec63,'color':'rgba('+_0x371895[0x0]+','+_0x371895[0x1]+','+_0x371895[0x2]+','+_0x371895[0x3]+')'};}}mars3d__namespace['LayerUtil']['register']('heat',HeatLayer),mars3d__namespace['layer']['HeatLayer']=HeatLayer,mars3d__namespace['h337']=h337__namespace;function getMercatorBounds(_0x100828){const _0x12145c={_0x18b675:0x1a6,_0x156d19:0x1a4},_0xbc170=_0x74c750,_0x5ce92e=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x100828[_0xbc170(_0x12145c._0x18b675)],_0x100828[_0xbc170(_0x12145c._0x156d19)]]),_0x92a5bd=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x100828[_0xbc170(0x186)],_0x100828['ymax']]);return{'xmin':_0x5ce92e[0x0],'ymin':_0x5ce92e[0x1],'xmax':_0x92a5bd[0x0],'ymax':_0x92a5bd[0x1]};}function geLatLngBounds(_0x23f9a8){const _0x4f4254=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x23f9a8['xmin'],_0x23f9a8['ymin']]),_0x152550=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x23f9a8['xmax'],_0x23f9a8['ymax']]);return{'xmin':_0x4f4254[0x0],'ymin':_0x4f4254[0x1],'xmax':_0x152550[0x0],'ymax':_0x152550[0x1]};}function getVertexShaderSource(_0x30631e){const _0x1a8e78=_0x74c750;return _0x1a8e78(0x1c3)+_0x30631e+';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a';}exports['HeatLayer']=HeatLayer,Object['defineProperty'](exports,'__esModule',{'value':!![]});
}));
