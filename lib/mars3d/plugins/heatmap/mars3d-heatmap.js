/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.7.9
 * 编译日期：2024-04-06 21:26:44
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2024-01-15
 */
(function (global, factory) {
	typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d'))) :
	typeof define === 'function' && define.amd ? define(['exports', 'mars3d'], factory) :
	(global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d));
})(this, (function (exports, mars3d) { 
'use strict';function _0x3d30(_0x4a8010,_0x3000fb){var _0x26c0f3=_0x26c0();return _0x3d30=function(_0x3d302d,_0x4b4e6d){_0x3d302d=_0x3d302d-0x1ed;var _0x169d9c=_0x26c0f3[_0x3d302d];return _0x169d9c;},_0x3d30(_0x4a8010,_0x3000fb);}var _0x19c601=_0x3d30;(function(_0x41fd49,_0x541f83){var _0x22496e={_0x28af15:0x227,_0x3aa1bd:0x230,_0xc0eeb4:0x236,_0x47c3af:0x25a,_0x4ddaad:0x1ee,_0x551d14:0x1f4,_0x2a5c52:0x27b},_0x18dd8a=_0x3d30,_0x4b8cd1=_0x41fd49();while(!![]){try{var _0x44eaf7=-parseInt(_0x18dd8a(_0x22496e._0x28af15))/0x1+parseInt(_0x18dd8a(_0x22496e._0x3aa1bd))/0x2*(parseInt(_0x18dd8a(_0x22496e._0xc0eeb4))/0x3)+parseInt(_0x18dd8a(_0x22496e._0x47c3af))/0x4+parseInt(_0x18dd8a(0x1f3))/0x5+parseInt(_0x18dd8a(_0x22496e._0x4ddaad))/0x6*(parseInt(_0x18dd8a(_0x22496e._0x551d14))/0x7)+-parseInt(_0x18dd8a(0x1f0))/0x8*(parseInt(_0x18dd8a(_0x22496e._0x2a5c52))/0x9)+-parseInt(_0x18dd8a(0x27c))/0xa;if(_0x44eaf7===_0x541f83)break;else _0x4b8cd1['push'](_0x4b8cd1['shift']());}catch(_0x312096){_0x4b8cd1['push'](_0x4b8cd1['shift']());}}}(_0x26c0,0x5f1e5));function _interopNamespace(_0x5ea469){var _0x20f655=_0x3d30;if(_0x5ea469&&_0x5ea469[_0x20f655(0x224)])return _0x5ea469;var _0x4b04e7=Object['create'](null);return _0x5ea469&&Object['keys'](_0x5ea469)[_0x20f655(0x225)](function(_0x429010){var _0xfada7f=_0x20f655;if(_0x429010!=='default'){var _0xf930b8=Object['getOwnPropertyDescriptor'](_0x5ea469,_0x429010);Object[_0xfada7f(0x24a)](_0x4b04e7,_0x429010,_0xf930b8['get']?_0xf930b8:{'enumerable':!![],'get':function(){return _0x5ea469[_0x429010];}});}}),_0x4b04e7['default']=_0x5ea469,_0x4b04e7;}function _0x26c0(){var _0x4e8f18=['graphic','RectanglePrimitive','replace','defaultValueField','remove','_templates','call','gradientArc','defaultRenderer','clear','lonlat2mercator','PointTrans','minCanvasSize','_coordinator','image','Cesium','xmax','rgb(255,0,0)','createMaterial','floor','heatStyle','setDataMax','StencilOperation','_height','push','addColorStop','removeGraphic','fromCache','positions','h337','createElement','54XgOmNq','6938380IPyTLY','arcBlurScale','emit','_createArcGraphic','_map','canvas','rgb(216,216,216)','bumpMap','getImageData','_last_mBounds','uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a','_xField','41436ZxIvCR','cssText','64856UwvWoH','_graphic2','_drawAlpha','698020MVNJoy','609hYHYyY','undefined','yellow','_store','flyToByAnimationEnd','addData','width:','_heat','diffHeight','granularity','_updatePositionsHook','ymin','_min','defaultGradient','isFormat','putImageData','gradient','minOpacity','fillStyle','_max','getValueAt','cStore','layer','_layer','_getArcHeatCanvas','exports','configure','prototype','_rectangle','_setStyles','DomUtil','LngLatPoint','_graphic','toDataURL','apply','style','_config','abs','clearRect','data','_scale','EPSG:3857','renderAll','rgb(140,140,140)','canvas2d','options','in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20','addGraphic','__esModule','forEach','rgba(0,0,0,0)','565104JZMjAr','drawImage','get','flyTo','renderall','default','plugin','_yField','_minOpacity','2PBTMfr','REPLACE','setData','_onExtremaChange','shadowCanvas','_valueField','2294592gkbKOP','_container','width','_positions','_mountedHook','_radi','px;','VERTEX_FORMAT','ymax','rgb(0,0,255)','_getInternalData','type','KEEP','maxOpacity','getContext','length','maxCanvasSize','formatRectangle','height','uniforms','defineProperty','plugins','xmin','shadowCtx','_renderer','ctx','value','_addedHook','min','rectangle','_renderBoundaries','getPointData','clientHeight','lng','appendChild','setDataMin','767596cetmca','radius'];_0x26c0=function(){return _0x4e8f18;};return _0x26c0();}function _mergeNamespaces(_0x17f15b,_0x3779d1){var _0xda8f69=_0x3d30;return _0x3779d1[_0xda8f69(0x225)](function(_0x3f9e61){var _0x47bc43={_0x346f3d:0x229};_0x3f9e61&&typeof _0x3f9e61!=='string'&&!Array['isArray'](_0x3f9e61)&&Object['keys'](_0x3f9e61)['forEach'](function(_0xd380a1){var _0xbac038=_0x3d30;if(_0xd380a1!==_0xbac038(0x22c)&&!(_0xd380a1 in _0x17f15b)){var _0xe4361c=Object['getOwnPropertyDescriptor'](_0x3f9e61,_0xd380a1);Object[_0xbac038(0x24a)](_0x17f15b,_0xd380a1,_0xe4361c[_0xbac038(_0x47bc43._0x346f3d)]?_0xe4361c:{'enumerable':!![],'get':function(){return _0x3f9e61[_0xd380a1];}});}});}),_0x17f15b;}var mars3d__namespace=_interopNamespace(mars3d),commonjsGlobal=typeof globalThis!=='undefined'?globalThis:typeof window!==_0x19c601(0x1f5)?window:typeof global!==_0x19c601(0x1f5)?global:typeof self!==_0x19c601(0x1f5)?self:{},heatmap$1={'exports':{}};(function(_0x365cf6){var _0x4dc45d={_0x2ec28f:0x220},_0x34a78b=_0x19c601;(function(_0x21cdfe,_0x15a93c,_0x4f079c){var _0xe4e9fb=_0x3d30;_0x365cf6['exports']?_0x365cf6[_0xe4e9fb(0x20d)]=_0x4f079c():_0x15a93c[_0x21cdfe]=_0x4f079c();}(_0x34a78b(0x279),commonjsGlobal,function(){var _0x3084f3={_0x37d24a:0x1f7,_0x2740f7:0x24e},_0x34eb64={_0x360ad5:0x269},_0x5dc55a={_0x48305a:0x232,_0xf3ebe2:0x216},_0x69b2bd={_0x32efc6:0x22d,_0x10cb8a:0x24b},_0x566376={_0x30dde8:0x219},_0x5595a4={_0x2f8707:0x254},_0x34d368={_0x9e1ea1:0x238,_0x2e9d8f:0x248},_0x59c69e={_0x36caa4:0x273,_0x28951c:0x24f},_0x321a2d={_0x4fc231:0x238,_0x24eeb6:0x234},_0x5258d7={_0x38e3f8:0x281,_0x3c062f:0x281,_0x324851:0x254,_0x4b726b:0x25e,_0xa7ca69:0x24f,_0x785649:0x217},_0x349f0c={_0x172493:0x27a},_0x242e08={_0x44beed:0x1f9,_0x37090d:0x200},_0x90c069={_0x8b8bb5:0x207,_0x3e32b0:0x235},_0x2d6820=_0x34a78b,_0x16801f={'defaultRadius':0x28,'defaultRenderer':_0x2d6820(_0x4dc45d._0x2ec28f),'defaultGradient':{0.25:_0x2d6820(0x23f),0.55:'rgb(0,255,0)',0.85:_0x2d6820(0x1f6),0x1:_0x2d6820(0x26d)},'defaultMaxOpacity':0x1,'defaultMinOpacity':0x0,'defaultBlur':0.85,'defaultXField':'x','defaultYField':'y','defaultValueField':'value','plugins':{}},_0x76c919=function _0x13505c(){var _0x3c8d04={_0x19ca31:0x269,_0x432fb9:0x27e},_0x17a548={_0x2cda61:0x233,_0x2ccd9b:0x269},_0x311bb9={_0x44ca41:0x259},_0x1ed286=_0x2d6820,_0x1e357d=function _0x445911(_0x479e55){var _0x3ff285=_0x3d30;this['_coordinator']={},this['_data']=[],this['_radi']=[],this['_min']=0xa,this[_0x3ff285(_0x90c069._0x8b8bb5)]=0x1,this[_0x3ff285(0x1ed)]=_0x479e55['xField']||_0x479e55['defaultXField'],this[_0x3ff285(0x22e)]=_0x479e55['yField']||_0x479e55['defaultYField'],this[_0x3ff285(_0x90c069._0x3e32b0)]=_0x479e55['valueField']||_0x479e55[_0x3ff285(0x25f)],_0x479e55['radius']&&(this['_cfgRadius']=_0x479e55['radius']);},_0x2252d1=_0x16801f['defaultRadius'];return _0x1e357d[_0x1ed286(0x20f)]={'_organiseData':function(_0x20870d,_0x3f8b84){var _0x30f463=_0x1ed286,_0x1ec9e0=_0x20870d[this['_xField']],_0x5c78c7=_0x20870d[this['_yField']],_0x6e9205=this['_radi'],_0x22b444=this['_data'],_0x1fb0a9=this['_max'],_0x2ab229=this['_min'],_0x5eeff5=_0x20870d[this[_0x30f463(0x235)]]||0x1,_0x2bdd8d=_0x20870d['radius']||this['_cfgRadius']||_0x2252d1;!_0x22b444[_0x1ec9e0]&&(_0x22b444[_0x1ec9e0]=[],_0x6e9205[_0x1ec9e0]=[]);!_0x22b444[_0x1ec9e0][_0x5c78c7]?(_0x22b444[_0x1ec9e0][_0x5c78c7]=_0x5eeff5,_0x6e9205[_0x1ec9e0][_0x5c78c7]=_0x2bdd8d):_0x22b444[_0x1ec9e0][_0x5c78c7]+=_0x5eeff5;var _0x1455fd=_0x22b444[_0x1ec9e0][_0x5c78c7];if(_0x1455fd>_0x1fb0a9)return!_0x3f8b84?this[_0x30f463(0x207)]=_0x1455fd:this[_0x30f463(0x271)](_0x1455fd),![];else return _0x1455fd<_0x2ab229?(!_0x3f8b84?this['_min']=_0x1455fd:this[_0x30f463(_0x311bb9._0x44ca41)](_0x1455fd),![]):{'x':_0x1ec9e0,'y':_0x5c78c7,'value':_0x5eeff5,'radius':_0x2bdd8d,'min':_0x2ab229,'max':_0x1fb0a9};},'_unOrganizeData':function(){var _0x5ab6e8=[],_0x5afba8=this['_data'],_0x41d8d0=this['_radi'];for(var _0x13a414 in _0x5afba8){for(var _0x33ca89 in _0x5afba8[_0x13a414]){_0x5ab6e8['push']({'x':_0x13a414,'y':_0x33ca89,'radius':_0x41d8d0[_0x13a414][_0x33ca89],'value':_0x5afba8[_0x13a414][_0x33ca89]});}}return{'min':this['_min'],'max':this['_max'],'data':_0x5ab6e8};},'_onExtremaChange':function(){var _0x506ec7=_0x1ed286;this['_coordinator'][_0x506ec7(0x27e)]('extremachange',{'min':this['_min'],'max':this[_0x506ec7(0x207)]});},'addData':function(){var _0xd17951=_0x1ed286;if(arguments[0x0]['length']>0x0){var _0x175f2c=arguments[0x0],_0x33bbab=_0x175f2c['length'];while(_0x33bbab--){this[_0xd17951(_0x242e08._0x44beed)][_0xd17951(0x262)](this,_0x175f2c[_0x33bbab]);}}else{var _0x38a14a=this['_organiseData'](arguments[0x0],!![]);_0x38a14a&&(this['_data']['length']===0x0&&(this['_min']=this['_max']=_0x38a14a[_0xd17951(0x250)]),this[_0xd17951(0x269)]['emit']('renderpartial',{'min':this[_0xd17951(_0x242e08._0x37090d)],'max':this['_max'],'data':[_0x38a14a]}));}return this;},'setData':function(_0x49928c){var _0x14faa6=_0x1ed286,_0x43fbf8=_0x49928c['data'],_0x1666b2=_0x43fbf8['length'];this['_data']=[],this['_radi']=[];for(var _0x232926=0x0;_0x232926<_0x1666b2;_0x232926++){this['_organiseData'](_0x43fbf8[_0x232926],![]);}return this['_max']=_0x49928c['max'],this['_min']=_0x49928c['min']||0x0,this[_0x14faa6(_0x17a548._0x2cda61)](),this[_0x14faa6(_0x17a548._0x2ccd9b)]['emit']('renderall',this[_0x14faa6(0x240)]()),this;},'removeData':function(){},'setDataMax':function(_0x2cab3c){var _0x5dac54=_0x1ed286;return this['_max']=_0x2cab3c,this['_onExtremaChange'](),this[_0x5dac54(_0x3c8d04._0x19ca31)][_0x5dac54(_0x3c8d04._0x432fb9)]('renderall',this[_0x5dac54(0x240)]()),this;},'setDataMin':function(_0x460641){var _0x37b5e3=_0x1ed286;return this['_min']=_0x460641,this['_onExtremaChange'](),this[_0x37b5e3(0x269)]['emit']('renderall',this['_getInternalData']()),this;},'setCoordinator':function(_0x244a16){this['_coordinator']=_0x244a16;},'_getInternalData':function(){var _0x222372=_0x1ed286;return{'max':this['_max'],'min':this['_min'],'data':this['_data'],'radi':this[_0x222372(0x23b)]};},'getData':function(){return this['_unOrganizeData']();}},_0x1e357d;}(),_0x9c56f1=function _0x2d3564(){var _0x31e6c7={_0x35265b:0x25b,_0x39461d:0x24d,_0x8f47a8:0x261},_0x6e49c={_0xb53883:0x21b,_0x205c36:0x1f2},_0x5cf688=function(_0x4f2222){var _0xd9eb5e=_0x3d30,_0x35b59c=_0x4f2222['gradient']||_0x4f2222['defaultGradient'],_0x663d69=document[_0xd9eb5e(_0x349f0c._0x172493)]('canvas'),_0x3cc331=_0x663d69['getContext']('2d',{'willReadFrequently':!![]});_0x663d69['width']=0x100,_0x663d69['height']=0x1;var _0x108b95=_0x3cc331['createLinearGradient'](0x0,0x0,0x100,0x1);for(var _0x1f5d64 in _0x35b59c){_0x108b95[_0xd9eb5e(0x275)](_0x1f5d64,_0x35b59c[_0x1f5d64]);}return _0x3cc331['fillStyle']=_0x108b95,_0x3cc331['fillRect'](0x0,0x0,0x100,0x1),_0x3cc331[_0xd9eb5e(0x284)](0x0,0x0,0x100,0x1)[_0xd9eb5e(0x21b)];},_0x34eb1f=function(_0x429f77,_0x55a2fd){var _0x5f168f=_0x3d30,_0x37afc7=document['createElement']('canvas'),_0x257e5f=_0x37afc7['getContext']('2d',{'willReadFrequently':!![]}),_0x5bf1b0=_0x429f77,_0x552050=_0x429f77;_0x37afc7['width']=_0x37afc7['height']=_0x429f77*0x2;if(_0x55a2fd==0x1)_0x257e5f['beginPath'](),_0x257e5f['arc'](_0x5bf1b0,_0x552050,_0x429f77,0x0,0x2*Math['PI'],![]),_0x257e5f[_0x5f168f(0x206)]='rgba(0,0,0,1)',_0x257e5f['fill']();else{var _0x701bf9=_0x257e5f['createRadialGradient'](_0x5bf1b0,_0x552050,_0x429f77*_0x55a2fd,_0x5bf1b0,_0x552050,_0x429f77);_0x701bf9['addColorStop'](0x0,'rgba(0,0,0,1)'),_0x701bf9[_0x5f168f(0x275)](0x1,_0x5f168f(0x226)),_0x257e5f['fillStyle']=_0x701bf9,_0x257e5f['fillRect'](0x0,0x0,0x2*_0x429f77,0x2*_0x429f77);}return _0x37afc7;},_0x1b1d3a=function(_0x2aa760){var _0x4d5842=[],_0x6710bd=_0x2aa760['min'],_0x23f764=_0x2aa760['max'],_0x312d01=_0x2aa760['radi'],_0x2aa760=_0x2aa760['data'],_0x5122b0=Object['keys'](_0x2aa760),_0x4e2077=_0x5122b0['length'];while(_0x4e2077--){var _0x5f45ab=_0x5122b0[_0x4e2077],_0x1f6785=Object['keys'](_0x2aa760[_0x5f45ab]),_0x4efad3=_0x1f6785['length'];while(_0x4efad3--){var _0x1be7f0=_0x1f6785[_0x4efad3],_0x8ceda9=_0x2aa760[_0x5f45ab][_0x1be7f0],_0x2268af=_0x312d01[_0x5f45ab][_0x1be7f0];_0x4d5842['push']({'x':_0x5f45ab,'y':_0x1be7f0,'value':_0x8ceda9,'radius':_0x2268af});}}return{'min':_0x6710bd,'max':_0x23f764,'data':_0x4d5842};};function _0x3093a8(_0x34d4ed){var _0x3714f1=_0x3d30,_0x465c50=_0x34d4ed['container'],_0x344238=this['shadowCanvas']=document['createElement']('canvas'),_0x3ae9e5=this[_0x3714f1(_0x5258d7._0x38e3f8)]=_0x34d4ed['canvas']||document['createElement'](_0x3714f1(_0x5258d7._0x3c062f));this[_0x3714f1(_0x5258d7._0x324851)]=[0x2710,0x2710,0x0,0x0];var _0x150b29=getComputedStyle(_0x34d4ed['container'])||{};_0x3ae9e5['className']='heatmap-canvas',this['_width']=_0x3ae9e5[_0x3714f1(0x238)]=_0x344238['width']=_0x34d4ed['width']||+_0x150b29['width'][_0x3714f1(_0x5258d7._0x4b726b)](/px/,''),this['_height']=_0x3ae9e5['height']=_0x344238['height']=_0x34d4ed['height']||+_0x150b29['height'][_0x3714f1(0x25e)](/px/,''),this['shadowCtx']=_0x344238['getContext']('2d',{'willReadFrequently':!![]}),this[_0x3714f1(_0x5258d7._0xa7ca69)]=_0x3ae9e5[_0x3714f1(0x244)]('2d',{'willReadFrequently':!![]}),_0x3ae9e5[_0x3714f1(_0x5258d7._0x785649)]['cssText']=_0x344238['style']['cssText']='position:absolute;left:0;top:0;',_0x465c50['style']['position']='relative',_0x465c50[_0x3714f1(0x258)](_0x3ae9e5),this['_palette']=_0x5cf688(_0x34d4ed),this['_templates']={},this[_0x3714f1(0x211)](_0x34d4ed);}return _0x3093a8['prototype']={'renderPartial':function(_0x445aba){var _0x98ed37=_0x3d30;_0x445aba['data'][_0x98ed37(0x245)]>0x0&&(this['_drawAlpha'](_0x445aba),this['_colorize']());},'renderAll':function(_0x409d17){var _0x1100dd=_0x3d30;this['_clear'](),_0x409d17[_0x1100dd(_0x6e49c._0xb53883)]['length']>0x0&&(this[_0x1100dd(_0x6e49c._0x205c36)](_0x1b1d3a(_0x409d17)),this['_colorize']());},'_updateGradient':function(_0x2f92a2){this['_palette']=_0x5cf688(_0x2f92a2);},'updateConfig':function(_0x400f7c){var _0x4c5ab2=_0x3d30;_0x400f7c[_0x4c5ab2(0x204)]&&this['_updateGradient'](_0x400f7c),this['_setStyles'](_0x400f7c);},'setDimensions':function(_0x1d2d99,_0x538bdd){var _0x22a036=_0x3d30;this['_width']=_0x1d2d99,this['_height']=_0x538bdd,this['canvas'][_0x22a036(_0x321a2d._0x4fc231)]=this[_0x22a036(_0x321a2d._0x24eeb6)]['width']=_0x1d2d99,this['canvas'][_0x22a036(0x248)]=this['shadowCanvas']['height']=_0x538bdd;},'_clear':function(){var _0x4cd465=_0x3d30;this['shadowCtx']['clearRect'](0x0,0x0,this['_width'],this[_0x4cd465(_0x59c69e._0x36caa4)]),this[_0x4cd465(_0x59c69e._0x28951c)][_0x4cd465(0x21a)](0x0,0x0,this['_width'],this['_height']);},'_setStyles':function(_0x42e947){var _0x2be4e4=_0x3d30;this['_blur']=_0x42e947['blur']==0x0?0x0:_0x42e947['blur']||_0x42e947['defaultBlur'],_0x42e947['backgroundColor']&&(this['canvas']['style']['backgroundColor']=_0x42e947['backgroundColor']),this['_width']=this['canvas'][_0x2be4e4(0x238)]=this['shadowCanvas']['width']=_0x42e947[_0x2be4e4(_0x34d368._0x9e1ea1)]||this['_width'],this['_height']=this['canvas']['height']=this['shadowCanvas']['height']=_0x42e947[_0x2be4e4(_0x34d368._0x2e9d8f)]||this[_0x2be4e4(0x273)],this['_opacity']=(_0x42e947['opacity']||0x0)*0xff,this['_maxOpacity']=(_0x42e947[_0x2be4e4(0x243)]||_0x42e947['defaultMaxOpacity'])*0xff,this[_0x2be4e4(0x22f)]=(_0x42e947[_0x2be4e4(0x205)]||_0x42e947['defaultMinOpacity'])*0xff,this['_useGradientOpacity']=!!_0x42e947['useGradientOpacity'];},'_drawAlpha':function(_0x47093b){var _0x2e6660=_0x3d30,_0x2b733d=this['_min']=_0x47093b['min'],_0x2c6355=this['_max']=_0x47093b['max'],_0x47093b=_0x47093b['data']||[],_0x2fb998=_0x47093b['length'],_0x4daa5d=0x1-this['_blur'];while(_0x2fb998--){var _0x12c7fd=_0x47093b[_0x2fb998],_0x7b5691=_0x12c7fd['x'],_0x3f199e=_0x12c7fd['y'],_0x59ab14=_0x12c7fd[_0x2e6660(_0x31e6c7._0x35265b)],_0x19f99d=Math['min'](_0x12c7fd['value'],_0x2c6355),_0x9b1818=_0x7b5691-_0x59ab14,_0x5fb556=_0x3f199e-_0x59ab14,_0x535ab6=this[_0x2e6660(_0x31e6c7._0x39461d)],_0xdb0cc3;!this['_templates'][_0x59ab14]?this['_templates'][_0x59ab14]=_0xdb0cc3=_0x34eb1f(_0x59ab14,_0x4daa5d):_0xdb0cc3=this[_0x2e6660(_0x31e6c7._0x8f47a8)][_0x59ab14];var _0x28a377=(_0x19f99d-_0x2b733d)/(_0x2c6355-_0x2b733d);_0x535ab6['globalAlpha']=_0x28a377<0.01?0.01:_0x28a377,_0x535ab6[_0x2e6660(0x228)](_0xdb0cc3,_0x9b1818,_0x5fb556),_0x9b1818<this['_renderBoundaries'][0x0]&&(this['_renderBoundaries'][0x0]=_0x9b1818),_0x5fb556<this['_renderBoundaries'][0x1]&&(this['_renderBoundaries'][0x1]=_0x5fb556),_0x9b1818+0x2*_0x59ab14>this['_renderBoundaries'][0x2]&&(this[_0x2e6660(0x254)][0x2]=_0x9b1818+0x2*_0x59ab14),_0x5fb556+0x2*_0x59ab14>this['_renderBoundaries'][0x3]&&(this['_renderBoundaries'][0x3]=_0x5fb556+0x2*_0x59ab14);}},'_colorize':function(){var _0xb648a9=_0x3d30,_0x422bb8=this['_renderBoundaries'][0x0],_0x543b5c=this['_renderBoundaries'][0x1],_0x1a5f1f=this[_0xb648a9(0x254)][0x2]-_0x422bb8,_0xbda318=this['_renderBoundaries'][0x3]-_0x543b5c,_0x485dc6=this['_width'],_0x35b631=this['_height'],_0x413277=this['_opacity'],_0x7eecb7=this['_maxOpacity'],_0x1a1da1=this['_minOpacity'],_0x5a0863=this['_useGradientOpacity'];_0x422bb8<0x0&&(_0x422bb8=0x0);_0x543b5c<0x0&&(_0x543b5c=0x0);_0x422bb8+_0x1a5f1f>_0x485dc6&&(_0x1a5f1f=_0x485dc6-_0x422bb8);_0x543b5c+_0xbda318>_0x35b631&&(_0xbda318=_0x35b631-_0x543b5c);var _0x4b5fbc=this[_0xb648a9(0x24d)]['getImageData'](_0x422bb8,_0x543b5c,_0x1a5f1f,_0xbda318),_0x3ef68b=_0x4b5fbc['data'],_0x440f6b=_0x3ef68b['length'],_0x3b713b=this['_palette'];for(var _0x1c7f19=0x3;_0x1c7f19<_0x440f6b;_0x1c7f19+=0x4){var _0x2da41f=_0x3ef68b[_0x1c7f19],_0x339eca=_0x2da41f*0x4;if(!_0x339eca)continue;var _0x50dcd3;_0x413277>0x0?_0x50dcd3=_0x413277:_0x2da41f<_0x7eecb7?_0x2da41f<_0x1a1da1?_0x50dcd3=_0x1a1da1:_0x50dcd3=_0x2da41f:_0x50dcd3=_0x7eecb7,_0x3ef68b[_0x1c7f19-0x3]=_0x3b713b[_0x339eca],_0x3ef68b[_0x1c7f19-0x2]=_0x3b713b[_0x339eca+0x1],_0x3ef68b[_0x1c7f19-0x1]=_0x3b713b[_0x339eca+0x2],_0x3ef68b[_0x1c7f19]=_0x5a0863?_0x3b713b[_0x339eca+0x3]:_0x50dcd3;}this['ctx'][_0xb648a9(0x203)](_0x4b5fbc,_0x422bb8,_0x543b5c),this[_0xb648a9(_0x5595a4._0x2f8707)]=[0x3e8,0x3e8,0x0,0x0];},'getValueAt':function(_0x18128c){var _0x3e802a=_0x3d30,_0x458e0f,_0x24d873=this[_0x3e802a(0x24d)],_0xf42f06=_0x24d873['getImageData'](_0x18128c['x'],_0x18128c['y'],0x1,0x1),_0x5b8e9e=_0xf42f06['data'][0x3],_0x355443=this['_max'],_0x57514c=this['_min'];return _0x458e0f=Math[_0x3e802a(_0x566376._0x30dde8)](_0x355443-_0x57514c)*(_0x5b8e9e/0xff)>>0x0,_0x458e0f;},'getDataURL':function(){return this['canvas']['toDataURL']();}},_0x3093a8;}(),_0x3b8485=function _0x3aa100(){var _0xc0a167=_0x2d6820,_0x590dfa=![];return _0x16801f[_0xc0a167(0x264)]==='canvas2d'&&(_0x590dfa=_0x9c56f1),_0x590dfa;}(),_0x58ffd9={'merge':function(){var _0x365998={},_0x52422a=arguments['length'];for(var _0x56d5ba=0x0;_0x56d5ba<_0x52422a;_0x56d5ba++){var _0x1d3c3c=arguments[_0x56d5ba];for(var _0xc4ac in _0x1d3c3c){_0x365998[_0xc4ac]=_0x1d3c3c[_0xc4ac];}}return _0x365998;}},_0x3a05eb=function _0xfe6be9(){var _0xa08f31={_0x2b8550:0x218},_0x235bfc={_0x4116ad:0x1f7},_0x541d93={_0xa32f20:0x269,_0x263b84:0x21e},_0x5cd0a3={_0x5060eb:0x218},_0x4b589e=function _0x28d610(){var _0x277b18={_0x550bfc:0x209};function _0x1c21b1(){this['cStore']={};}return _0x1c21b1['prototype']={'on':function(_0x311df3,_0x1a0302,_0x48a521){var _0x2895e7=this['cStore'];!_0x2895e7[_0x311df3]&&(_0x2895e7[_0x311df3]=[]),_0x2895e7[_0x311df3]['push'](function(_0x244b7e){return _0x1a0302['call'](_0x48a521,_0x244b7e);});},'emit':function(_0x346be0,_0x379928){var _0x237000=_0x3d30,_0x4ff56e=this[_0x237000(_0x277b18._0x550bfc)];if(_0x4ff56e[_0x346be0]){var _0x1d7eb7=_0x4ff56e[_0x346be0]['length'];for(var _0x3299b7=0x0;_0x3299b7<_0x1d7eb7;_0x3299b7++){var _0x201547=_0x4ff56e[_0x346be0][_0x3299b7];_0x201547(_0x379928);}}}},_0x1c21b1;}(),_0xd9615a=function(_0x365d46){var _0x5a1721=_0x3d30,_0x3d85e6=_0x365d46['_renderer'],_0x38750=_0x365d46[_0x5a1721(_0x541d93._0xa32f20)],_0x52c742=_0x365d46['_store'];_0x38750['on']('renderpartial',_0x3d85e6['renderPartial'],_0x3d85e6),_0x38750['on']('renderall',_0x3d85e6[_0x5a1721(_0x541d93._0x263b84)],_0x3d85e6),_0x38750['on']('extremachange',function(_0x22697c){var _0x40c138=_0x5a1721;_0x365d46[_0x40c138(0x218)]['onExtremaChange']&&_0x365d46[_0x40c138(_0x5cd0a3._0x5060eb)]['onExtremaChange']({'min':_0x22697c[_0x40c138(0x252)],'max':_0x22697c['max'],'gradient':_0x365d46['_config'][_0x40c138(0x204)]||_0x365d46['_config'][_0x40c138(0x201)]});}),_0x52c742['setCoordinator'](_0x38750);};function _0x21931a(){var _0x49cbfe=_0x3d30,_0x378b53=this['_config']=_0x58ffd9['merge'](_0x16801f,arguments[0x0]||{});this['_coordinator']=new _0x4b589e();if(_0x378b53['plugin']){var _0x24f7a1=_0x378b53[_0x49cbfe(_0x69b2bd._0x32efc6)];if(!_0x16801f[_0x49cbfe(_0x69b2bd._0x10cb8a)][_0x24f7a1])throw new Error('Plugin\x20\x27'+_0x24f7a1+'\x27\x20not\x20found.\x20Maybe\x20it\x20was\x20not\x20registered.');else{var _0x5645c8=_0x16801f['plugins'][_0x24f7a1];this[_0x49cbfe(0x24e)]=new _0x5645c8['renderer'](_0x378b53),this['_store']=new _0x5645c8['store'](_0x378b53);}}else this['_renderer']=new _0x3b8485(_0x378b53),this['_store']=new _0x76c919(_0x378b53);_0xd9615a(this);}return _0x21931a['prototype']={'addData':function(){return this['_store']['addData']['apply'](this['_store'],arguments),this;},'removeData':function(){return this['_store']['removeData']&&this['_store']['removeData']['apply'](this['_store'],arguments),this;},'setData':function(){var _0x3fa2c7=_0x3d30;return this['_store'][_0x3fa2c7(_0x5dc55a._0x48305a)][_0x3fa2c7(_0x5dc55a._0xf3ebe2)](this['_store'],arguments),this;},'setDataMax':function(){var _0x104942=_0x3d30;return this['_store']['setDataMax']['apply'](this[_0x104942(0x1f7)],arguments),this;},'setDataMin':function(){var _0x3316de=_0x3d30;return this[_0x3316de(_0x235bfc._0x4116ad)]['setDataMin']['apply'](this['_store'],arguments),this;},'configure':function(_0x122ea7){var _0x9420b6=_0x3d30;return this['_config']=_0x58ffd9['merge'](this['_config'],_0x122ea7),this['_renderer']['updateConfig'](this[_0x9420b6(_0xa08f31._0x2b8550)]),this['_coordinator']['emit'](_0x9420b6(0x22b),this['_store']['_getInternalData']()),this;},'repaint':function(){var _0x3cd0eb=_0x3d30;return this[_0x3cd0eb(_0x34eb64._0x360ad5)]['emit']('renderall',this[_0x3cd0eb(0x1f7)]['_getInternalData']()),this;},'getData':function(){return this['_store']['getData']();},'getDataURL':function(){return this['_renderer']['getDataURL']();},'getValueAt':function(_0x25fac3){var _0x3fc946=_0x3d30;if(this[_0x3fc946(0x1f7)][_0x3fc946(0x208)])return this[_0x3fc946(_0x3084f3._0x37d24a)]['getValueAt'](_0x25fac3);else return this['_renderer'][_0x3fc946(0x208)]?this[_0x3fc946(_0x3084f3._0x2740f7)]['getValueAt'](_0x25fac3):null;}},_0x21931a;}(),_0xf9bb70={'create':function(_0x2e560a){return new _0x3a05eb(_0x2e560a);},'register':function(_0x26f193,_0x5cf209){var _0x49f957=_0x2d6820;_0x16801f[_0x49f957(0x24b)][_0x26f193]=_0x5cf209;}};return _0xf9bb70;}));}(heatmap$1));var heatmap=heatmap$1['exports'],h337=_mergeNamespaces({'__proto__':null,'default':heatmap},[heatmap$1['exports']]),HeatMaterial=_0x19c601(0x286);if(!heatmap$1[_0x19c601(0x20d)]['create'])throw new Error('请引入\x20heatmap.js\x20库\x20');const Cesium=mars3d__namespace[_0x19c601(0x26b)],BaseLayer=mars3d__namespace['layer']['BaseLayer'],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:'blue',0.6:'green',0.8:'yellow',0.9:'red'}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium['EllipsoidSurfaceAppearance'][_0x19c601(0x23d)]};class HeatLayer extends BaseLayer{constructor(_0x2a9561={}){var _0x55a78e={_0x4fc225:0x246,_0x501ee9:0x221,_0x56e62a:0x221,_0x5ad82f:0x256,_0x46e182:0x217},_0x2ebedd=_0x19c601;super(_0x2a9561),this['options']['maxCanvasSize']=this['options'][_0x2ebedd(_0x55a78e._0x4fc225)]??document['body']['clientWidth'],this['options']['maxCanvasSize']=Math['min'](this['options'][_0x2ebedd(_0x55a78e._0x4fc225)],0x1388),this[_0x2ebedd(_0x55a78e._0x501ee9)]['minCanvasSize']=this[_0x2ebedd(_0x55a78e._0x56e62a)]['minCanvasSize']??document['body'][_0x2ebedd(_0x55a78e._0x5ad82f)],this['options']['minCanvasSize']=Math['max'](this['options'][_0x2ebedd(0x268)],0x2bc),this[_0x2ebedd(0x221)]['heatStyle']={...DEF_HEATSTYLE,...this['options']['heatStyle']},this[_0x2ebedd(0x221)][_0x2ebedd(0x217)]={...DEF_STYLE,...this['options'][_0x2ebedd(_0x55a78e._0x46e182)]};}get[_0x19c601(0x20a)](){var _0x128c41=_0x19c601;return this[_0x128c41(0x20b)];}get['heatStyle'](){var _0x9a7394=_0x19c601;return this['options'][_0x9a7394(0x270)];}set[_0x19c601(0x270)](_0x130846){var _0x319a4c={_0x5672f9:0x221},_0xbd93a6=_0x19c601;this[_0xbd93a6(0x221)][_0xbd93a6(0x270)]=mars3d__namespace['Util']['merge'](this['options']['heatStyle'],_0x130846),this[_0xbd93a6(0x1fb)]&&(this['_heat']['configure'](this[_0xbd93a6(_0x319a4c._0x5672f9)]['heatStyle']),this['_updatePositionsHook'](!![]));}get['style'](){return this['options']['style'];}set['style'](_0x250d1b){var _0x307972=_0x19c601;this['options']['style']=mars3d__namespace['Util']['merge'](this['options'][_0x307972(0x217)],_0x250d1b);}get[_0x19c601(0x278)](){return this['_positions'];}set[_0x19c601(0x278)](_0x311a92){this['setPositions'](_0x311a92);}get['coordinates'](){var _0x1101fe={_0x55bf42:0x274};const _0xa6831=[];return this['points']['forEach'](_0x391620=>{var _0x4e5779=_0x3d30;_0xa6831[_0x4e5779(_0x1101fe._0x55bf42)](_0x391620['toArray']());}),_0xa6831;}get[_0x19c601(0x253)](){return this['_rectangle'];}['_setOptionsHook'](_0x2ebc80,_0x461827){var _0x97c311=_0x19c601;_0x2ebc80[_0x97c311(0x278)]&&(this['positions']=_0x2ebc80['positions']);}[_0x19c601(0x23a)](){var _0x431734=_0x19c601;this['style'][_0x431734(0x241)]==='image'?this['_layer']=new mars3d__namespace[(_0x431734(0x20a))]['ImageLayer']({'crs':_0x431734(0x21d),'private':!![]}):this['_layer']=new mars3d__namespace['layer']['GraphicLayer']({'private':!![]});}[_0x19c601(0x251)](){var _0x46367e={_0x3e132c:0x237,_0x34e883:0x22a},_0x2ee700=_0x19c601;this['_map']['addLayer'](this['_layer']),this[_0x2ee700(_0x46367e._0x3e132c)]=mars3d__namespace['DomUtil']['create']('div','mars3d-heatmap\x20mars3d-hideDiv',this[_0x2ee700(0x280)]['container']),this['options']['positions']&&(this['positions']=this['options']['positions']),this[_0x2ee700(0x221)][_0x2ee700(_0x46367e._0x34e883)]&&this[_0x2ee700(0x1f8)]();}['_removedHook'](){var _0x1cec36={_0x44917b:0x260,_0x4e1b6d:0x237,_0x538812:0x265},_0x57f065=_0x19c601;this[_0x57f065(0x237)]&&(mars3d__namespace['DomUtil'][_0x57f065(_0x1cec36._0x44917b)](this[_0x57f065(_0x1cec36._0x4e1b6d)]),delete this['_container']),this[_0x57f065(_0x1cec36._0x538812)](),this['_map']['removeLayer'](this['_layer']);}['addPosition'](_0x528143,_0x5aea37){var _0x444a32={_0xcc2193:0x239},_0x37d914=_0x19c601;this[_0x37d914(_0x444a32._0xcc2193)]=this['_positions']||[],this['_positions']['push'](_0x528143),this['_updatePositionsHook'](_0x5aea37);}['setPositions'](_0x542eab,_0x30e56e){this['_positions']=_0x542eab,this['_updatePositionsHook'](_0x30e56e);}['clear'](){var _0x12687f={_0x5c813a:0x276},_0x1abf32=_0x19c601;this['_graphic']&&(this[_0x1abf32(0x20b)]['removeGraphic'](this[_0x1abf32(0x214)],!![]),delete this['_graphic']),this['_graphic2']&&(this['_layer'][_0x1abf32(_0x12687f._0x5c813a)](this['_graphic2'],!![]),delete this['_graphic2']);}[_0x19c601(0x1fe)](_0x21bfd6){var _0x478222={_0x36f007:0x214,_0x101571:0x26a,_0x1af40d:0x214,_0x2e434f:0x283},_0x56c55c=_0x19c601;if(!this['show']||!this['_map']||!this['positions']||this['positions']['length']===0x0)return this;const _0x15e540=this['_getHeatCanvas']();if(this['style']['type']==='image')this['_layer']['setOptions']({'url':_0x15e540[_0x56c55c(0x215)]('image/png',0x1),'rectangle':this['_rectangle'],'opacity':this['style']['opacity']});else this['style']['arc']?this[_0x56c55c(_0x478222._0x36f007)]&&_0x21bfd6?(this['_graphic']['uniforms'][_0x56c55c(_0x478222._0x101571)]=_0x15e540,this[_0x56c55c(_0x478222._0x1af40d)]['uniforms']['bumpMap']=this[_0x56c55c(0x20c)](),this['_graphic2']&&(this['_graphic2']['uniforms']['image']=_0x15e540,this['_graphic2']['uniforms'][_0x56c55c(_0x478222._0x2e434f)]=this['_graphic']['uniforms'][_0x56c55c(0x283)])):this['_createArcGraphic'](_0x15e540):this['_graphic']&&_0x21bfd6?this['_graphic'][_0x56c55c(0x249)]['image']=_0x15e540:this['_createGraphic'](_0x15e540);return this;}['_createGraphic'](_0x1d5672){var _0x172b35={_0x1ad936:0x223},_0x487e52=_0x19c601;this[_0x487e52(0x265)](),this['_graphic']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'material':mars3d__namespace['MaterialUtil'][_0x487e52(0x26e)](mars3d__namespace['MaterialType']['Image2'],{'image':_0x1d5672}),'flat':!![]})}),this['_layer'][_0x487e52(_0x172b35._0x1ad936)](this['_graphic']);}[_0x19c601(0x27f)](_0x1d7371){var _0xd28bc9={_0x2988be:0x277,_0x54e871:0x242,_0xef87b5:0x272,_0x53a241:0x231,_0x1e51f9:0x26f,_0x53252e:0x238,_0x2091b5:0x217,_0x2f6664:0x1f1,_0x5dae84:0x25c},_0x3f653a=_0x19c601;this[_0x3f653a(0x265)]();const _0x599c06=Cesium['RenderState'][_0x3f653a(_0xd28bc9._0x2988be)]({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium['StencilFunction']['ALWAYS'],'frontOperation':{'fail':Cesium['StencilOperation'][_0x3f653a(_0xd28bc9._0x54e871)],'zFail':Cesium[_0x3f653a(_0xd28bc9._0xef87b5)]['KEEP'],'zPass':Cesium['StencilOperation'][_0x3f653a(_0xd28bc9._0x53a241)]},'backFunction':Cesium['StencilFunction']['ALWAYS'],'backOperation':{'fail':Cesium[_0x3f653a(0x272)]['KEEP'],'zFail':Cesium['StencilOperation'][_0x3f653a(0x242)],'zPass':Cesium['StencilOperation']['REPLACE']},'reference':0x2,'mask':0x2},'blending':Cesium['BlendingState']['ALPHA_BLEND']}),_0x55d52a=Math[_0x3f653a(_0xd28bc9._0x1e51f9)](this['style'][_0x3f653a(0x1fc)]??this['_mBoundsMax']*0.02)+0.1;this['style'][_0x3f653a(0x1fc)]&&delete this[_0x3f653a(0x217)]['diffHeight'];const _0x2e35e7=(this['style']['splitNum'],0x64);let _0x54f26e=Math['max'](this['_rectangle'][_0x3f653a(0x248)],this['_rectangle'][_0x3f653a(_0xd28bc9._0x53252e)]);this[_0x3f653a(0x217)][_0x3f653a(0x1fd)]=_0x54f26e/=_0x2e35e7;const _0x169032=new Cesium['Material']({'fabric':{'uniforms':{'image':_0x1d7371,'repeat':new Cesium['Cartesian2'](0x1,0x1),'color':new Cesium['Color'](0x1,0x1,0x1,0x0),'bumpMap':this[_0x3f653a(0x20c)]()},'source':HeatMaterial},'translucent':!![]}),_0x5c4442=this['style']['arcDirection']||0x1;this['_graphic']=new mars3d__namespace['graphic'][(_0x3f653a(0x25d))]({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x599c06,'material':_0x169032,'vertexShaderSource':getVertexShaderSource(_0x55d52a*_0x5c4442)})}),this['_layer']['addGraphic'](this['_graphic']),this[_0x3f653a(_0xd28bc9._0x2091b5)]['arcDirection']===0x0&&(this[_0x3f653a(_0xd28bc9._0x2f6664)]=new mars3d__namespace[(_0x3f653a(_0xd28bc9._0x5dae84))]['RectanglePrimitive']({...this[_0x3f653a(0x221)],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x599c06,'material':_0x169032,'vertexShaderSource':getVertexShaderSource(-_0x55d52a)})}),this['_layer']['addGraphic'](this['_graphic2']));}['getRectangle'](_0x1e38a3){var _0x5e5f4b=_0x19c601;return _0x1e38a3!==null&&_0x1e38a3!==void 0x0&&_0x1e38a3[_0x5e5f4b(0x202)]&&this[_0x5e5f4b(0x210)]?mars3d__namespace['PolyUtil'][_0x5e5f4b(0x247)](this['_rectangle']):this['_rectangle'];}['_getHeatCanvas'](){var _0x29a6e3={_0x11749e:0x219,_0x824251:0x268,_0x4b6a28:0x24c,_0x3955fd:0x26c,_0x2c2846:0x21c,_0x49d097:0x221,_0x2b973e:0x1fa,_0x80eaeb:0x23c,_0x506054:0x1fb,_0x2b28bd:0x20e,_0x1cfd07:0x232},_0xd08a35={_0x4527c0:0x266},_0x3ec1f6={_0x309dc9:0x250,_0x2d0218:0x252},_0x13f54d=_0x19c601;const _0x5a86e6=this[_0x13f54d(0x239)],_0x4ba1d9=[];let _0x295222,_0x531b29,_0x5e1990,_0x2ddd9c;_0x5a86e6['forEach'](_0x37b269=>{var _0x528d34=_0x13f54d;const _0x4c8c01=mars3d__namespace['LngLatPoint']['parse'](_0x37b269);if(!_0x4c8c01)return;_0x4c8c01['value']=_0x37b269[_0x528d34(_0x3ec1f6._0x309dc9)]||0x1,!this['options']['rectangle']&&(_0x295222===undefined?(_0x295222=_0x4c8c01['lng'],_0x531b29=_0x4c8c01['lng'],_0x5e1990=_0x4c8c01['lat'],_0x2ddd9c=_0x4c8c01['lat']):(_0x295222=Math['min'](_0x295222,_0x4c8c01['lng']),_0x531b29=Math['max'](_0x531b29,_0x4c8c01['lng']),_0x5e1990=Math[_0x528d34(_0x3ec1f6._0x2d0218)](_0x5e1990,_0x4c8c01['lat']),_0x2ddd9c=Math['max'](_0x2ddd9c,_0x4c8c01['lat']))),_0x4ba1d9['push'](_0x4c8c01);});_0x295222===_0x531b29&&(_0x295222-=0.000001,_0x531b29+=0.000001);_0x5e1990===_0x2ddd9c&&(_0x5e1990-=0.000001,_0x2ddd9c+=0.000001);let _0x493898=this['options']['rectangle']||{'xmin':_0x295222,'xmax':_0x531b29,'ymin':_0x5e1990,'ymax':_0x2ddd9c};const _0x22c87=getMercatorBounds(_0x493898),_0x526436=Math[_0x13f54d(_0x29a6e3._0x11749e)](_0x22c87['xmax']-_0x22c87[_0x13f54d(0x24c)]),_0x187138=Math['abs'](_0x22c87['ymax']-_0x22c87['ymin']),_0x485d8f=Math['max'](_0x526436,_0x187138),_0x29ff12=Math['min'](_0x526436,_0x187138);this['_mBoundsMax']=_0x485d8f;let _0x478322=0x1;if(_0x485d8f>this['options']['maxCanvasSize'])_0x478322=_0x485d8f/this[_0x13f54d(0x221)][_0x13f54d(0x246)],_0x29ff12/_0x478322<this['options'][_0x13f54d(_0x29a6e3._0x824251)]&&(_0x478322=_0x29ff12/this[_0x13f54d(0x221)]['minCanvasSize']);else _0x29ff12<this['options']['minCanvasSize']&&(_0x478322=_0x29ff12/this['options']['minCanvasSize'],_0x485d8f/_0x478322>this['options']['maxCanvasSize']&&(_0x478322=_0x485d8f/this['options']['maxCanvasSize']));const _0x2e19cc=this[_0x13f54d(0x270)]['radius']*1.5,_0x3c9cf4=_0x526436/_0x478322+_0x2e19cc*0x2,_0x1c7702=_0x187138/_0x478322+_0x2e19cc*0x2,_0x2ce577=_0x2e19cc*_0x478322;_0x22c87['xmin']-=_0x2ce577,_0x22c87['ymin']-=_0x2ce577,_0x22c87['xmax']+=_0x2ce577,_0x22c87['ymax']+=_0x2ce577,_0x22c87[_0x13f54d(_0x29a6e3._0x4b6a28)]=Math['max'](_0x22c87[_0x13f54d(_0x29a6e3._0x4b6a28)],-20037508.34),_0x22c87[_0x13f54d(_0x29a6e3._0x3955fd)]=Math['min'](_0x22c87['xmax'],20037508.34),_0x22c87['ymin']=Math['max'](_0x22c87['ymin'],-20037508.34),_0x22c87['ymax']=Math['min'](_0x22c87['ymax'],20037508.34),this[_0x13f54d(_0x29a6e3._0x2c2846)]=_0x478322,_0x493898=geLatLngBounds(_0x22c87),this['_rectangle']=Cesium['Rectangle']['fromDegrees'](_0x493898['xmin'],_0x493898['ymin'],_0x493898[_0x13f54d(0x26c)],_0x493898[_0x13f54d(0x23e)]);let _0x4ebd4d=_0x4ba1d9[0x0]['value']??0x1,_0x414136=_0x4ba1d9[0x0]['value']??0x0;const _0x40ca78=[];_0x4ba1d9['forEach'](_0x1a6c37=>{var _0x2a52e5=_0x13f54d;const _0x1049cb=mars3d__namespace['PointTrans'][_0x2a52e5(_0xd08a35._0x4527c0)]([_0x1a6c37['lng'],_0x1a6c37['lat']]),_0x1488fc=_0x1a6c37['value']||0x1,_0x29f2f4=Math['round']((_0x1049cb[0x0]-_0x22c87['xmin'])/_0x478322),_0x3d470a=Math['round']((_0x22c87['ymax']-_0x1049cb[0x1])/_0x478322);_0x4ebd4d=Math['max'](_0x4ebd4d,_0x1488fc),_0x414136=Math['min'](_0x414136,_0x1488fc),_0x40ca78[_0x2a52e5(0x274)]({'x':_0x29f2f4,'y':_0x3d470a,'value':_0x1488fc});});const _0x2fe070={'min':this[_0x13f54d(_0x29a6e3._0x49d097)]['min']??_0x414136,'max':this['options']['max']??_0x4ebd4d,'data':_0x40ca78};this['_last_heatData']=_0x2fe070;if(!this['_last_mBounds']||_0x22c87[_0x13f54d(0x24c)]!==this['_last_mBounds']['xmin']||_0x22c87['ymin']!==this['_last_mBounds'][_0x13f54d(0x1ff)]||_0x22c87[_0x13f54d(0x26c)]!==this['_last_mBounds'][_0x13f54d(0x26c)]||_0x22c87['ymax']!==this[_0x13f54d(0x285)]['ymax']){this['_last_mBounds']=_0x22c87,this['_container']['style'][_0x13f54d(0x1ef)]=_0x13f54d(_0x29a6e3._0x2b973e)+_0x3c9cf4+'px;height:'+_0x1c7702+_0x13f54d(_0x29a6e3._0x80eaeb);const _0x2b35ca={...this['heatStyle'],'container':this['_container']};!this['_heat']?this[_0x13f54d(_0x29a6e3._0x506054)]=heatmap$1['exports']['create'](_0x2b35ca):this['_heat'][_0x13f54d(_0x29a6e3._0x2b28bd)](_0x2b35ca);}this['_heat'][_0x13f54d(_0x29a6e3._0x1cfd07)](_0x2fe070);const _0x4f386e=mars3d__namespace[_0x13f54d(0x212)]['copyCanvas'](this[_0x13f54d(0x1fb)]['_renderer']['canvas']);return _0x4f386e;}[_0x19c601(0x20c)](){var _0x59e075={_0x182f93:0x217,_0x1a2d35:0x263,_0x24a451:0x282,_0x3dda06:0x1fb},_0x37526c=_0x19c601;this['_heat'][_0x37526c(0x20e)]({'radius':this['heatStyle']['radius']*this[_0x37526c(_0x59e075._0x182f93)]['arcRadiusScale'],'blur':this['heatStyle']['blur']*this['style'][_0x37526c(0x27d)],'gradient':this['heatStyle'][_0x37526c(_0x59e075._0x1a2d35)]||{0.25:'rgb(0,0,0)',0.55:_0x37526c(0x21f),0.85:_0x37526c(_0x59e075._0x24a451),0x1:'rgb(255,255,255)'}});const _0xc1ae02=mars3d__namespace['DomUtil']['copyCanvas'](this['_heat']['_renderer']['canvas']);return this[_0x37526c(_0x59e075._0x3dda06)]['configure'](this['options']['heatStyle']),_0xc1ae02;}[_0x19c601(0x255)](_0x3d07fd){var _0x132f3a=_0x19c601;const _0x286d6e=mars3d__namespace[_0x132f3a(0x213)]['parse'](_0x3d07fd);if(!_0x286d6e)return{};const _0x51e6e9=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x286d6e[_0x132f3a(0x257)],_0x286d6e['lat']]),_0x16db35=this['_last_mBounds'],_0x505baf=Math['round']((_0x51e6e9[0x0]-_0x16db35['xmin'])/this['_scale']),_0x1e274e=Math['round']((_0x16db35[_0x132f3a(0x23e)]-_0x51e6e9[0x1])/this['_scale']),_0x1e1a04=this['_heat']['getValueAt']({'x':_0x505baf,'y':_0x1e274e}),_0x2bfdad=this['_heat']['_renderer']['ctx']['getImageData'](_0x505baf-0x1,_0x1e274e-0x1,0x1,0x1)[_0x132f3a(0x21b)];return{'x':_0x505baf,'y':_0x1e274e,'value':_0x1e1a04,'color':'rgba('+_0x2bfdad[0x0]+','+_0x2bfdad[0x1]+','+_0x2bfdad[0x2]+','+_0x2bfdad[0x3]+')'};}}mars3d__namespace['LayerUtil']['register']('heat',HeatLayer),mars3d__namespace[_0x19c601(0x20a)]['HeatLayer']=HeatLayer,mars3d__namespace['h337']=h337;function getMercatorBounds(_0x127730){var _0x330bc9={_0x40ff07:0x24c},_0x18d9db=_0x19c601;const _0x205871=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x127730[_0x18d9db(_0x330bc9._0x40ff07)],_0x127730['ymin']]),_0x3c8ebd=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x127730['xmax'],_0x127730[_0x18d9db(0x23e)]]);return{'xmin':_0x205871[0x0],'ymin':_0x205871[0x1],'xmax':_0x3c8ebd[0x0],'ymax':_0x3c8ebd[0x1]};}function geLatLngBounds(_0x4b2a51){var _0x20c805=_0x19c601;const _0x38761c=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x4b2a51['xmin'],_0x4b2a51['ymin']]),_0xe1fb76=mars3d__namespace[_0x20c805(0x267)]['mercator2lonlat']([_0x4b2a51['xmax'],_0x4b2a51['ymax']]);return{'xmin':_0x38761c[0x0],'ymin':_0x38761c[0x1],'xmax':_0xe1fb76[0x0],'ymax':_0xe1fb76[0x1]};}function getVertexShaderSource(_0x4e1fda){var _0x15bcbc={_0x4560ee:0x222},_0x2e4de0=_0x19c601;return _0x2e4de0(_0x15bcbc._0x4560ee)+_0x4e1fda+';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a';}exports['HeatLayer']=HeatLayer,Object['defineProperty'](exports,'__esModule',{'value':!![]});
}));
