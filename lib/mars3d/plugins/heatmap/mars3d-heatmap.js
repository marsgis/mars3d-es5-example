/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.7.7
 * 编译日期：2024-03-19 15:39:39
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2024-01-15
 */
(function (global, factory) {
	typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d'))) :
	typeof define === 'function' && define.amd ? define(['exports', 'mars3d'], factory) :
	(global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d));
})(this, (function (exports, mars3d) { 
'use strict';var _0x268c4c=_0xe245;(function(_0x24c29a,_0x8b18be){var _0x16c848={_0x5eabb2:0x106,_0x4a1e78:0x73,_0x4ed594:0xaf,_0x1a14d8:0x102,_0x33ed3a:0xb7,_0xbac68c:0xa1,_0x555432:0xc3},_0x3cf63e=_0xe245,_0x46e7df=_0x24c29a();while(!![]){try{var _0x2e1b58=-parseInt(_0x3cf63e(_0x16c848._0x5eabb2))/0x1*(parseInt(_0x3cf63e(_0x16c848._0x4a1e78))/0x2)+-parseInt(_0x3cf63e(_0x16c848._0x4ed594))/0x3+parseInt(_0x3cf63e(0x99))/0x4*(parseInt(_0x3cf63e(0xb2))/0x5)+-parseInt(_0x3cf63e(0xa2))/0x6+-parseInt(_0x3cf63e(_0x16c848._0x1a14d8))/0x7*(parseInt(_0x3cf63e(_0x16c848._0x33ed3a))/0x8)+-parseInt(_0x3cf63e(_0x16c848._0xbac68c))/0x9+parseInt(_0x3cf63e(_0x16c848._0x555432))/0xa*(parseInt(_0x3cf63e(0xa5))/0xb);if(_0x2e1b58===_0x8b18be)break;else _0x46e7df['push'](_0x46e7df['shift']());}catch(_0x3baa02){_0x46e7df['push'](_0x46e7df['shift']());}}}(_0x57c7,0x61ff2));function _0x57c7(){var _0x33cd8f=['70aImByz','min','lng','positions','heatStyle','points','merge','yellow','rgb(0,0,0)','_layer','rgba(0,0,0,1)','clientWidth','fillRect','yField','lat','emit','value','addGraphic','keys','_onExtremaChange','_getHeatCanvas','options','EllipsoidSurfaceAppearance','isFormat','prototype','_templates','bumpMap','height','create','image','defaultGradient','onExtremaChange','round','_renderer','configure','minCanvasSize','_container','call','renderpartial','_map','renderall','radius','getDataURL','xmax','valueField','apply','_updateGradient','Color','red','_clear','arc','KEEP','_getArcHeatCanvas','ALWAYS','default','h337','_rectangle','_heat','uniforms','_updatePositionsHook','Util','Rectangle','_last_mBounds','686FhgTMZ','_min','RectanglePrimitive','xmin','70877vJoprL','ymax','cStore','shadowCanvas','StencilOperation','_createArcGraphic','maxOpacity','defaultYField','abs','max','_minOpacity','cssText','20qrXrZd','_mBoundsMax','GraphicLayer','toDataURL','_scale','blue','length','_radi','_graphic','body','createElement','BlendingState','PointTrans',';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a','_store','addColorStop','uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a','_config','maxCanvasSize','getOwnPropertyDescriptor','defineProperty','setOptions','_colorize','show','ctx','_graphic2','_cfgRadius','style','VERTEX_FORMAT','DomUtil','_palette','REPLACE','renderer','_unOrganizeData','defaultRadius','lonlat2mercator','ImageLayer','backgroundColor','2458184kJxgeg','LayerUtil','Cesium','fillStyle','_data','canvas','PolyUtil','mercator2lonlat','2793708ByJPXT','3175278Wfnsff','HeatLayer','_height','3592479GKUkmP','_width','blur','shadowCtx','px;','_useGradientOpacity','rgb(0,255,0)','push','putImageData','_renderBoundaries','1986222AQmHTn','StencilFunction','getImageData','5jopxRE','getContext','arcDirection','_max','_addedHook','23576LqURJl','_createGraphic','graphic','_coordinator','forEach','addPosition','ymin','rectangle','type','setPositions','width','data'];_0x57c7=function(){return _0x33cd8f;};return _0x57c7();}function _interopNamespace(_0x24e4d4){var _0x491b11={_0x3784c3:0xdf},_0x163e97={_0x2d98cc:0x86},_0x286af0=_0xe245;if(_0x24e4d4&&_0x24e4d4['__esModule'])return _0x24e4d4;var _0x4d5131=Object[_0x286af0(_0x491b11._0x3784c3)](null);return _0x24e4d4&&Object['keys'](_0x24e4d4)['forEach'](function(_0x3fe60a){var _0x557606=_0x286af0;if(_0x3fe60a!==_0x557606(0xf9)){var _0x5677c5=Object[_0x557606(_0x163e97._0x2d98cc)](_0x24e4d4,_0x3fe60a);Object['defineProperty'](_0x4d5131,_0x3fe60a,_0x5677c5['get']?_0x5677c5:{'enumerable':!![],'get':function(){return _0x24e4d4[_0x3fe60a];}});}}),_0x4d5131['default']=_0x24e4d4,_0x4d5131;}function _mergeNamespaces(_0xeefc0a,_0x59f9b6){return _0x59f9b6['forEach'](function(_0x4df80a){_0x4df80a&&typeof _0x4df80a!=='string'&&!Array['isArray'](_0x4df80a)&&Object['keys'](_0x4df80a)['forEach'](function(_0x2c851c){if(_0x2c851c!=='default'&&!(_0x2c851c in _0xeefc0a)){var _0x5b470a=Object['getOwnPropertyDescriptor'](_0x4df80a,_0x2c851c);Object['defineProperty'](_0xeefc0a,_0x2c851c,_0x5b470a['get']?_0x5b470a:{'enumerable':!![],'get':function(){return _0x4df80a[_0x2c851c];}});}});}),_0xeefc0a;}var mars3d__namespace=_interopNamespace(mars3d),commonjsGlobal=typeof globalThis!=='undefined'?globalThis:typeof window!=='undefined'?window:typeof global!=='undefined'?global:typeof self!=='undefined'?self:{},heatmap$1={'exports':{}};(function(_0x12c487){var _0x919fd9={_0x5341ff:0xfa},_0x373546={_0x3c9c59:0xab},_0x3a3d65=_0xe245;(function(_0xfe1854,_0x51ae29,_0x491d1f){_0x12c487['exports']?_0x12c487['exports']=_0x491d1f():_0x51ae29[_0xfe1854]=_0x491d1f();}(_0x3a3d65(_0x919fd9._0x5341ff),commonjsGlobal,function(){var _0x18562a={_0x2edf56:0xf0},_0x57ec47={_0xcf4d2a:0x81},_0x1a98f2={_0x46afc9:0x93,_0x249f9d:0x81},_0x1b338c={_0x5da75b:0xb1},_0x35c214={_0x138cc9:0x103,_0x35a85e:0x10f,_0x3a928e:0xc2,_0x3d2c65:0xd3},_0x1ea808={_0x3d1749:0xa8},_0x508675={_0x5aaddd:0xf1},_0x5aab6d={_0x142e21:0xf4},_0x58d863={_0x48a15e:0xd5,_0x1466d1:0x79},_0x4481ea={_0x17480e:0x9c,_0xc9ca5d:0xcd,_0x43806a:0x82},_0x124294={_0x4ee796:0xe1,_0x5c873a:0x7d,_0x58f5d4:0xcf},_0x4dbe55={_0x49e079:0x95,_0x383906:0xdb},_0x2d19f9={_0x3e6734:0x9d,_0x50fe2f:0x79,_0xa932c2:0xe9},_0x57af90={_0x3614ec:0xb5},_0x37f535={_0x59b592:0x9d},_0xe92203={_0xc223a7:0xd0,_0xca1d57:0x8d},_0x38f934=_0x3a3d65,_0x5c0b3c={'defaultRadius':0x28,'defaultRenderer':'canvas2d','defaultGradient':{0.25:'rgb(0,0,255)',0.55:_0x38f934(_0x373546._0x3c9c59),0.85:_0x38f934(0xca),0x1:'rgb(255,0,0)'},'defaultMaxOpacity':0x1,'defaultMinOpacity':0x0,'defaultBlur':0.85,'defaultXField':'x','defaultYField':'y','defaultValueField':'value','plugins':{}},_0x36769e=function _0x2ad240(){var _0x2a9a3d={_0x512d31:0x7a,_0x16dbb6:0xc4},_0x98dc30=_0x38f934,_0x8a01c8=function _0x24a88f(_0x210df4){var _0x3df689=_0xe245;this['_coordinator']={},this[_0x3df689(0x9d)]=[],this['_radi']=[],this['_min']=0xa,this['_max']=0x1,this['_xField']=_0x210df4['xField']||_0x210df4['defaultXField'],this['_yField']=_0x210df4[_0x3df689(_0xe92203._0xc223a7)]||_0x210df4[_0x3df689(0x10d)],this['_valueField']=_0x210df4[_0x3df689(0xef)]||_0x210df4['defaultValueField'],_0x210df4['radius']&&(this[_0x3df689(_0xe92203._0xca1d57)]=_0x210df4[_0x3df689(0xec)]);},_0x6661a=_0x5c0b3c[_0x98dc30(_0x4dbe55._0x49e079)];return _0x8a01c8[_0x98dc30(_0x4dbe55._0x383906)]={'_organiseData':function(_0x1e4c40,_0x12faa7){var _0x1458cc=_0x98dc30,_0x33a62d=_0x1e4c40[this['_xField']],_0x523bb1=_0x1e4c40[this['_yField']],_0x2d91ca=this['_radi'],_0x43498e=this[_0x1458cc(_0x37f535._0x59b592)],_0x789a78=this['_max'],_0x30d7af=this[_0x1458cc(0x103)],_0x229403=_0x1e4c40[this['_valueField']]||0x1,_0x3c2812=_0x1e4c40['radius']||this['_cfgRadius']||_0x6661a;!_0x43498e[_0x33a62d]&&(_0x43498e[_0x33a62d]=[],_0x2d91ca[_0x33a62d]=[]);!_0x43498e[_0x33a62d][_0x523bb1]?(_0x43498e[_0x33a62d][_0x523bb1]=_0x229403,_0x2d91ca[_0x33a62d][_0x523bb1]=_0x3c2812):_0x43498e[_0x33a62d][_0x523bb1]+=_0x229403;var _0x52af44=_0x43498e[_0x33a62d][_0x523bb1];if(_0x52af44>_0x789a78)return!_0x12faa7?this['_max']=_0x52af44:this['setDataMax'](_0x52af44),![];else return _0x52af44<_0x30d7af?(!_0x12faa7?this['_min']=_0x52af44:this['setDataMin'](_0x52af44),![]):{'x':_0x33a62d,'y':_0x523bb1,'value':_0x229403,'radius':_0x3c2812,'min':_0x30d7af,'max':_0x789a78};},'_unOrganizeData':function(){var _0x3b5230=_0x98dc30,_0x200132=[],_0x5c1ec0=this['_data'],_0x44bd32=this['_radi'];for(var _0x1a0901 in _0x5c1ec0){for(var _0x2476d6 in _0x5c1ec0[_0x1a0901]){_0x200132['push']({'x':_0x1a0901,'y':_0x2476d6,'radius':_0x44bd32[_0x1a0901][_0x2476d6],'value':_0x5c1ec0[_0x1a0901][_0x2476d6]});}}return{'min':this['_min'],'max':this[_0x3b5230(_0x57af90._0x3614ec)],'data':_0x200132};},'_onExtremaChange':function(){var _0x143325=_0x98dc30;this[_0x143325(0xba)]['emit']('extremachange',{'min':this['_min'],'max':this['_max']});},'addData':function(){var _0x3d7c08=_0x98dc30;if(arguments[0x0]['length']>0x0){var _0x1ee815=arguments[0x0],_0x3d8412=_0x1ee815['length'];while(_0x3d8412--){this['addData'][_0x3d7c08(0xe8)](this,_0x1ee815[_0x3d8412]);}}else{var _0x58c024=this['_organiseData'](arguments[0x0],!![]);_0x58c024&&(this[_0x3d7c08(_0x2d19f9._0x3e6734)][_0x3d7c08(_0x2d19f9._0x50fe2f)]===0x0&&(this['_min']=this['_max']=_0x58c024['value']),this[_0x3d7c08(0xba)][_0x3d7c08(0xd2)](_0x3d7c08(_0x2d19f9._0xa932c2),{'min':this['_min'],'max':this['_max'],'data':[_0x58c024]}));}return this;},'setData':function(_0x429eff){var _0x46628f=_0x98dc30,_0x2eab1c=_0x429eff[_0x46628f(0xc2)],_0x56718d=_0x2eab1c[_0x46628f(0x79)];this[_0x46628f(0x9d)]=[],this[_0x46628f(_0x2a9a3d._0x512d31)]=[];for(var _0x4c1c0b=0x0;_0x4c1c0b<_0x56718d;_0x4c1c0b++){this['_organiseData'](_0x2eab1c[_0x4c1c0b],![]);}return this['_max']=_0x429eff['max'],this['_min']=_0x429eff[_0x46628f(_0x2a9a3d._0x16dbb6)]||0x0,this['_onExtremaChange'](),this['_coordinator']['emit']('renderall',this['_getInternalData']()),this;},'removeData':function(){},'setDataMax':function(_0x40a50e){var _0x3c766f=_0x98dc30;return this['_max']=_0x40a50e,this[_0x3c766f(0xd6)](),this['_coordinator'][_0x3c766f(0xd2)](_0x3c766f(0xeb),this['_getInternalData']()),this;},'setDataMin':function(_0x153031){return this['_min']=_0x153031,this['_onExtremaChange'](),this['_coordinator']['emit']('renderall',this['_getInternalData']()),this;},'setCoordinator':function(_0x1918a8){this['_coordinator']=_0x1918a8;},'_getInternalData':function(){return{'max':this['_max'],'min':this['_min'],'data':this['_data'],'radi':this['_radi']};},'getData':function(){var _0x4d8a19=_0x98dc30;return this[_0x4d8a19(0x94)]();}},_0x8a01c8;}(),_0x52484a=function _0x4d99eb(){var _0x1c3c4d={_0x5c9847:0xae,_0xe6ca90:0x110},_0x36c0d4={_0x474d5b:0xa7,_0x2f81db:0xc1,_0x4adfed:0x109,_0x3589ef:0xa4,_0x2f8254:0x10c},_0x4288c0={_0x2fecf4:0x9e,_0xfb8c1d:0xa4,_0x415af6:0xb3,_0x36ddbe:0x8e},_0x32f5dc=_0x38f934,_0xe749c0=function(_0x181cf1){var _0x5a7e3b=_0xe245,_0x3b6b3d=_0x181cf1['gradient']||_0x181cf1[_0x5a7e3b(_0x124294._0x4ee796)],_0x303d3c=document[_0x5a7e3b(_0x124294._0x5c873a)]('canvas'),_0x21d6ae=_0x303d3c['getContext']('2d',{'willReadFrequently':!![]});_0x303d3c['width']=0x100,_0x303d3c[_0x5a7e3b(0xde)]=0x1;var _0x3dd7ae=_0x21d6ae['createLinearGradient'](0x0,0x0,0x100,0x1);for(var _0x521105 in _0x3b6b3d){_0x3dd7ae['addColorStop'](_0x521105,_0x3b6b3d[_0x521105]);}return _0x21d6ae['fillStyle']=_0x3dd7ae,_0x21d6ae[_0x5a7e3b(_0x124294._0x58f5d4)](0x0,0x0,0x100,0x1),_0x21d6ae[_0x5a7e3b(0xb1)](0x0,0x0,0x100,0x1)['data'];},_0x4881ab=function(_0x48d3b5,_0x5b7865){var _0xbf32c1=_0xe245,_0x8313a6=document['createElement']('canvas'),_0x5473e5=_0x8313a6['getContext']('2d',{'willReadFrequently':!![]}),_0x149ce2=_0x48d3b5,_0x1a5209=_0x48d3b5;_0x8313a6['width']=_0x8313a6['height']=_0x48d3b5*0x2;if(_0x5b7865==0x1)_0x5473e5['beginPath'](),_0x5473e5[_0xbf32c1(0xf5)](_0x149ce2,_0x1a5209,_0x48d3b5,0x0,0x2*Math['PI'],![]),_0x5473e5[_0xbf32c1(_0x4481ea._0x17480e)]=_0xbf32c1(_0x4481ea._0xc9ca5d),_0x5473e5['fill']();else{var _0xd9ca33=_0x5473e5['createRadialGradient'](_0x149ce2,_0x1a5209,_0x48d3b5*_0x5b7865,_0x149ce2,_0x1a5209,_0x48d3b5);_0xd9ca33[_0xbf32c1(_0x4481ea._0x43806a)](0x0,'rgba(0,0,0,1)'),_0xd9ca33['addColorStop'](0x1,'rgba(0,0,0,0)'),_0x5473e5['fillStyle']=_0xd9ca33,_0x5473e5['fillRect'](0x0,0x0,0x2*_0x48d3b5,0x2*_0x48d3b5);}return _0x8313a6;},_0xa8204b=function(_0x11b1da){var _0x565e32=_0xe245,_0x51db1a=[],_0x56a717=_0x11b1da['min'],_0x36473f=_0x11b1da['max'],_0x460f24=_0x11b1da['radi'],_0x11b1da=_0x11b1da['data'],_0x4832e5=Object[_0x565e32(_0x58d863._0x48a15e)](_0x11b1da),_0x1d9584=_0x4832e5[_0x565e32(_0x58d863._0x1466d1)];while(_0x1d9584--){var _0x70c12a=_0x4832e5[_0x1d9584],_0x3a7b5f=Object[_0x565e32(_0x58d863._0x48a15e)](_0x11b1da[_0x70c12a]),_0x269490=_0x3a7b5f['length'];while(_0x269490--){var _0x4acbcd=_0x3a7b5f[_0x269490],_0x23e525=_0x11b1da[_0x70c12a][_0x4acbcd],_0xc34ba2=_0x460f24[_0x70c12a][_0x4acbcd];_0x51db1a['push']({'x':_0x70c12a,'y':_0x4acbcd,'value':_0x23e525,'radius':_0xc34ba2});}}return{'min':_0x56a717,'max':_0x36473f,'data':_0x51db1a};};function _0x48afbc(_0x4b5550){var _0x1815e2=_0xe245,_0x5accf5=_0x4b5550['container'],_0x4e6661=this[_0x1815e2(0x109)]=document[_0x1815e2(0x7d)]('canvas'),_0x207eb1=this[_0x1815e2(_0x4288c0._0x2fecf4)]=_0x4b5550['canvas']||document['createElement']('canvas');this['_renderBoundaries']=[0x2710,0x2710,0x0,0x0];var _0x2e5b40=getComputedStyle(_0x4b5550['container'])||{};_0x207eb1['className']='heatmap-canvas',this['_width']=_0x207eb1['width']=_0x4e6661['width']=_0x4b5550['width']||+_0x2e5b40['width']['replace'](/px/,''),this[_0x1815e2(_0x4288c0._0xfb8c1d)]=_0x207eb1['height']=_0x4e6661['height']=_0x4b5550['height']||+_0x2e5b40['height']['replace'](/px/,''),this['shadowCtx']=_0x4e6661[_0x1815e2(_0x4288c0._0x415af6)]('2d',{'willReadFrequently':!![]}),this['ctx']=_0x207eb1['getContext']('2d',{'willReadFrequently':!![]}),_0x207eb1[_0x1815e2(0x8e)][_0x1815e2(0x111)]=_0x4e6661['style']['cssText']='position:absolute;left:0;top:0;',_0x5accf5[_0x1815e2(_0x4288c0._0x36ddbe)]['position']='relative',_0x5accf5['appendChild'](_0x207eb1),this[_0x1815e2(0x91)]=_0xe749c0(_0x4b5550),this['_templates']={},this['_setStyles'](_0x4b5550);}return _0x48afbc[_0x32f5dc(0xdb)]={'renderPartial':function(_0x22007b){var _0x3175e5=_0x32f5dc;_0x22007b['data']['length']>0x0&&(this['_drawAlpha'](_0x22007b),this[_0x3175e5(0x89)]());},'renderAll':function(_0x5d49a7){var _0x1691f3=_0x32f5dc;this[_0x1691f3(_0x5aab6d._0x142e21)](),_0x5d49a7[_0x1691f3(0xc2)]['length']>0x0&&(this['_drawAlpha'](_0xa8204b(_0x5d49a7)),this['_colorize']());},'_updateGradient':function(_0x6742bb){this['_palette']=_0xe749c0(_0x6742bb);},'updateConfig':function(_0x41c891){var _0x1cc591=_0x32f5dc;_0x41c891['gradient']&&this[_0x1cc591(_0x508675._0x5aaddd)](_0x41c891),this['_setStyles'](_0x41c891);},'setDimensions':function(_0x538ea5,_0x4a0235){var _0x3debaa=_0x32f5dc;this['_width']=_0x538ea5,this['_height']=_0x4a0235,this['canvas']['width']=this['shadowCanvas']['width']=_0x538ea5,this['canvas'][_0x3debaa(0xde)]=this['shadowCanvas']['height']=_0x4a0235;},'_clear':function(){var _0x54a2a4=_0x32f5dc;this[_0x54a2a4(_0x1ea808._0x3d1749)]['clearRect'](0x0,0x0,this['_width'],this['_height']),this[_0x54a2a4(0x8b)]['clearRect'](0x0,0x0,this[_0x54a2a4(0xa6)],this['_height']);},'_setStyles':function(_0x25a4ae){var _0x247243=_0x32f5dc;this['_blur']=_0x25a4ae['blur']==0x0?0x0:_0x25a4ae[_0x247243(_0x36c0d4._0x474d5b)]||_0x25a4ae['defaultBlur'],_0x25a4ae[_0x247243(0x98)]&&(this['canvas']['style']['backgroundColor']=_0x25a4ae[_0x247243(0x98)]),this['_width']=this['canvas'][_0x247243(_0x36c0d4._0x2f81db)]=this['shadowCanvas']['width']=_0x25a4ae[_0x247243(0xc1)]||this['_width'],this['_height']=this['canvas']['height']=this[_0x247243(_0x36c0d4._0x4adfed)]['height']=_0x25a4ae['height']||this[_0x247243(_0x36c0d4._0x3589ef)],this['_opacity']=(_0x25a4ae['opacity']||0x0)*0xff,this['_maxOpacity']=(_0x25a4ae[_0x247243(_0x36c0d4._0x2f8254)]||_0x25a4ae['defaultMaxOpacity'])*0xff,this['_minOpacity']=(_0x25a4ae['minOpacity']||_0x25a4ae['defaultMinOpacity'])*0xff,this[_0x247243(0xaa)]=!!_0x25a4ae['useGradientOpacity'];},'_drawAlpha':function(_0x988d34){var _0x1f4431=_0x32f5dc,_0x344212=this[_0x1f4431(_0x35c214._0x138cc9)]=_0x988d34['min'],_0x3e4075=this[_0x1f4431(0xb5)]=_0x988d34[_0x1f4431(_0x35c214._0x35a85e)],_0x988d34=_0x988d34[_0x1f4431(_0x35c214._0x3a928e)]||[],_0x4b5379=_0x988d34['length'],_0x44c12c=0x1-this['_blur'];while(_0x4b5379--){var _0x49df3e=_0x988d34[_0x4b5379],_0x39a96f=_0x49df3e['x'],_0x3585c8=_0x49df3e['y'],_0x2648b8=_0x49df3e['radius'],_0x51d159=Math[_0x1f4431(0xc4)](_0x49df3e[_0x1f4431(_0x35c214._0x3d2c65)],_0x3e4075),_0x4c4f87=_0x39a96f-_0x2648b8,_0x47a6e1=_0x3585c8-_0x2648b8,_0x20052f=this['shadowCtx'],_0x50004c;!this['_templates'][_0x2648b8]?this[_0x1f4431(0xdc)][_0x2648b8]=_0x50004c=_0x4881ab(_0x2648b8,_0x44c12c):_0x50004c=this['_templates'][_0x2648b8];var _0x422edc=(_0x51d159-_0x344212)/(_0x3e4075-_0x344212);_0x20052f['globalAlpha']=_0x422edc<0.01?0.01:_0x422edc,_0x20052f['drawImage'](_0x50004c,_0x4c4f87,_0x47a6e1),_0x4c4f87<this[_0x1f4431(0xae)][0x0]&&(this['_renderBoundaries'][0x0]=_0x4c4f87),_0x47a6e1<this['_renderBoundaries'][0x1]&&(this['_renderBoundaries'][0x1]=_0x47a6e1),_0x4c4f87+0x2*_0x2648b8>this['_renderBoundaries'][0x2]&&(this['_renderBoundaries'][0x2]=_0x4c4f87+0x2*_0x2648b8),_0x47a6e1+0x2*_0x2648b8>this['_renderBoundaries'][0x3]&&(this[_0x1f4431(0xae)][0x3]=_0x47a6e1+0x2*_0x2648b8);}},'_colorize':function(){var _0x260fcc=_0x32f5dc,_0x3f18dc=this[_0x260fcc(0xae)][0x0],_0x4c67b2=this['_renderBoundaries'][0x1],_0x296024=this[_0x260fcc(_0x1c3c4d._0x5c9847)][0x2]-_0x3f18dc,_0x2afcb1=this['_renderBoundaries'][0x3]-_0x4c67b2,_0x40268c=this['_width'],_0x3ef526=this['_height'],_0x7c440e=this['_opacity'],_0x2e1b33=this['_maxOpacity'],_0x10f05e=this[_0x260fcc(_0x1c3c4d._0xe6ca90)],_0x594d48=this['_useGradientOpacity'];_0x3f18dc<0x0&&(_0x3f18dc=0x0);_0x4c67b2<0x0&&(_0x4c67b2=0x0);_0x3f18dc+_0x296024>_0x40268c&&(_0x296024=_0x40268c-_0x3f18dc);_0x4c67b2+_0x2afcb1>_0x3ef526&&(_0x2afcb1=_0x3ef526-_0x4c67b2);var _0x3970d6=this[_0x260fcc(0xa8)]['getImageData'](_0x3f18dc,_0x4c67b2,_0x296024,_0x2afcb1),_0x281b60=_0x3970d6['data'],_0x352b95=_0x281b60['length'],_0x130841=this['_palette'];for(var _0x18ee6e=0x3;_0x18ee6e<_0x352b95;_0x18ee6e+=0x4){var _0x237dd8=_0x281b60[_0x18ee6e],_0x233f0a=_0x237dd8*0x4;if(!_0x233f0a)continue;var _0x50eb59;_0x7c440e>0x0?_0x50eb59=_0x7c440e:_0x237dd8<_0x2e1b33?_0x237dd8<_0x10f05e?_0x50eb59=_0x10f05e:_0x50eb59=_0x237dd8:_0x50eb59=_0x2e1b33,_0x281b60[_0x18ee6e-0x3]=_0x130841[_0x233f0a],_0x281b60[_0x18ee6e-0x2]=_0x130841[_0x233f0a+0x1],_0x281b60[_0x18ee6e-0x1]=_0x130841[_0x233f0a+0x2],_0x281b60[_0x18ee6e]=_0x594d48?_0x130841[_0x233f0a+0x3]:_0x50eb59;}this['ctx'][_0x260fcc(0xad)](_0x3970d6,_0x3f18dc,_0x4c67b2),this['_renderBoundaries']=[0x3e8,0x3e8,0x0,0x0];},'getValueAt':function(_0x41053c){var _0x2b809b=_0x32f5dc,_0x42615c,_0xfcd204=this['shadowCtx'],_0x1dd35e=_0xfcd204[_0x2b809b(_0x1b338c._0x5da75b)](_0x41053c['x'],_0x41053c['y'],0x1,0x1),_0x54f86f=_0x1dd35e['data'][0x3],_0x1110b9=this[_0x2b809b(0xb5)],_0x3766dd=this['_min'];return _0x42615c=Math['abs'](_0x1110b9-_0x3766dd)*(_0x54f86f/0xff)>>0x0,_0x42615c;},'getDataURL':function(){return this['canvas']['toDataURL']();}},_0x48afbc;}(),_0x2eb244=function _0x13b743(){var _0x2a0335=![];return _0x5c0b3c['defaultRenderer']==='canvas2d'&&(_0x2a0335=_0x52484a),_0x2a0335;}(),_0x90faf6={'merge':function(){var _0x58414b={},_0x1304cd=arguments['length'];for(var _0x318147=0x0;_0x318147<_0x1304cd;_0x318147++){var _0xa62e82=arguments[_0x318147];for(var _0x475443 in _0xa62e82){_0x58414b[_0x475443]=_0xa62e82[_0x475443];}}return _0x58414b;}},_0x42c8b7=function _0x47c8de(){var _0x446385={_0x26a5e3:0xed},_0x25a914={_0x396fd8:0x84},_0x5ae061={_0x20cbdb:0xe4,_0x2ce0a1:0xe9,_0x4fe0a1:0xeb},_0x5906b7={_0x5cfba1:0x108},_0x286d25=function _0x50666e(){function _0x591130(){this['cStore']={};}return _0x591130['prototype']={'on':function(_0x44549b,_0x2f260e,_0x65971a){var _0x162635=_0xe245,_0x334d44=this[_0x162635(_0x5906b7._0x5cfba1)];!_0x334d44[_0x44549b]&&(_0x334d44[_0x44549b]=[]),_0x334d44[_0x44549b]['push'](function(_0x1adf9a){return _0x2f260e['call'](_0x65971a,_0x1adf9a);});},'emit':function(_0xf8662,_0x4640ad){var _0x2b9645=this['cStore'];if(_0x2b9645[_0xf8662]){var _0x4cb9c5=_0x2b9645[_0xf8662]['length'];for(var _0x3dd5f2=0x0;_0x3dd5f2<_0x4cb9c5;_0x3dd5f2++){var _0x509d7f=_0x2b9645[_0xf8662][_0x3dd5f2];_0x509d7f(_0x4640ad);}}}},_0x591130;}(),_0xd08654=function(_0x4e923f){var _0x44838f={_0x5dd145:0xe2},_0x19ecfc=_0xe245,_0x32e97d=_0x4e923f[_0x19ecfc(_0x5ae061._0x20cbdb)],_0x167827=_0x4e923f['_coordinator'],_0x243568=_0x4e923f['_store'];_0x167827['on'](_0x19ecfc(_0x5ae061._0x2ce0a1),_0x32e97d['renderPartial'],_0x32e97d),_0x167827['on'](_0x19ecfc(_0x5ae061._0x4fe0a1),_0x32e97d['renderAll'],_0x32e97d),_0x167827['on']('extremachange',function(_0x29dc85){var _0x4b1d32=_0x19ecfc;_0x4e923f[_0x4b1d32(0x84)][_0x4b1d32(_0x44838f._0x5dd145)]&&_0x4e923f['_config']['onExtremaChange']({'min':_0x29dc85['min'],'max':_0x29dc85['max'],'gradient':_0x4e923f['_config']['gradient']||_0x4e923f['_config'][_0x4b1d32(0xe1)]});}),_0x243568['setCoordinator'](_0x167827);};function _0x54f91b(){var _0x3e0b79=_0xe245,_0x4a65aa=this[_0x3e0b79(0x84)]=_0x90faf6[_0x3e0b79(0xc9)](_0x5c0b3c,arguments[0x0]||{});this['_coordinator']=new _0x286d25();if(_0x4a65aa['plugin']){var _0x303eab=_0x4a65aa['plugin'];if(!_0x5c0b3c['plugins'][_0x303eab])throw new Error('Plugin\x20\x27'+_0x303eab+'\x27\x20not\x20found.\x20Maybe\x20it\x20was\x20not\x20registered.');else{var _0x5cd79c=_0x5c0b3c['plugins'][_0x303eab];this['_renderer']=new _0x5cd79c[(_0x3e0b79(_0x1a98f2._0x46afc9))](_0x4a65aa),this['_store']=new _0x5cd79c['store'](_0x4a65aa);}}else this['_renderer']=new _0x2eb244(_0x4a65aa),this[_0x3e0b79(_0x1a98f2._0x249f9d)]=new _0x36769e(_0x4a65aa);_0xd08654(this);}return _0x54f91b['prototype']={'addData':function(){var _0x1cb676=_0xe245;return this['_store']['addData']['apply'](this[_0x1cb676(0x81)],arguments),this;},'removeData':function(){var _0x11e706=_0xe245;return this[_0x11e706(0x81)]['removeData']&&this['_store']['removeData']['apply'](this[_0x11e706(_0x57ec47._0xcf4d2a)],arguments),this;},'setData':function(){return this['_store']['setData']['apply'](this['_store'],arguments),this;},'setDataMax':function(){var _0x402614=_0xe245;return this['_store']['setDataMax'][_0x402614(_0x18562a._0x2edf56)](this['_store'],arguments),this;},'setDataMin':function(){return this['_store']['setDataMin']['apply'](this['_store'],arguments),this;},'configure':function(_0x513726){var _0x35dbc5=_0xe245;return this[_0x35dbc5(_0x25a914._0x396fd8)]=_0x90faf6['merge'](this['_config'],_0x513726),this[_0x35dbc5(0xe4)]['updateConfig'](this[_0x35dbc5(_0x25a914._0x396fd8)]),this[_0x35dbc5(0xba)]['emit'](_0x35dbc5(0xeb),this['_store']['_getInternalData']()),this;},'repaint':function(){return this['_coordinator']['emit']('renderall',this['_store']['_getInternalData']()),this;},'getData':function(){return this['_store']['getData']();},'getDataURL':function(){var _0x49da0c=_0xe245;return this['_renderer'][_0x49da0c(_0x446385._0x26a5e3)]();},'getValueAt':function(_0x4e87ad){var _0x10381f=_0xe245;if(this['_store']['getValueAt'])return this[_0x10381f(0x81)]['getValueAt'](_0x4e87ad);else return this['_renderer']['getValueAt']?this['_renderer']['getValueAt'](_0x4e87ad):null;}},_0x54f91b;}(),_0x23f1ec={'create':function(_0xb92455){return new _0x42c8b7(_0xb92455);},'register':function(_0x13e854,_0xacce44){_0x5c0b3c['plugins'][_0x13e854]=_0xacce44;}};return _0x23f1ec;}));}(heatmap$1));var heatmap=heatmap$1['exports'],h337=_mergeNamespaces({'__proto__':null,'default':heatmap},[heatmap$1['exports']]),HeatMaterial=_0x268c4c(0x83);if(!heatmap$1['exports']['create'])throw new Error('请引入\x20heatmap.js\x20库\x20');const Cesium=mars3d__namespace[_0x268c4c(0x9b)],BaseLayer=mars3d__namespace['layer']['BaseLayer'],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:_0x268c4c(0x78),0.6:'green',0.8:'yellow',0.9:_0x268c4c(0xf3)}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium[_0x268c4c(0xd9)][_0x268c4c(0x8f)]};function _0xe245(_0x25226c,_0x55f1d1){var _0x57c7b5=_0x57c7();return _0xe245=function(_0xe245a2,_0x124467){_0xe245a2=_0xe245a2-0x73;var _0x3abf0e=_0x57c7b5[_0xe245a2];return _0x3abf0e;},_0xe245(_0x25226c,_0x55f1d1);}class HeatLayer extends BaseLayer{constructor(_0x1478c9={}){var _0x4276c6={_0x134d12:0xd8,_0xc42126:0xc4,_0x8b5161:0xe6},_0x4d535b=_0x268c4c;super(_0x1478c9),this[_0x4d535b(_0x4276c6._0x134d12)]['maxCanvasSize']=this[_0x4d535b(_0x4276c6._0x134d12)]['maxCanvasSize']??document[_0x4d535b(0x7c)][_0x4d535b(0xce)],this[_0x4d535b(_0x4276c6._0x134d12)]['maxCanvasSize']=Math[_0x4d535b(_0x4276c6._0xc42126)](this['options']['maxCanvasSize'],0x1388),this[_0x4d535b(_0x4276c6._0x134d12)]['minCanvasSize']=this['options']['minCanvasSize']??document['body']['clientHeight'],this['options'][_0x4d535b(_0x4276c6._0x8b5161)]=Math['max'](this['options']['minCanvasSize'],0x2bc),this['options']['heatStyle']={...DEF_HEATSTYLE,...this['options']['heatStyle']},this['options']['style']={...DEF_STYLE,...this['options']['style']};}get['layer'](){return this['_layer'];}get['heatStyle'](){var _0x491018=_0x268c4c;return this[_0x491018(0xd8)][_0x491018(0xc7)];}set[_0x268c4c(0xc7)](_0xdb2bc9){var _0x7de78f={_0x2140bd:0xfe},_0x4b094e=_0x268c4c;this[_0x4b094e(0xd8)]['heatStyle']=mars3d__namespace['Util']['merge'](this['options']['heatStyle'],_0xdb2bc9),this['_heat']&&(this['_heat']['configure'](this['options'][_0x4b094e(0xc7)]),this[_0x4b094e(_0x7de78f._0x2140bd)](!![]));}get[_0x268c4c(0x8e)](){return this['options']['style'];}set['style'](_0x431d85){var _0x523c38={_0x2d2135:0xff},_0x5bcd22=_0x268c4c;this['options']['style']=mars3d__namespace[_0x5bcd22(_0x523c38._0x2d2135)][_0x5bcd22(0xc9)](this['options']['style'],_0x431d85);}get[_0x268c4c(0xc6)](){return this['_positions'];}set['positions'](_0x1c2af6){var _0x599bbc=_0x268c4c;this[_0x599bbc(0xc0)](_0x1c2af6);}get['coordinates'](){var _0x1323d2={_0x3d1d66:0xbb},_0x344403=_0x268c4c;const _0x430c86=[];return this[_0x344403(0xc8)][_0x344403(_0x1323d2._0x3d1d66)](_0x1c8e25=>{_0x430c86['push'](_0x1c8e25['toArray']());}),_0x430c86;}get[_0x268c4c(0xbe)](){return this['_rectangle'];}['_setOptionsHook'](_0x10b558,_0x5de1c4){var _0x415d81=_0x268c4c;_0x10b558[_0x415d81(0xc6)]&&(this['positions']=_0x10b558['positions']);}['_mountedHook'](){var _0x4bf806={_0x75e76:0x97,_0x1fe463:0x75},_0x5c32d9=_0x268c4c;this['style'][_0x5c32d9(0xbf)]==='image'?this['_layer']=new mars3d__namespace['layer'][(_0x5c32d9(_0x4bf806._0x75e76))]({'crs':'EPSG:3857','private':!![]}):this['_layer']=new mars3d__namespace['layer'][(_0x5c32d9(_0x4bf806._0x1fe463))]({'private':!![]});}[_0x268c4c(0xb6)](){var _0x4ddf8a={_0x42eae2:0xdf,_0x591b77:0xc6},_0xd60cd0=_0x268c4c;this['_map']['addLayer'](this['_layer']),this['_container']=mars3d__namespace['DomUtil'][_0xd60cd0(_0x4ddf8a._0x42eae2)]('div','mars3d-heatmap\x20mars3d-hideDiv',this['_map']['container']),this['options']['positions']&&(this[_0xd60cd0(_0x4ddf8a._0x591b77)]=this['options']['positions']),this[_0xd60cd0(0xd8)]['flyTo']&&this['flyToByAnimationEnd']();}['_removedHook'](){var _0x5cb717={_0x1edf74:0x90},_0x398b8f=_0x268c4c;this[_0x398b8f(0xe7)]&&(mars3d__namespace[_0x398b8f(_0x5cb717._0x1edf74)]['remove'](this[_0x398b8f(0xe7)]),delete this['_container']),this['clear'](),this[_0x398b8f(0xea)]['removeLayer'](this['_layer']);}[_0x268c4c(0xbc)](_0x1942cd,_0x5f5c56){var _0x2ac174={_0x1427b0:0xac},_0x53453d=_0x268c4c;this['_positions']=this['_positions']||[],this['_positions'][_0x53453d(_0x2ac174._0x1427b0)](_0x1942cd),this[_0x53453d(0xfe)](_0x5f5c56);}[_0x268c4c(0xc0)](_0x19bc5f,_0x31585e){this['_positions']=_0x19bc5f,this['_updatePositionsHook'](_0x31585e);}['clear'](){var _0x50bb33={_0x1eaad2:0x8c},_0x652428=_0x268c4c;this['_graphic']&&(this['_layer']['removeGraphic'](this['_graphic'],!![]),delete this[_0x652428(0x7b)]),this[_0x652428(_0x50bb33._0x1eaad2)]&&(this['_layer']['removeGraphic'](this[_0x652428(0x8c)],!![]),delete this['_graphic2']);}['_updatePositionsHook'](_0x2599d2){var _0x58e3f7={_0x236261:0x8a,_0x47cf62:0x88,_0x3f8381:0xf5,_0xca29ed:0x10b,_0x59f81a:0x7b},_0x4cd52c=_0x268c4c;if(!this[_0x4cd52c(_0x58e3f7._0x236261)]||!this['_map']||!this[_0x4cd52c(0xc6)]||this[_0x4cd52c(0xc6)]['length']===0x0)return this;const _0x4d4159=this[_0x4cd52c(0xd7)]();if(this['style']['type']==='image')this[_0x4cd52c(0xcc)][_0x4cd52c(_0x58e3f7._0x47cf62)]({'url':_0x4d4159[_0x4cd52c(0x76)]('image/png',0x1),'rectangle':this[_0x4cd52c(0xfb)],'opacity':this[_0x4cd52c(0x8e)]['opacity']});else this['style'][_0x4cd52c(_0x58e3f7._0x3f8381)]?this['_graphic']&&_0x2599d2?(this[_0x4cd52c(0x7b)]['uniforms'][_0x4cd52c(0xe0)]=_0x4d4159,this[_0x4cd52c(0x7b)][_0x4cd52c(0xfd)]['bumpMap']=this['_getArcHeatCanvas'](),this['_graphic2']&&(this['_graphic2'][_0x4cd52c(0xfd)]['image']=_0x4d4159,this['_graphic2']['uniforms'][_0x4cd52c(0xdd)]=this['_graphic']['uniforms']['bumpMap'])):this[_0x4cd52c(_0x58e3f7._0xca29ed)](_0x4d4159):this['_graphic']&&_0x2599d2?this[_0x4cd52c(_0x58e3f7._0x59f81a)]['uniforms'][_0x4cd52c(0xe0)]=_0x4d4159:this['_createGraphic'](_0x4d4159);return this;}[_0x268c4c(0xb8)](_0x3ba342){var _0x41d713={_0x502744:0xb9,_0x46a0b4:0x7b},_0x3a14ce=_0x268c4c;this['clear'](),this[_0x3a14ce(0x7b)]=new mars3d__namespace[(_0x3a14ce(_0x41d713._0x502744))]['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'material':mars3d__namespace['MaterialUtil']['createMaterial'](mars3d__namespace['MaterialType']['Image2'],{'image':_0x3ba342}),'flat':!![]})}),this['_layer']['addGraphic'](this[_0x3a14ce(_0x41d713._0x46a0b4)]);}['_createArcGraphic'](_0x54093c){var _0x3a52eb={_0x389e59:0xf6,_0x2e0668:0xfb,_0x39e8c4:0x8e,_0x24ca29:0xd9,_0x21c74c:0x8c,_0x12f0a7:0xd8},_0x58d6b5=_0x268c4c;this['clear']();const _0x3eaaa1=Cesium['RenderState']['fromCache']({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium[_0x58d6b5(0xb0)]['ALWAYS'],'frontOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium[_0x58d6b5(0x10a)][_0x58d6b5(_0x3a52eb._0x389e59)],'zPass':Cesium['StencilOperation']['REPLACE']},'backFunction':Cesium['StencilFunction'][_0x58d6b5(0xf8)],'backOperation':{'fail':Cesium['StencilOperation'][_0x58d6b5(0xf6)],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium[_0x58d6b5(0x10a)][_0x58d6b5(0x92)]},'reference':0x2,'mask':0x2},'blending':Cesium[_0x58d6b5(0x7e)]['ALPHA_BLEND']}),_0x554cdf=Math['floor'](this[_0x58d6b5(0x8e)]['diffHeight']??this['_mBoundsMax']*0.02)+0.1;this[_0x58d6b5(0x8e)]['diffHeight']&&delete this['style']['diffHeight'];const _0x3e1b44=(this[_0x58d6b5(0x8e)]['splitNum'],0x64);let _0x3635d1=Math['max'](this[_0x58d6b5(0xfb)][_0x58d6b5(0xde)],this[_0x58d6b5(_0x3a52eb._0x2e0668)][_0x58d6b5(0xc1)]);this[_0x58d6b5(_0x3a52eb._0x39e8c4)]['granularity']=_0x3635d1/=_0x3e1b44;const _0x3ef075=new Cesium['Material']({'fabric':{'uniforms':{'image':_0x54093c,'repeat':new Cesium['Cartesian2'](0x1,0x1),'color':new Cesium[(_0x58d6b5(0xf2))](0x1,0x1,0x1,0x0),'bumpMap':this[_0x58d6b5(0xf7)]()},'source':HeatMaterial},'translucent':!![]}),_0x288459=this['style'][_0x58d6b5(0xb4)]||0x1;this['_graphic']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium[(_0x58d6b5(_0x3a52eb._0x24ca29))]({'flat':!![],'aboveGround':!![],'renderState':_0x3eaaa1,'material':_0x3ef075,'vertexShaderSource':getVertexShaderSource(_0x554cdf*_0x288459)})}),this['_layer']['addGraphic'](this['_graphic']),this['style']['arcDirection']===0x0&&(this[_0x58d6b5(_0x3a52eb._0x21c74c)]=new mars3d__namespace['graphic'][(_0x58d6b5(0x104))]({...this[_0x58d6b5(_0x3a52eb._0x12f0a7)],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x3eaaa1,'material':_0x3ef075,'vertexShaderSource':getVertexShaderSource(-_0x554cdf)})}),this['_layer'][_0x58d6b5(0xd4)](this['_graphic2']));}['getRectangle'](_0x4c35a4){var _0x1255d4=_0x268c4c;return _0x4c35a4!==null&&_0x4c35a4!==void 0x0&&_0x4c35a4[_0x1255d4(0xda)]&&this[_0x1255d4(0xfb)]?mars3d__namespace[_0x1255d4(0x9f)]['formatRectangle'](this['_rectangle']):this['_rectangle'];}['_getHeatCanvas'](){var _0x34a910={_0x5e6297:0xbe,_0x1b474a:0x10f,_0x538a8a:0x74,_0x148703:0xd8,_0x222886:0x85,_0x4aa232:0xe6,_0x44b010:0xe6,_0x21df58:0xec,_0x69eec8:0xbd,_0x41a77c:0xee,_0x3c16ab:0xc4,_0x1ed50a:0x107,_0x4c75ab:0xd3,_0x29bf4b:0x105,_0x4c9175:0x101,_0x128290:0xe5},_0x5c79bb={_0x2a4d0f:0x105,_0x2aa6ae:0x107,_0x223a56:0xc4},_0x25919f={_0x1b51ca:0xd3,_0x2d9d8e:0xd8,_0x30de97:0xbe,_0x2d35aa:0xd1,_0x5cf5f5:0xc5,_0x87235a:0xd1},_0x4ad37f=_0x268c4c;const _0x61efca=this['_positions'],_0x148df7=[];let _0x3bac49,_0x36b95e,_0x897039,_0x4710a6;_0x61efca['forEach'](_0x43be40=>{var _0x1a959e=_0xe245;const _0x47190f=mars3d__namespace['LngLatPoint']['parse'](_0x43be40);if(!_0x47190f)return;_0x47190f[_0x1a959e(_0x25919f._0x1b51ca)]=_0x43be40['value']||0x1,!this[_0x1a959e(_0x25919f._0x2d9d8e)][_0x1a959e(_0x25919f._0x30de97)]&&(_0x3bac49===undefined?(_0x3bac49=_0x47190f[_0x1a959e(0xc5)],_0x36b95e=_0x47190f[_0x1a959e(0xc5)],_0x897039=_0x47190f['lat'],_0x4710a6=_0x47190f[_0x1a959e(_0x25919f._0x2d35aa)]):(_0x3bac49=Math['min'](_0x3bac49,_0x47190f[_0x1a959e(0xc5)]),_0x36b95e=Math[_0x1a959e(0x10f)](_0x36b95e,_0x47190f[_0x1a959e(_0x25919f._0x5cf5f5)]),_0x897039=Math['min'](_0x897039,_0x47190f[_0x1a959e(0xd1)]),_0x4710a6=Math['max'](_0x4710a6,_0x47190f[_0x1a959e(_0x25919f._0x87235a)]))),_0x148df7['push'](_0x47190f);});_0x3bac49===_0x36b95e&&(_0x3bac49-=0.000001,_0x36b95e+=0.000001);_0x897039===_0x4710a6&&(_0x897039-=0.000001,_0x4710a6+=0.000001);let _0x5294df=this['options'][_0x4ad37f(_0x34a910._0x5e6297)]||{'xmin':_0x3bac49,'xmax':_0x36b95e,'ymin':_0x897039,'ymax':_0x4710a6};const _0x338e8e=getMercatorBounds(_0x5294df),_0x2d5529=Math['abs'](_0x338e8e[_0x4ad37f(0xee)]-_0x338e8e['xmin']),_0x1a2a15=Math[_0x4ad37f(0x10e)](_0x338e8e['ymax']-_0x338e8e[_0x4ad37f(0xbd)]),_0xf0b598=Math[_0x4ad37f(_0x34a910._0x1b474a)](_0x2d5529,_0x1a2a15),_0x4d6dc7=Math['min'](_0x2d5529,_0x1a2a15);this[_0x4ad37f(_0x34a910._0x538a8a)]=_0xf0b598;let _0x28c843=0x1;if(_0xf0b598>this['options']['maxCanvasSize'])_0x28c843=_0xf0b598/this[_0x4ad37f(_0x34a910._0x148703)][_0x4ad37f(_0x34a910._0x222886)],_0x4d6dc7/_0x28c843<this[_0x4ad37f(0xd8)][_0x4ad37f(_0x34a910._0x4aa232)]&&(_0x28c843=_0x4d6dc7/this['options']['minCanvasSize']);else _0x4d6dc7<this[_0x4ad37f(0xd8)][_0x4ad37f(_0x34a910._0x44b010)]&&(_0x28c843=_0x4d6dc7/this['options'][_0x4ad37f(0xe6)],_0xf0b598/_0x28c843>this['options']['maxCanvasSize']&&(_0x28c843=_0xf0b598/this[_0x4ad37f(_0x34a910._0x148703)]['maxCanvasSize']));const _0x357069=this['heatStyle'][_0x4ad37f(_0x34a910._0x21df58)]*1.5,_0x5fa2cc=_0x2d5529/_0x28c843+_0x357069*0x2,_0x664e69=_0x1a2a15/_0x28c843+_0x357069*0x2,_0x2208a1=_0x357069*_0x28c843;_0x338e8e['xmin']-=_0x2208a1,_0x338e8e[_0x4ad37f(_0x34a910._0x69eec8)]-=_0x2208a1,_0x338e8e['xmax']+=_0x2208a1,_0x338e8e['ymax']+=_0x2208a1,_0x338e8e['xmin']=Math['max'](_0x338e8e['xmin'],-20037508.34),_0x338e8e[_0x4ad37f(_0x34a910._0x41a77c)]=Math[_0x4ad37f(_0x34a910._0x3c16ab)](_0x338e8e['xmax'],20037508.34),_0x338e8e['ymin']=Math['max'](_0x338e8e['ymin'],-20037508.34),_0x338e8e['ymax']=Math['min'](_0x338e8e[_0x4ad37f(_0x34a910._0x1ed50a)],20037508.34),this[_0x4ad37f(0x77)]=_0x28c843,_0x5294df=geLatLngBounds(_0x338e8e),this['_rectangle']=Cesium[_0x4ad37f(0x100)]['fromDegrees'](_0x5294df['xmin'],_0x5294df[_0x4ad37f(_0x34a910._0x69eec8)],_0x5294df[_0x4ad37f(0xee)],_0x5294df['ymax']);let _0x1245f4=_0x148df7[0x0]['value']??0x1,_0x1359b0=_0x148df7[0x0][_0x4ad37f(_0x34a910._0x4c75ab)]??0x0;const _0x44f6ff=[];_0x148df7['forEach'](_0x5bd15d=>{var _0x51aea2=_0x4ad37f;const _0xd11994=mars3d__namespace[_0x51aea2(0x7f)]['lonlat2mercator']([_0x5bd15d[_0x51aea2(0xc5)],_0x5bd15d['lat']]),_0x2b558b=_0x5bd15d[_0x51aea2(0xd3)]||0x1,_0x276954=Math['round']((_0xd11994[0x0]-_0x338e8e[_0x51aea2(_0x5c79bb._0x2a4d0f)])/_0x28c843),_0x5234df=Math['round']((_0x338e8e[_0x51aea2(_0x5c79bb._0x2aa6ae)]-_0xd11994[0x1])/_0x28c843);_0x1245f4=Math['max'](_0x1245f4,_0x2b558b),_0x1359b0=Math[_0x51aea2(_0x5c79bb._0x223a56)](_0x1359b0,_0x2b558b),_0x44f6ff['push']({'x':_0x276954,'y':_0x5234df,'value':_0x2b558b});});const _0x390f98={'min':this['options'][_0x4ad37f(0xc4)]??_0x1359b0,'max':this[_0x4ad37f(0xd8)]['max']??_0x1245f4,'data':_0x44f6ff};this['_last_heatData']=_0x390f98;if(!this['_last_mBounds']||_0x338e8e['xmin']!==this['_last_mBounds'][_0x4ad37f(_0x34a910._0x29bf4b)]||_0x338e8e[_0x4ad37f(0xbd)]!==this[_0x4ad37f(0x101)]['ymin']||_0x338e8e['xmax']!==this[_0x4ad37f(_0x34a910._0x4c9175)]['xmax']||_0x338e8e['ymax']!==this['_last_mBounds']['ymax']){this['_last_mBounds']=_0x338e8e,this[_0x4ad37f(0xe7)]['style']['cssText']='width:'+_0x5fa2cc+'px;height:'+_0x664e69+_0x4ad37f(0xa9);const _0x5800ec={...this['heatStyle'],'container':this[_0x4ad37f(0xe7)]};!this['_heat']?this['_heat']=heatmap$1['exports']['create'](_0x5800ec):this['_heat'][_0x4ad37f(_0x34a910._0x128290)](_0x5800ec);}this['_heat']['setData'](_0x390f98);const _0x4e5dc7=mars3d__namespace[_0x4ad37f(0x90)]['copyCanvas'](this['_heat']['_renderer']['canvas']);return _0x4e5dc7;}[_0x268c4c(0xf7)](){var _0x5ce168={_0x21ad03:0xcb,_0x55ef84:0x90},_0xfa053c=_0x268c4c;this[_0xfa053c(0xfc)][_0xfa053c(0xe5)]({'radius':this['heatStyle'][_0xfa053c(0xec)]*this['style']['arcRadiusScale'],'blur':this['heatStyle']['blur']*this['style']['arcBlurScale'],'gradient':this['heatStyle']['gradientArc']||{0.25:_0xfa053c(_0x5ce168._0x21ad03),0.55:'rgb(140,140,140)',0.85:'rgb(216,216,216)',0x1:'rgb(255,255,255)'}});const _0x2d7e95=mars3d__namespace[_0xfa053c(_0x5ce168._0x55ef84)]['copyCanvas'](this['_heat']['_renderer']['canvas']);return this[_0xfa053c(0xfc)]['configure'](this['options']['heatStyle']),_0x2d7e95;}['getPointData'](_0x13a1dd){var _0x86ffaf={_0x27c111:0x96},_0x46415b=_0x268c4c;const _0x42cc54=mars3d__namespace['LngLatPoint']['parse'](_0x13a1dd);if(!_0x42cc54)return{};const _0x4a214a=mars3d__namespace['PointTrans'][_0x46415b(_0x86ffaf._0x27c111)]([_0x42cc54['lng'],_0x42cc54['lat']]),_0x10a35f=this['_last_mBounds'],_0x42a70c=Math[_0x46415b(0xe3)]((_0x4a214a[0x0]-_0x10a35f['xmin'])/this['_scale']),_0x42b53f=Math['round']((_0x10a35f['ymax']-_0x4a214a[0x1])/this['_scale']),_0x553546=this['_heat']['getValueAt']({'x':_0x42a70c,'y':_0x42b53f}),_0x26a6a4=this['_heat']['_renderer']['ctx']['getImageData'](_0x42a70c-0x1,_0x42b53f-0x1,0x1,0x1)['data'];return{'x':_0x42a70c,'y':_0x42b53f,'value':_0x553546,'color':'rgba('+_0x26a6a4[0x0]+','+_0x26a6a4[0x1]+','+_0x26a6a4[0x2]+','+_0x26a6a4[0x3]+')'};}}mars3d__namespace[_0x268c4c(0x9a)]['register']('heat',HeatLayer),mars3d__namespace['layer'][_0x268c4c(0xa3)]=HeatLayer,mars3d__namespace[_0x268c4c(0xfa)]=h337;function getMercatorBounds(_0x2dbeb1){var _0x3a52f7={_0x52da86:0xbd,_0x531f28:0x96},_0x4d5e03=_0x268c4c;const _0x22da69=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x2dbeb1['xmin'],_0x2dbeb1[_0x4d5e03(_0x3a52f7._0x52da86)]]),_0x3d4809=mars3d__namespace['PointTrans'][_0x4d5e03(_0x3a52f7._0x531f28)]([_0x2dbeb1['xmax'],_0x2dbeb1['ymax']]);return{'xmin':_0x22da69[0x0],'ymin':_0x22da69[0x1],'xmax':_0x3d4809[0x0],'ymax':_0x3d4809[0x1]};}function geLatLngBounds(_0x9c841a){var _0x332f29={_0x4b792c:0xa0},_0x12ff09=_0x268c4c;const _0x182533=mars3d__namespace['PointTrans'][_0x12ff09(_0x332f29._0x4b792c)]([_0x9c841a['xmin'],_0x9c841a['ymin']]),_0x1209dd=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x9c841a['xmax'],_0x9c841a['ymax']]);return{'xmin':_0x182533[0x0],'ymin':_0x182533[0x1],'xmax':_0x1209dd[0x0],'ymax':_0x1209dd[0x1]};}function getVertexShaderSource(_0x2e0157){var _0x4d45b4={_0x4da3fa:0x80},_0x37b8bb=_0x268c4c;return'in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20'+_0x2e0157+_0x37b8bb(_0x4d45b4._0x4da3fa);}exports[_0x268c4c(0xa3)]=HeatLayer,Object[_0x268c4c(0x87)](exports,'__esModule',{'value':!![]});
}));
