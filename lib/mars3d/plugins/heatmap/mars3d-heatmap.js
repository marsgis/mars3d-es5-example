/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.7.9
 * 编译日期：2024-03-28 22:20:03
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2024-01-15
 */
(function (global, factory) {
	typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d'))) :
	typeof define === 'function' && define.amd ? define(['exports', 'mars3d'], factory) :
	(global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d));
})(this, (function (exports, mars3d) { 
'use strict';var _0x1388eb=_0x36c2;(function(_0x148bb2,_0x49e3c9){var _0x3cd009={_0x2607de:0x12f,_0x35a0ef:0x19c},_0x5e04b7=_0x36c2,_0x37356d=_0x148bb2();while(!![]){try{var _0x1424e2=-parseInt(_0x5e04b7(0x185))/0x1+parseInt(_0x5e04b7(0x13d))/0x2*(-parseInt(_0x5e04b7(0x1bf))/0x3)+-parseInt(_0x5e04b7(0x196))/0x4+parseInt(_0x5e04b7(_0x3cd009._0x2607de))/0x5*(-parseInt(_0x5e04b7(0x1ae))/0x6)+-parseInt(_0x5e04b7(0x142))/0x7+parseInt(_0x5e04b7(_0x3cd009._0x35a0ef))/0x8+-parseInt(_0x5e04b7(0x198))/0x9*(-parseInt(_0x5e04b7(0x1be))/0xa);if(_0x1424e2===_0x49e3c9)break;else _0x37356d['push'](_0x37356d['shift']());}catch(_0x443895){_0x37356d['push'](_0x37356d['shift']());}}}(_0x23de,0xbbc26));function _interopNamespace(_0x2e0acc){var _0x14cd79={_0x1216d9:0x14c},_0x4af648={_0x4db04b:0x179,_0x3ae8b7:0x19e},_0x409c48=_0x36c2;if(_0x2e0acc&&_0x2e0acc[_0x409c48(0x1a9)])return _0x2e0acc;var _0x3f82dd=Object['create'](null);return _0x2e0acc&&Object[_0x409c48(0x147)](_0x2e0acc)[_0x409c48(_0x14cd79._0x1216d9)](function(_0xe3f66b){var _0x3359d5=_0x409c48;if(_0xe3f66b!=='default'){var _0x47df80=Object[_0x3359d5(_0x4af648._0x4db04b)](_0x2e0acc,_0xe3f66b);Object[_0x3359d5(_0x4af648._0x3ae8b7)](_0x3f82dd,_0xe3f66b,_0x47df80['get']?_0x47df80:{'enumerable':!![],'get':function(){return _0x2e0acc[_0xe3f66b];}});}}),_0x3f82dd['default']=_0x2e0acc,_0x3f82dd;}function _mergeNamespaces(_0x2ec9ed,_0x5d630d){var _0x1f9d8f={_0x1e5a9a:0x134,_0x3ad6fc:0x14c},_0x3bec1d={_0x149b78:0x1ad,_0x399341:0x1bd},_0x9cddd8=_0x36c2;return _0x5d630d[_0x9cddd8(0x14c)](function(_0x7aa56a){var _0x184c40=_0x9cddd8;_0x7aa56a&&typeof _0x7aa56a!=='string'&&!Array[_0x184c40(_0x1f9d8f._0x1e5a9a)](_0x7aa56a)&&Object['keys'](_0x7aa56a)[_0x184c40(_0x1f9d8f._0x3ad6fc)](function(_0xeb7852){var _0x13be29=_0x184c40;if(_0xeb7852!==_0x13be29(_0x3bec1d._0x149b78)&&!(_0xeb7852 in _0x2ec9ed)){var _0x550249=Object[_0x13be29(0x179)](_0x7aa56a,_0xeb7852);Object['defineProperty'](_0x2ec9ed,_0xeb7852,_0x550249[_0x13be29(_0x3bec1d._0x399341)]?_0x550249:{'enumerable':!![],'get':function(){return _0x7aa56a[_0xeb7852];}});}});}),_0x2ec9ed;}var mars3d__namespace=_interopNamespace(mars3d),commonjsGlobal=typeof globalThis!=='undefined'?globalThis:typeof window!=='undefined'?window:typeof global!=='undefined'?global:typeof self!=='undefined'?self:{},heatmap$1={'exports':{}};(function(_0x57c19b){var _0x459465={_0x1a46e7:0x1bb},_0x5c19f8={_0x37d85e:0x145},_0x41c370={_0x416c69:0x15e},_0x42eb76={_0x51fa67:0x16e};(function(_0x297fd4,_0x48f731,_0x1e1491){var _0x1dada6=_0x36c2;_0x57c19b[_0x1dada6(_0x42eb76._0x51fa67)]?_0x57c19b['exports']=_0x1e1491():_0x48f731[_0x297fd4]=_0x1e1491();}('h337',commonjsGlobal,function(){var _0x15c3e6={_0x4c7917:0x1a1,_0x5639d7:0x189},_0x524bae={_0x41b5f2:0x16c},_0x18f6fe={_0x4b8e9b:0x1a1},_0x297d83={_0xfe4f39:0x192,_0x446d63:0x1a1},_0x462eb2={_0x49ee26:0x18d},_0x38d1d6={_0x419bb2:0x136},_0x31337c={_0x548b6f:0x135,_0xc15b7a:0x1c4,_0x5b3586:0x159,_0x5d5832:0x19b},_0x263de7={_0x294ea1:0x1aa},_0x283bd4={_0x208eff:0x19d},_0x55ed14={_0x2541b4:0x199,_0x104501:0x17f,_0x5706d7:0x1c0,_0x1c7f33:0x13e},_0x784dc2={_0x554af7:0x1c4,_0x3b2a8f:0x153},_0x54d299={_0x51eb06:0x1c1},_0x1c8bbd={_0x5d2036:0x1b9,_0x932d5e:0x13c},_0x494d81={_0x408902:0x1b9,_0x302a6b:0x132},_0x36ab59={_0x4ad1dc:0x177,_0x2f90b4:0x1b9},_0xff79f5={_0x4586da:0x15a,_0x4c9108:0x14a,_0x5f4ae2:0x16d,_0xab6730:0x174},_0x404b27=_0x36c2,_0x5c3956={'defaultRadius':0x28,'defaultRenderer':_0x404b27(0x15e),'defaultGradient':{0.25:'rgb(0,0,255)',0.55:_0x404b27(_0x459465._0x1a46e7),0.85:_0x404b27(0x17d),0x1:'rgb(255,0,0)'},'defaultMaxOpacity':0x1,'defaultMinOpacity':0x0,'defaultBlur':0.85,'defaultXField':'x','defaultYField':'y','defaultValueField':'value','plugins':{}},_0x44db11=function _0x2cd7e9(){var _0x420d00={_0x465ecf:0x166},_0x811405={_0x17ad94:0x193,_0x27db78:0x132},_0x5c6443={_0x374a5b:0x141,_0x34128e:0x1b9},_0x349046={_0x2e1574:0x1b9},_0x5653ce={_0x5a4cc4:0x15f,_0x28d9f5:0x13c},_0x1f667d=_0x404b27,_0x256500=function _0x2a2af0(_0x3dace0){var _0x2b356b=_0x36c2;this['_coordinator']={},this['_data']=[],this['_radi']=[],this['_min']=0xa,this['_max']=0x1,this['_xField']=_0x3dace0[_0x2b356b(_0xff79f5._0x4586da)]||_0x3dace0['defaultXField'],this[_0x2b356b(0x1ac)]=_0x3dace0[_0x2b356b(_0xff79f5._0x4c9108)]||_0x3dace0[_0x2b356b(0x184)],this['_valueField']=_0x3dace0[_0x2b356b(_0xff79f5._0x5f4ae2)]||_0x3dace0['defaultValueField'],_0x3dace0['radius']&&(this['_cfgRadius']=_0x3dace0[_0x2b356b(_0xff79f5._0xab6730)]);},_0x1f4345=_0x5c3956['defaultRadius'];return _0x256500[_0x1f667d(0x18a)]={'_organiseData':function(_0x440b1b,_0x41fd8c){var _0x3bbf63=_0x1f667d,_0x3c8b44=_0x440b1b[this[_0x3bbf63(_0x5653ce._0x5a4cc4)]],_0x13b316=_0x440b1b[this['_yField']],_0x2b7bd0=this[_0x3bbf63(0x129)],_0x4971c7=this[_0x3bbf63(_0x5653ce._0x28d9f5)],_0x587924=this['_max'],_0x12eab8=this[_0x3bbf63(0x19a)],_0x391f4d=_0x440b1b[this['_valueField']]||0x1,_0x4ffacb=_0x440b1b['radius']||this['_cfgRadius']||_0x1f4345;!_0x4971c7[_0x3c8b44]&&(_0x4971c7[_0x3c8b44]=[],_0x2b7bd0[_0x3c8b44]=[]);!_0x4971c7[_0x3c8b44][_0x13b316]?(_0x4971c7[_0x3c8b44][_0x13b316]=_0x391f4d,_0x2b7bd0[_0x3c8b44][_0x13b316]=_0x4ffacb):_0x4971c7[_0x3c8b44][_0x13b316]+=_0x391f4d;var _0x13c126=_0x4971c7[_0x3c8b44][_0x13b316];if(_0x13c126>_0x587924)return!_0x41fd8c?this['_max']=_0x13c126:this['setDataMax'](_0x13c126),![];else return _0x13c126<_0x12eab8?(!_0x41fd8c?this['_min']=_0x13c126:this[_0x3bbf63(0x156)](_0x13c126),![]):{'x':_0x3c8b44,'y':_0x13b316,'value':_0x391f4d,'radius':_0x4ffacb,'min':_0x12eab8,'max':_0x587924};},'_unOrganizeData':function(){var _0x2df975=_0x1f667d,_0x63215e=[],_0x2579d2=this[_0x2df975(0x13c)],_0x170e20=this['_radi'];for(var _0xf6e665 in _0x2579d2){for(var _0x2e8a2f in _0x2579d2[_0xf6e665]){_0x63215e[_0x2df975(_0x36ab59._0x4ad1dc)]({'x':_0xf6e665,'y':_0x2e8a2f,'radius':_0x170e20[_0xf6e665][_0x2e8a2f],'value':_0x2579d2[_0xf6e665][_0x2e8a2f]});}}return{'min':this[_0x2df975(0x19a)],'max':this[_0x2df975(_0x36ab59._0x2f90b4)],'data':_0x63215e};},'_onExtremaChange':function(){var _0x3d61e4=_0x1f667d;this['_coordinator']['emit']('extremachange',{'min':this['_min'],'max':this[_0x3d61e4(_0x349046._0x2e1574)]});},'addData':function(){var _0x480e92=_0x1f667d;if(arguments[0x0]['length']>0x0){var _0x5cd151=arguments[0x0],_0x193b25=_0x5cd151['length'];while(_0x193b25--){this['addData'][_0x480e92(0x176)](this,_0x5cd151[_0x193b25]);}}else{var _0x1cb802=this['_organiseData'](arguments[0x0],!![]);_0x1cb802&&(this['_data']['length']===0x0&&(this[_0x480e92(0x19a)]=this['_max']=_0x1cb802['value']),this['_coordinator'][_0x480e92(_0x5c6443._0x374a5b)](_0x480e92(0x187),{'min':this[_0x480e92(0x19a)],'max':this[_0x480e92(_0x5c6443._0x34128e)],'data':[_0x1cb802]}));}return this;},'setData':function(_0x21724b){var _0xb8377e=_0x1f667d,_0x2c9590=_0x21724b['data'],_0x466e8c=_0x2c9590['length'];this['_data']=[],this[_0xb8377e(0x129)]=[];for(var _0x2cfc49=0x0;_0x2cfc49<_0x466e8c;_0x2cfc49++){this['_organiseData'](_0x2c9590[_0x2cfc49],![]);}return this['_max']=_0x21724b['max'],this['_min']=_0x21724b[_0xb8377e(_0x811405._0x17ad94)]||0x0,this[_0xb8377e(_0x811405._0x27db78)](),this['_coordinator']['emit']('renderall',this['_getInternalData']()),this;},'removeData':function(){},'setDataMax':function(_0x115c0c){var _0x429ec9=_0x1f667d;return this[_0x429ec9(_0x494d81._0x408902)]=_0x115c0c,this[_0x429ec9(_0x494d81._0x302a6b)](),this['_coordinator']['emit'](_0x429ec9(0x166),this['_getInternalData']()),this;},'setDataMin':function(_0x2a4d3d){var _0x9cafb3=_0x1f667d;return this['_min']=_0x2a4d3d,this['_onExtremaChange'](),this['_coordinator']['emit'](_0x9cafb3(_0x420d00._0x465ecf),this['_getInternalData']()),this;},'setCoordinator':function(_0x3bd2cc){var _0x442724=_0x1f667d;this[_0x442724(0x151)]=_0x3bd2cc;},'_getInternalData':function(){var _0x43afcc=_0x1f667d;return{'max':this[_0x43afcc(_0x1c8bbd._0x5d2036)],'min':this['_min'],'data':this[_0x43afcc(_0x1c8bbd._0x932d5e)],'radi':this['_radi']};},'getData':function(){return this['_unOrganizeData']();}},_0x256500;}(),_0x514f7d=function _0x497f57(){var _0x359510={_0x57b9df:0x16f,_0x44057a:0x12c,_0x2ac8ab:0x17f},_0x1dc793={_0x247f9e:0x145,_0xbaca1e:0x197},_0x4212df={_0x2bc598:0x145},_0x5ec7e6=function(_0x32b44a){var _0x524b12=_0x36c2,_0x5a60e1=_0x32b44a['gradient']||_0x32b44a[_0x524b12(_0x54d299._0x51eb06)],_0x278ef5=document['createElement']('canvas'),_0x2bd864=_0x278ef5['getContext']('2d',{'willReadFrequently':!![]});_0x278ef5['width']=0x100,_0x278ef5['height']=0x1;var _0x19a24c=_0x2bd864['createLinearGradient'](0x0,0x0,0x100,0x1);for(var _0x390c2e in _0x5a60e1){_0x19a24c['addColorStop'](_0x390c2e,_0x5a60e1[_0x390c2e]);}return _0x2bd864['fillStyle']=_0x19a24c,_0x2bd864['fillRect'](0x0,0x0,0x100,0x1),_0x2bd864['getImageData'](0x0,0x0,0x100,0x1)['data'];},_0x2f3f83=function(_0x565ec3,_0x5b97e9){var _0x1a0892=_0x36c2,_0x2a73d1=document['createElement'](_0x1a0892(0x136)),_0x244f69=_0x2a73d1['getContext']('2d',{'willReadFrequently':!![]}),_0xf929e6=_0x565ec3,_0x2ea017=_0x565ec3;_0x2a73d1[_0x1a0892(_0x784dc2._0x554af7)]=_0x2a73d1['height']=_0x565ec3*0x2;if(_0x5b97e9==0x1)_0x244f69['beginPath'](),_0x244f69['arc'](_0xf929e6,_0x2ea017,_0x565ec3,0x0,0x2*Math['PI'],![]),_0x244f69['fillStyle']='rgba(0,0,0,1)',_0x244f69['fill']();else{var _0x19e9ee=_0x244f69[_0x1a0892(_0x784dc2._0x3b2a8f)](_0xf929e6,_0x2ea017,_0x565ec3*_0x5b97e9,_0xf929e6,_0x2ea017,_0x565ec3);_0x19e9ee['addColorStop'](0x0,'rgba(0,0,0,1)'),_0x19e9ee['addColorStop'](0x1,'rgba(0,0,0,0)'),_0x244f69['fillStyle']=_0x19e9ee,_0x244f69[_0x1a0892(0x173)](0x0,0x0,0x2*_0x565ec3,0x2*_0x565ec3);}return _0x2a73d1;},_0x2ee3fe=function(_0x4dfc9a){var _0x3478c1=_0x36c2,_0x23dd44=[],_0x314e14=_0x4dfc9a[_0x3478c1(0x193)],_0x3fc841=_0x4dfc9a[_0x3478c1(0x1b2)],_0x2ac1b6=_0x4dfc9a['radi'],_0x4dfc9a=_0x4dfc9a['data'],_0x4501d1=Object['keys'](_0x4dfc9a),_0x460437=_0x4501d1['length'];while(_0x460437--){var _0x26541d=_0x4501d1[_0x460437],_0xcd9d01=Object[_0x3478c1(0x147)](_0x4dfc9a[_0x26541d]),_0x2125f5=_0xcd9d01[_0x3478c1(_0x4212df._0x2bc598)];while(_0x2125f5--){var _0x478181=_0xcd9d01[_0x2125f5],_0xcd2522=_0x4dfc9a[_0x26541d][_0x478181],_0x485345=_0x2ac1b6[_0x26541d][_0x478181];_0x23dd44['push']({'x':_0x26541d,'y':_0x478181,'value':_0xcd2522,'radius':_0x485345});}}return{'min':_0x314e14,'max':_0x3fc841,'data':_0x23dd44};};function _0x4172ae(_0x550846){var _0x98116e=_0x36c2,_0x183b99=_0x550846['container'],_0x322118=this['shadowCanvas']=document['createElement']('canvas'),_0x116117=this['canvas']=_0x550846['canvas']||document['createElement']('canvas');this['_renderBoundaries']=[0x2710,0x2710,0x0,0x0];var _0xc8809=getComputedStyle(_0x550846['container'])||{};_0x116117[_0x98116e(0x194)]='heatmap-canvas',this['_width']=_0x116117['width']=_0x322118[_0x98116e(0x1c4)]=_0x550846[_0x98116e(0x1c4)]||+_0xc8809[_0x98116e(0x1c4)][_0x98116e(0x15c)](/px/,''),this[_0x98116e(0x144)]=_0x116117['height']=_0x322118['height']=_0x550846[_0x98116e(_0x55ed14._0x2541b4)]||+_0xc8809['height'][_0x98116e(0x15c)](/px/,''),this['shadowCtx']=_0x322118['getContext']('2d',{'willReadFrequently':!![]}),this[_0x98116e(_0x55ed14._0x104501)]=_0x116117[_0x98116e(0x1ab)]('2d',{'willReadFrequently':!![]}),_0x116117['style']['cssText']=_0x322118['style'][_0x98116e(_0x55ed14._0x5706d7)]='position:absolute;left:0;top:0;',_0x183b99[_0x98116e(_0x55ed14._0x1c7f33)]['position']='relative',_0x183b99['appendChild'](_0x116117),this['_palette']=_0x5ec7e6(_0x550846),this['_templates']={},this['_setStyles'](_0x550846);}return _0x4172ae['prototype']={'renderPartial':function(_0x2a278f){var _0x35ffed=_0x36c2;_0x2a278f['data']['length']>0x0&&(this[_0x35ffed(_0x283bd4._0x208eff)](_0x2a278f),this['_colorize']());},'renderAll':function(_0x2f0548){this['_clear'](),_0x2f0548['data']['length']>0x0&&(this['_drawAlpha'](_0x2ee3fe(_0x2f0548)),this['_colorize']());},'_updateGradient':function(_0x585725){this['_palette']=_0x5ec7e6(_0x585725);},'updateConfig':function(_0x586c5e){var _0x4591eb=_0x36c2;_0x586c5e[_0x4591eb(0x180)]&&this['_updateGradient'](_0x586c5e),this['_setStyles'](_0x586c5e);},'setDimensions':function(_0x360a8e,_0x5bee5f){var _0x56bd99=_0x36c2;this['_width']=_0x360a8e,this['_height']=_0x5bee5f,this['canvas']['width']=this['shadowCanvas']['width']=_0x360a8e,this['canvas']['height']=this[_0x56bd99(0x186)]['height']=_0x5bee5f;},'_clear':function(){var _0xfb6dcb=_0x36c2;this[_0xfb6dcb(0x12c)]['clearRect'](0x0,0x0,this['_width'],this['_height']),this['ctx'][_0xfb6dcb(_0x263de7._0x294ea1)](0x0,0x0,this['_width'],this[_0xfb6dcb(0x144)]);},'_setStyles':function(_0x1219f2){var _0x37c9e6=_0x36c2;this[_0x37c9e6(_0x31337c._0x548b6f)]=_0x1219f2[_0x37c9e6(0x1b3)]==0x0?0x0:_0x1219f2[_0x37c9e6(0x1b3)]||_0x1219f2[_0x37c9e6(0x155)],_0x1219f2['backgroundColor']&&(this['canvas']['style']['backgroundColor']=_0x1219f2['backgroundColor']),this['_width']=this['canvas'][_0x37c9e6(_0x31337c._0xc15b7a)]=this[_0x37c9e6(0x186)]['width']=_0x1219f2['width']||this['_width'],this['_height']=this['canvas']['height']=this['shadowCanvas']['height']=_0x1219f2['height']||this['_height'],this[_0x37c9e6(0x158)]=(_0x1219f2['opacity']||0x0)*0xff,this[_0x37c9e6(_0x31337c._0x5b3586)]=(_0x1219f2['maxOpacity']||_0x1219f2['defaultMaxOpacity'])*0xff,this['_minOpacity']=(_0x1219f2[_0x37c9e6(_0x31337c._0x5d5832)]||_0x1219f2['defaultMinOpacity'])*0xff,this[_0x37c9e6(0x152)]=!!_0x1219f2['useGradientOpacity'];},'_drawAlpha':function(_0x364229){var _0x525179=_0x36c2,_0x24ea7e=this['_min']=_0x364229['min'],_0x2ca24b=this['_max']=_0x364229['max'],_0x364229=_0x364229['data']||[],_0x25957a=_0x364229[_0x525179(_0x1dc793._0x247f9e)],_0x16860d=0x1-this['_blur'];while(_0x25957a--){var _0x33c7bb=_0x364229[_0x25957a],_0x1c45d5=_0x33c7bb['x'],_0x2eafbb=_0x33c7bb['y'],_0x3bd960=_0x33c7bb['radius'],_0x26e434=Math['min'](_0x33c7bb['value'],_0x2ca24b),_0x448d19=_0x1c45d5-_0x3bd960,_0x11ea96=_0x2eafbb-_0x3bd960,_0xe6ca0d=this['shadowCtx'],_0x5a7dd6;!this['_templates'][_0x3bd960]?this['_templates'][_0x3bd960]=_0x5a7dd6=_0x2f3f83(_0x3bd960,_0x16860d):_0x5a7dd6=this['_templates'][_0x3bd960];var _0x33e3d5=(_0x26e434-_0x24ea7e)/(_0x2ca24b-_0x24ea7e);_0xe6ca0d[_0x525179(_0x1dc793._0xbaca1e)]=_0x33e3d5<0.01?0.01:_0x33e3d5,_0xe6ca0d['drawImage'](_0x5a7dd6,_0x448d19,_0x11ea96),_0x448d19<this[_0x525179(0x16f)][0x0]&&(this['_renderBoundaries'][0x0]=_0x448d19),_0x11ea96<this['_renderBoundaries'][0x1]&&(this[_0x525179(0x16f)][0x1]=_0x11ea96),_0x448d19+0x2*_0x3bd960>this['_renderBoundaries'][0x2]&&(this['_renderBoundaries'][0x2]=_0x448d19+0x2*_0x3bd960),_0x11ea96+0x2*_0x3bd960>this['_renderBoundaries'][0x3]&&(this[_0x525179(0x16f)][0x3]=_0x11ea96+0x2*_0x3bd960);}},'_colorize':function(){var _0x491949=_0x36c2,_0x43fac3=this['_renderBoundaries'][0x0],_0x88e1b1=this['_renderBoundaries'][0x1],_0x276b03=this[_0x491949(_0x359510._0x57b9df)][0x2]-_0x43fac3,_0x46d55b=this['_renderBoundaries'][0x3]-_0x88e1b1,_0x287e17=this['_width'],_0x2a3154=this[_0x491949(0x144)],_0x1ff8b3=this['_opacity'],_0x42eb9d=this['_maxOpacity'],_0xbaacb1=this[_0x491949(0x183)],_0x4d2ea6=this['_useGradientOpacity'];_0x43fac3<0x0&&(_0x43fac3=0x0);_0x88e1b1<0x0&&(_0x88e1b1=0x0);_0x43fac3+_0x276b03>_0x287e17&&(_0x276b03=_0x287e17-_0x43fac3);_0x88e1b1+_0x46d55b>_0x2a3154&&(_0x46d55b=_0x2a3154-_0x88e1b1);var _0x22c08f=this[_0x491949(_0x359510._0x44057a)]['getImageData'](_0x43fac3,_0x88e1b1,_0x276b03,_0x46d55b),_0x352301=_0x22c08f[_0x491949(0x1a8)],_0x268eaf=_0x352301['length'],_0x2cfa76=this['_palette'];for(var _0x55d28c=0x3;_0x55d28c<_0x268eaf;_0x55d28c+=0x4){var _0x3ce7fe=_0x352301[_0x55d28c],_0x404151=_0x3ce7fe*0x4;if(!_0x404151)continue;var _0x190675;_0x1ff8b3>0x0?_0x190675=_0x1ff8b3:_0x3ce7fe<_0x42eb9d?_0x3ce7fe<_0xbaacb1?_0x190675=_0xbaacb1:_0x190675=_0x3ce7fe:_0x190675=_0x42eb9d,_0x352301[_0x55d28c-0x3]=_0x2cfa76[_0x404151],_0x352301[_0x55d28c-0x2]=_0x2cfa76[_0x404151+0x1],_0x352301[_0x55d28c-0x1]=_0x2cfa76[_0x404151+0x2],_0x352301[_0x55d28c]=_0x4d2ea6?_0x2cfa76[_0x404151+0x3]:_0x190675;}this[_0x491949(_0x359510._0x2ac8ab)][_0x491949(0x150)](_0x22c08f,_0x43fac3,_0x88e1b1),this['_renderBoundaries']=[0x3e8,0x3e8,0x0,0x0];},'getValueAt':function(_0x2c3682){var _0x1c59fd=_0x36c2,_0x1a64d9,_0x6f9904=this['shadowCtx'],_0x5e2040=_0x6f9904[_0x1c59fd(0x14e)](_0x2c3682['x'],_0x2c3682['y'],0x1,0x1),_0x573e8d=_0x5e2040['data'][0x3],_0x523bbb=this[_0x1c59fd(0x1b9)],_0x1c352a=this['_min'];return _0x1a64d9=Math['abs'](_0x523bbb-_0x1c352a)*(_0x573e8d/0xff)>>0x0,_0x1a64d9;},'getDataURL':function(){var _0x30bd80=_0x36c2;return this[_0x30bd80(_0x38d1d6._0x419bb2)]['toDataURL']();}},_0x4172ae;}(),_0x35913a=function _0x2d4fc9(){var _0x2a8303=_0x404b27,_0x3a5225=![];return _0x5c3956['defaultRenderer']===_0x2a8303(_0x41c370._0x416c69)&&(_0x3a5225=_0x514f7d),_0x3a5225;}(),_0x27593c={'merge':function(){var _0x267778=_0x404b27,_0x38f5e6={},_0x474c69=arguments[_0x267778(_0x5c19f8._0x37d85e)];for(var _0x3a3c49=0x0;_0x3a3c49<_0x474c69;_0x3a3c49++){var _0x218ffd=arguments[_0x3a3c49];for(var _0x296a11 in _0x218ffd){_0x38f5e6[_0x296a11]=_0x218ffd[_0x296a11];}}return _0x38f5e6;}},_0x2db50e=function _0x1d435c(){var _0x53e9e2={_0xe4f146:0x13b},_0x4d3323={_0x22354e:0x17c,_0x541d70:0x137,_0x4e0fe4:0x151},_0x13c748={_0x1427ba:0x1a0},_0xf51d0={_0x8b4cd9:0x130,_0x9f50c2:0x166},_0x3e74d3=function _0x5e3ad0(){function _0x374bb8(){this['cStore']={};}return _0x374bb8['prototype']={'on':function(_0x2e5cee,_0x1e7e8d,_0x15c929){var _0x564e7f=this['cStore'];!_0x564e7f[_0x2e5cee]&&(_0x564e7f[_0x2e5cee]=[]),_0x564e7f[_0x2e5cee]['push'](function(_0x2acd4c){return _0x1e7e8d['call'](_0x15c929,_0x2acd4c);});},'emit':function(_0x332e00,_0x120946){var _0x3491a2=_0x36c2,_0x7b9326=this['cStore'];if(_0x7b9326[_0x332e00]){var _0x32ee58=_0x7b9326[_0x332e00][_0x3491a2(0x145)];for(var _0x1ecadb=0x0;_0x1ecadb<_0x32ee58;_0x1ecadb++){var _0x1aa126=_0x7b9326[_0x332e00][_0x1ecadb];_0x1aa126(_0x120946);}}}},_0x374bb8;}(),_0x5a5828=function(_0x42e296){var _0x7f3c9e={_0x1f65f2:0x1a3,_0x416e60:0x1c1},_0x3ad099=_0x36c2,_0x2e26e5=_0x42e296['_renderer'],_0x3dc1e8=_0x42e296['_coordinator'],_0x3361f5=_0x42e296[_0x3ad099(0x1a1)];_0x3dc1e8['on']('renderpartial',_0x2e26e5[_0x3ad099(_0xf51d0._0x8b4cd9)],_0x2e26e5),_0x3dc1e8['on'](_0x3ad099(_0xf51d0._0x9f50c2),_0x2e26e5['renderAll'],_0x2e26e5),_0x3dc1e8['on']('extremachange',function(_0x5ce779){var _0x25dc75=_0x3ad099;_0x42e296[_0x25dc75(0x175)][_0x25dc75(_0x7f3c9e._0x1f65f2)]&&_0x42e296[_0x25dc75(0x175)]['onExtremaChange']({'min':_0x5ce779['min'],'max':_0x5ce779['max'],'gradient':_0x42e296['_config']['gradient']||_0x42e296['_config'][_0x25dc75(_0x7f3c9e._0x416e60)]});}),_0x3361f5['setCoordinator'](_0x3dc1e8);};function _0x4ddf56(){var _0x61ff83=_0x36c2,_0x3a1604=this['_config']=_0x27593c['merge'](_0x5c3956,arguments[0x0]||{});this['_coordinator']=new _0x3e74d3();if(_0x3a1604['plugin']){var _0x4b5e59=_0x3a1604[_0x61ff83(0x1b6)];if(!_0x5c3956['plugins'][_0x4b5e59])throw new Error(_0x61ff83(_0x462eb2._0x49ee26)+_0x4b5e59+'\x27\x20not\x20found.\x20Maybe\x20it\x20was\x20not\x20registered.');else{var _0x165333=_0x5c3956['plugins'][_0x4b5e59];this['_renderer']=new _0x165333['renderer'](_0x3a1604),this['_store']=new _0x165333['store'](_0x3a1604);}}else this['_renderer']=new _0x35913a(_0x3a1604),this[_0x61ff83(0x1a1)]=new _0x44db11(_0x3a1604);_0x5a5828(this);}return _0x4ddf56['prototype']={'addData':function(){var _0x4cab98=_0x36c2;return this[_0x4cab98(0x1a1)][_0x4cab98(_0x297d83._0xfe4f39)]['apply'](this[_0x4cab98(_0x297d83._0x446d63)],arguments),this;},'removeData':function(){var _0x18a4fd=_0x36c2;return this['_store']['removeData']&&this[_0x18a4fd(_0x18f6fe._0x4b8e9b)]['removeData'][_0x18a4fd(0x195)](this['_store'],arguments),this;},'setData':function(){var _0x1fcd58=_0x36c2;return this['_store'][_0x1fcd58(_0x524bae._0x41b5f2)][_0x1fcd58(0x195)](this['_store'],arguments),this;},'setDataMax':function(){var _0x48d72d=_0x36c2;return this['_store'][_0x48d72d(_0x13c748._0x1427ba)][_0x48d72d(0x195)](this['_store'],arguments),this;},'setDataMin':function(){var _0x401ebc=_0x36c2;return this['_store']['setDataMin'][_0x401ebc(0x195)](this['_store'],arguments),this;},'configure':function(_0x4be039){var _0x373959=_0x36c2;return this['_config']=_0x27593c['merge'](this['_config'],_0x4be039),this[_0x373959(_0x4d3323._0x22354e)][_0x373959(_0x4d3323._0x541d70)](this['_config']),this[_0x373959(_0x4d3323._0x4e0fe4)][_0x373959(0x141)]('renderall',this['_store'][_0x373959(0x13b)]()),this;},'repaint':function(){var _0x37962b=_0x36c2;return this['_coordinator']['emit']('renderall',this['_store'][_0x37962b(_0x53e9e2._0xe4f146)]()),this;},'getData':function(){return this['_store']['getData']();},'getDataURL':function(){var _0x323d28=_0x36c2;return this[_0x323d28(0x17c)]['getDataURL']();},'getValueAt':function(_0xcb737d){var _0x47476f=_0x36c2;if(this[_0x47476f(_0x15c3e6._0x4c7917)]['getValueAt'])return this[_0x47476f(0x1a1)][_0x47476f(_0x15c3e6._0x5639d7)](_0xcb737d);else return this['_renderer']['getValueAt']?this[_0x47476f(0x17c)]['getValueAt'](_0xcb737d):null;}},_0x4ddf56;}(),_0x19ba18={'create':function(_0x57ce3d){return new _0x2db50e(_0x57ce3d);},'register':function(_0x34a9dd,_0x397ea9){_0x5c3956['plugins'][_0x34a9dd]=_0x397ea9;}};return _0x19ba18;}));}(heatmap$1));function _0x23de(){var _0x1b1965=['8325devDsM','height','_min','minOpacity','10715432llHeYI','_drawAlpha','defineProperty','_graphic','setDataMax','_store','StencilOperation','onExtremaChange','PointTrans','clientHeight','graphic','image','data','__esModule','clearRect','getContext','_yField','default','210NezOPP','create','_graphic2','lng','max','blur','getPointData','xmin','plugin','layer','positions','_max','StencilFunction','rgb(0,255,0)','round','get','35050MnYtvl','57xCyCCp','cssText','defaultGradient','ymax','MaterialType','width','lonlat2mercator','EllipsoidSurfaceAppearance','_radi','xmax','clientWidth','shadowCtx','register','_container','108635xZlDQA','renderPartial','DomUtil','_onExtremaChange','minCanvasSize','isArray','_blur','canvas','updateConfig','rgb(216,216,216)','REPLACE','maxCanvasSize','_getInternalData','_data','114122KTpVdB','style','_positions','merge','emit','8458555jKozNC','removeGraphic','_height','length','EPSG:3857','keys','image/png','configure','yField','ImageLayer','forEach','diffHeight','getImageData','rectangle','putImageData','_coordinator','_useGradientOpacity','createRadialGradient','_heat','defaultBlur','setDataMin','show','_opacity','_maxOpacity','xField','uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a','replace','arcDirection','canvas2d','_xField','uniforms','parse','ALWAYS','getRectangle','options','splitNum','renderall','BlendingState','removeLayer','_layer','KEEP','heatStyle','setData','valueField','exports','_renderBoundaries','lat','_getArcHeatCanvas','value','fillRect','radius','_config','call','push','MaterialUtil','getOwnPropertyDescriptor','BaseLayer','_last_mBounds','_renderer','yellow','ymin','ctx','gradient','addGraphic','remove','_minOpacity','defaultYField','748826qdbvur','shadowCanvas','renderpartial','toArray','getValueAt','prototype','_rectangle','floor','Plugin\x20\x27','RenderState','_mBoundsMax','addPosition','div','addData','min','className','apply','42788fAgnoy','globalAlpha'];_0x23de=function(){return _0x1b1965;};return _0x23de();}function _0x36c2(_0x55fa4e,_0x442d5f){var _0x23de80=_0x23de();return _0x36c2=function(_0x36c2ab,_0x7cd5aa){_0x36c2ab=_0x36c2ab-0x128;var _0x2eaf33=_0x23de80[_0x36c2ab];return _0x2eaf33;},_0x36c2(_0x55fa4e,_0x442d5f);}var heatmap=heatmap$1['exports'],h337=_mergeNamespaces({'__proto__':null,'default':heatmap},[heatmap$1['exports']]),HeatMaterial=_0x1388eb(0x15b);if(!heatmap$1[_0x1388eb(0x16e)][_0x1388eb(0x1af)])throw new Error('请引入\x20heatmap.js\x20库\x20');const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace[_0x1388eb(0x1b7)][_0x1388eb(0x17a)],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:'blue',0.6:'green',0.8:'yellow',0.9:'red'}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium['EllipsoidSurfaceAppearance']['VERTEX_FORMAT']};class HeatLayer extends BaseLayer{constructor(_0x1d2ecc={}){var _0x4f627a={_0xe429f8:0x12b,_0x1f817b:0x193,_0x36b38e:0x13a},_0x448172=_0x1388eb;super(_0x1d2ecc),this['options']['maxCanvasSize']=this['options']['maxCanvasSize']??document['body'][_0x448172(_0x4f627a._0xe429f8)],this['options']['maxCanvasSize']=Math[_0x448172(_0x4f627a._0x1f817b)](this['options'][_0x448172(_0x4f627a._0x36b38e)],0x1388),this['options']['minCanvasSize']=this['options']['minCanvasSize']??document['body'][_0x448172(0x1a5)],this['options']['minCanvasSize']=Math['max'](this['options'][_0x448172(0x133)],0x2bc),this[_0x448172(0x164)][_0x448172(0x16b)]={...DEF_HEATSTYLE,...this['options']['heatStyle']},this['options'][_0x448172(0x13e)]={...DEF_STYLE,...this[_0x448172(0x164)]['style']};}get[_0x1388eb(0x1b7)](){return this['_layer'];}get['heatStyle'](){return this['options']['heatStyle'];}set['heatStyle'](_0x5f051f){var _0x2dcff2=_0x1388eb;this['options'][_0x2dcff2(0x16b)]=mars3d__namespace['Util']['merge'](this['options']['heatStyle'],_0x5f051f),this['_heat']&&(this['_heat']['configure'](this[_0x2dcff2(0x164)]['heatStyle']),this['_updatePositionsHook'](!![]));}get['style'](){var _0x810fd7=_0x1388eb;return this[_0x810fd7(0x164)]['style'];}set['style'](_0x4a502d){var _0x5db1f3={_0x1f3181:0x164},_0x4194a4=_0x1388eb;this['options']['style']=mars3d__namespace['Util'][_0x4194a4(0x140)](this[_0x4194a4(_0x5db1f3._0x1f3181)][_0x4194a4(0x13e)],_0x4a502d);}get['positions'](){return this['_positions'];}set['positions'](_0x97d4ca){this['setPositions'](_0x97d4ca);}get['coordinates'](){var _0x2efd1a={_0x3c44b1:0x177,_0x38a0a0:0x188};const _0x4ef281=[];return this['points']['forEach'](_0x2d285=>{var _0x239eaf=_0x36c2;_0x4ef281[_0x239eaf(_0x2efd1a._0x3c44b1)](_0x2d285[_0x239eaf(_0x2efd1a._0x38a0a0)]());}),_0x4ef281;}get['rectangle'](){var _0x106b26=_0x1388eb;return this[_0x106b26(0x18b)];}['_setOptionsHook'](_0x2567e1,_0xf1efc4){var _0x109df7=_0x1388eb;_0x2567e1['positions']&&(this[_0x109df7(0x1b8)]=_0x2567e1['positions']);}['_mountedHook'](){var _0x3cac57=_0x1388eb;this['style']['type']==='image'?this['_layer']=new mars3d__namespace['layer'][(_0x3cac57(0x14b))]({'crs':_0x3cac57(0x146),'private':!![]}):this['_layer']=new mars3d__namespace[(_0x3cac57(0x1b7))]['GraphicLayer']({'private':!![]});}['_addedHook'](){var _0x1f2138={_0x1c2941:0x1af,_0x2b0334:0x1b8},_0x2fe20f=_0x1388eb;this['_map']['addLayer'](this['_layer']),this['_container']=mars3d__namespace['DomUtil'][_0x2fe20f(_0x1f2138._0x1c2941)](_0x2fe20f(0x191),'mars3d-heatmap\x20mars3d-hideDiv',this['_map']['container']),this['options']['positions']&&(this['positions']=this['options'][_0x2fe20f(_0x1f2138._0x2b0334)]),this['options']['flyTo']&&this['flyToByAnimationEnd']();}['_removedHook'](){var _0x20db8a={_0x2897b:0x182,_0x21adf3:0x168},_0x595a98=_0x1388eb;this['_container']&&(mars3d__namespace['DomUtil'][_0x595a98(_0x20db8a._0x2897b)](this[_0x595a98(0x12e)]),delete this[_0x595a98(0x12e)]),this['clear'](),this['_map'][_0x595a98(_0x20db8a._0x21adf3)](this['_layer']);}[_0x1388eb(0x190)](_0x19931a,_0x52c69a){var _0x56dd0e=_0x1388eb;this['_positions']=this[_0x56dd0e(0x13f)]||[],this['_positions']['push'](_0x19931a),this['_updatePositionsHook'](_0x52c69a);}['setPositions'](_0x1a1d3b,_0xd82c3e){var _0x1ba289={_0x3a3780:0x13f},_0x164b8f=_0x1388eb;this[_0x164b8f(_0x1ba289._0x3a3780)]=_0x1a1d3b,this['_updatePositionsHook'](_0xd82c3e);}['clear'](){var _0x2ebec6={_0x549923:0x143},_0x22a5ea=_0x1388eb;this['_graphic']&&(this['_layer']['removeGraphic'](this['_graphic'],!![]),delete this['_graphic']),this['_graphic2']&&(this[_0x22a5ea(0x169)][_0x22a5ea(_0x2ebec6._0x549923)](this[_0x22a5ea(0x1b0)],!![]),delete this['_graphic2']);}['_updatePositionsHook'](_0x2c4903){var _0x1ea09f={_0x1dc370:0x157,_0xde4a49:0x13e,_0x2e9263:0x19f,_0x43315a:0x1b0,_0x3c4c81:0x1a7},_0x595f5e=_0x1388eb;if(!this[_0x595f5e(_0x1ea09f._0x1dc370)]||!this['_map']||!this['positions']||this['positions'][_0x595f5e(0x145)]===0x0)return this;const _0x5ee4c9=this['_getHeatCanvas']();if(this['style']['type']==='image')this['_layer']['setOptions']({'url':_0x5ee4c9['toDataURL'](_0x595f5e(0x148),0x1),'rectangle':this['_rectangle'],'opacity':this[_0x595f5e(_0x1ea09f._0xde4a49)]['opacity']});else this['style']['arc']?this[_0x595f5e(_0x1ea09f._0x2e9263)]&&_0x2c4903?(this[_0x595f5e(0x19f)]['uniforms']['image']=_0x5ee4c9,this['_graphic']['uniforms']['bumpMap']=this['_getArcHeatCanvas'](),this['_graphic2']&&(this[_0x595f5e(_0x1ea09f._0x43315a)]['uniforms']['image']=_0x5ee4c9,this[_0x595f5e(_0x1ea09f._0x43315a)]['uniforms']['bumpMap']=this[_0x595f5e(0x19f)][_0x595f5e(0x160)]['bumpMap'])):this['_createArcGraphic'](_0x5ee4c9):this['_graphic']&&_0x2c4903?this['_graphic']['uniforms'][_0x595f5e(_0x1ea09f._0x3c4c81)]=_0x5ee4c9:this['_createGraphic'](_0x5ee4c9);return this;}['_createGraphic'](_0x5be7d6){var _0x268ee8={_0x56e151:0x128,_0x1da88a:0x1c3,_0x25d302:0x19f},_0x52467e=_0x1388eb;this['clear'](),this['_graphic']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this[_0x52467e(0x164)],'rectangle':this[_0x52467e(0x18b)],'appearance':new Cesium[(_0x52467e(_0x268ee8._0x56e151))]({'material':mars3d__namespace[_0x52467e(0x178)]['createMaterial'](mars3d__namespace[_0x52467e(_0x268ee8._0x1da88a)]['Image2'],{'image':_0x5be7d6}),'flat':!![]})}),this['_layer']['addGraphic'](this[_0x52467e(_0x268ee8._0x25d302)]);}['_createArcGraphic'](_0x1973da){var _0x33316b={_0x523ab9:0x16a,_0x5f3dad:0x1ba,_0x395d01:0x1a2,_0x129278:0x16a,_0x2f8551:0x13e,_0x485d4d:0x14d,_0x181e80:0x18b,_0x4fbaaf:0x181,_0x4d77bb:0x19f},_0x363bc7=_0x1388eb;this['clear']();const _0x456dfc=Cesium[_0x363bc7(0x18e)]['fromCache']({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium[_0x363bc7(0x1ba)]['ALWAYS'],'frontOperation':{'fail':Cesium['StencilOperation'][_0x363bc7(_0x33316b._0x523ab9)],'zFail':Cesium[_0x363bc7(0x1a2)]['KEEP'],'zPass':Cesium['StencilOperation']['REPLACE']},'backFunction':Cesium[_0x363bc7(_0x33316b._0x5f3dad)][_0x363bc7(0x162)],'backOperation':{'fail':Cesium[_0x363bc7(_0x33316b._0x395d01)]['KEEP'],'zFail':Cesium['StencilOperation'][_0x363bc7(_0x33316b._0x129278)],'zPass':Cesium['StencilOperation'][_0x363bc7(0x139)]},'reference':0x2,'mask':0x2},'blending':Cesium[_0x363bc7(0x167)]['ALPHA_BLEND']}),_0x12c02b=Math[_0x363bc7(0x18c)](this[_0x363bc7(_0x33316b._0x2f8551)]['diffHeight']??this['_mBoundsMax']*0.02)+0.1;this['style'][_0x363bc7(_0x33316b._0x485d4d)]&&delete this['style'][_0x363bc7(0x14d)];const _0x2c0d7b=(this['style'][_0x363bc7(0x165)],0x64);let _0xa85247=Math[_0x363bc7(0x1b2)](this['_rectangle']['height'],this[_0x363bc7(_0x33316b._0x181e80)][_0x363bc7(0x1c4)]);this['style']['granularity']=_0xa85247/=_0x2c0d7b;const _0x5c17c9=new Cesium['Material']({'fabric':{'uniforms':{'image':_0x1973da,'repeat':new Cesium['Cartesian2'](0x1,0x1),'color':new Cesium['Color'](0x1,0x1,0x1,0x0),'bumpMap':this['_getArcHeatCanvas']()},'source':HeatMaterial},'translucent':!![]}),_0x2765a8=this['style'][_0x363bc7(0x15d)]||0x1;this['_graphic']=new mars3d__namespace[(_0x363bc7(0x1a6))]['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x456dfc,'material':_0x5c17c9,'vertexShaderSource':getVertexShaderSource(_0x12c02b*_0x2765a8)})}),this[_0x363bc7(0x169)][_0x363bc7(_0x33316b._0x4fbaaf)](this[_0x363bc7(_0x33316b._0x4d77bb)]),this['style']['arcDirection']===0x0&&(this['_graphic2']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x456dfc,'material':_0x5c17c9,'vertexShaderSource':getVertexShaderSource(-_0x12c02b)})}),this['_layer']['addGraphic'](this['_graphic2']));}[_0x1388eb(0x163)](_0x151144){var _0x5a05cb={_0x474f4b:0x18b},_0x3a85b1=_0x1388eb;return _0x151144!==null&&_0x151144!==void 0x0&&_0x151144['isFormat']&&this[_0x3a85b1(_0x5a05cb._0x474f4b)]?mars3d__namespace['PolyUtil']['formatRectangle'](this['_rectangle']):this['_rectangle'];}['_getHeatCanvas'](){var _0x94bf20={_0x553177:0x14c,_0x24aede:0x14f,_0x2841ca:0x12a,_0x46686d:0x133,_0x2304c1:0x17e,_0x3a0435:0x1c2,_0x337844:0x17e,_0xdfad44:0x17b,_0x416e0b:0x1b5,_0x5b5c8c:0x12a,_0x26c94f:0x17b},_0x2ea10b={_0xace563:0x1c5,_0xa33445:0x193},_0x2ab900={_0x5a15bb:0x193,_0x47e576:0x1b1,_0x4c54f9:0x193,_0x5c93f7:0x170},_0x8f7c75=_0x1388eb;const _0x5cdb7f=this[_0x8f7c75(0x13f)],_0x3e4112=[];let _0x5d6d3a,_0x2d7918,_0x256bee,_0x21ee99;_0x5cdb7f[_0x8f7c75(_0x94bf20._0x553177)](_0xd9e28a=>{var _0x7853dc=_0x8f7c75;const _0x7aa9cb=mars3d__namespace['LngLatPoint']['parse'](_0xd9e28a);if(!_0x7aa9cb)return;_0x7aa9cb['value']=_0xd9e28a['value']||0x1,!this['options'][_0x7853dc(0x14f)]&&(_0x5d6d3a===undefined?(_0x5d6d3a=_0x7aa9cb['lng'],_0x2d7918=_0x7aa9cb['lng'],_0x256bee=_0x7aa9cb['lat'],_0x21ee99=_0x7aa9cb['lat']):(_0x5d6d3a=Math[_0x7853dc(_0x2ab900._0x5a15bb)](_0x5d6d3a,_0x7aa9cb[_0x7853dc(_0x2ab900._0x47e576)]),_0x2d7918=Math['max'](_0x2d7918,_0x7aa9cb['lng']),_0x256bee=Math[_0x7853dc(_0x2ab900._0x4c54f9)](_0x256bee,_0x7aa9cb['lat']),_0x21ee99=Math['max'](_0x21ee99,_0x7aa9cb[_0x7853dc(_0x2ab900._0x5c93f7)]))),_0x3e4112['push'](_0x7aa9cb);});_0x5d6d3a===_0x2d7918&&(_0x5d6d3a-=0.000001,_0x2d7918+=0.000001);_0x256bee===_0x21ee99&&(_0x256bee-=0.000001,_0x21ee99+=0.000001);let _0x4cdc64=this['options'][_0x8f7c75(_0x94bf20._0x24aede)]||{'xmin':_0x5d6d3a,'xmax':_0x2d7918,'ymin':_0x256bee,'ymax':_0x21ee99};const _0x1082fe=getMercatorBounds(_0x4cdc64),_0x18f553=Math['abs'](_0x1082fe[_0x8f7c75(_0x94bf20._0x2841ca)]-_0x1082fe['xmin']),_0x21e7f0=Math['abs'](_0x1082fe['ymax']-_0x1082fe['ymin']),_0x5b82bf=Math[_0x8f7c75(0x1b2)](_0x18f553,_0x21e7f0),_0x33407a=Math['min'](_0x18f553,_0x21e7f0);this[_0x8f7c75(0x18f)]=_0x5b82bf;let _0x2825f5=0x1;if(_0x5b82bf>this['options'][_0x8f7c75(0x13a)])_0x2825f5=_0x5b82bf/this['options']['maxCanvasSize'],_0x33407a/_0x2825f5<this['options'][_0x8f7c75(_0x94bf20._0x46686d)]&&(_0x2825f5=_0x33407a/this['options']['minCanvasSize']);else _0x33407a<this[_0x8f7c75(0x164)]['minCanvasSize']&&(_0x2825f5=_0x33407a/this['options']['minCanvasSize'],_0x5b82bf/_0x2825f5>this['options']['maxCanvasSize']&&(_0x2825f5=_0x5b82bf/this[_0x8f7c75(0x164)]['maxCanvasSize']));const _0x141676=this['heatStyle']['radius']*1.5,_0x3db56a=_0x18f553/_0x2825f5+_0x141676*0x2,_0x35cc3d=_0x21e7f0/_0x2825f5+_0x141676*0x2,_0x44c036=_0x141676*_0x2825f5;_0x1082fe['xmin']-=_0x44c036,_0x1082fe[_0x8f7c75(_0x94bf20._0x2304c1)]-=_0x44c036,_0x1082fe['xmax']+=_0x44c036,_0x1082fe['ymax']+=_0x44c036,_0x1082fe['xmin']=Math['max'](_0x1082fe['xmin'],-20037508.34),_0x1082fe['xmax']=Math['min'](_0x1082fe[_0x8f7c75(_0x94bf20._0x2841ca)],20037508.34),_0x1082fe['ymin']=Math[_0x8f7c75(0x1b2)](_0x1082fe['ymin'],-20037508.34),_0x1082fe['ymax']=Math['min'](_0x1082fe[_0x8f7c75(_0x94bf20._0x3a0435)],20037508.34),this['_scale']=_0x2825f5,_0x4cdc64=geLatLngBounds(_0x1082fe),this['_rectangle']=Cesium['Rectangle']['fromDegrees'](_0x4cdc64['xmin'],_0x4cdc64[_0x8f7c75(_0x94bf20._0x337844)],_0x4cdc64[_0x8f7c75(_0x94bf20._0x2841ca)],_0x4cdc64['ymax']);let _0x46ee59=_0x3e4112[0x0]['value']??0x1,_0x353d33=_0x3e4112[0x0][_0x8f7c75(0x172)]??0x0;const _0x2417dc=[];_0x3e4112['forEach'](_0x285ddc=>{var _0x49cbcc=_0x8f7c75;const _0x305555=mars3d__namespace['PointTrans'][_0x49cbcc(_0x2ea10b._0xace563)]([_0x285ddc['lng'],_0x285ddc['lat']]),_0x396044=_0x285ddc['value']||0x1,_0x5cca22=Math['round']((_0x305555[0x0]-_0x1082fe['xmin'])/_0x2825f5),_0xa84663=Math['round']((_0x1082fe['ymax']-_0x305555[0x1])/_0x2825f5);_0x46ee59=Math['max'](_0x46ee59,_0x396044),_0x353d33=Math[_0x49cbcc(_0x2ea10b._0xa33445)](_0x353d33,_0x396044),_0x2417dc[_0x49cbcc(0x177)]({'x':_0x5cca22,'y':_0xa84663,'value':_0x396044});});const _0x2562be={'min':this['options']['min']??_0x353d33,'max':this['options']['max']??_0x46ee59,'data':_0x2417dc};this['_last_heatData']=_0x2562be;if(!this[_0x8f7c75(_0x94bf20._0xdfad44)]||_0x1082fe[_0x8f7c75(_0x94bf20._0x416e0b)]!==this['_last_mBounds']['xmin']||_0x1082fe['ymin']!==this['_last_mBounds'][_0x8f7c75(_0x94bf20._0x337844)]||_0x1082fe[_0x8f7c75(_0x94bf20._0x5b5c8c)]!==this[_0x8f7c75(_0x94bf20._0x26c94f)]['xmax']||_0x1082fe['ymax']!==this[_0x8f7c75(0x17b)]['ymax']){this['_last_mBounds']=_0x1082fe,this[_0x8f7c75(0x12e)][_0x8f7c75(0x13e)][_0x8f7c75(0x1c0)]='width:'+_0x3db56a+'px;height:'+_0x35cc3d+'px;';const _0x3c378a={...this['heatStyle'],'container':this['_container']};!this[_0x8f7c75(0x154)]?this['_heat']=heatmap$1['exports']['create'](_0x3c378a):this['_heat'][_0x8f7c75(0x149)](_0x3c378a);}this['_heat']['setData'](_0x2562be);const _0x1ae8b7=mars3d__namespace[_0x8f7c75(0x131)]['copyCanvas'](this['_heat'][_0x8f7c75(0x17c)]['canvas']);return _0x1ae8b7;}[_0x1388eb(0x171)](){var _0x26d964={_0x52c315:0x16b,_0x1d5253:0x13e,_0x321620:0x138,_0x299e01:0x149},_0x509e81=_0x1388eb;this['_heat'][_0x509e81(0x149)]({'radius':this['heatStyle']['radius']*this[_0x509e81(0x13e)]['arcRadiusScale'],'blur':this[_0x509e81(_0x26d964._0x52c315)][_0x509e81(0x1b3)]*this[_0x509e81(_0x26d964._0x1d5253)]['arcBlurScale'],'gradient':this['heatStyle']['gradientArc']||{0.25:'rgb(0,0,0)',0.55:'rgb(140,140,140)',0.85:_0x509e81(_0x26d964._0x321620),0x1:'rgb(255,255,255)'}});const _0x47b2c5=mars3d__namespace['DomUtil']['copyCanvas'](this['_heat']['_renderer']['canvas']);return this['_heat'][_0x509e81(_0x26d964._0x299e01)](this['options']['heatStyle']),_0x47b2c5;}[_0x1388eb(0x1b4)](_0x1bb3b4){var _0x4c7578={_0x648686:0x1a4,_0x444420:0x1bc,_0x478982:0x1a8},_0x57c923=_0x1388eb;const _0x508a4c=mars3d__namespace['LngLatPoint'][_0x57c923(0x161)](_0x1bb3b4);if(!_0x508a4c)return{};const _0x83c96b=mars3d__namespace[_0x57c923(_0x4c7578._0x648686)]['lonlat2mercator']([_0x508a4c['lng'],_0x508a4c[_0x57c923(0x170)]]),_0xd6130=this['_last_mBounds'],_0x4a6fde=Math[_0x57c923(_0x4c7578._0x444420)]((_0x83c96b[0x0]-_0xd6130['xmin'])/this['_scale']),_0x5eac53=Math['round']((_0xd6130['ymax']-_0x83c96b[0x1])/this['_scale']),_0x280f89=this['_heat']['getValueAt']({'x':_0x4a6fde,'y':_0x5eac53}),_0x4fce82=this['_heat']['_renderer']['ctx']['getImageData'](_0x4a6fde-0x1,_0x5eac53-0x1,0x1,0x1)[_0x57c923(_0x4c7578._0x478982)];return{'x':_0x4a6fde,'y':_0x5eac53,'value':_0x280f89,'color':'rgba('+_0x4fce82[0x0]+','+_0x4fce82[0x1]+','+_0x4fce82[0x2]+','+_0x4fce82[0x3]+')'};}}mars3d__namespace['LayerUtil'][_0x1388eb(0x12d)]('heat',HeatLayer),mars3d__namespace['layer']['HeatLayer']=HeatLayer,mars3d__namespace['h337']=h337;function getMercatorBounds(_0x2e4046){const _0x4aec45=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x2e4046['xmin'],_0x2e4046['ymin']]),_0x55e990=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x2e4046['xmax'],_0x2e4046['ymax']]);return{'xmin':_0x4aec45[0x0],'ymin':_0x4aec45[0x1],'xmax':_0x55e990[0x0],'ymax':_0x55e990[0x1]};}function geLatLngBounds(_0x2956d9){var _0x3d5378=_0x1388eb;const _0x3830ae=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x2956d9[_0x3d5378(0x1b5)],_0x2956d9['ymin']]),_0x35eb6d=mars3d__namespace[_0x3d5378(0x1a4)]['mercator2lonlat']([_0x2956d9['xmax'],_0x2956d9['ymax']]);return{'xmin':_0x3830ae[0x0],'ymin':_0x3830ae[0x1],'xmax':_0x35eb6d[0x0],'ymax':_0x35eb6d[0x1]};}function getVertexShaderSource(_0x5c8ad4){return'in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20'+_0x5c8ad4+';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a';}exports['HeatLayer']=HeatLayer,Object['defineProperty'](exports,'__esModule',{'value':!![]});
}));
