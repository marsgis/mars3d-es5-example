/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.6.14
 * 编译日期：2023-11-28 09:43:07
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';const _0x520234=_0x462e;(function(_0x374a75,_0x1f361e){const _0x12d10a={_0x587877:0x1f0,_0x40ce4e:0x1ce,_0x28e63a:0x1a5,_0x512a3b:0x1ca,_0x55db4a:0x1ec,_0x2c2ebc:0x1ed,_0x311d95:0x1e0},_0x2db3ec=_0x462e,_0x5125ef=_0x374a75();while(!![]){try{const _0x1746b8=parseInt(_0x2db3ec(_0x12d10a._0x587877))/0x1+parseInt(_0x2db3ec(0x1de))/0x2+parseInt(_0x2db3ec(0x1bc))/0x3*(-parseInt(_0x2db3ec(0x1dd))/0x4)+-parseInt(_0x2db3ec(0x1d7))/0x5*(parseInt(_0x2db3ec(_0x12d10a._0x40ce4e))/0x6)+parseInt(_0x2db3ec(_0x12d10a._0x28e63a))/0x7*(parseInt(_0x2db3ec(_0x12d10a._0x512a3b))/0x8)+parseInt(_0x2db3ec(_0x12d10a._0x55db4a))/0x9*(-parseInt(_0x2db3ec(_0x12d10a._0x2c2ebc))/0xa)+parseInt(_0x2db3ec(_0x12d10a._0x311d95))/0xb*(parseInt(_0x2db3ec(0x1e5))/0xc);if(_0x1746b8===_0x1f361e)break;else _0x5125ef['push'](_0x5125ef['shift']());}catch(_0x5c3753){_0x5125ef['push'](_0x5125ef['shift']());}}}(_0x18a6,0xdf812));function _0x462e(_0x3ad16f,_0x9d91ec){const _0x18a64a=_0x18a6();return _0x462e=function(_0x462ec3,_0x2c4e52){_0x462ec3=_0x462ec3-0x193;let _0x17979d=_0x18a64a[_0x462ec3];return _0x17979d;},_0x462e(_0x3ad16f,_0x9d91ec);}function _interopNamespace(_0x42133e){const _0x29a238={_0x117f98:0x1ab},_0xd1fa7={_0x3a3c7f:0x1a3,_0x249542:0x1e6},_0x1afbb3=_0x462e;if(_0x42133e&&_0x42133e['__esModule'])return _0x42133e;var _0x59b6b9=Object[_0x1afbb3(_0x29a238._0x117f98)](null);return _0x42133e&&Object['keys'](_0x42133e)['forEach'](function(_0x352090){const _0x5cf053=_0x1afbb3;if(_0x352090!==_0x5cf053(_0xd1fa7._0x3a3c7f)){var _0x241dbf=Object['getOwnPropertyDescriptor'](_0x42133e,_0x352090);Object['defineProperty'](_0x59b6b9,_0x352090,_0x241dbf[_0x5cf053(_0xd1fa7._0x249542)]?_0x241dbf:{'enumerable':!![],'get':function(){return _0x42133e[_0x352090];}});}}),_0x59b6b9['default']=_0x42133e,_0x59b6b9;}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337),HeatMaterial='uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a';if(!h337__namespace[_0x520234(0x1ab)])throw new Error('请引入\x20heatmap.js\x20库\x20');const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace['layer'][_0x520234(0x1cf)],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:'blue',0.6:'green',0.8:'yellow',0.9:'red'}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium[_0x520234(0x1c5)]['VERTEX_FORMAT']};class HeatLayer extends BaseLayer{constructor(_0x329808={}){const _0x512151={_0x4687e3:0x19c,_0x3c14d5:0x1b0,_0x52fe0c:0x19c,_0x21179d:0x19e,_0x4fd8d5:0x19c},_0x1e07d6=_0x520234;super(_0x329808),this[_0x1e07d6(0x19c)]['maxCanvasSize']=this[_0x1e07d6(0x19c)]['maxCanvasSize']??document['body']['clientWidth'],this[_0x1e07d6(_0x512151._0x4687e3)]['maxCanvasSize']=Math['min'](this[_0x1e07d6(0x19c)]['maxCanvasSize'],0x1388),this['options'][_0x1e07d6(_0x512151._0x3c14d5)]=this['options'][_0x1e07d6(0x1b0)]??document[_0x1e07d6(0x19f)]['clientHeight'],this['options']['minCanvasSize']=Math['max'](this['options'][_0x1e07d6(0x1b0)],0x2bc),this['options']['heatStyle']={...DEF_HEATSTYLE,...this[_0x1e07d6(_0x512151._0x52fe0c)]['heatStyle']},this['options'][_0x1e07d6(_0x512151._0x21179d)]={...DEF_STYLE,...this[_0x1e07d6(_0x512151._0x4fd8d5)][_0x1e07d6(0x19e)]};}get['layer'](){return this['_layer'];}get['heatStyle'](){return this['options']['heatStyle'];}set['heatStyle'](_0x30a3fd){const _0x1cd665={_0x4255ae:0x1c2},_0x2c08ad=_0x520234;this['options']['heatStyle']=mars3d__namespace[_0x2c08ad(_0x1cd665._0x4255ae)]['merge'](this['options']['heatStyle'],_0x30a3fd),this['_heat']&&(this[_0x2c08ad(0x1a2)]['configure'](this[_0x2c08ad(0x19c)]['heatStyle']),this['_updatePositionsHook'](!![]));}get['style'](){const _0x46ceeb={_0x1794e3:0x19c},_0x1c190f=_0x520234;return this[_0x1c190f(_0x46ceeb._0x1794e3)]['style'];}set['style'](_0x4fa5ca){const _0x18be12=_0x520234;this['options'][_0x18be12(0x19e)]=mars3d__namespace[_0x18be12(0x1c2)][_0x18be12(0x1ae)](this['options']['style'],_0x4fa5ca);}get['positions'](){return this['_positions'];}set['positions'](_0xca1405){this['setPositions'](_0xca1405);}get['coordinates'](){const _0x4a6739=_0x520234,_0x1da141=[];return this['points'][_0x4a6739(0x1d0)](_0x4035c0=>{_0x1da141['push'](_0x4035c0['toArray']());}),_0x1da141;}get[_0x520234(0x196)](){const _0x33c285=_0x520234;return this[_0x33c285(0x1c1)];}['_setOptionsHook'](_0x2d7d65,_0x2c9a45){const _0x5ec456={_0x26cbd1:0x1cb},_0x2225ba=_0x520234;_0x2d7d65['positions']&&(this['positions']=_0x2d7d65[_0x2225ba(_0x5ec456._0x26cbd1)]);}['_mountedHook'](){const _0x31104b={_0x599c03:0x1df,_0x480cb1:0x19b,_0x91de4f:0x1a1},_0x554f83=_0x520234;this['style'][_0x554f83(_0x31104b._0x599c03)]===_0x554f83(0x1c3)?this['_layer']=new mars3d__namespace[(_0x554f83(_0x31104b._0x480cb1))]['ImageLayer']({'crs':_0x554f83(_0x31104b._0x91de4f),'private':!![]}):this['_layer']=new mars3d__namespace['layer']['GraphicLayer']({'private':!![]});}['_addedHook'](){const _0x557132={_0x35496b:0x1dc,_0x267125:0x1cb,_0x495e82:0x198},_0x2c9d1c=_0x520234;this['_map']['addLayer'](this[_0x2c9d1c(0x1cd)]),this[_0x2c9d1c(0x1c4)]=mars3d__namespace['DomUtil']['create']('div','mars3d-heatmap\x20mars3d-hideDiv',this[_0x2c9d1c(0x1e8)][_0x2c9d1c(_0x557132._0x35496b)]),this['options']['positions']&&(this[_0x2c9d1c(_0x557132._0x267125)]=this['options']['positions']),this['options']['flyTo']&&this[_0x2c9d1c(_0x557132._0x495e82)]();}['_removedHook'](){const _0x543e3d=_0x520234;this['_container']&&(mars3d__namespace[_0x543e3d(0x1be)]['remove'](this['_container']),delete this[_0x543e3d(0x1c4)]),this['clear'](),this[_0x543e3d(0x1e8)][_0x543e3d(0x1d5)](this[_0x543e3d(0x1cd)]);}['addPosition'](_0x2efeae,_0x3e5b62){const _0x189bdf=_0x520234;this['_positions']=this['_positions']||[],this[_0x189bdf(0x199)]['push'](_0x2efeae),this[_0x189bdf(0x1b8)](_0x3e5b62);}[_0x520234(0x1cc)](_0x33b729,_0x2fbb47){const _0x9a879f=_0x520234;this[_0x9a879f(0x199)]=_0x33b729,this['_updatePositionsHook'](_0x2fbb47);}['clear'](){const _0x3868b4={_0x26280f:0x1b6},_0x1cd251=_0x520234;this['_graphic']&&(this['_layer']['removeGraphic'](this['_graphic'],!![]),delete this[_0x1cd251(_0x3868b4._0x26280f)]),this['_graphic2']&&(this['_layer']['removeGraphic'](this['_graphic2'],!![]),delete this['_graphic2']);}[_0x520234(0x1b8)](_0x30037f){const _0x147ad1={_0x16c73b:0x1cd,_0x56f89e:0x1d8,_0x5a2104:0x1e2,_0x32803f:0x1bb,_0x9d58ce:0x1c3},_0x42dbfa=_0x520234;if(!this['show']||!this[_0x42dbfa(0x1e8)]||!this['positions']||this['positions']['length']===0x0)return this;const _0x291d4f=this['_getHeatCanvas']();if(this['style']['type']==='image')this[_0x42dbfa(_0x147ad1._0x16c73b)]['setOptions']({'url':_0x291d4f[_0x42dbfa(_0x147ad1._0x56f89e)]('image/png'),'rectangle':this['_rectangle'],'opacity':this['style'][_0x42dbfa(_0x147ad1._0x5a2104)]});else this['style'][_0x42dbfa(0x1a8)]?this['_graphic']&&_0x30037f?(this['_graphic'][_0x42dbfa(_0x147ad1._0x32803f)]['image']=_0x291d4f,this['_graphic'][_0x42dbfa(_0x147ad1._0x32803f)]['bumpMap']=this['_getArcHeatCanvas'](),this[_0x42dbfa(0x1f2)]&&(this['_graphic2']['uniforms']['image']=_0x291d4f,this['_graphic2'][_0x42dbfa(0x1bb)]['bumpMap']=this['_graphic']['uniforms']['bumpMap'])):this['_createArcGraphic'](_0x291d4f):this[_0x42dbfa(0x1b6)]&&_0x30037f?this['_graphic']['uniforms'][_0x42dbfa(_0x147ad1._0x9d58ce)]=_0x291d4f:this['_createGraphic'](_0x291d4f);return this;}[_0x520234(0x1af)](_0x52393c){const _0x4d5408=_0x520234;this[_0x4d5408(0x197)](),this['_graphic']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this[_0x4d5408(0x19c)],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'material':new Cesium[(_0x4d5408(0x1ea))]({'fabric':{'uniforms':{'image':_0x52393c},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})}),this['_layer']['addGraphic'](this['_graphic']);}[_0x520234(0x195)](_0x424d52){const _0x2176fb={_0x374a50:0x1ee,_0x5a33f4:0x1b5,_0x7de285:0x19a,_0x22c17b:0x1bf,_0x38f15e:0x1bd,_0x233dc3:0x193,_0x234a89:0x1b7,_0x4656f9:0x19c,_0x3b9b86:0x1c1,_0x11e34d:0x1f4,_0x542dc4:0x1f2},_0x293351=_0x520234;this['clear']();const _0x230faa=Cesium['RenderState']['fromCache']({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium[_0x293351(_0x2176fb._0x374a50)]['ALWAYS'],'frontOperation':{'fail':Cesium['StencilOperation'][_0x293351(_0x2176fb._0x5a33f4)],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium['StencilOperation']['REPLACE']},'backFunction':Cesium[_0x293351(0x1ee)]['ALWAYS'],'backOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium['StencilOperation'][_0x293351(_0x2176fb._0x7de285)]},'reference':0x2,'mask':0x2},'blending':Cesium['BlendingState']['ALPHA_BLEND']}),_0x3c5255=Math['floor'](this['style'][_0x293351(0x1bf)]??this['_mBoundsMax']*0.02)+0.1;this['style'][_0x293351(_0x2176fb._0x22c17b)]&&delete this['style']['diffHeight'];const _0x3fb1b0=(this[_0x293351(0x19e)][_0x293351(_0x2176fb._0x38f15e)],0x64);let _0x198ed1=Math['max'](this['_rectangle'][_0x293351(_0x2176fb._0x233dc3)],this['_rectangle']['width']);this['style'][_0x293351(_0x2176fb._0x234a89)]=_0x198ed1/=_0x3fb1b0;const _0x476f10=new Cesium['Material']({'fabric':{'uniforms':{'image':_0x424d52,'repeat':new Cesium['Cartesian2'](0x1,0x1),'color':new Cesium['Color'](0x1,0x1,0x1,0x0),'bumpMap':this['_getArcHeatCanvas']()},'source':HeatMaterial},'translucent':!![]}),_0xefefe=this[_0x293351(0x19e)][_0x293351(0x1a4)]||0x1;this['_graphic']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this[_0x293351(_0x2176fb._0x4656f9)],'rectangle':this[_0x293351(_0x2176fb._0x3b9b86)],'appearance':new Cesium[(_0x293351(0x1c5))]({'flat':!![],'aboveGround':!![],'renderState':_0x230faa,'material':_0x476f10,'vertexShaderSource':getVertexShaderSource(_0x3c5255*_0xefefe)})}),this['_layer']['addGraphic'](this['_graphic']),this[_0x293351(0x19e)]['arcDirection']===0x0&&(this['_graphic2']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium[(_0x293351(0x1c5))]({'flat':!![],'aboveGround':!![],'renderState':_0x230faa,'material':_0x476f10,'vertexShaderSource':getVertexShaderSource(-_0x3c5255)})}),this['_layer'][_0x293351(_0x2176fb._0x11e34d)](this[_0x293351(_0x2176fb._0x542dc4)]));}[_0x520234(0x1eb)](_0x3da241){const _0x3fc232={_0x30bf75:0x1c0},_0x2e5cc1=_0x520234;return _0x3da241!==null&&_0x3da241!==void 0x0&&_0x3da241[_0x2e5cc1(0x1aa)]&&this['_rectangle']?mars3d__namespace[_0x2e5cc1(0x1a9)][_0x2e5cc1(_0x3fc232._0x30bf75)](this['_rectangle']):this['_rectangle'];}['_getHeatCanvas'](){const _0x2b2496={_0x111fd1:0x196,_0x453daa:0x1b0,_0x343094:0x1db,_0x366353:0x1f3,_0x5287f6:0x1d9,_0x144f00:0x1c1,_0x163203:0x1e4,_0x362a3e:0x1b1,_0x382514:0x19e,_0x16262f:0x1f1,_0x2196d5:0x1a2,_0x2d816:0x1d2},_0x5b286e={_0xc81059:0x1e9},_0xf02350={_0x11d8f3:0x1ba,_0xd774fe:0x1e9},_0x59816f=_0x520234,_0x1d6fb3=this['_positions'],_0x3440dd=[];let _0x388ceb,_0x2ec633,_0x2b0358,_0x328a8a;_0x1d6fb3['forEach'](_0x9fba15=>{const _0x5de9c6=_0x462e,_0x46b955=mars3d__namespace[_0x5de9c6(0x1c8)]['parse'](_0x9fba15);if(!_0x46b955)return;_0x46b955['value']=_0x9fba15['value']||0x1,!this['options']['rectangle']&&(_0x388ceb===undefined?(_0x388ceb=_0x46b955['lng'],_0x2ec633=_0x46b955['lng'],_0x2b0358=_0x46b955['lat'],_0x328a8a=_0x46b955['lat']):(_0x388ceb=Math['min'](_0x388ceb,_0x46b955[_0x5de9c6(0x1ba)]),_0x2ec633=Math['max'](_0x2ec633,_0x46b955[_0x5de9c6(_0xf02350._0x11d8f3)]),_0x2b0358=Math['min'](_0x2b0358,_0x46b955[_0x5de9c6(_0xf02350._0xd774fe)]),_0x328a8a=Math[_0x5de9c6(0x1b9)](_0x328a8a,_0x46b955['lat']))),_0x3440dd['push'](_0x46b955);});_0x388ceb===_0x2ec633&&(_0x388ceb-=0.000001,_0x2ec633+=0.000001);_0x2b0358===_0x328a8a&&(_0x2b0358-=0.000001,_0x328a8a+=0.000001);let _0x14c7df=this[_0x59816f(0x19c)][_0x59816f(_0x2b2496._0x111fd1)]||{'xmin':_0x388ceb,'xmax':_0x2ec633,'ymin':_0x2b0358,'ymax':_0x328a8a};const _0x3159ea=getMercatorBounds(_0x14c7df),_0x563292=Math['abs'](_0x3159ea['xmax']-_0x3159ea['xmin']),_0x88251c=Math['abs'](_0x3159ea['ymax']-_0x3159ea['ymin']),_0x2e7105=Math['max'](_0x563292,_0x88251c),_0x380466=Math['min'](_0x563292,_0x88251c);this['_mBoundsMax']=_0x2e7105;let _0x138638=0x1;if(_0x2e7105>this['options'][_0x59816f(0x1db)])_0x138638=_0x2e7105/this['options'][_0x59816f(0x1db)],_0x380466/_0x138638<this[_0x59816f(0x19c)]['minCanvasSize']&&(_0x138638=_0x380466/this['options']['minCanvasSize']);else _0x380466<this['options'][_0x59816f(0x1b0)]&&(_0x138638=_0x380466/this['options'][_0x59816f(_0x2b2496._0x453daa)],_0x2e7105/_0x138638>this['options'][_0x59816f(_0x2b2496._0x343094)]&&(_0x138638=_0x2e7105/this['options']['maxCanvasSize']));const _0x583122=this[_0x59816f(_0x2b2496._0x366353)]['radius']*1.5,_0xaced3b=_0x563292/_0x138638+_0x583122*0x2,_0x4d4433=_0x88251c/_0x138638+_0x583122*0x2,_0x3cb91f=_0x583122*_0x138638;_0x3159ea[_0x59816f(0x19d)]-=_0x3cb91f,_0x3159ea[_0x59816f(0x1d4)]-=_0x3cb91f,_0x3159ea['xmax']+=_0x3cb91f,_0x3159ea[_0x59816f(_0x2b2496._0x5287f6)]+=_0x3cb91f,this['_scale']=_0x138638,_0x14c7df=geLatLngBounds(_0x3159ea),this[_0x59816f(_0x2b2496._0x144f00)]=Cesium[_0x59816f(0x1ef)]['fromDegrees'](_0x14c7df['xmin'],_0x14c7df['ymin'],_0x14c7df['xmax'],_0x14c7df['ymax']);let _0x4ce1a7=_0x3440dd[0x0]['value']??0x1,_0x2844b9=_0x3440dd[0x0]['value']??0x0;const _0x2ed1ec=[];_0x3440dd['forEach'](_0x55a859=>{const _0x2b289a=_0x59816f,_0x43f61f=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x55a859['lng'],_0x55a859[_0x2b289a(_0x5b286e._0xc81059)]]),_0x1653c7=_0x55a859['value']||0x1,_0x281f99=Math['round']((_0x43f61f[0x0]-_0x3159ea['xmin'])/_0x138638),_0x338a8c=Math['round']((_0x3159ea['ymax']-_0x43f61f[0x1])/_0x138638);_0x4ce1a7=Math['max'](_0x4ce1a7,_0x1653c7),_0x2844b9=Math['min'](_0x2844b9,_0x1653c7),_0x2ed1ec['push']({'x':_0x281f99,'y':_0x338a8c,'value':_0x1653c7});});const _0x24a449={'min':this[_0x59816f(0x19c)][_0x59816f(_0x2b2496._0x163203)]??_0x2844b9,'max':this['options'][_0x59816f(0x1b9)]??_0x4ce1a7,'data':_0x2ed1ec};this['_last_heatData']=_0x24a449;if(!this['_last_mBounds']||_0x3159ea['xmin']!==this[_0x59816f(0x1a7)]['xmin']||_0x3159ea['ymin']!==this['_last_mBounds'][_0x59816f(0x1d4)]||_0x3159ea[_0x59816f(_0x2b2496._0x362a3e)]!==this['_last_mBounds']['xmax']||_0x3159ea['ymax']!==this[_0x59816f(0x1a7)]['ymax']){this['_last_mBounds']=_0x3159ea,this[_0x59816f(0x1c4)][_0x59816f(_0x2b2496._0x382514)][_0x59816f(0x1ac)]='width:'+_0xaced3b+'px;height:'+_0x4d4433+_0x59816f(_0x2b2496._0x16262f);const _0x4863e0={...this['heatStyle'],'container':this['_container']};!this[_0x59816f(0x1a2)]?this[_0x59816f(_0x2b2496._0x2196d5)]=h337__namespace['create'](_0x4863e0):this['_heat']['configure'](_0x4863e0);}this['_heat']['setData'](_0x24a449);const _0x2dda94=mars3d__namespace['DomUtil'][_0x59816f(_0x2b2496._0x2d816)](this[_0x59816f(_0x2b2496._0x2196d5)]['_renderer']['canvas']);return _0x2dda94;}['_getArcHeatCanvas'](){const _0xc97428={_0x5d0657:0x1f3,_0x2173a1:0x1a6,_0x32fe02:0x194,_0x57a785:0x1f3},_0x38e1df=_0x520234;this['_heat']['configure']({'radius':this[_0x38e1df(_0xc97428._0x5d0657)]['radius']*this['style'][_0x38e1df(0x1d6)],'blur':this['heatStyle'][_0x38e1df(_0xc97428._0x2173a1)]*this['style'][_0x38e1df(_0xc97428._0x32fe02)],'gradient':this['heatStyle']['gradientArc']||{0.25:'rgb(0,0,0)',0.55:_0x38e1df(0x1c6),0.85:'rgb(216,216,216)',0x1:'rgb(255,255,255)'}});const _0x15df06=mars3d__namespace['DomUtil']['copyCanvas'](this['_heat']['_renderer']['canvas']);return this['_heat'][_0x38e1df(0x1b2)](this['options'][_0x38e1df(_0xc97428._0x57a785)]),_0x15df06;}[_0x520234(0x1b4)](_0x38d374){const _0x2015c7={_0x8040f1:0x1ad,_0x17671e:0x1c9},_0x1d1180=_0x520234,_0x5b0fb6=mars3d__namespace['LngLatPoint']['parse'](_0x38d374);if(!_0x5b0fb6)return{};const _0x4a3b73=mars3d__namespace['PointTrans'][_0x1d1180(_0x2015c7._0x8040f1)]([_0x5b0fb6['lng'],_0x5b0fb6['lat']]),_0x1de9bc=this['_last_mBounds'],_0x2b2dcf=Math['round']((_0x4a3b73[0x0]-_0x1de9bc[_0x1d1180(0x19d)])/this['_scale']),_0x2353ff=Math[_0x1d1180(0x1da)]((_0x1de9bc['ymax']-_0x4a3b73[0x1])/this['_scale']),_0x5032d3=this['_heat'][_0x1d1180(0x1a0)]({'x':_0x2b2dcf,'y':_0x2353ff}),_0x3c5d07=this['_heat']['_renderer']['ctx']['getImageData'](_0x2b2dcf-0x1,_0x2353ff-0x1,0x1,0x1)[_0x1d1180(_0x2015c7._0x17671e)];return{'x':_0x2b2dcf,'y':_0x2353ff,'value':_0x5032d3,'color':'rgba('+_0x3c5d07[0x0]+','+_0x3c5d07[0x1]+','+_0x3c5d07[0x2]+','+_0x3c5d07[0x3]+')'};}}mars3d__namespace['LayerUtil'][_0x520234(0x1d3)](_0x520234(0x1c7),HeatLayer),mars3d__namespace[_0x520234(0x19b)]['HeatLayer']=HeatLayer,mars3d__namespace[_0x520234(0x1b3)]=h337__namespace;function _0x18a6(){const _0x4642da=['create','cssText','lonlat2mercator','merge','_createGraphic','minCanvasSize','xmax','configure','h337','getPointData','KEEP','_graphic','granularity','_updatePositionsHook','max','lng','uniforms','2912541JGyHWk','splitNum','DomUtil','diffHeight','formatRectangle','_rectangle','Util','image','_container','EllipsoidSurfaceAppearance','rgb(140,140,140)','heat','LngLatPoint','data','1304zZoTKw','positions','setPositions','_layer','5097234wGfquY','BaseLayer','forEach','HeatLayer','copyCanvas','register','ymin','removeLayer','arcRadiusScale','5SKlOIH','toDataURL','ymax','round','maxCanvasSize','container','4uEPhvK','506572KCciUy','type','858OaFJwI',';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a','opacity','PointTrans','min','138948stBcda','get','__esModule','_map','lat','Material','getRectangle','63IyqTAc','2318910UGoaQB','StencilFunction','Rectangle','1475175kHxsuM','px;','_graphic2','heatStyle','addGraphic','height','arcBlurScale','_createArcGraphic','rectangle','clear','flyToByAnimationEnd','_positions','REPLACE','layer','options','xmin','style','body','getValueAt','EPSG:3857','_heat','default','arcDirection','74186sunHmq','blur','_last_mBounds','arc','PolyUtil','isFormat'];_0x18a6=function(){return _0x4642da;};return _0x18a6();}function getMercatorBounds(_0x2a3df8){const _0x2a207e={_0x4f0ac5:0x1e3},_0x2a245=_0x520234,_0x525a18=mars3d__namespace[_0x2a245(_0x2a207e._0x4f0ac5)]['lonlat2mercator']([_0x2a3df8['xmin'],_0x2a3df8[_0x2a245(0x1d4)]]),_0x40c482=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x2a3df8['xmax'],_0x2a3df8['ymax']]);return{'xmin':_0x525a18[0x0],'ymin':_0x525a18[0x1],'xmax':_0x40c482[0x0],'ymax':_0x40c482[0x1]};}function geLatLngBounds(_0x87fe85){const _0x5af39a={_0x22b4fb:0x19d,_0x41ae9e:0x1d4,_0xfca471:0x1b1},_0x381b8d=_0x520234,_0x5810c9=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x87fe85[_0x381b8d(_0x5af39a._0x22b4fb)],_0x87fe85[_0x381b8d(_0x5af39a._0x41ae9e)]]),_0x1dedb4=mars3d__namespace[_0x381b8d(0x1e3)]['mercator2lonlat']([_0x87fe85[_0x381b8d(_0x5af39a._0xfca471)],_0x87fe85['ymax']]);return{'xmin':_0x5810c9[0x0],'ymin':_0x5810c9[0x1],'xmax':_0x1dedb4[0x0],'ymax':_0x1dedb4[0x1]};}function getVertexShaderSource(_0x164030){const _0x4ce552={_0x1f6fc6:0x1e1},_0x1f7b2d=_0x520234;return'in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20'+_0x164030+_0x1f7b2d(_0x4ce552._0x1f6fc6);}exports[_0x520234(0x1d1)]=HeatLayer,Object['defineProperty'](exports,_0x520234(0x1e7),{'value':!![]});
}));
