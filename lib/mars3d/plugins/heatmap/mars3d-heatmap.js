/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.6.17
 * 编译日期：2023-12-17 23:57:42
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';const _0xf4976d=_0x5c5f;(function(_0x2b2eba,_0x528a88){const _0x2434d3={_0x312401:0x167,_0x2a7558:0x16b,_0x3851a6:0x12b,_0x486dbf:0x177},_0x27b2d5=_0x5c5f,_0x5576c9=_0x2b2eba();while(!![]){try{const _0x21f58c=-parseInt(_0x27b2d5(0x14e))/0x1*(parseInt(_0x27b2d5(0x124))/0x2)+parseInt(_0x27b2d5(_0x2434d3._0x312401))/0x3+parseInt(_0x27b2d5(_0x2434d3._0x2a7558))/0x4*(-parseInt(_0x27b2d5(_0x2434d3._0x3851a6))/0x5)+parseInt(_0x27b2d5(0x16e))/0x6+parseInt(_0x27b2d5(0x170))/0x7+-parseInt(_0x27b2d5(_0x2434d3._0x486dbf))/0x8*(-parseInt(_0x27b2d5(0x134))/0x9)+-parseInt(_0x27b2d5(0x178))/0xa;if(_0x21f58c===_0x528a88)break;else _0x5576c9['push'](_0x5576c9['shift']());}catch(_0x466522){_0x5576c9['push'](_0x5576c9['shift']());}}}(_0x3e0d,0x8dd4f));function _0x3e0d(){const _0xa8a05b=['gradientArc','_mountedHook','min','lat',';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a','maxCanvasSize','_graphic','copyCanvas','ALWAYS','_container','ymax','lonlat2mercator','defineProperty','setOptions','value','StencilFunction','length','body','_setOptionsHook','_last_mBounds','setData','2998155IQYRIy','KEEP','addLayer','RectanglePrimitive','2192996hSeSjQ','radius','EPSG:3857','4377084sCLgWb','rgb(216,216,216)','2053513qEppjy','green','layer','arc','heatStyle','type','canvas','552LeNOJc','10065610gvkZCf','create','options','graphic','PointTrans','LayerUtil','getPointData','abs','2uBBzQc','xmin','toArray','_createArcGraphic','Util','uniforms','_createGraphic','5ygHzgu','setPositions','max','image','EllipsoidSurfaceAppearance','ymin','_mBoundsMax','default','removeGraphic','103284ByVgmB','opacity','Cesium','_renderer','forEach','_positions','addPosition','BlendingState','_getArcHeatCanvas','arcRadiusScale','_updatePositionsHook','image/png','round','_graphic2','xmax','clear','__esModule','style','minCanvasSize','lng','clientWidth','diffHeight','_heat','StencilOperation','DomUtil','getRectangle','678349DWwUGL','_rectangle','push','positions'];_0x3e0d=function(){return _0xa8a05b;};return _0x3e0d();}function _interopNamespace(_0x28253e){const _0x2ed30a={_0x2ca63e:0x132},_0x4b66ce=_0x5c5f;if(_0x28253e&&_0x28253e['__esModule'])return _0x28253e;var _0x4aba46=Object['create'](null);return _0x28253e&&Object['keys'](_0x28253e)[_0x4b66ce(0x138)](function(_0x2db444){if(_0x2db444!=='default'){var _0x1c5a5d=Object['getOwnPropertyDescriptor'](_0x28253e,_0x2db444);Object['defineProperty'](_0x4aba46,_0x2db444,_0x1c5a5d['get']?_0x1c5a5d:{'enumerable':!![],'get':function(){return _0x28253e[_0x2db444];}});}}),_0x4aba46[_0x4b66ce(_0x2ed30a._0x2ca63e)]=_0x28253e,_0x4aba46;}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337),HeatMaterial='uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a';if(!h337__namespace['create'])throw new Error('请引入\x20heatmap.js\x20库\x20');const Cesium=mars3d__namespace[_0xf4976d(0x136)],BaseLayer=mars3d__namespace['layer']['BaseLayer'],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:'blue',0.6:_0xf4976d(0x171),0.8:'yellow',0.9:'red'}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium['EllipsoidSurfaceAppearance']['VERTEX_FORMAT']};class HeatLayer extends BaseLayer{constructor(_0x2b70ce={}){const _0x113e1c={_0x4b43f5:0x17a,_0x438ca4:0x157,_0x4a9e71:0x148,_0x337638:0x146,_0x504c75:0x17a},_0xf0b4e6=_0xf4976d;super(_0x2b70ce),this[_0xf0b4e6(_0x113e1c._0x4b43f5)][_0xf0b4e6(_0x113e1c._0x438ca4)]=this[_0xf0b4e6(0x17a)]['maxCanvasSize']??document[_0xf0b4e6(0x163)][_0xf0b4e6(_0x113e1c._0x4a9e71)],this['options']['maxCanvasSize']=Math['min'](this['options']['maxCanvasSize'],0x1388),this['options']['minCanvasSize']=this['options'][_0xf0b4e6(_0x113e1c._0x337638)]??document['body']['clientHeight'],this['options'][_0xf0b4e6(_0x113e1c._0x337638)]=Math['max'](this[_0xf0b4e6(_0x113e1c._0x504c75)][_0xf0b4e6(0x146)],0x2bc),this[_0xf0b4e6(0x17a)]['heatStyle']={...DEF_HEATSTYLE,...this['options']['heatStyle']},this[_0xf0b4e6(0x17a)]['style']={...DEF_STYLE,...this['options']['style']};}get[_0xf4976d(0x172)](){return this['_layer'];}get['heatStyle'](){const _0x1ccf88={_0x5c22b6:0x174},_0x46563c=_0xf4976d;return this['options'][_0x46563c(_0x1ccf88._0x5c22b6)];}set['heatStyle'](_0x42c29f){const _0x6b6f49={_0x58130d:0x17a,_0xa99918:0x174},_0x7ae3a1=_0xf4976d;this['options']['heatStyle']=mars3d__namespace[_0x7ae3a1(0x128)]['merge'](this[_0x7ae3a1(_0x6b6f49._0x58130d)][_0x7ae3a1(_0x6b6f49._0xa99918)],_0x42c29f),this['_heat']&&(this['_heat']['configure'](this[_0x7ae3a1(_0x6b6f49._0x58130d)][_0x7ae3a1(_0x6b6f49._0xa99918)]),this[_0x7ae3a1(0x13e)](!![]));}get['style'](){return this['options']['style'];}set['style'](_0x325f2d){const _0x2c3507={_0x10bc48:0x17a},_0x548813=_0xf4976d;this['options']['style']=mars3d__namespace['Util']['merge'](this[_0x548813(_0x2c3507._0x10bc48)]['style'],_0x325f2d);}get['positions'](){return this['_positions'];}set[_0xf4976d(0x151)](_0x3da7be){const _0x3a29a1={_0x325947:0x12c},_0x510403=_0xf4976d;this[_0x510403(_0x3a29a1._0x325947)](_0x3da7be);}get['coordinates'](){const _0xb08717=[];return this['points']['forEach'](_0x441eaf=>{const _0x57d454=_0x5c5f;_0xb08717[_0x57d454(0x150)](_0x441eaf[_0x57d454(0x126)]());}),_0xb08717;}get['rectangle'](){return this['_rectangle'];}[_0xf4976d(0x164)](_0x1367d1,_0x4acd6c){_0x1367d1['positions']&&(this['positions']=_0x1367d1['positions']);}[_0xf4976d(0x153)](){const _0x229031=_0xf4976d;this['style'][_0x229031(0x175)]==='image'?this['_layer']=new mars3d__namespace['layer']['ImageLayer']({'crs':_0x229031(0x16d),'private':!![]}):this['_layer']=new mars3d__namespace['layer']['GraphicLayer']({'private':!![]});}['_addedHook'](){const _0x4fc77f={_0x396085:0x169,_0x495c0d:0x179,_0x4bb1bf:0x17a},_0x53952d=_0xf4976d;this['_map'][_0x53952d(_0x4fc77f._0x396085)](this['_layer']),this['_container']=mars3d__namespace['DomUtil'][_0x53952d(_0x4fc77f._0x495c0d)]('div','mars3d-heatmap\x20mars3d-hideDiv',this['_map']['container']),this['options']['positions']&&(this['positions']=this['options']['positions']),this[_0x53952d(_0x4fc77f._0x4bb1bf)]['flyTo']&&this['flyToByAnimationEnd']();}['_removedHook'](){this['_container']&&(mars3d__namespace['DomUtil']['remove'](this['_container']),delete this['_container']),this['clear'](),this['_map']['removeLayer'](this['_layer']);}[_0xf4976d(0x13a)](_0x4304d2,_0x197ef5){const _0x1e6d05={_0x2638a4:0x139},_0x2fb00d=_0xf4976d;this[_0x2fb00d(_0x1e6d05._0x2638a4)]=this[_0x2fb00d(0x139)]||[],this['_positions'][_0x2fb00d(0x150)](_0x4304d2),this['_updatePositionsHook'](_0x197ef5);}['setPositions'](_0x402720,_0x47de4b){this['_positions']=_0x402720,this['_updatePositionsHook'](_0x47de4b);}[_0xf4976d(0x143)](){const _0xdf093d={_0x21ca73:0x133},_0x1db9ce=_0xf4976d;this['_graphic']&&(this['_layer'][_0x1db9ce(0x133)](this['_graphic'],!![]),delete this['_graphic']),this['_graphic2']&&(this['_layer'][_0x1db9ce(_0xdf093d._0x21ca73)](this['_graphic2'],!![]),delete this['_graphic2']);}['_updatePositionsHook'](_0x1ada11){const _0xa6d300={_0x22be30:0x151,_0x1bc516:0x162,_0xd8ec8b:0x175,_0x329cdc:0x135,_0x2b9704:0x13c,_0x25078d:0x12a},_0x291acc=_0xf4976d;if(!this['show']||!this['_map']||!this[_0x291acc(_0xa6d300._0x22be30)]||this['positions'][_0x291acc(_0xa6d300._0x1bc516)]===0x0)return this;const _0x4fe62=this['_getHeatCanvas']();if(this[_0x291acc(0x145)][_0x291acc(_0xa6d300._0xd8ec8b)]==='image')this['_layer'][_0x291acc(0x15f)]({'url':_0x4fe62['toDataURL'](_0x291acc(0x13f)),'rectangle':this['_rectangle'],'opacity':this['style'][_0x291acc(_0xa6d300._0x329cdc)]});else this[_0x291acc(0x145)][_0x291acc(0x173)]?this['_graphic']&&_0x1ada11?(this['_graphic']['uniforms']['image']=_0x4fe62,this['_graphic']['uniforms']['bumpMap']=this[_0x291acc(_0xa6d300._0x2b9704)](),this[_0x291acc(0x141)]&&(this[_0x291acc(0x141)]['uniforms'][_0x291acc(0x12e)]=_0x4fe62,this['_graphic2']['uniforms']['bumpMap']=this['_graphic'][_0x291acc(0x129)]['bumpMap'])):this['_createArcGraphic'](_0x4fe62):this['_graphic']&&_0x1ada11?this['_graphic']['uniforms'][_0x291acc(0x12e)]=_0x4fe62:this[_0x291acc(_0xa6d300._0x25078d)](_0x4fe62);return this;}['_createGraphic'](_0x1a8d7d){const _0x580d81={_0x5da0cd:0x158,_0xaa13fa:0x17a,_0x44e940:0x14f},_0x422ad7=_0xf4976d;this['clear'](),this[_0x422ad7(_0x580d81._0x5da0cd)]=new mars3d__namespace[(_0x422ad7(0x17b))][(_0x422ad7(0x16a))]({...this[_0x422ad7(_0x580d81._0xaa13fa)],'rectangle':this[_0x422ad7(_0x580d81._0x44e940)],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'material':new Cesium['Material']({'fabric':{'uniforms':{'image':_0x1a8d7d},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})}),this['_layer']['addGraphic'](this['_graphic']);}[_0xf4976d(0x127)](_0x57973b){const _0x238e5a={_0x5b7fc4:0x143,_0x55092b:0x161,_0x478ac5:0x14b,_0x35449f:0x15a,_0x57c466:0x168,_0x144c61:0x149,_0x1d4c1c:0x12d,_0x45b169:0x12f},_0x5645db=_0xf4976d;this[_0x5645db(_0x238e5a._0x5b7fc4)]();const _0x4ae04c=Cesium['RenderState']['fromCache']({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium[_0x5645db(_0x238e5a._0x55092b)]['ALWAYS'],'frontOperation':{'fail':Cesium[_0x5645db(_0x238e5a._0x478ac5)]['KEEP'],'zFail':Cesium[_0x5645db(_0x238e5a._0x478ac5)][_0x5645db(0x168)],'zPass':Cesium['StencilOperation']['REPLACE']},'backFunction':Cesium[_0x5645db(_0x238e5a._0x55092b)][_0x5645db(_0x238e5a._0x35449f)],'backOperation':{'fail':Cesium['StencilOperation'][_0x5645db(_0x238e5a._0x57c466)],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium['StencilOperation']['REPLACE']},'reference':0x2,'mask':0x2},'blending':Cesium[_0x5645db(0x13b)]['ALPHA_BLEND']}),_0x941124=Math['floor'](this['style']['diffHeight']??this['_mBoundsMax']*0.02)+0.1;this['style'][_0x5645db(_0x238e5a._0x144c61)]&&delete this[_0x5645db(0x145)]['diffHeight'];const _0x4e9778=(this['style']['splitNum'],0x64);let _0xdb48ee=Math[_0x5645db(_0x238e5a._0x1d4c1c)](this['_rectangle']['height'],this['_rectangle']['width']);this['style']['granularity']=_0xdb48ee/=_0x4e9778;const _0x2da35e=new Cesium['Material']({'fabric':{'uniforms':{'image':_0x57973b,'repeat':new Cesium['Cartesian2'](0x1,0x1),'color':new Cesium['Color'](0x1,0x1,0x1,0x0),'bumpMap':this['_getArcHeatCanvas']()},'source':HeatMaterial},'translucent':!![]}),_0x486cdc=this[_0x5645db(0x145)]['arcDirection']||0x1;this['_graphic']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x4ae04c,'material':_0x2da35e,'vertexShaderSource':getVertexShaderSource(_0x941124*_0x486cdc)})}),this['_layer']['addGraphic'](this['_graphic']),this['style']['arcDirection']===0x0&&(this['_graphic2']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this[_0x5645db(0x14f)],'appearance':new Cesium[(_0x5645db(_0x238e5a._0x45b169))]({'flat':!![],'aboveGround':!![],'renderState':_0x4ae04c,'material':_0x2da35e,'vertexShaderSource':getVertexShaderSource(-_0x941124)})}),this['_layer']['addGraphic'](this['_graphic2']));}[_0xf4976d(0x14d)](_0x5640ec){const _0x1fe79d={_0x33e578:0x14f},_0x19aaa7=_0xf4976d;return _0x5640ec!==null&&_0x5640ec!==void 0x0&&_0x5640ec['isFormat']&&this[_0x19aaa7(0x14f)]?mars3d__namespace['PolyUtil']['formatRectangle'](this['_rectangle']):this[_0x19aaa7(_0x1fe79d._0x33e578)];}['_getHeatCanvas'](){const _0x26d3af={_0x30a40b:0x142,_0x3464c5:0x15c,_0x33a501:0x12d,_0x209a23:0x131,_0x39b77a:0x17a,_0xe643f8:0x130,_0x1b620d:0x166},_0x4a0b71={_0x38b8d6:0x140},_0x1a8a17={_0x4d03d0:0x154,_0x6fdcab:0x155},_0x27e207=_0xf4976d,_0x24c9dd=this[_0x27e207(0x139)],_0x21464f=[];let _0x4b9cf6,_0x4e0d17,_0x3bc381,_0x47e34a;_0x24c9dd['forEach'](_0x30e039=>{const _0x3b0046=_0x27e207,_0x2108ce=mars3d__namespace['LngLatPoint']['parse'](_0x30e039);if(!_0x2108ce)return;_0x2108ce[_0x3b0046(0x160)]=_0x30e039['value']||0x1,!this['options']['rectangle']&&(_0x4b9cf6===undefined?(_0x4b9cf6=_0x2108ce[_0x3b0046(0x147)],_0x4e0d17=_0x2108ce[_0x3b0046(0x147)],_0x3bc381=_0x2108ce['lat'],_0x47e34a=_0x2108ce['lat']):(_0x4b9cf6=Math[_0x3b0046(0x154)](_0x4b9cf6,_0x2108ce[_0x3b0046(0x147)]),_0x4e0d17=Math[_0x3b0046(0x12d)](_0x4e0d17,_0x2108ce['lng']),_0x3bc381=Math[_0x3b0046(_0x1a8a17._0x4d03d0)](_0x3bc381,_0x2108ce['lat']),_0x47e34a=Math['max'](_0x47e34a,_0x2108ce[_0x3b0046(_0x1a8a17._0x6fdcab)]))),_0x21464f['push'](_0x2108ce);});_0x4b9cf6===_0x4e0d17&&(_0x4b9cf6-=0.000001,_0x4e0d17+=0.000001);_0x3bc381===_0x47e34a&&(_0x3bc381-=0.000001,_0x47e34a+=0.000001);let _0x3b29b4=this['options']['rectangle']||{'xmin':_0x4b9cf6,'xmax':_0x4e0d17,'ymin':_0x3bc381,'ymax':_0x47e34a};const _0x5c52f0=getMercatorBounds(_0x3b29b4),_0x2e569a=Math['abs'](_0x5c52f0[_0x27e207(_0x26d3af._0x30a40b)]-_0x5c52f0['xmin']),_0x5818cf=Math[_0x27e207(0x123)](_0x5c52f0[_0x27e207(_0x26d3af._0x3464c5)]-_0x5c52f0['ymin']),_0x340db0=Math[_0x27e207(_0x26d3af._0x33a501)](_0x2e569a,_0x5818cf),_0x51ad39=Math['min'](_0x2e569a,_0x5818cf);this[_0x27e207(_0x26d3af._0x209a23)]=_0x340db0;let _0x4aad50=0x1;if(_0x340db0>this[_0x27e207(_0x26d3af._0x39b77a)][_0x27e207(0x157)])_0x4aad50=_0x340db0/this['options']['maxCanvasSize'],_0x51ad39/_0x4aad50<this['options']['minCanvasSize']&&(_0x4aad50=_0x51ad39/this['options']['minCanvasSize']);else _0x51ad39<this['options']['minCanvasSize']&&(_0x4aad50=_0x51ad39/this[_0x27e207(0x17a)][_0x27e207(0x146)],_0x340db0/_0x4aad50>this['options']['maxCanvasSize']&&(_0x4aad50=_0x340db0/this[_0x27e207(0x17a)]['maxCanvasSize']));const _0x1d5efb=this[_0x27e207(0x174)][_0x27e207(0x16c)]*1.5,_0x52d161=_0x2e569a/_0x4aad50+_0x1d5efb*0x2,_0xfe3ad6=_0x5818cf/_0x4aad50+_0x1d5efb*0x2,_0x25fdd1=_0x1d5efb*_0x4aad50;_0x5c52f0['xmin']-=_0x25fdd1,_0x5c52f0['ymin']-=_0x25fdd1,_0x5c52f0[_0x27e207(0x142)]+=_0x25fdd1,_0x5c52f0['ymax']+=_0x25fdd1,this['_scale']=_0x4aad50,_0x3b29b4=geLatLngBounds(_0x5c52f0),this['_rectangle']=Cesium['Rectangle']['fromDegrees'](_0x3b29b4['xmin'],_0x3b29b4[_0x27e207(_0x26d3af._0xe643f8)],_0x3b29b4['xmax'],_0x3b29b4['ymax']);let _0x8196c1=_0x21464f[0x0]['value']??0x1,_0x37beb0=_0x21464f[0x0][_0x27e207(0x160)]??0x0;const _0x374436=[];_0x21464f[_0x27e207(0x138)](_0x286393=>{const _0x221d6f=_0x27e207,_0x1bb86a=mars3d__namespace[_0x221d6f(0x17c)]['lonlat2mercator']([_0x286393['lng'],_0x286393['lat']]),_0xff7144=_0x286393['value']||0x1,_0x5c08d1=Math['round']((_0x1bb86a[0x0]-_0x5c52f0['xmin'])/_0x4aad50),_0x2c35f8=Math[_0x221d6f(_0x4a0b71._0x38b8d6)]((_0x5c52f0[_0x221d6f(0x15c)]-_0x1bb86a[0x1])/_0x4aad50);_0x8196c1=Math['max'](_0x8196c1,_0xff7144),_0x37beb0=Math['min'](_0x37beb0,_0xff7144),_0x374436['push']({'x':_0x5c08d1,'y':_0x2c35f8,'value':_0xff7144});});const _0x51e345={'min':this[_0x27e207(0x17a)]['min']??_0x37beb0,'max':this['options']['max']??_0x8196c1,'data':_0x374436};this['_last_heatData']=_0x51e345;if(!this['_last_mBounds']||_0x5c52f0['xmin']!==this['_last_mBounds']['xmin']||_0x5c52f0[_0x27e207(_0x26d3af._0xe643f8)]!==this[_0x27e207(0x165)][_0x27e207(_0x26d3af._0xe643f8)]||_0x5c52f0[_0x27e207(_0x26d3af._0x30a40b)]!==this['_last_mBounds']['xmax']||_0x5c52f0['ymax']!==this['_last_mBounds']['ymax']){this['_last_mBounds']=_0x5c52f0,this[_0x27e207(0x15b)]['style']['cssText']='width:'+_0x52d161+'px;height:'+_0xfe3ad6+'px;';const _0x2a6f68={...this['heatStyle'],'container':this['_container']};!this['_heat']?this['_heat']=h337__namespace['create'](_0x2a6f68):this['_heat']['configure'](_0x2a6f68);}this['_heat'][_0x27e207(_0x26d3af._0x1b620d)](_0x51e345);const _0x1a3020=mars3d__namespace[_0x27e207(0x14c)][_0x27e207(0x159)](this['_heat']['_renderer']['canvas']);return _0x1a3020;}[_0xf4976d(0x13c)](){const _0x400653={_0x48022d:0x145,_0x2142a8:0x13d,_0x168b4b:0x176},_0x5e6fe6=_0xf4976d;this['_heat']['configure']({'radius':this[_0x5e6fe6(0x174)]['radius']*this[_0x5e6fe6(_0x400653._0x48022d)][_0x5e6fe6(_0x400653._0x2142a8)],'blur':this['heatStyle']['blur']*this['style']['arcBlurScale'],'gradient':this['heatStyle'][_0x5e6fe6(0x152)]||{0.25:'rgb(0,0,0)',0.55:'rgb(140,140,140)',0.85:_0x5e6fe6(0x16f),0x1:'rgb(255,255,255)'}});const _0x2ed0ef=mars3d__namespace['DomUtil']['copyCanvas'](this['_heat']['_renderer'][_0x5e6fe6(_0x400653._0x168b4b)]);return this['_heat']['configure'](this['options']['heatStyle']),_0x2ed0ef;}[_0xf4976d(0x122)](_0xae4622){const _0x1bfbe7={_0x125597:0x137},_0x3fd4f4=_0xf4976d,_0x15a327=mars3d__namespace['LngLatPoint']['parse'](_0xae4622);if(!_0x15a327)return{};const _0x8bace1=mars3d__namespace['PointTrans'][_0x3fd4f4(0x15d)]([_0x15a327['lng'],_0x15a327['lat']]),_0x43937c=this['_last_mBounds'],_0x84fb7f=Math['round']((_0x8bace1[0x0]-_0x43937c['xmin'])/this['_scale']),_0x4c282d=Math['round']((_0x43937c['ymax']-_0x8bace1[0x1])/this['_scale']),_0x1feeae=this[_0x3fd4f4(0x14a)]['getValueAt']({'x':_0x84fb7f,'y':_0x4c282d}),_0x6ec7ab=this['_heat'][_0x3fd4f4(_0x1bfbe7._0x125597)]['ctx']['getImageData'](_0x84fb7f-0x1,_0x4c282d-0x1,0x1,0x1)['data'];return{'x':_0x84fb7f,'y':_0x4c282d,'value':_0x1feeae,'color':'rgba('+_0x6ec7ab[0x0]+','+_0x6ec7ab[0x1]+','+_0x6ec7ab[0x2]+','+_0x6ec7ab[0x3]+')'};}}mars3d__namespace[_0xf4976d(0x121)]['register']('heat',HeatLayer),mars3d__namespace['layer']['HeatLayer']=HeatLayer,mars3d__namespace['h337']=h337__namespace;function getMercatorBounds(_0x59fc0e){const _0x434d24=_0xf4976d,_0x41f877=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x59fc0e['xmin'],_0x59fc0e['ymin']]),_0x1a7f08=mars3d__namespace['PointTrans'][_0x434d24(0x15d)]([_0x59fc0e['xmax'],_0x59fc0e['ymax']]);return{'xmin':_0x41f877[0x0],'ymin':_0x41f877[0x1],'xmax':_0x1a7f08[0x0],'ymax':_0x1a7f08[0x1]};}function _0x5c5f(_0x3ef593,_0x5adf50){const _0x3e0d4c=_0x3e0d();return _0x5c5f=function(_0x5c5fe0,_0x59eac3){_0x5c5fe0=_0x5c5fe0-0x121;let _0x5c0db2=_0x3e0d4c[_0x5c5fe0];return _0x5c0db2;},_0x5c5f(_0x3ef593,_0x5adf50);}function geLatLngBounds(_0x356b77){const _0x2ace92={_0x306ca1:0x125},_0x365a27=_0xf4976d,_0x20d6ab=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x356b77[_0x365a27(_0x2ace92._0x306ca1)],_0x356b77['ymin']]),_0x24e4f2=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x356b77['xmax'],_0x356b77[_0x365a27(0x15c)]]);return{'xmin':_0x20d6ab[0x0],'ymin':_0x20d6ab[0x1],'xmax':_0x24e4f2[0x0],'ymax':_0x24e4f2[0x1]};}function getVertexShaderSource(_0x594a65){const _0x5a3211=_0xf4976d;return'in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20'+_0x594a65+_0x5a3211(0x156);}exports['HeatLayer']=HeatLayer,Object[_0xf4976d(0x15e)](exports,_0xf4976d(0x144),{'value':!![]});
}));
