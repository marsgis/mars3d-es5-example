/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.6.15
 * 编译日期：2023-12-04 17:36:02
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';const _0x479cc1=_0x40ed;(function(_0xf4b993,_0x11a836){const _0x4cc86f={_0x443c28:0x138,_0x46dcdb:0x127,_0x124675:0x144,_0x500df6:0x157,_0x40d9ab:0x150},_0x452286=_0x40ed,_0x57f2ad=_0xf4b993();while(!![]){try{const _0x4176c1=parseInt(_0x452286(0x15e))/0x1+-parseInt(_0x452286(0x130))/0x2*(-parseInt(_0x452286(_0x4cc86f._0x443c28))/0x3)+-parseInt(_0x452286(0x158))/0x4*(parseInt(_0x452286(_0x4cc86f._0x46dcdb))/0x5)+-parseInt(_0x452286(_0x4cc86f._0x124675))/0x6+-parseInt(_0x452286(_0x4cc86f._0x500df6))/0x7+parseInt(_0x452286(0x123))/0x8+-parseInt(_0x452286(0x16c))/0x9*(-parseInt(_0x452286(_0x4cc86f._0x40d9ab))/0xa);if(_0x4176c1===_0x11a836)break;else _0x57f2ad['push'](_0x57f2ad['shift']());}catch(_0x16fb77){_0x57f2ad['push'](_0x57f2ad['shift']());}}}(_0x1c29,0xdd9a1));function _interopNamespace(_0x5e832d){const _0xa496c1=_0x40ed;if(_0x5e832d&&_0x5e832d['__esModule'])return _0x5e832d;var _0x237ba2=Object['create'](null);return _0x5e832d&&Object[_0xa496c1(0x133)](_0x5e832d)['forEach'](function(_0xaab4cc){if(_0xaab4cc!=='default'){var _0x2fac87=Object['getOwnPropertyDescriptor'](_0x5e832d,_0xaab4cc);Object['defineProperty'](_0x237ba2,_0xaab4cc,_0x2fac87['get']?_0x2fac87:{'enumerable':!![],'get':function(){return _0x5e832d[_0xaab4cc];}});}}),_0x237ba2['default']=_0x5e832d,_0x237ba2;}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337),HeatMaterial='uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a';if(!h337__namespace['create'])throw new Error('请引入\x20heatmap.js\x20库\x20');const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace[_0x479cc1(0x11d)][_0x479cc1(0x126)],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:'blue',0.6:_0x479cc1(0x128),0.8:'yellow',0.9:'red'}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium['EllipsoidSurfaceAppearance']['VERTEX_FORMAT']};class HeatLayer extends BaseLayer{constructor(_0x2b15b7={}){const _0x1ac3f1={_0x1726e9:0x122,_0x446252:0x12d,_0x598dd1:0x141,_0x1c9527:0x171},_0x59dd26=_0x479cc1;super(_0x2b15b7),this['options']['maxCanvasSize']=this['options']['maxCanvasSize']??document['body']['clientWidth'],this['options']['maxCanvasSize']=Math['min'](this['options']['maxCanvasSize'],0x1388),this[_0x59dd26(_0x1ac3f1._0x1726e9)]['minCanvasSize']=this['options'][_0x59dd26(0x119)]??document['body'][_0x59dd26(_0x1ac3f1._0x446252)],this['options']['minCanvasSize']=Math[_0x59dd26(_0x1ac3f1._0x598dd1)](this['options']['minCanvasSize'],0x2bc),this['options']['heatStyle']={...DEF_HEATSTYLE,...this['options']['heatStyle']},this['options'][_0x59dd26(_0x1ac3f1._0x1c9527)]={...DEF_STYLE,...this[_0x59dd26(_0x1ac3f1._0x1726e9)]['style']};}get['layer'](){return this['_layer'];}get['heatStyle'](){const _0x2bdb09={_0x20d6c6:0x131},_0x3a1ffb=_0x479cc1;return this[_0x3a1ffb(0x122)][_0x3a1ffb(_0x2bdb09._0x20d6c6)];}set['heatStyle'](_0x52a494){const _0x50d0a4={_0x26bc68:0x131,_0x52252e:0x148},_0x3475bf=_0x479cc1;this['options']['heatStyle']=mars3d__namespace[_0x3475bf(0x168)]['merge'](this['options'][_0x3475bf(_0x50d0a4._0x26bc68)],_0x52a494),this[_0x3475bf(_0x50d0a4._0x52252e)]&&(this['_heat']['configure'](this['options']['heatStyle']),this['_updatePositionsHook'](!![]));}get['style'](){return this['options']['style'];}set['style'](_0x5dc3c4){const _0x27406d=_0x479cc1;this['options'][_0x27406d(0x171)]=mars3d__namespace['Util']['merge'](this['options']['style'],_0x5dc3c4);}get[_0x479cc1(0x13d)](){return this['_positions'];}set[_0x479cc1(0x13d)](_0x34ff7d){this['setPositions'](_0x34ff7d);}get['coordinates'](){const _0x5a8bfa={_0x548d35:0x12b},_0x57fa6d={_0x2201e2:0x12e},_0x39fe37=_0x479cc1,_0x170051=[];return this[_0x39fe37(_0x5a8bfa._0x548d35)]['forEach'](_0x126591=>{const _0x17b079=_0x39fe37;_0x170051[_0x17b079(_0x57fa6d._0x2201e2)](_0x126591[_0x17b079(0x11b)]());}),_0x170051;}get['rectangle'](){return this['_rectangle'];}['_setOptionsHook'](_0x305783,_0x1057df){const _0x482b8d={_0x23bd90:0x13d},_0x3a5ab8=_0x479cc1;_0x305783['positions']&&(this['positions']=_0x305783[_0x3a5ab8(_0x482b8d._0x23bd90)]);}['_mountedHook'](){const _0x210d89={_0x4b76c0:0x160,_0x21ecb9:0x155},_0x30f9b8=_0x479cc1;this['style'][_0x30f9b8(_0x210d89._0x4b76c0)]==='image'?this['_layer']=new mars3d__namespace['layer']['ImageLayer']({'crs':'EPSG:3857','private':!![]}):this[_0x30f9b8(_0x210d89._0x21ecb9)]=new mars3d__namespace['layer']['GraphicLayer']({'private':!![]});}['_addedHook'](){const _0x5d3630={_0x1c623f:0x13c,_0xb8af15:0x125,_0x36216b:0x169},_0x4d69be=_0x479cc1;this['_map']['addLayer'](this['_layer']),this['_container']=mars3d__namespace[_0x4d69be(_0x5d3630._0x1c623f)]['create']('div',_0x4d69be(0x12a),this[_0x4d69be(_0x5d3630._0xb8af15)][_0x4d69be(_0x5d3630._0x36216b)]),this['options']['positions']&&(this['positions']=this['options'][_0x4d69be(0x13d)]),this['options']['flyTo']&&this['flyToByAnimationEnd']();}[_0x479cc1(0x16b)](){const _0x1c0fa0={_0x25881a:0x147},_0x3aa684=_0x479cc1;this['_container']&&(mars3d__namespace['DomUtil']['remove'](this['_container']),delete this['_container']),this['clear'](),this['_map'][_0x3aa684(_0x1c0fa0._0x25881a)](this['_layer']);}['addPosition'](_0x4975a7,_0x4177db){const _0x4497e4=_0x479cc1;this['_positions']=this['_positions']||[],this['_positions'][_0x4497e4(0x12e)](_0x4975a7),this['_updatePositionsHook'](_0x4177db);}['setPositions'](_0x538ba6,_0x3459dd){const _0x40fd0e={_0x152678:0x11f},_0x31106a=_0x479cc1;this['_positions']=_0x538ba6,this[_0x31106a(_0x40fd0e._0x152678)](_0x3459dd);}['clear'](){const _0x1594de={_0x540bd9:0x14d},_0x332fab=_0x479cc1;this['_graphic']&&(this['_layer']['removeGraphic'](this['_graphic'],!![]),delete this['_graphic']),this[_0x332fab(0x14d)]&&(this['_layer']['removeGraphic'](this['_graphic2'],!![]),delete this[_0x332fab(_0x1594de._0x540bd9)]);}[_0x479cc1(0x11f)](_0x18c381){const _0x22d4c4={_0x5e8c72:0x165,_0xe4d265:0x14c,_0x788c3f:0x16f,_0x1b9ad4:0x14a},_0xf99662=_0x479cc1;if(!this['show']||!this['_map']||!this['positions']||this['positions']['length']===0x0)return this;const _0x520d08=this['_getHeatCanvas']();if(this[_0xf99662(0x171)]['type']==='image')this['_layer'][_0xf99662(0x145)]({'url':_0x520d08['toDataURL'](_0xf99662(_0x22d4c4._0x5e8c72)),'rectangle':this['_rectangle'],'opacity':this['style']['opacity']});else this['style']['arc']?this[_0xf99662(0x14c)]&&_0x18c381?(this[_0xf99662(_0x22d4c4._0xe4d265)]['uniforms']['image']=_0x520d08,this['_graphic'][_0xf99662(0x153)][_0xf99662(_0x22d4c4._0x788c3f)]=this[_0xf99662(_0x22d4c4._0x1b9ad4)](),this['_graphic2']&&(this['_graphic2']['uniforms']['image']=_0x520d08,this['_graphic2']['uniforms']['bumpMap']=this['_graphic']['uniforms'][_0xf99662(0x16f)])):this[_0xf99662(0x139)](_0x520d08):this['_graphic']&&_0x18c381?this['_graphic'][_0xf99662(0x153)]['image']=_0x520d08:this['_createGraphic'](_0x520d08);return this;}[_0x479cc1(0x167)](_0x1de851){const _0x283b82={_0x54d5f1:0x13b},_0x1dc7e1=_0x479cc1;this[_0x1dc7e1(0x170)](),this['_graphic']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this[_0x1dc7e1(0x122)],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'material':new Cesium[(_0x1dc7e1(_0x283b82._0x54d5f1))]({'fabric':{'uniforms':{'image':_0x1de851},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})}),this[_0x1dc7e1(0x155)]['addGraphic'](this['_graphic']);}['_createArcGraphic'](_0x10ef59){const _0x1e3cb0={_0x233b98:0x14e,_0x31918a:0x142,_0x1194d8:0x171,_0xb1a3c6:0x15f,_0x4a4b9f:0x13b,_0x4a5c62:0x13f,_0x251613:0x140,_0x10a58f:0x14d,_0x26ee1e:0x155},_0x5cab62=_0x479cc1;this['clear']();const _0x4221b6=Cesium['RenderState'][_0x5cab62(0x15c)]({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium['StencilFunction']['ALWAYS'],'frontOperation':{'fail':Cesium['StencilOperation'][_0x5cab62(_0x1e3cb0._0x233b98)],'zFail':Cesium['StencilOperation'][_0x5cab62(_0x1e3cb0._0x233b98)],'zPass':Cesium['StencilOperation'][_0x5cab62(0x14f)]},'backFunction':Cesium[_0x5cab62(_0x1e3cb0._0x31918a)]['ALWAYS'],'backOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium['StencilOperation'][_0x5cab62(_0x1e3cb0._0x233b98)],'zPass':Cesium['StencilOperation']['REPLACE']},'reference':0x2,'mask':0x2},'blending':Cesium[_0x5cab62(0x151)][_0x5cab62(0x156)]}),_0x1ed452=Math['floor'](this[_0x5cab62(0x171)]['diffHeight']??this['_mBoundsMax']*0.02)+0.1;this[_0x5cab62(_0x1e3cb0._0x1194d8)]['diffHeight']&&delete this['style']['diffHeight'];const _0x166762=(this['style']['splitNum'],0x64);let _0xdf3c5=Math[_0x5cab62(0x141)](this['_rectangle']['height'],this['_rectangle']['width']);this['style'][_0x5cab62(_0x1e3cb0._0xb1a3c6)]=_0xdf3c5/=_0x166762;const _0xb99908=new Cesium[(_0x5cab62(_0x1e3cb0._0x4a4b9f))]({'fabric':{'uniforms':{'image':_0x10ef59,'repeat':new Cesium['Cartesian2'](0x1,0x1),'color':new Cesium['Color'](0x1,0x1,0x1,0x0),'bumpMap':this[_0x5cab62(0x14a)]()},'source':HeatMaterial},'translucent':!![]}),_0x1cb631=this[_0x5cab62(0x171)]['arcDirection']||0x1;this['_graphic']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium[(_0x5cab62(_0x1e3cb0._0x4a5c62))]({'flat':!![],'aboveGround':!![],'renderState':_0x4221b6,'material':_0xb99908,'vertexShaderSource':getVertexShaderSource(_0x1ed452*_0x1cb631)})}),this['_layer']['addGraphic'](this['_graphic']),this['style'][_0x5cab62(_0x1e3cb0._0x251613)]===0x0&&(this[_0x5cab62(_0x1e3cb0._0x10a58f)]=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x4221b6,'material':_0xb99908,'vertexShaderSource':getVertexShaderSource(-_0x1ed452)})}),this[_0x5cab62(_0x1e3cb0._0x26ee1e)]['addGraphic'](this['_graphic2']));}['getRectangle'](_0xf209ec){const _0x4bfc4e={_0x5e21cc:0x16d},_0x1f86f2=_0x479cc1;return _0xf209ec!==null&&_0xf209ec!==void 0x0&&_0xf209ec[_0x1f86f2(0x16e)]&&this['_rectangle']?mars3d__namespace[_0x1f86f2(_0x4bfc4e._0x5e21cc)][_0x1f86f2(0x137)](this['_rectangle']):this['_rectangle'];}['_getHeatCanvas'](){const _0x2227a4={_0x515d89:0x124,_0xd35458:0x159,_0x3c3577:0x152,_0xffac10:0x162,_0xdccf28:0x124,_0x17c248:0x122,_0x4a7db9:0x11e,_0x5731c8:0x171,_0xa54571:0x148,_0x22bd12:0x161},_0x4681c1={_0xd36df:0x11a},_0x2c63a9={_0x263632:0x129,_0x3543c9:0x11a,_0x16a03c:0x15b,_0x18134c:0x11c},_0x2d2241=_0x479cc1,_0xd8ea20=this['_positions'],_0x21f96b=[];let _0x4037ce,_0x1c391b,_0x133c0c,_0xd80635;_0xd8ea20[_0x2d2241(0x143)](_0x27464f=>{const _0x1a939f=_0x2d2241,_0x8a051e=mars3d__namespace[_0x1a939f(_0x2c63a9._0x263632)]['parse'](_0x27464f);if(!_0x8a051e)return;_0x8a051e['value']=_0x27464f[_0x1a939f(_0x2c63a9._0x3543c9)]||0x1,!this['options'][_0x1a939f(_0x2c63a9._0x16a03c)]&&(_0x4037ce===undefined?(_0x4037ce=_0x8a051e['lng'],_0x1c391b=_0x8a051e['lng'],_0x133c0c=_0x8a051e[_0x1a939f(0x11c)],_0xd80635=_0x8a051e['lat']):(_0x4037ce=Math['min'](_0x4037ce,_0x8a051e['lng']),_0x1c391b=Math['max'](_0x1c391b,_0x8a051e['lng']),_0x133c0c=Math['min'](_0x133c0c,_0x8a051e['lat']),_0xd80635=Math['max'](_0xd80635,_0x8a051e[_0x1a939f(_0x2c63a9._0x18134c)]))),_0x21f96b['push'](_0x8a051e);});_0x4037ce===_0x1c391b&&(_0x4037ce-=0.000001,_0x1c391b+=0.000001);_0x133c0c===_0xd80635&&(_0x133c0c-=0.000001,_0xd80635+=0.000001);let _0x595e08=this[_0x2d2241(0x122)]['rectangle']||{'xmin':_0x4037ce,'xmax':_0x1c391b,'ymin':_0x133c0c,'ymax':_0xd80635};const _0x7eea85=getMercatorBounds(_0x595e08),_0x1788b1=Math['abs'](_0x7eea85['xmax']-_0x7eea85[_0x2d2241(0x12c)]),_0x453d6c=Math[_0x2d2241(0x154)](_0x7eea85[_0x2d2241(_0x2227a4._0x515d89)]-_0x7eea85['ymin']),_0x11c5b8=Math['max'](_0x1788b1,_0x453d6c),_0x446d02=Math['min'](_0x1788b1,_0x453d6c);this[_0x2d2241(_0x2227a4._0xd35458)]=_0x11c5b8;let _0x84a008=0x1;if(_0x11c5b8>this[_0x2d2241(0x122)]['maxCanvasSize'])_0x84a008=_0x11c5b8/this['options'][_0x2d2241(0x12f)],_0x446d02/_0x84a008<this['options']['minCanvasSize']&&(_0x84a008=_0x446d02/this['options']['minCanvasSize']);else _0x446d02<this['options'][_0x2d2241(0x119)]&&(_0x84a008=_0x446d02/this['options']['minCanvasSize'],_0x11c5b8/_0x84a008>this['options']['maxCanvasSize']&&(_0x84a008=_0x11c5b8/this['options']['maxCanvasSize']));const _0x3cc48e=this['heatStyle'][_0x2d2241(0x146)]*1.5,_0x2c1d90=_0x1788b1/_0x84a008+_0x3cc48e*0x2,_0x3f421e=_0x453d6c/_0x84a008+_0x3cc48e*0x2,_0x2c5db8=_0x3cc48e*_0x84a008;_0x7eea85[_0x2d2241(0x12c)]-=_0x2c5db8,_0x7eea85['ymin']-=_0x2c5db8,_0x7eea85['xmax']+=_0x2c5db8,_0x7eea85['ymax']+=_0x2c5db8,this[_0x2d2241(_0x2227a4._0x3c3577)]=_0x84a008,_0x595e08=geLatLngBounds(_0x7eea85),this['_rectangle']=Cesium[_0x2d2241(0x13e)]['fromDegrees'](_0x595e08[_0x2d2241(0x12c)],_0x595e08[_0x2d2241(_0x2227a4._0xffac10)],_0x595e08['xmax'],_0x595e08[_0x2d2241(_0x2227a4._0xdccf28)]);let _0x21d5c4=_0x21f96b[0x0]['value']??0x1,_0xbdbdf2=_0x21f96b[0x0]['value']??0x0;const _0x5a3085=[];_0x21f96b['forEach'](_0x1c39f0=>{const _0xcb7613=_0x2d2241,_0x323a44=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x1c39f0['lng'],_0x1c39f0['lat']]),_0x8eeac6=_0x1c39f0[_0xcb7613(_0x4681c1._0xd36df)]||0x1,_0x392aee=Math['round']((_0x323a44[0x0]-_0x7eea85['xmin'])/_0x84a008),_0x404fd0=Math[_0xcb7613(0x134)]((_0x7eea85['ymax']-_0x323a44[0x1])/_0x84a008);_0x21d5c4=Math['max'](_0x21d5c4,_0x8eeac6),_0xbdbdf2=Math['min'](_0xbdbdf2,_0x8eeac6),_0x5a3085['push']({'x':_0x392aee,'y':_0x404fd0,'value':_0x8eeac6});});const _0x2634f0={'min':this[_0x2d2241(_0x2227a4._0x17c248)]['min']??_0xbdbdf2,'max':this['options']['max']??_0x21d5c4,'data':_0x5a3085};this['_last_heatData']=_0x2634f0;if(!this['_last_mBounds']||_0x7eea85[_0x2d2241(0x12c)]!==this['_last_mBounds']['xmin']||_0x7eea85[_0x2d2241(0x162)]!==this[_0x2d2241(0x136)]['ymin']||_0x7eea85['xmax']!==this['_last_mBounds'][_0x2d2241(_0x2227a4._0x4a7db9)]||_0x7eea85['ymax']!==this[_0x2d2241(0x136)]['ymax']){this['_last_mBounds']=_0x7eea85,this[_0x2d2241(0x164)][_0x2d2241(_0x2227a4._0x5731c8)][_0x2d2241(0x13a)]='width:'+_0x2c1d90+'px;height:'+_0x3f421e+'px;';const _0x18c161={...this[_0x2d2241(0x131)],'container':this['_container']};!this[_0x2d2241(_0x2227a4._0xa54571)]?this['_heat']=h337__namespace['create'](_0x18c161):this['_heat'][_0x2d2241(_0x2227a4._0x22bd12)](_0x18c161);}this['_heat'][_0x2d2241(0x16a)](_0x2634f0);const _0x573b76=mars3d__namespace['DomUtil']['copyCanvas'](this['_heat']['_renderer']['canvas']);return _0x573b76;}['_getArcHeatCanvas'](){const _0x37f36f={_0x141294:0x131,_0x3721ca:0x132,_0xb166af:0x131},_0x33ab99=_0x479cc1;this['_heat']['configure']({'radius':this['heatStyle']['radius']*this['style']['arcRadiusScale'],'blur':this[_0x33ab99(_0x37f36f._0x141294)]['blur']*this[_0x33ab99(0x171)]['arcBlurScale'],'gradient':this[_0x33ab99(_0x37f36f._0x141294)][_0x33ab99(_0x37f36f._0x3721ca)]||{0.25:'rgb(0,0,0)',0.55:'rgb(140,140,140)',0.85:'rgb(216,216,216)',0x1:'rgb(255,255,255)'}});const _0x593066=mars3d__namespace['DomUtil']['copyCanvas'](this['_heat']['_renderer']['canvas']);return this['_heat']['configure'](this['options'][_0x33ab99(_0x37f36f._0xb166af)]),_0x593066;}['getPointData'](_0x9726e0){const _0x4c8478={_0x321080:0x14b,_0x40707e:0x149,_0xc4c4b0:0x15a},_0x4133cf=_0x479cc1,_0x2e1cf3=mars3d__namespace[_0x4133cf(0x129)]['parse'](_0x9726e0);if(!_0x2e1cf3)return{};const _0x5acdb9=mars3d__namespace['PointTrans'][_0x4133cf(_0x4c8478._0x321080)]([_0x2e1cf3[_0x4133cf(_0x4c8478._0x40707e)],_0x2e1cf3['lat']]),_0x339a7e=this['_last_mBounds'],_0x108cb3=Math['round']((_0x5acdb9[0x0]-_0x339a7e['xmin'])/this['_scale']),_0x334553=Math['round']((_0x339a7e['ymax']-_0x5acdb9[0x1])/this['_scale']),_0x38e512=this['_heat']['getValueAt']({'x':_0x108cb3,'y':_0x334553}),_0x13976a=this['_heat']['_renderer']['ctx'][_0x4133cf(_0x4c8478._0xc4c4b0)](_0x108cb3-0x1,_0x334553-0x1,0x1,0x1)['data'];return{'x':_0x108cb3,'y':_0x334553,'value':_0x38e512,'color':'rgba('+_0x13976a[0x0]+','+_0x13976a[0x1]+','+_0x13976a[0x2]+','+_0x13976a[0x3]+')'};}}function _0x1c29(){const _0x7d2523=['image/png','__esModule','_createGraphic','Util','container','setData','_removedHook','3425283NHLMnP','PolyUtil','isFormat','bumpMap','clear','style','minCanvasSize','value','toArray','lat','layer','xmax','_updatePositionsHook','LayerUtil','PointTrans','options','6398656vYdCUy','ymax','_map','BaseLayer','5265070Nglkng','green','LngLatPoint','mars3d-heatmap\x20mars3d-hideDiv','points','xmin','clientHeight','push','maxCanvasSize','170918JwANov','heatStyle','gradientArc','keys','round','register','_last_mBounds','formatRectangle','9JGPPSK','_createArcGraphic','cssText','Material','DomUtil','positions','Rectangle','EllipsoidSurfaceAppearance','arcDirection','max','StencilFunction','forEach','2722476JwRmZG','setOptions','radius','removeLayer','_heat','lng','_getArcHeatCanvas','lonlat2mercator','_graphic','_graphic2','KEEP','REPLACE','20SuKxDF','BlendingState','_scale','uniforms','abs','_layer','ALPHA_BLEND','8438045WNOXfy','4rSEFWR','_mBoundsMax','getImageData','rectangle','fromCache','defineProperty','1802493kqGFUo','granularity','type','configure','ymin','h337','_container'];_0x1c29=function(){return _0x7d2523;};return _0x1c29();}mars3d__namespace[_0x479cc1(0x120)][_0x479cc1(0x135)]('heat',HeatLayer),mars3d__namespace['layer']['HeatLayer']=HeatLayer,mars3d__namespace[_0x479cc1(0x163)]=h337__namespace;function getMercatorBounds(_0x5a71ab){const _0x1458c8={_0x178e78:0x162,_0x39b738:0x121},_0x15bc1e=_0x479cc1,_0x449def=mars3d__namespace['PointTrans'][_0x15bc1e(0x14b)]([_0x5a71ab['xmin'],_0x5a71ab[_0x15bc1e(_0x1458c8._0x178e78)]]),_0x1033f7=mars3d__namespace[_0x15bc1e(_0x1458c8._0x39b738)]['lonlat2mercator']([_0x5a71ab['xmax'],_0x5a71ab[_0x15bc1e(0x124)]]);return{'xmin':_0x449def[0x0],'ymin':_0x449def[0x1],'xmax':_0x1033f7[0x0],'ymax':_0x1033f7[0x1]};}function geLatLngBounds(_0x4c97ba){const _0x43175c={_0x17aeae:0x124},_0x3a9734=_0x479cc1,_0x1fdc81=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x4c97ba['xmin'],_0x4c97ba[_0x3a9734(0x162)]]),_0x11572f=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x4c97ba['xmax'],_0x4c97ba[_0x3a9734(_0x43175c._0x17aeae)]]);return{'xmin':_0x1fdc81[0x0],'ymin':_0x1fdc81[0x1],'xmax':_0x11572f[0x0],'ymax':_0x11572f[0x1]};}function getVertexShaderSource(_0x28d7da){return'in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20'+_0x28d7da+';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a';}function _0x40ed(_0x1c443a,_0x2b97d2){const _0x1c2980=_0x1c29();return _0x40ed=function(_0x40ed7d,_0x53b0ac){_0x40ed7d=_0x40ed7d-0x119;let _0xc47ae2=_0x1c2980[_0x40ed7d];return _0xc47ae2;},_0x40ed(_0x1c443a,_0x2b97d2);}exports['HeatLayer']=HeatLayer,Object[_0x479cc1(0x15d)](exports,_0x479cc1(0x166),{'value':!![]});
}));
