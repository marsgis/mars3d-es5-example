/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.6.11
 * 编译日期：2023-11-02 17:47:10
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';const _0x471db4=_0x47fd;function _0x47fd(_0x19d0e1,_0x497a6a){const _0x32981c=_0x3298();return _0x47fd=function(_0x47fdd0,_0xf12795){_0x47fdd0=_0x47fdd0-0x70;let _0x1ba431=_0x32981c[_0x47fdd0];return _0x1ba431;},_0x47fd(_0x19d0e1,_0x497a6a);}function _0x3298(){const _0x1b6048=['addGraphic','VERTEX_FORMAT','xmax','PolyUtil','10482sdJYRR','forEach','lonlat2mercator','graphic','_mBoundsMax','RenderState','286bxMdRl','65695JYirjQ','130yEJOuv','_container','RectanglePrimitive','coordinates','rgb(216,216,216)','red','layer','options','getValueAt','BaseLayer','246lFVkXV','image','289809xJInpL','heatStyle','26mCcsdC','_graphic2','_createGraphic','_heat','LngLatPoint','StencilOperation','min','max','opacity','lat','px;height:','_graphic','_scale','splitNum','mercator2lonlat','_setOptionsHook','style','_getArcHeatCanvas','BlendingState','10307256AeqUyJ','_last_heatData','EllipsoidSurfaceAppearance','remove','abs','removeGraphic','blur','default','369lYstik','ymax','uniforms','body','7roTOCV','clear','_last_mBounds','merge','_renderer','__esModule','_rectangle','Rectangle','width:','configure','32540duhcNA','_mountedHook','minCanvasSize','maxCanvasSize','_removedHook','length','_map','width','round','rgb(140,140,140)','getPointData','setData','lng','clientWidth','PointTrans','_layer','11656408xnLtHM','DomUtil','StencilFunction','LayerUtil','positions','Material','value','5620791EIBCEG','gradientArc','create','HeatLayer','xmin','rgba(','parse'];_0x3298=function(){return _0x1b6048;};return _0x3298();}(function(_0x54d680,_0x78c04a){const _0x6be256={_0x1f1bae:0xb9,_0x51f215:0xb3,_0x385cdb:0x83,_0x1fc0ae:0x91,_0x34d15c:0xba,_0x5453ad:0xa1,_0x33f501:0xc7,_0x1ffab7:0x7b,_0x3c3f31:0xc9},_0x59c406=_0x47fd,_0x48f0df=_0x54d680();while(!![]){try{const _0x2b8bd1=-parseInt(_0x59c406(_0x6be256._0x1f1bae))/0x1*(-parseInt(_0x59c406(_0x6be256._0x51f215))/0x2)+-parseInt(_0x59c406(_0x6be256._0x385cdb))/0x3*(-parseInt(_0x59c406(_0x6be256._0x1fc0ae))/0x4)+-parseInt(_0x59c406(_0x6be256._0x34d15c))/0x5*(parseInt(_0x59c406(0xc5))/0x6)+-parseInt(_0x59c406(0x87))/0x7*(-parseInt(_0x59c406(_0x6be256._0x5453ad))/0x8)+-parseInt(_0x59c406(_0x6be256._0x33f501))/0x9*(parseInt(_0x59c406(0xbb))/0xa)+-parseInt(_0x59c406(0xa8))/0xb+-parseInt(_0x59c406(_0x6be256._0x1ffab7))/0xc*(parseInt(_0x59c406(_0x6be256._0x3c3f31))/0xd);if(_0x2b8bd1===_0x78c04a)break;else _0x48f0df['push'](_0x48f0df['shift']());}catch(_0x33464e){_0x48f0df['push'](_0x48f0df['shift']());}}}(_0x3298,0xbc16d));function _interopNamespace(_0x2de1cd){const _0x59bb49={_0x490e1a:0x8c,_0x1152c6:0x82},_0x588a75=_0x47fd;if(_0x2de1cd&&_0x2de1cd[_0x588a75(_0x59bb49._0x490e1a)])return _0x2de1cd;var _0x26c87e=Object['create'](null);return _0x2de1cd&&Object['keys'](_0x2de1cd)[_0x588a75(0xb4)](function(_0x419c22){if(_0x419c22!=='default'){var _0x4b9f1e=Object['getOwnPropertyDescriptor'](_0x2de1cd,_0x419c22);Object['defineProperty'](_0x26c87e,_0x419c22,_0x4b9f1e['get']?_0x4b9f1e:{'enumerable':!![],'get':function(){return _0x2de1cd[_0x419c22];}});}}),_0x26c87e[_0x588a75(_0x59bb49._0x1152c6)]=_0x2de1cd,_0x26c87e;}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337),HeatMaterial='uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a';if(!h337__namespace['create'])throw new Error('请引入\x20heatmap.js\x20库\x20');const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace[_0x471db4(0xc1)][_0x471db4(0xc4)],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:'blue',0.6:'green',0.8:'yellow',0.9:_0x471db4(0xc0)}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium['EllipsoidSurfaceAppearance'][_0x471db4(0xb0)]};class HeatLayer extends BaseLayer{constructor(_0xbf573c={}){const _0x39e5fb={_0x170921:0xc2,_0x33f272:0x93,_0x102706:0xc8},_0xa144b8=_0x471db4;super(_0xbf573c),this[_0xa144b8(0xc2)]['maxCanvasSize']=this[_0xa144b8(_0x39e5fb._0x170921)]['maxCanvasSize']??document['body'][_0xa144b8(0x9e)],this[_0xa144b8(0xc2)]['maxCanvasSize']=Math['min'](this['options']['maxCanvasSize'],0x1388),this['options'][_0xa144b8(_0x39e5fb._0x33f272)]=this['options'][_0xa144b8(0x93)]??document[_0xa144b8(0x86)]['clientHeight'],this['options']['minCanvasSize']=Math['max'](this['options']['minCanvasSize'],0x2bc),this['options'][_0xa144b8(_0x39e5fb._0x102706)]={...DEF_HEATSTYLE,...this[_0xa144b8(0xc2)][_0xa144b8(0xc8)]},this['options']['style']={...DEF_STYLE,...this['options']['style']};}get['layer'](){return this['_layer'];}get['heatStyle'](){return this['options']['heatStyle'];}set['heatStyle'](_0x1d2008){const _0x1d89ad={_0x1caf53:0xc2},_0x2c62cf=_0x471db4;this[_0x2c62cf(_0x1d89ad._0x1caf53)]['heatStyle']=mars3d__namespace['Util'][_0x2c62cf(0x8a)](this['options']['heatStyle'],_0x1d2008),this['_heat']&&(this['_heat'][_0x2c62cf(0x90)](this['options']['heatStyle']),this['_updatePositionsHook'](!![]));}get['style'](){const _0x106b38=_0x471db4;return this['options'][_0x106b38(0x78)];}set['style'](_0x4d2b23){const _0x1c68f3=_0x471db4;this['options'][_0x1c68f3(0x78)]=mars3d__namespace['Util'][_0x1c68f3(0x8a)](this['options']['style'],_0x4d2b23);}get['positions'](){return this['_positions'];}set['positions'](_0x1d41fe){this['setPositions'](_0x1d41fe);}get[_0x471db4(0xbe)](){const _0x323f6f={_0x33dfe8:0xb4},_0x5ceb12=_0x471db4,_0x325454=[];return this['points'][_0x5ceb12(_0x323f6f._0x33dfe8)](_0x27b330=>{_0x325454['push'](_0x27b330['toArray']());}),_0x325454;}get['rectangle'](){return this['_rectangle'];}[_0x471db4(0x77)](_0x55f541,_0x46b8de){_0x55f541['positions']&&(this['positions']=_0x55f541['positions']);}[_0x471db4(0x92)](){const _0x16ee59=_0x471db4;this['style']['type']==='image'?this['_layer']=new mars3d__namespace['layer']['ImageLayer']({'crs':'EPSG:3857','private':!![]}):this['_layer']=new mars3d__namespace[(_0x16ee59(0xc1))]['GraphicLayer']({'private':!![]});}['_addedHook'](){const _0x50708d={_0x16cbfc:0xc2},_0x2c9627=_0x471db4;this['_map']['addLayer'](this['_layer']),this['_container']=mars3d__namespace['DomUtil']['create']('div','mars3d-heatmap\x20mars3d-hideDiv',this['_map']['container']),this['options'][_0x2c9627(0xa5)]&&(this['positions']=this['options']['positions']),this[_0x2c9627(_0x50708d._0x16cbfc)]['flyTo']&&this['flyToByAnimationEnd']();}[_0x471db4(0x95)](){const _0xc70314={_0x11e9c7:0xa2,_0x1cdb36:0x97},_0x176a2b=_0x471db4;this['_container']&&(mars3d__namespace[_0x176a2b(_0xc70314._0x11e9c7)][_0x176a2b(0x7e)](this['_container']),delete this['_container']),this[_0x176a2b(0x88)](),this[_0x176a2b(_0xc70314._0x1cdb36)]['removeLayer'](this['_layer']);}['addPosition'](_0x17e9ae,_0x4492e5){this['_positions']=this['_positions']||[],this['_positions']['push'](_0x17e9ae),this['_updatePositionsHook'](_0x4492e5);}['setPositions'](_0x13ac35,_0x253e1c){this['_positions']=_0x13ac35,this['_updatePositionsHook'](_0x253e1c);}['clear'](){const _0x3ccd27={_0x1df7bd:0x73,_0x5bba24:0x80,_0xd31dbe:0xca},_0x2c3d41=_0x471db4;this[_0x2c3d41(_0x3ccd27._0x1df7bd)]&&(this['_layer']['removeGraphic'](this[_0x2c3d41(_0x3ccd27._0x1df7bd)],!![]),delete this['_graphic']),this[_0x2c3d41(0xca)]&&(this['_layer'][_0x2c3d41(_0x3ccd27._0x5bba24)](this[_0x2c3d41(_0x3ccd27._0xd31dbe)],!![]),delete this['_graphic2']);}['_updatePositionsHook'](_0x575efb){const _0xfd04e7={_0x20dc1e:0x70,_0x48c456:0x78,_0x5071d1:0xc6,_0x1a7638:0x79,_0x4277fc:0xca},_0x597ab0=_0x471db4;if(!this['show']||!this['_map']||!this['positions']||this['positions'][_0x597ab0(0x96)]===0x0)return this;const _0x4504bb=this['_getHeatCanvas']();if(this['style']['type']==='image')this[_0x597ab0(0xa0)]['setOptions']({'url':_0x4504bb['toDataURL']('image/png'),'rectangle':this['_rectangle'],'opacity':this['style'][_0x597ab0(_0xfd04e7._0x20dc1e)]});else this[_0x597ab0(_0xfd04e7._0x48c456)]['arc']?this['_graphic']&&_0x575efb?(this['_graphic']['uniforms'][_0x597ab0(_0xfd04e7._0x5071d1)]=_0x4504bb,this['_graphic']['uniforms']['bumpMap']=this[_0x597ab0(_0xfd04e7._0x1a7638)](),this['_graphic2']&&(this['_graphic2']['uniforms']['image']=_0x4504bb,this[_0x597ab0(_0xfd04e7._0x4277fc)]['uniforms']['bumpMap']=this['_graphic']['uniforms']['bumpMap'])):this['_createArcGraphic'](_0x4504bb):this[_0x597ab0(0x73)]&&_0x575efb?this[_0x597ab0(0x73)][_0x597ab0(0x85)]['image']=_0x4504bb:this['_createGraphic'](_0x4504bb);return this;}[_0x471db4(0xcb)](_0x252bfa){const _0x5d101c={_0x44782a:0xa0},_0x5d5cb1=_0x471db4;this['clear'](),this['_graphic']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'material':new Cesium[(_0x5d5cb1(0xa6))]({'fabric':{'uniforms':{'image':_0x252bfa},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})}),this[_0x5d5cb1(_0x5d101c._0x44782a)]['addGraphic'](this['_graphic']);}['_createArcGraphic'](_0x46b555){const _0x3f04b2={_0x54a4a1:0xa3,_0x559199:0xce,_0x98c3d0:0xce,_0x17ca7d:0x7a,_0x5210cd:0xb7,_0x1dd9dc:0x98,_0x2a7b51:0xbd,_0x57fd36:0x7d,_0x9beee5:0x78,_0x3fe7af:0xb6,_0x170359:0xa0},_0x5f4006=_0x471db4;this['clear']();const _0x4b7e90=Cesium[_0x5f4006(0xb8)]['fromCache']({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium[_0x5f4006(_0x3f04b2._0x54a4a1)]['ALWAYS'],'frontOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium[_0x5f4006(0xce)]['KEEP'],'zPass':Cesium[_0x5f4006(_0x3f04b2._0x559199)]['REPLACE']},'backFunction':Cesium['StencilFunction']['ALWAYS'],'backOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium[_0x5f4006(_0x3f04b2._0x98c3d0)]['KEEP'],'zPass':Cesium['StencilOperation']['REPLACE']},'reference':0x2,'mask':0x2},'blending':Cesium[_0x5f4006(_0x3f04b2._0x17ca7d)]['ALPHA_BLEND']}),_0x2516dc=Math['floor'](this[_0x5f4006(0x78)]['diffHeight']??this[_0x5f4006(_0x3f04b2._0x5210cd)]*0.02)+0.1;this[_0x5f4006(0x78)]['diffHeight']&&delete this['style']['diffHeight'];const _0x1e25d7=(this[_0x5f4006(0x78)][_0x5f4006(0x75)],0x64);let _0x198061=Math['max'](this[_0x5f4006(0x8d)]['height'],this['_rectangle'][_0x5f4006(_0x3f04b2._0x1dd9dc)]);this['style']['granularity']=_0x198061/=_0x1e25d7;const _0x44052f=new Cesium['Material']({'fabric':{'uniforms':{'image':_0x46b555,'repeat':new Cesium['Cartesian2'](0x1,0x1),'color':new Cesium['Color'](0x1,0x1,0x1,0x0),'bumpMap':this['_getArcHeatCanvas']()},'source':HeatMaterial},'translucent':!![]}),_0x5cdc44=this[_0x5f4006(0x78)]['arcDirection']||0x1;this['_graphic']=new mars3d__namespace['graphic'][(_0x5f4006(_0x3f04b2._0x2a7b51))]({...this['options'],'rectangle':this[_0x5f4006(0x8d)],'appearance':new Cesium[(_0x5f4006(_0x3f04b2._0x57fd36))]({'flat':!![],'aboveGround':!![],'renderState':_0x4b7e90,'material':_0x44052f,'vertexShaderSource':getVertexShaderSource(_0x2516dc*_0x5cdc44)})}),this['_layer']['addGraphic'](this['_graphic']),this[_0x5f4006(_0x3f04b2._0x9beee5)]['arcDirection']===0x0&&(this['_graphic2']=new mars3d__namespace[(_0x5f4006(_0x3f04b2._0x3fe7af))]['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x4b7e90,'material':_0x44052f,'vertexShaderSource':getVertexShaderSource(-_0x2516dc)})}),this[_0x5f4006(_0x3f04b2._0x170359)][_0x5f4006(0xaf)](this['_graphic2']));}['getRectangle'](_0x3289a1){const _0x55696b={_0x66d939:0xb2,_0x211648:0x8d},_0xfda500=_0x471db4;return _0x3289a1!==null&&_0x3289a1!==void 0x0&&_0x3289a1['isFormat']&&this['_rectangle']?mars3d__namespace[_0xfda500(_0x55696b._0x66d939)]['formatRectangle'](this[_0xfda500(_0x55696b._0x211648)]):this['_rectangle'];}['_getHeatCanvas'](){const _0x3dcae2={_0x42720c:0xb4,_0x34cbe4:0x7f,_0x2fc6e7:0x84,_0x596172:0xb7,_0x5a7743:0x94,_0x2dd553:0x7c,_0x118e22:0xbc},_0x421d5f={_0x2c98b9:0x9f,_0x2eeed2:0x99,_0x5219a4:0xd0},_0x25098a={_0x477500:0x9d},_0x3eb2b3=_0x471db4,_0xa49f4f=this['_positions'],_0x34c256=[];let _0xb2aa73,_0x140aa1,_0x58f57e,_0xc1f58c;_0xa49f4f[_0x3eb2b3(_0x3dcae2._0x42720c)](_0x299f78=>{const _0x186a22=_0x3eb2b3,_0x182009=mars3d__namespace[_0x186a22(0xcd)]['parse'](_0x299f78);if(!_0x182009)return;_0x182009['value']=_0x299f78['value']||0x1,!this[_0x186a22(0xc2)]['rectangle']&&(_0xb2aa73===undefined?(_0xb2aa73=_0x182009['lng'],_0x140aa1=_0x182009[_0x186a22(0x9d)],_0x58f57e=_0x182009['lat'],_0xc1f58c=_0x182009['lat']):(_0xb2aa73=Math['min'](_0xb2aa73,_0x182009['lng']),_0x140aa1=Math[_0x186a22(0xd0)](_0x140aa1,_0x182009[_0x186a22(_0x25098a._0x477500)]),_0x58f57e=Math[_0x186a22(0xcf)](_0x58f57e,_0x182009[_0x186a22(0x71)]),_0xc1f58c=Math[_0x186a22(0xd0)](_0xc1f58c,_0x182009['lat']))),_0x34c256['push'](_0x182009);});_0xb2aa73===_0x140aa1&&(_0xb2aa73-=0.000001,_0x140aa1+=0.000001);_0x58f57e===_0xc1f58c&&(_0x58f57e-=0.000001,_0xc1f58c+=0.000001);let _0x4209d9=this['options']['rectangle']||{'xmin':_0xb2aa73,'xmax':_0x140aa1,'ymin':_0x58f57e,'ymax':_0xc1f58c};const _0x1174a0=getMercatorBounds(_0x4209d9),_0x4e5eb9=Math['abs'](_0x1174a0['xmax']-_0x1174a0['xmin']),_0x3c08ce=Math[_0x3eb2b3(_0x3dcae2._0x34cbe4)](_0x1174a0[_0x3eb2b3(_0x3dcae2._0x2fc6e7)]-_0x1174a0['ymin']),_0x505548=Math['max'](_0x4e5eb9,_0x3c08ce),_0x360b76=Math['min'](_0x4e5eb9,_0x3c08ce);this[_0x3eb2b3(_0x3dcae2._0x596172)]=_0x505548;let _0x7c22a3=0x1;if(_0x505548>this[_0x3eb2b3(0xc2)]['maxCanvasSize'])_0x7c22a3=_0x505548/this[_0x3eb2b3(0xc2)]['maxCanvasSize'],_0x360b76/_0x7c22a3<this[_0x3eb2b3(0xc2)]['minCanvasSize']&&(_0x7c22a3=_0x360b76/this['options']['minCanvasSize']);else _0x360b76<this['options']['minCanvasSize']&&(_0x7c22a3=_0x360b76/this['options']['minCanvasSize'],_0x505548/_0x7c22a3>this['options'][_0x3eb2b3(_0x3dcae2._0x5a7743)]&&(_0x7c22a3=_0x505548/this[_0x3eb2b3(0xc2)]['maxCanvasSize']));const _0x31f165=this['heatStyle']['radius']*1.5,_0xb375a2=_0x4e5eb9/_0x7c22a3+_0x31f165*0x2,_0x4e4cae=_0x3c08ce/_0x7c22a3+_0x31f165*0x2,_0xe757f=_0x31f165*_0x7c22a3;_0x1174a0['xmin']-=_0xe757f,_0x1174a0['ymin']-=_0xe757f,_0x1174a0[_0x3eb2b3(0xb1)]+=_0xe757f,_0x1174a0['ymax']+=_0xe757f,this['_scale']=_0x7c22a3,_0x4209d9=geLatLngBounds(_0x1174a0),this[_0x3eb2b3(0x8d)]=Cesium[_0x3eb2b3(0x8e)]['fromDegrees'](_0x4209d9['xmin'],_0x4209d9['ymin'],_0x4209d9['xmax'],_0x4209d9['ymax']);let _0x2cfa94=_0x34c256[0x0]['value']??0x1,_0x3e35ef=_0x34c256[0x0]['value']??0x0;const _0x5a68d6=[];_0x34c256['forEach'](_0x2f224a=>{const _0x1e21ce=_0x3eb2b3,_0xd93d56=mars3d__namespace[_0x1e21ce(_0x421d5f._0x2c98b9)][_0x1e21ce(0xb5)]([_0x2f224a[_0x1e21ce(0x9d)],_0x2f224a['lat']]),_0x14d0f2=_0x2f224a[_0x1e21ce(0xa7)]||0x1,_0x33972d=Math['round']((_0xd93d56[0x0]-_0x1174a0['xmin'])/_0x7c22a3),_0x46a382=Math[_0x1e21ce(_0x421d5f._0x2eeed2)]((_0x1174a0[_0x1e21ce(0x84)]-_0xd93d56[0x1])/_0x7c22a3);_0x2cfa94=Math[_0x1e21ce(_0x421d5f._0x5219a4)](_0x2cfa94,_0x14d0f2),_0x3e35ef=Math['min'](_0x3e35ef,_0x14d0f2),_0x5a68d6['push']({'x':_0x33972d,'y':_0x46a382,'value':_0x14d0f2});});const _0x192d20={'min':this['options'][_0x3eb2b3(0xcf)]??_0x3e35ef,'max':this['options']['max']??_0x2cfa94,'data':_0x5a68d6};this[_0x3eb2b3(_0x3dcae2._0x2dd553)]=_0x192d20;if(!this['_last_mBounds']||_0x1174a0['xmin']!==this['_last_mBounds']['xmin']||_0x1174a0['ymin']!==this['_last_mBounds']['ymin']||_0x1174a0['xmax']!==this['_last_mBounds']['xmax']||_0x1174a0['ymax']!==this['_last_mBounds'][_0x3eb2b3(0x84)]){this['_last_mBounds']=_0x1174a0,this['_container']['style']['cssText']=_0x3eb2b3(0x8f)+_0xb375a2+_0x3eb2b3(0x72)+_0x4e4cae+'px;';const _0x2cecfc={...this['heatStyle'],'container':this[_0x3eb2b3(_0x3dcae2._0x118e22)]};!this['_heat']?this['_heat']=h337__namespace[_0x3eb2b3(0xaa)](_0x2cecfc):this[_0x3eb2b3(0xcc)]['configure'](_0x2cecfc);}this['_heat'][_0x3eb2b3(0x9c)](_0x192d20);const _0x13d0de=mars3d__namespace['DomUtil']['copyCanvas'](this[_0x3eb2b3(0xcc)]['_renderer']['canvas']);return _0x13d0de;}[_0x471db4(0x79)](){const _0x31a695={_0x74ea49:0xc8,_0xb9f7f1:0x81,_0x1fb3f4:0x8b},_0xe83f44=_0x471db4;this['_heat']['configure']({'radius':this[_0xe83f44(_0x31a695._0x74ea49)]['radius']*this['style']['arcRadiusScale'],'blur':this['heatStyle'][_0xe83f44(_0x31a695._0xb9f7f1)]*this[_0xe83f44(0x78)]['arcBlurScale'],'gradient':this[_0xe83f44(_0x31a695._0x74ea49)][_0xe83f44(0xa9)]||{0.25:'rgb(0,0,0)',0.55:_0xe83f44(0x9a),0.85:_0xe83f44(0xbf),0x1:'rgb(255,255,255)'}});const _0x456b67=mars3d__namespace['DomUtil']['copyCanvas'](this['_heat'][_0xe83f44(_0x31a695._0x1fb3f4)]['canvas']);return this['_heat'][_0xe83f44(0x90)](this['options']['heatStyle']),_0x456b67;}[_0x471db4(0x9b)](_0x33b9cc){const _0x43cbec={_0x2c910c:0xae,_0x57e8a4:0x9d,_0x3b527f:0x89,_0x30dd85:0x99,_0x3e71cd:0x99,_0x5d6c16:0x84,_0x43f48f:0xc3},_0x46f53c=_0x471db4,_0x3217fc=mars3d__namespace['LngLatPoint'][_0x46f53c(_0x43cbec._0x2c910c)](_0x33b9cc);if(!_0x3217fc)return{};const _0x24b539=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x3217fc[_0x46f53c(_0x43cbec._0x57e8a4)],_0x3217fc['lat']]),_0x363c53=this[_0x46f53c(_0x43cbec._0x3b527f)],_0x3a98a3=Math[_0x46f53c(_0x43cbec._0x30dd85)]((_0x24b539[0x0]-_0x363c53['xmin'])/this[_0x46f53c(0x74)]),_0x188716=Math[_0x46f53c(_0x43cbec._0x3e71cd)]((_0x363c53[_0x46f53c(_0x43cbec._0x5d6c16)]-_0x24b539[0x1])/this['_scale']),_0x5fd228=this['_heat'][_0x46f53c(_0x43cbec._0x43f48f)]({'x':_0x3a98a3,'y':_0x188716}),_0x5d3d7f=this['_heat']['_renderer']['ctx']['getImageData'](_0x3a98a3-0x1,_0x188716-0x1,0x1,0x1)['data'];return{'x':_0x3a98a3,'y':_0x188716,'value':_0x5fd228,'color':_0x46f53c(0xad)+_0x5d3d7f[0x0]+','+_0x5d3d7f[0x1]+','+_0x5d3d7f[0x2]+','+_0x5d3d7f[0x3]+')'};}}mars3d__namespace[_0x471db4(0xa4)]['register']('heat',HeatLayer),mars3d__namespace['layer']['HeatLayer']=HeatLayer,mars3d__namespace['h337']=h337__namespace;function getMercatorBounds(_0x46ccb9){const _0x26fca7={_0x475f37:0xb1},_0x6f7fa3=_0x471db4,_0x11cc47=mars3d__namespace[_0x6f7fa3(0x9f)]['lonlat2mercator']([_0x46ccb9['xmin'],_0x46ccb9['ymin']]),_0x4f12b4=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x46ccb9[_0x6f7fa3(_0x26fca7._0x475f37)],_0x46ccb9[_0x6f7fa3(0x84)]]);return{'xmin':_0x11cc47[0x0],'ymin':_0x11cc47[0x1],'xmax':_0x4f12b4[0x0],'ymax':_0x4f12b4[0x1]};}function geLatLngBounds(_0x5cbbd5){const _0x1dba35={_0x34396c:0xac},_0x4fceda=_0x471db4,_0xef2ea2=mars3d__namespace['PointTrans'][_0x4fceda(0x76)]([_0x5cbbd5[_0x4fceda(_0x1dba35._0x34396c)],_0x5cbbd5['ymin']]),_0x3aeec9=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x5cbbd5['xmax'],_0x5cbbd5['ymax']]);return{'xmin':_0xef2ea2[0x0],'ymin':_0xef2ea2[0x1],'xmax':_0x3aeec9[0x0],'ymax':_0x3aeec9[0x1]};}function getVertexShaderSource(_0x23048a){return'in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20'+_0x23048a+';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a';}exports[_0x471db4(0xab)]=HeatLayer,Object['defineProperty'](exports,_0x471db4(0x8c),{'value':!![]});
}));
