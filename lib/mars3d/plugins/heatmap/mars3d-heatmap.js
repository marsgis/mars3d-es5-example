/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.7.3
 * 编译日期：2024-02-05 13:29:31
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2024-01-15
 */
(function (global, factory) {
	typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d'))) :
	typeof define === 'function' && define.amd ? define(['exports', 'mars3d'], factory) :
	(global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d));
})(this, (function (exports, mars3d) { 
'use strict';var _0x37e774=_0x5d9c;(function(_0x2d57d9,_0x5758af){var _0x2aa4bf={_0x347277:0xf3,_0xb7146f:0xb6,_0x3eed2f:0xed},_0x29fd73=_0x5d9c,_0x232897=_0x2d57d9();while(!![]){try{var _0x2d3459=-parseInt(_0x29fd73(0x122))/0x1*(parseInt(_0x29fd73(0xc3))/0x2)+parseInt(_0x29fd73(0x11f))/0x3*(parseInt(_0x29fd73(_0x2aa4bf._0x347277))/0x4)+-parseInt(_0x29fd73(_0x2aa4bf._0xb7146f))/0x5*(-parseInt(_0x29fd73(0xe5))/0x6)+parseInt(_0x29fd73(0x113))/0x7*(-parseInt(_0x29fd73(0xe3))/0x8)+-parseInt(_0x29fd73(0x12c))/0x9*(-parseInt(_0x29fd73(_0x2aa4bf._0x3eed2f))/0xa)+parseInt(_0x29fd73(0xb9))/0xb*(-parseInt(_0x29fd73(0xa6))/0xc)+-parseInt(_0x29fd73(0x10c))/0xd*(parseInt(_0x29fd73(0xdb))/0xe);if(_0x2d3459===_0x5758af)break;else _0x232897['push'](_0x232897['shift']());}catch(_0x5ccf96){_0x232897['push'](_0x232897['shift']());}}}(_0xa9d3,0xce916));function _interopNamespace(_0x29899c){var _0x34df3c={_0x32d00c:0xe2,_0x42258c:0xb7},_0x41271=_0x5d9c;if(_0x29899c&&_0x29899c[_0x41271(_0x34df3c._0x32d00c)])return _0x29899c;var _0x1a8135=Object[_0x41271(_0x34df3c._0x42258c)](null);return _0x29899c&&Object[_0x41271(0xe9)](_0x29899c)['forEach'](function(_0x1ae26d){var _0x2dcc5f=_0x41271;if(_0x1ae26d!=='default'){var _0x2d0970=Object[_0x2dcc5f(0xc9)](_0x29899c,_0x1ae26d);Object[_0x2dcc5f(0xbc)](_0x1a8135,_0x1ae26d,_0x2d0970['get']?_0x2d0970:{'enumerable':!![],'get':function(){return _0x29899c[_0x1ae26d];}});}}),_0x1a8135[_0x41271(0xb2)]=_0x29899c,_0x1a8135;}function _0x5d9c(_0x14ab7f,_0x21f2df){var _0xa9d386=_0xa9d3();return _0x5d9c=function(_0x5d9c8a,_0x3a4979){_0x5d9c8a=_0x5d9c8a-0x98;var _0x3f4996=_0xa9d386[_0x5d9c8a];return _0x3f4996;},_0x5d9c(_0x14ab7f,_0x21f2df);}function _mergeNamespaces(_0x5c740b,_0x1409e4){var _0xbbd960={_0x3517b7:0xc9};return _0x1409e4['forEach'](function(_0x3c5c79){_0x3c5c79&&typeof _0x3c5c79!=='string'&&!Array['isArray'](_0x3c5c79)&&Object['keys'](_0x3c5c79)['forEach'](function(_0x4796a1){var _0x128b6a=_0x5d9c;if(_0x4796a1!=='default'&&!(_0x4796a1 in _0x5c740b)){var _0x520dbe=Object[_0x128b6a(_0xbbd960._0x3517b7)](_0x3c5c79,_0x4796a1);Object['defineProperty'](_0x5c740b,_0x4796a1,_0x520dbe['get']?_0x520dbe:{'enumerable':!![],'get':function(){return _0x3c5c79[_0x4796a1];}});}});}),_0x5c740b;}function _0xa9d3(){var _0x466e0f=['div','plugin','xmax','_radi','positions','defaultRenderer','position:absolute;left:0;top:0;','renderPartial','Material','_clear','RectanglePrimitive','713937PWVKpw','_data','defaultGradient','13xMFYej','extremachange','toDataURL','style','setPositions','arcDirection','width','renderall','plugins','_createGraphic','7209ElVLVf','HeatLayer','_last_mBounds','isFormat','_onExtremaChange','lng','lonlat2mercator','radi','addGraphic','heatStyle','_valueField','graphic','granularity','max','rgba(0,0,0,0)','Rectangle','getContext','请引入\x20heatmap.js\x20库\x20','rgb(216,216,216)','_mBoundsMax','rectangle','_templates','apply','backgroundColor','_config','defaultXField','configure','lat','_height','exports','canvas2d','PointTrans','12Srpuzl','forEach','renderer','ALPHA_BLEND','ymin','_minOpacity','push','image','_unOrganizeData','_map','LngLatPoint','_rectangle','default','Util','_heat','_getInternalData','1973975ZpIKRZ','create','fromCache','14696044Cfjnmr','emit','arcBlurScale','defineProperty','uniforms','merge','arc','updateConfig','abs','StencilFunction','158102vQUohj','_layer','defaultMaxOpacity','_renderer','copyCanvas','_palette','getOwnPropertyDescriptor','radius','value','yellow','_getArcHeatCanvas','remove','container','KEEP','_container','getPointData','ImageLayer','ymax','_positions','_graphic','getValueAt','body','splitNum','options','1329650xkTEch','_store','_renderBoundaries','_min','getDataURL','_graphic2','call','__esModule','776rCWpSX','layer','18mIIpwc','position','rgb(0,255,0)','addColorStop','keys','setDataMax','heat','BaseLayer','17160kEtCdV','height','_removedHook','data','blur','xmin','24tzrmPw','_coordinator','removeData','flyTo','diffHeight','onExtremaChange','addPosition','_max','clientHeight','renderpartial','rgb(140,140,140)','round','heatmap-canvas','flyToByAnimationEnd','gradient','parse','replace','removeGraphic','EllipsoidSurfaceAppearance','_width','canvas','ALWAYS','minCanvasSize','StencilOperation','createElement','39dJOtXo','min','defaultRadius','clear','length','getData','_opacity','35511GYLYDR'];_0xa9d3=function(){return _0x466e0f;};return _0xa9d3();}var mars3d__namespace=_interopNamespace(mars3d),commonjsGlobal=typeof globalThis!=='undefined'?globalThis:typeof window!=='undefined'?window:typeof global!=='undefined'?global:typeof self!=='undefined'?self:{},heatmap$1={'exports':{}};(function(_0x48b698){var _0x423239={_0x283a76:0x10e};(function(_0xa3b0e0,_0x1c675e,_0x36d102){_0x48b698['exports']?_0x48b698['exports']=_0x36d102():_0x1c675e[_0xa3b0e0]=_0x36d102();}('h337',commonjsGlobal,function(){var _0x4b541e={_0x337aa4:0xc6},_0x4fede0={_0xbe5f1f:0xf5,_0x1a4d3a:0x9c,_0xdcec8d:0xdc},_0x2d6595={_0x4f10da:0xf4,_0x2811d2:0x115,_0x4c7f0a:0x12a},_0x209cc6={_0x4720be:0xdc,_0x23b8b1:0xfc},_0x26d317={_0x2a70e0:0x119},_0x33ddc6={_0x58f345:0xc8},_0x2f80f2={_0x2a7901:0xff,_0x5ddb69:0x106,_0x420601:0x128,_0x5d8e87:0x103,_0x2603bf:0x13c,_0x16af7d:0xe6},_0x4858c6={_0x155b00:0x128,_0x41e148:0xe8},_0x36541d={_0x50207d:0x121,_0x380333:0xe8},_0x2b72b7={_0x567e81:0xae},_0xce537d={_0x4d9e1f:0xf0,_0x58479b:0x110,_0x8c8da7:0x130},_0x3e43f2={_0x2314e2:0x120,_0x114329:0xfa},_0xaef154={_0x2981c2:0x117},_0x2da34f={_0x4a0f8e:0x136},_0x15fee6=_0x5d9c,_0x52e892={'defaultRadius':0x28,'defaultRenderer':'canvas2d','defaultGradient':{0.25:'rgb(0,0,255)',0.55:_0x15fee6(0xe7),0.85:'yellow',0x1:'rgb(255,0,0)'},'defaultMaxOpacity':0x1,'defaultMinOpacity':0x0,'defaultBlur':0.85,'defaultXField':'x','defaultYField':'y','defaultValueField':'value','plugins':{}},_0x5356e7=function _0x2a0de7(){var _0x5796cf={_0xc12be4:0x120},_0xd4ddcf={_0xf59cb3:0xba,_0x3dd91f:0xb5},_0x4adf3a={_0x290ce8:0xde},_0x343831=_0x15fee6,_0xbc9e3a=function _0x2ad031(_0x301bac){var _0x3df7e6=_0x5d9c;this[_0x3df7e6(0xf4)]={},this['_data']=[],this['_radi']=[],this['_min']=0xa,this[_0x3df7e6(0xfa)]=0x1,this['_xField']=_0x301bac['xField']||_0x301bac[_0x3df7e6(0x9f)],this['_yField']=_0x301bac['yField']||_0x301bac['defaultYField'],this[_0x3df7e6(_0x2da34f._0x4a0f8e)]=_0x301bac['valueField']||_0x301bac['defaultValueField'],_0x301bac['radius']&&(this['_cfgRadius']=_0x301bac['radius']);},_0x2ac191=_0x52e892[_0x343831(_0x423239._0x283a76)];return _0xbc9e3a['prototype']={'_organiseData':function(_0x50cc24,_0x2ee441){var _0x2f334c=_0x343831,_0x4e61e8=_0x50cc24[this['_xField']],_0x354c16=_0x50cc24[this['_yField']],_0x5e7230=this[_0x2f334c(0x117)],_0x3c39af=this['_data'],_0xfd64d5=this['_max'],_0x1096e0=this['_min'],_0x1a429a=_0x50cc24[this['_valueField']]||0x1,_0x3b98a2=_0x50cc24['radius']||this['_cfgRadius']||_0x2ac191;!_0x3c39af[_0x4e61e8]&&(_0x3c39af[_0x4e61e8]=[],_0x5e7230[_0x4e61e8]=[]);!_0x3c39af[_0x4e61e8][_0x354c16]?(_0x3c39af[_0x4e61e8][_0x354c16]=_0x1a429a,_0x5e7230[_0x4e61e8][_0x354c16]=_0x3b98a2):_0x3c39af[_0x4e61e8][_0x354c16]+=_0x1a429a;var _0x40cf48=_0x3c39af[_0x4e61e8][_0x354c16];if(_0x40cf48>_0xfd64d5)return!_0x2ee441?this['_max']=_0x40cf48:this['setDataMax'](_0x40cf48),![];else return _0x40cf48<_0x1096e0?(!_0x2ee441?this[_0x2f334c(_0x4adf3a._0x290ce8)]=_0x40cf48:this['setDataMin'](_0x40cf48),![]):{'x':_0x4e61e8,'y':_0x354c16,'value':_0x1a429a,'radius':_0x3b98a2,'min':_0x1096e0,'max':_0xfd64d5};},'_unOrganizeData':function(){var _0x5d4cf7=_0x343831,_0x35db48=[],_0x3fd34f=this[_0x5d4cf7(0x120)],_0x3a7349=this[_0x5d4cf7(_0xaef154._0x2981c2)];for(var _0x3e8502 in _0x3fd34f){for(var _0x4e5711 in _0x3fd34f[_0x3e8502]){_0x35db48['push']({'x':_0x3e8502,'y':_0x4e5711,'radius':_0x3a7349[_0x3e8502][_0x4e5711],'value':_0x3fd34f[_0x3e8502][_0x4e5711]});}}return{'min':this['_min'],'max':this[_0x5d4cf7(0xfa)],'data':_0x35db48};},'_onExtremaChange':function(){var _0x1ea260=_0x343831;this['_coordinator']['emit'](_0x1ea260(0x123),{'min':this[_0x1ea260(0xde)],'max':this['_max']});},'addData':function(){var _0x1226c4=_0x343831;if(arguments[0x0][_0x1226c4(0x110)]>0x0){var _0xd5013c=arguments[0x0],_0x434311=_0xd5013c['length'];while(_0x434311--){this['addData'][_0x1226c4(0xe1)](this,_0xd5013c[_0x434311]);}}else{var _0x404987=this['_organiseData'](arguments[0x0],!![]);_0x404987&&(this[_0x1226c4(_0x3e43f2._0x2314e2)]['length']===0x0&&(this['_min']=this['_max']=_0x404987['value']),this['_coordinator']['emit'](_0x1226c4(0xfc),{'min':this['_min'],'max':this[_0x1226c4(_0x3e43f2._0x114329)],'data':[_0x404987]}));}return this;},'setData':function(_0xebcc4a){var _0x5c86d7=_0x343831,_0x5e0efe=_0xebcc4a[_0x5c86d7(_0xce537d._0x4d9e1f)],_0x8dbe45=_0x5e0efe[_0x5c86d7(_0xce537d._0x58479b)];this['_data']=[],this[_0x5c86d7(0x117)]=[];for(var _0x25d663=0x0;_0x25d663<_0x8dbe45;_0x25d663++){this['_organiseData'](_0x5e0efe[_0x25d663],![]);}return this['_max']=_0xebcc4a['max'],this['_min']=_0xebcc4a['min']||0x0,this[_0x5c86d7(_0xce537d._0x8c8da7)](),this['_coordinator'][_0x5c86d7(0xba)]('renderall',this['_getInternalData']()),this;},'removeData':function(){},'setDataMax':function(_0x13eaa9){var _0x6cf80=_0x343831;return this['_max']=_0x13eaa9,this['_onExtremaChange'](),this['_coordinator']['emit'](_0x6cf80(0x129),this['_getInternalData']()),this;},'setDataMin':function(_0x15c6cb){var _0x34f024=_0x343831;return this['_min']=_0x15c6cb,this['_onExtremaChange'](),this[_0x34f024(0xf4)][_0x34f024(_0xd4ddcf._0xf59cb3)]('renderall',this[_0x34f024(_0xd4ddcf._0x3dd91f)]()),this;},'setCoordinator':function(_0x3f129e){var _0x4d4f6d=_0x343831;this[_0x4d4f6d(0xf4)]=_0x3f129e;},'_getInternalData':function(){var _0x4136b2=_0x343831;return{'max':this['_max'],'min':this['_min'],'data':this[_0x4136b2(_0x5796cf._0xc12be4)],'radi':this[_0x4136b2(0x117)]};},'getData':function(){var _0x24f9c2=_0x343831;return this[_0x24f9c2(_0x2b72b7._0x567e81)]();}},_0xbc9e3a;}(),_0x105bf4=function _0x129e98(){var _0x54ee19={_0x3210b4:0xf0,_0x49a34f:0xc1},_0x247476={_0x3b93e2:0xdd,_0x2208e8:0xab,_0x167ad1:0x110},_0x219e8d={_0x315285:0xca},_0x399f0f={_0x530cbc:0xf1,_0x4f8bca:0x9d,_0xbbee04:0x107,_0x5e161f:0x128,_0x439117:0xa2,_0x46a776:0x112,_0x1d87fe:0xc5},_0x452276={_0x336b9a:0x11d},_0x351d08={_0x1a5d50:0xe9,_0x2d75df:0xac},_0x4c1eba=function(_0x34989c){var _0x484775=_0x5d9c,_0x595552=_0x34989c['gradient']||_0x34989c[_0x484775(_0x36541d._0x50207d)],_0x2d531a=document[_0x484775(0x10b)]('canvas'),_0x40dfbf=_0x2d531a['getContext']('2d',{'willReadFrequently':!![]});_0x2d531a['width']=0x100,_0x2d531a['height']=0x1;var _0xee174a=_0x40dfbf['createLinearGradient'](0x0,0x0,0x100,0x1);for(var _0x2ac6d1 in _0x595552){_0xee174a[_0x484775(_0x36541d._0x380333)](_0x2ac6d1,_0x595552[_0x2ac6d1]);}return _0x40dfbf['fillStyle']=_0xee174a,_0x40dfbf['fillRect'](0x0,0x0,0x100,0x1),_0x40dfbf['getImageData'](0x0,0x0,0x100,0x1)[_0x484775(0xf0)];},_0x21711c=function(_0x6bf99,_0x248e1e){var _0x43f541=_0x5d9c,_0xdf12ec=document['createElement']('canvas'),_0x5813fc=_0xdf12ec['getContext']('2d',{'willReadFrequently':!![]}),_0x13c4f6=_0x6bf99,_0x5d5980=_0x6bf99;_0xdf12ec[_0x43f541(_0x4858c6._0x155b00)]=_0xdf12ec['height']=_0x6bf99*0x2;if(_0x248e1e==0x1)_0x5813fc['beginPath'](),_0x5813fc[_0x43f541(0xbf)](_0x13c4f6,_0x5d5980,_0x6bf99,0x0,0x2*Math['PI'],![]),_0x5813fc['fillStyle']='rgba(0,0,0,1)',_0x5813fc['fill']();else{var _0x5a0b81=_0x5813fc['createRadialGradient'](_0x13c4f6,_0x5d5980,_0x6bf99*_0x248e1e,_0x13c4f6,_0x5d5980,_0x6bf99);_0x5a0b81[_0x43f541(0xe8)](0x0,'rgba(0,0,0,1)'),_0x5a0b81[_0x43f541(_0x4858c6._0x41e148)](0x1,_0x43f541(0x13a)),_0x5813fc['fillStyle']=_0x5a0b81,_0x5813fc['fillRect'](0x0,0x0,0x2*_0x6bf99,0x2*_0x6bf99);}return _0xdf12ec;},_0x11456b=function(_0xb31024){var _0x4ce00d=_0x5d9c,_0x163ba2=[],_0x5e9a6a=_0xb31024['min'],_0x10e4a9=_0xb31024['max'],_0xff72fb=_0xb31024[_0x4ce00d(0x133)],_0xb31024=_0xb31024['data'],_0x157505=Object['keys'](_0xb31024),_0x1101de=_0x157505['length'];while(_0x1101de--){var _0x57f8b7=_0x157505[_0x1101de],_0x435b71=Object[_0x4ce00d(_0x351d08._0x1a5d50)](_0xb31024[_0x57f8b7]),_0x504b67=_0x435b71['length'];while(_0x504b67--){var _0x501569=_0x435b71[_0x504b67],_0x212e39=_0xb31024[_0x57f8b7][_0x501569],_0x54fcd3=_0xff72fb[_0x57f8b7][_0x501569];_0x163ba2[_0x4ce00d(_0x351d08._0x2d75df)]({'x':_0x57f8b7,'y':_0x501569,'value':_0x212e39,'radius':_0x54fcd3});}}return{'min':_0x5e9a6a,'max':_0x10e4a9,'data':_0x163ba2};};function _0x2babec(_0x2519fa){var _0x1447b9=_0x5d9c,_0x2a28b8=_0x2519fa['container'],_0x65f932=this['shadowCanvas']=document[_0x1447b9(0x10b)]('canvas'),_0x521ee7=this['canvas']=_0x2519fa['canvas']||document['createElement'](_0x1447b9(0x107));this['_renderBoundaries']=[0x2710,0x2710,0x0,0x0];var _0x5d5d7c=getComputedStyle(_0x2519fa['container'])||{};_0x521ee7['className']=_0x1447b9(_0x2f80f2._0x2a7901),this[_0x1447b9(_0x2f80f2._0x5ddb69)]=_0x521ee7[_0x1447b9(0x128)]=_0x65f932['width']=_0x2519fa[_0x1447b9(_0x2f80f2._0x420601)]||+_0x5d5d7c['width']['replace'](/px/,''),this['_height']=_0x521ee7['height']=_0x65f932['height']=_0x2519fa[_0x1447b9(0xee)]||+_0x5d5d7c['height'][_0x1447b9(_0x2f80f2._0x5d8e87)](/px/,''),this['shadowCtx']=_0x65f932['getContext']('2d',{'willReadFrequently':!![]}),this['ctx']=_0x521ee7[_0x1447b9(_0x2f80f2._0x2603bf)]('2d',{'willReadFrequently':!![]}),_0x521ee7['style']['cssText']=_0x65f932[_0x1447b9(0x125)]['cssText']=_0x1447b9(0x11a),_0x2a28b8['style'][_0x1447b9(_0x2f80f2._0x16af7d)]='relative',_0x2a28b8['appendChild'](_0x521ee7),this['_palette']=_0x4c1eba(_0x2519fa),this['_templates']={},this['_setStyles'](_0x2519fa);}return _0x2babec['prototype']={'renderPartial':function(_0x3bbfd6){_0x3bbfd6['data']['length']>0x0&&(this['_drawAlpha'](_0x3bbfd6),this['_colorize']());},'renderAll':function(_0x2581c0){var _0x589ceb=_0x5d9c;this[_0x589ceb(_0x452276._0x336b9a)](),_0x2581c0['data']['length']>0x0&&(this['_drawAlpha'](_0x11456b(_0x2581c0)),this['_colorize']());},'_updateGradient':function(_0x2005f0){var _0x8f640a=_0x5d9c;this[_0x8f640a(_0x33ddc6._0x58f345)]=_0x4c1eba(_0x2005f0);},'updateConfig':function(_0x1bcb56){_0x1bcb56['gradient']&&this['_updateGradient'](_0x1bcb56),this['_setStyles'](_0x1bcb56);},'setDimensions':function(_0x535276,_0x522fab){var _0x4519ab=_0x5d9c;this['_width']=_0x535276,this['_height']=_0x522fab,this[_0x4519ab(0x107)]['width']=this['shadowCanvas']['width']=_0x535276,this['canvas']['height']=this['shadowCanvas']['height']=_0x522fab;},'_clear':function(){var _0x1c25f5=_0x5d9c;this['shadowCtx']['clearRect'](0x0,0x0,this['_width'],this['_height']),this['ctx']['clearRect'](0x0,0x0,this[_0x1c25f5(0x106)],this['_height']);},'_setStyles':function(_0x22c530){var _0x56d156=_0x5d9c;this['_blur']=_0x22c530['blur']==0x0?0x0:_0x22c530[_0x56d156(_0x399f0f._0x530cbc)]||_0x22c530['defaultBlur'],_0x22c530[_0x56d156(_0x399f0f._0x4f8bca)]&&(this[_0x56d156(_0x399f0f._0xbbee04)]['style']['backgroundColor']=_0x22c530['backgroundColor']),this['_width']=this['canvas']['width']=this['shadowCanvas']['width']=_0x22c530[_0x56d156(_0x399f0f._0x5e161f)]||this['_width'],this['_height']=this[_0x56d156(_0x399f0f._0xbbee04)][_0x56d156(0xee)]=this['shadowCanvas']['height']=_0x22c530['height']||this[_0x56d156(_0x399f0f._0x439117)],this[_0x56d156(_0x399f0f._0x46a776)]=(_0x22c530['opacity']||0x0)*0xff,this['_maxOpacity']=(_0x22c530['maxOpacity']||_0x22c530[_0x56d156(_0x399f0f._0x1d87fe)])*0xff,this['_minOpacity']=(_0x22c530['minOpacity']||_0x22c530['defaultMinOpacity'])*0xff,this['_useGradientOpacity']=!!_0x22c530['useGradientOpacity'];},'_drawAlpha':function(_0xa1e8d5){var _0x3d8840=_0x5d9c,_0x358093=this['_min']=_0xa1e8d5['min'],_0x240fdf=this[_0x3d8840(0xfa)]=_0xa1e8d5['max'],_0xa1e8d5=_0xa1e8d5[_0x3d8840(0xf0)]||[],_0x5334e4=_0xa1e8d5['length'],_0x19fcc2=0x1-this['_blur'];while(_0x5334e4--){var _0x149946=_0xa1e8d5[_0x5334e4],_0x3a42bf=_0x149946['x'],_0x344b25=_0x149946['y'],_0x346378=_0x149946[_0x3d8840(_0x219e8d._0x315285)],_0xa183cf=Math['min'](_0x149946['value'],_0x240fdf),_0x2b79a3=_0x3a42bf-_0x346378,_0x31f2fb=_0x344b25-_0x346378,_0x3d636a=this['shadowCtx'],_0x475e47;!this[_0x3d8840(0x9b)][_0x346378]?this['_templates'][_0x346378]=_0x475e47=_0x21711c(_0x346378,_0x19fcc2):_0x475e47=this['_templates'][_0x346378];var _0x51aaef=(_0xa183cf-_0x358093)/(_0x240fdf-_0x358093);_0x3d636a['globalAlpha']=_0x51aaef<0.01?0.01:_0x51aaef,_0x3d636a['drawImage'](_0x475e47,_0x2b79a3,_0x31f2fb),_0x2b79a3<this['_renderBoundaries'][0x0]&&(this['_renderBoundaries'][0x0]=_0x2b79a3),_0x31f2fb<this['_renderBoundaries'][0x1]&&(this['_renderBoundaries'][0x1]=_0x31f2fb),_0x2b79a3+0x2*_0x346378>this['_renderBoundaries'][0x2]&&(this['_renderBoundaries'][0x2]=_0x2b79a3+0x2*_0x346378),_0x31f2fb+0x2*_0x346378>this['_renderBoundaries'][0x3]&&(this['_renderBoundaries'][0x3]=_0x31f2fb+0x2*_0x346378);}},'_colorize':function(){var _0x3e8a48=_0x5d9c,_0x3580d0=this['_renderBoundaries'][0x0],_0x5c18b5=this['_renderBoundaries'][0x1],_0x15e56b=this[_0x3e8a48(_0x247476._0x3b93e2)][0x2]-_0x3580d0,_0x4d5b85=this['_renderBoundaries'][0x3]-_0x5c18b5,_0x11d692=this['_width'],_0x5a5ce5=this[_0x3e8a48(0xa2)],_0x9310fb=this['_opacity'],_0x599f97=this['_maxOpacity'],_0x1380b4=this[_0x3e8a48(_0x247476._0x2208e8)],_0x91caaa=this['_useGradientOpacity'];_0x3580d0<0x0&&(_0x3580d0=0x0);_0x5c18b5<0x0&&(_0x5c18b5=0x0);_0x3580d0+_0x15e56b>_0x11d692&&(_0x15e56b=_0x11d692-_0x3580d0);_0x5c18b5+_0x4d5b85>_0x5a5ce5&&(_0x4d5b85=_0x5a5ce5-_0x5c18b5);var _0x146306=this['shadowCtx']['getImageData'](_0x3580d0,_0x5c18b5,_0x15e56b,_0x4d5b85),_0x45ff6a=_0x146306['data'],_0x10e67d=_0x45ff6a[_0x3e8a48(_0x247476._0x167ad1)],_0x295ff4=this['_palette'];for(var _0x3c117a=0x3;_0x3c117a<_0x10e67d;_0x3c117a+=0x4){var _0x3ad797=_0x45ff6a[_0x3c117a],_0x2f60f8=_0x3ad797*0x4;if(!_0x2f60f8)continue;var _0x37c9ee;_0x9310fb>0x0?_0x37c9ee=_0x9310fb:_0x3ad797<_0x599f97?_0x3ad797<_0x1380b4?_0x37c9ee=_0x1380b4:_0x37c9ee=_0x3ad797:_0x37c9ee=_0x599f97,_0x45ff6a[_0x3c117a-0x3]=_0x295ff4[_0x2f60f8],_0x45ff6a[_0x3c117a-0x2]=_0x295ff4[_0x2f60f8+0x1],_0x45ff6a[_0x3c117a-0x1]=_0x295ff4[_0x2f60f8+0x2],_0x45ff6a[_0x3c117a]=_0x91caaa?_0x295ff4[_0x2f60f8+0x3]:_0x37c9ee;}this['ctx']['putImageData'](_0x146306,_0x3580d0,_0x5c18b5),this['_renderBoundaries']=[0x3e8,0x3e8,0x0,0x0];},'getValueAt':function(_0x14d24c){var _0x411337=_0x5d9c,_0x84443e,_0x33308a=this['shadowCtx'],_0x193b71=_0x33308a['getImageData'](_0x14d24c['x'],_0x14d24c['y'],0x1,0x1),_0x36878c=_0x193b71[_0x411337(_0x54ee19._0x3210b4)][0x3],_0x224fd4=this['_max'],_0x5c3ce4=this['_min'];return _0x84443e=Math[_0x411337(_0x54ee19._0x49a34f)](_0x224fd4-_0x5c3ce4)*(_0x36878c/0xff)>>0x0,_0x84443e;},'getDataURL':function(){return this['canvas']['toDataURL']();}},_0x2babec;}(),_0x5e7958=function _0x48d8f1(){var _0x40a27f=_0x15fee6,_0x512212=![];return _0x52e892[_0x40a27f(_0x26d317._0x2a70e0)]===_0x40a27f(0xa4)&&(_0x512212=_0x105bf4),_0x512212;}(),_0x128ae7={'merge':function(){var _0x4cc01c={},_0x574f6b=arguments['length'];for(var _0xbb6c0=0x0;_0xbb6c0<_0x574f6b;_0xbb6c0++){var _0x405543=arguments[_0xbb6c0];for(var _0x2abc01 in _0x405543){_0x4cc01c[_0x2abc01]=_0x405543[_0x2abc01];}}return _0x4cc01c;}},_0x337a36=function _0x3411aa(){var _0x304d9d={_0x42340c:0x9e,_0x6219c2:0xbe,_0x3c6895:0xf4,_0x2a1c00:0x129,_0x4cb482:0xb5},_0x2e5784={_0x40463c:0xdc},_0x7727c0={_0x599f81:0x9e,_0x27044b:0x101},_0x29edc2=function _0x5e2553(){var _0x1065b6={_0x17f970:0xe1};function _0x13f226(){this['cStore']={};}return _0x13f226['prototype']={'on':function(_0x46bde7,_0xaeaa06,_0x309220){var _0x5d88c9=this['cStore'];!_0x5d88c9[_0x46bde7]&&(_0x5d88c9[_0x46bde7]=[]),_0x5d88c9[_0x46bde7]['push'](function(_0x3e1d39){var _0x437219=_0x5d9c;return _0xaeaa06[_0x437219(_0x1065b6._0x17f970)](_0x309220,_0x3e1d39);});},'emit':function(_0x4014e9,_0x4ff0d9){var _0x1b02fd=this['cStore'];if(_0x1b02fd[_0x4014e9]){var _0x3bd064=_0x1b02fd[_0x4014e9]['length'];for(var _0x16e07b=0x0;_0x16e07b<_0x3bd064;_0x16e07b++){var _0x5ed4d8=_0x1b02fd[_0x4014e9][_0x16e07b];_0x5ed4d8(_0x4ff0d9);}}}},_0x13f226;}(),_0x1011bb=function(_0x2cbfcb){var _0x16512e=_0x5d9c,_0x3b06d0=_0x2cbfcb['_renderer'],_0x554e23=_0x2cbfcb['_coordinator'],_0x1e4ac7=_0x2cbfcb[_0x16512e(_0x209cc6._0x4720be)];_0x554e23['on'](_0x16512e(_0x209cc6._0x23b8b1),_0x3b06d0[_0x16512e(0x11b)],_0x3b06d0),_0x554e23['on']('renderall',_0x3b06d0['renderAll'],_0x3b06d0),_0x554e23['on']('extremachange',function(_0x7f2eee){var _0x3b77a7=_0x16512e;_0x2cbfcb[_0x3b77a7(_0x7727c0._0x599f81)][_0x3b77a7(0xf8)]&&_0x2cbfcb[_0x3b77a7(0x9e)]['onExtremaChange']({'min':_0x7f2eee[_0x3b77a7(0x10d)],'max':_0x7f2eee['max'],'gradient':_0x2cbfcb['_config'][_0x3b77a7(_0x7727c0._0x27044b)]||_0x2cbfcb[_0x3b77a7(0x9e)]['defaultGradient']});}),_0x1e4ac7['setCoordinator'](_0x554e23);};function _0x1c29c4(){var _0x6720ff=_0x5d9c,_0x5eba1f=this[_0x6720ff(0x9e)]=_0x128ae7['merge'](_0x52e892,arguments[0x0]||{});this[_0x6720ff(_0x2d6595._0x4f10da)]=new _0x29edc2();if(_0x5eba1f[_0x6720ff(_0x2d6595._0x2811d2)]){var _0x325be1=_0x5eba1f['plugin'];if(!_0x52e892['plugins'][_0x325be1])throw new Error('Plugin\x20\x27'+_0x325be1+'\x27\x20not\x20found.\x20Maybe\x20it\x20was\x20not\x20registered.');else{var _0x41e118=_0x52e892[_0x6720ff(_0x2d6595._0x4c7f0a)][_0x325be1];this[_0x6720ff(0xc6)]=new _0x41e118[(_0x6720ff(0xa8))](_0x5eba1f),this['_store']=new _0x41e118['store'](_0x5eba1f);}}else this[_0x6720ff(0xc6)]=new _0x5e7958(_0x5eba1f),this[_0x6720ff(0xdc)]=new _0x5356e7(_0x5eba1f);_0x1011bb(this);}return _0x1c29c4['prototype']={'addData':function(){var _0x2852e8=_0x5d9c;return this[_0x2852e8(0xdc)]['addData'][_0x2852e8(0x9c)](this[_0x2852e8(0xdc)],arguments),this;},'removeData':function(){var _0x1bcc5f=_0x5d9c;return this['_store'][_0x1bcc5f(0xf5)]&&this[_0x1bcc5f(0xdc)][_0x1bcc5f(_0x4fede0._0xbe5f1f)][_0x1bcc5f(_0x4fede0._0x1a4d3a)](this[_0x1bcc5f(_0x4fede0._0xdcec8d)],arguments),this;},'setData':function(){var _0x40e934=_0x5d9c;return this[_0x40e934(_0x2e5784._0x40463c)]['setData']['apply'](this[_0x40e934(_0x2e5784._0x40463c)],arguments),this;},'setDataMax':function(){var _0x4af08e=_0x5d9c;return this['_store'][_0x4af08e(0xea)]['apply'](this['_store'],arguments),this;},'setDataMin':function(){return this['_store']['setDataMin']['apply'](this['_store'],arguments),this;},'configure':function(_0x4e03fb){var _0x199e0a=_0x5d9c;return this[_0x199e0a(_0x304d9d._0x42340c)]=_0x128ae7[_0x199e0a(_0x304d9d._0x6219c2)](this['_config'],_0x4e03fb),this['_renderer'][_0x199e0a(0xc0)](this['_config']),this[_0x199e0a(_0x304d9d._0x3c6895)]['emit'](_0x199e0a(_0x304d9d._0x2a1c00),this['_store'][_0x199e0a(_0x304d9d._0x4cb482)]()),this;},'repaint':function(){var _0x5130e1=_0x5d9c;return this['_coordinator'][_0x5130e1(0xba)]('renderall',this['_store']['_getInternalData']()),this;},'getData':function(){var _0x508424=_0x5d9c;return this['_store'][_0x508424(0x111)]();},'getDataURL':function(){var _0x2e8aa8=_0x5d9c;return this['_renderer'][_0x2e8aa8(0xdf)]();},'getValueAt':function(_0x449864){var _0x40aab8=_0x5d9c;if(this[_0x40aab8(0xdc)]['getValueAt'])return this['_store']['getValueAt'](_0x449864);else return this[_0x40aab8(_0x4b541e._0x337aa4)][_0x40aab8(0xd7)]?this[_0x40aab8(0xc6)]['getValueAt'](_0x449864):null;}},_0x1c29c4;}(),_0x13b2ec={'create':function(_0x36d8e4){return new _0x337a36(_0x36d8e4);},'register':function(_0x27a357,_0x177966){_0x52e892['plugins'][_0x27a357]=_0x177966;}};return _0x13b2ec;}));}(heatmap$1));var heatmap=heatmap$1[_0x37e774(0xa3)],h337=_mergeNamespaces({'__proto__':null,'default':heatmap},[heatmap$1['exports']]),HeatMaterial='uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a';if(!heatmap$1['exports']['create'])throw new Error(_0x37e774(0x13d));const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace[_0x37e774(0xe4)][_0x37e774(0xec)],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:'blue',0.6:'green',0.8:_0x37e774(0xcc),0.9:'red'}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium['EllipsoidSurfaceAppearance']['VERTEX_FORMAT']};class HeatLayer extends BaseLayer{constructor(_0x468f43={}){var _0x537d2d={_0x4a1f1b:0xda,_0x1ed313:0x10d,_0x1d5f8f:0xfb,_0x40228a:0x135},_0x15ef44=_0x37e774;super(_0x468f43),this['options']['maxCanvasSize']=this['options']['maxCanvasSize']??document['body']['clientWidth'],this[_0x15ef44(_0x537d2d._0x4a1f1b)]['maxCanvasSize']=Math[_0x15ef44(_0x537d2d._0x1ed313)](this['options']['maxCanvasSize'],0x1388),this['options'][_0x15ef44(0x109)]=this['options'][_0x15ef44(0x109)]??document[_0x15ef44(0xd8)][_0x15ef44(_0x537d2d._0x1d5f8f)],this['options']['minCanvasSize']=Math[_0x15ef44(0x139)](this['options']['minCanvasSize'],0x2bc),this[_0x15ef44(_0x537d2d._0x4a1f1b)]['heatStyle']={...DEF_HEATSTYLE,...this['options'][_0x15ef44(_0x537d2d._0x40228a)]},this['options']['style']={...DEF_STYLE,...this['options']['style']};}get['layer'](){return this['_layer'];}get['heatStyle'](){var _0x3a89f1=_0x37e774;return this['options'][_0x3a89f1(0x135)];}set[_0x37e774(0x135)](_0x4dc7e1){var _0x3b1d52={_0x4ba9fd:0xb3,_0x566222:0x135,_0x481413:0x135},_0x54aed3=_0x37e774;this['options']['heatStyle']=mars3d__namespace[_0x54aed3(_0x3b1d52._0x4ba9fd)]['merge'](this['options'][_0x54aed3(_0x3b1d52._0x566222)],_0x4dc7e1),this['_heat']&&(this[_0x54aed3(0xb4)]['configure'](this['options'][_0x54aed3(_0x3b1d52._0x481413)]),this['_updatePositionsHook'](!![]));}get['style'](){return this['options']['style'];}set['style'](_0x565477){var _0x10f932={_0x2ba73a:0xda,_0xd715eb:0x125},_0x5a0780=_0x37e774;this['options']['style']=mars3d__namespace[_0x5a0780(0xb3)]['merge'](this[_0x5a0780(_0x10f932._0x2ba73a)][_0x5a0780(_0x10f932._0xd715eb)],_0x565477);}get['positions'](){return this['_positions'];}set[_0x37e774(0x118)](_0x5daa19){var _0x4ca9fd={_0x1703ef:0x126},_0x8553af=_0x37e774;this[_0x8553af(_0x4ca9fd._0x1703ef)](_0x5daa19);}get['coordinates'](){var _0xce3378=_0x37e774;const _0xee91f=[];return this['points'][_0xce3378(0xa7)](_0x7af9d9=>{_0xee91f['push'](_0x7af9d9['toArray']());}),_0xee91f;}get[_0x37e774(0x9a)](){var _0x32b129={_0x51c191:0xb1},_0x3c13e3=_0x37e774;return this[_0x3c13e3(_0x32b129._0x51c191)];}['_setOptionsHook'](_0x327c19,_0x468db0){var _0x5ee873=_0x37e774;_0x327c19['positions']&&(this[_0x5ee873(0x118)]=_0x327c19['positions']);}['_mountedHook'](){var _0x7fb8ca={_0x490fc5:0xc4,_0x53609d:0xe4},_0x511b01=_0x37e774;this['style']['type']==='image'?this[_0x511b01(_0x7fb8ca._0x490fc5)]=new mars3d__namespace[(_0x511b01(_0x7fb8ca._0x53609d))][(_0x511b01(0xd3))]({'crs':'EPSG:3857','private':!![]}):this[_0x511b01(0xc4)]=new mars3d__namespace['layer']['GraphicLayer']({'private':!![]});}['_addedHook'](){var _0x57ac1f={_0x2eddd2:0x114,_0x43dd85:0xda,_0x2b1123:0xf6,_0xd51f96:0x100},_0x52a297=_0x37e774;this['_map']['addLayer'](this['_layer']),this['_container']=mars3d__namespace['DomUtil'][_0x52a297(0xb7)](_0x52a297(_0x57ac1f._0x2eddd2),'mars3d-heatmap\x20mars3d-hideDiv',this['_map'][_0x52a297(0xcf)]),this['options']['positions']&&(this['positions']=this[_0x52a297(_0x57ac1f._0x43dd85)]['positions']),this['options'][_0x52a297(_0x57ac1f._0x2b1123)]&&this[_0x52a297(_0x57ac1f._0xd51f96)]();}[_0x37e774(0xef)](){var _0x15217a={_0x5a5a1f:0xce},_0x2cb7da=_0x37e774;this['_container']&&(mars3d__namespace['DomUtil'][_0x2cb7da(_0x15217a._0x5a5a1f)](this['_container']),delete this['_container']),this['clear'](),this['_map']['removeLayer'](this[_0x2cb7da(0xc4)]);}[_0x37e774(0xf9)](_0x9ff4ef,_0x210f45){var _0x4e34ca={_0x5474fd:0xd5,_0x56007b:0xac},_0xe90eb8=_0x37e774;this['_positions']=this[_0xe90eb8(_0x4e34ca._0x5474fd)]||[],this['_positions'][_0xe90eb8(_0x4e34ca._0x56007b)](_0x9ff4ef),this['_updatePositionsHook'](_0x210f45);}[_0x37e774(0x126)](_0x35e455,_0xddf98b){var _0x3d0c23={_0x56c03c:0xd5},_0x14c3b6=_0x37e774;this[_0x14c3b6(_0x3d0c23._0x56c03c)]=_0x35e455,this['_updatePositionsHook'](_0xddf98b);}[_0x37e774(0x10f)](){var _0x3994a4={_0x2a9769:0xd6,_0xf5131:0xe0},_0x56efa8=_0x37e774;this[_0x56efa8(0xd6)]&&(this['_layer']['removeGraphic'](this['_graphic'],!![]),delete this[_0x56efa8(_0x3994a4._0x2a9769)]),this[_0x56efa8(0xe0)]&&(this['_layer'][_0x56efa8(0x104)](this[_0x56efa8(_0x3994a4._0xf5131)],!![]),delete this['_graphic2']);}['_updatePositionsHook'](_0x510066){var _0x3f3284={_0x15d93b:0x118,_0x501bf6:0xc4,_0x113328:0xe0,_0x5c956b:0xbd,_0x1ac71c:0xd6},_0x7250f8=_0x37e774;if(!this['show']||!this[_0x7250f8(0xaf)]||!this[_0x7250f8(_0x3f3284._0x15d93b)]||this['positions']['length']===0x0)return this;const _0x22ed80=this['_getHeatCanvas']();if(this['style']['type']===_0x7250f8(0xad))this[_0x7250f8(_0x3f3284._0x501bf6)]['setOptions']({'url':_0x22ed80[_0x7250f8(0x124)]('image/png',0x1),'rectangle':this['_rectangle'],'opacity':this[_0x7250f8(0x125)]['opacity']});else this['style']['arc']?this['_graphic']&&_0x510066?(this['_graphic']['uniforms']['image']=_0x22ed80,this['_graphic'][_0x7250f8(0xbd)]['bumpMap']=this['_getArcHeatCanvas'](),this['_graphic2']&&(this['_graphic2']['uniforms']['image']=_0x22ed80,this[_0x7250f8(_0x3f3284._0x113328)]['uniforms']['bumpMap']=this['_graphic'][_0x7250f8(_0x3f3284._0x5c956b)]['bumpMap'])):this['_createArcGraphic'](_0x22ed80):this['_graphic']&&_0x510066?this[_0x7250f8(_0x3f3284._0x1ac71c)]['uniforms']['image']=_0x22ed80:this[_0x7250f8(0x12b)](_0x22ed80);return this;}[_0x37e774(0x12b)](_0x5a3fed){var _0x5d81a6={_0x254b47:0x11e,_0x3bb6c9:0xb1},_0x3926f1=_0x37e774;this['clear'](),this['_graphic']=new mars3d__namespace[(_0x3926f1(0x137))][(_0x3926f1(_0x5d81a6._0x254b47))]({...this['options'],'rectangle':this[_0x3926f1(_0x5d81a6._0x3bb6c9)],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'material':mars3d__namespace['MaterialUtil']['createMaterial'](mars3d__namespace['MaterialType']['Image2'],{'image':_0x5a3fed}),'flat':!![]})}),this['_layer']['addGraphic'](this['_graphic']);}['_createArcGraphic'](_0x434d13){var _0x2dcc26={_0xda48c9:0x108,_0x37e5d3:0xc2,_0x5caac1:0x10a,_0x174bf1:0xf7,_0x1d1a89:0x125,_0x24b922:0x11c,_0x45c32f:0xcd,_0x46be8e:0xb1,_0x3b871d:0x105,_0x570d6b:0xe0},_0x29c823=_0x37e774;this[_0x29c823(0x10f)]();const _0x1c7ca4=Cesium['RenderState'][_0x29c823(0xb8)]({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium['StencilFunction'][_0x29c823(_0x2dcc26._0xda48c9)],'frontOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium['StencilOperation'][_0x29c823(0xd0)],'zPass':Cesium['StencilOperation']['REPLACE']},'backFunction':Cesium[_0x29c823(_0x2dcc26._0x37e5d3)]['ALWAYS'],'backOperation':{'fail':Cesium[_0x29c823(_0x2dcc26._0x5caac1)]['KEEP'],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium['StencilOperation']['REPLACE']},'reference':0x2,'mask':0x2},'blending':Cesium['BlendingState'][_0x29c823(0xa9)]}),_0xeae222=Math['floor'](this['style']['diffHeight']??this['_mBoundsMax']*0.02)+0.1;this['style'][_0x29c823(_0x2dcc26._0x174bf1)]&&delete this['style']['diffHeight'];const _0x456799=(this[_0x29c823(_0x2dcc26._0x1d1a89)][_0x29c823(0xd9)],0x64);let _0x260094=Math['max'](this['_rectangle']['height'],this['_rectangle']['width']);this['style'][_0x29c823(0x138)]=_0x260094/=_0x456799;const _0x22fb7e=new Cesium[(_0x29c823(_0x2dcc26._0x24b922))]({'fabric':{'uniforms':{'image':_0x434d13,'repeat':new Cesium['Cartesian2'](0x1,0x1),'color':new Cesium['Color'](0x1,0x1,0x1,0x0),'bumpMap':this[_0x29c823(_0x2dcc26._0x45c32f)]()},'source':HeatMaterial},'translucent':!![]}),_0x1d0ac7=this['style']['arcDirection']||0x1;this['_graphic']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this[_0x29c823(_0x2dcc26._0x46be8e)],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x1c7ca4,'material':_0x22fb7e,'vertexShaderSource':getVertexShaderSource(_0xeae222*_0x1d0ac7)})}),this['_layer'][_0x29c823(0x134)](this['_graphic']),this[_0x29c823(_0x2dcc26._0x1d1a89)][_0x29c823(0x127)]===0x0&&(this['_graphic2']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this[_0x29c823(0xda)],'rectangle':this['_rectangle'],'appearance':new Cesium[(_0x29c823(_0x2dcc26._0x3b871d))]({'flat':!![],'aboveGround':!![],'renderState':_0x1c7ca4,'material':_0x22fb7e,'vertexShaderSource':getVertexShaderSource(-_0xeae222)})}),this[_0x29c823(0xc4)][_0x29c823(0x134)](this[_0x29c823(_0x2dcc26._0x570d6b)]));}['getRectangle'](_0x50e527){var _0x8a9ede={_0x1ba84b:0x12f},_0x5a5991=_0x37e774;return _0x50e527!==null&&_0x50e527!==void 0x0&&_0x50e527[_0x5a5991(_0x8a9ede._0x1ba84b)]&&this['_rectangle']?mars3d__namespace['PolyUtil']['formatRectangle'](this['_rectangle']):this['_rectangle'];}['_getHeatCanvas'](){var _0xe0696c={_0x21e524:0xd5,_0x2b9c6f:0xa7,_0x13b925:0xda,_0x2d9534:0xda,_0x3a9a72:0xaa,_0x13ae40:0xf2,_0x1c54e6:0xd4,_0x2400ac:0xd1,_0x2ad6bd:0xa0},_0xf92c43={_0x4eb693:0xb0,_0x2d3945:0xcb,_0x4539b9:0xda,_0x500ed9:0x131,_0x14f5d2:0xac},_0xcb05b3=_0x37e774;const _0x20151b=this[_0xcb05b3(_0xe0696c._0x21e524)],_0x5b9f44=[];let _0x4b96c9,_0x58b074,_0x39e2ee,_0x13d5b1;_0x20151b[_0xcb05b3(_0xe0696c._0x2b9c6f)](_0x4ab7f1=>{var _0x45f254=_0xcb05b3;const _0x36f850=mars3d__namespace[_0x45f254(_0xf92c43._0x4eb693)][_0x45f254(0x102)](_0x4ab7f1);if(!_0x36f850)return;_0x36f850[_0x45f254(_0xf92c43._0x2d3945)]=_0x4ab7f1['value']||0x1,!this[_0x45f254(_0xf92c43._0x4539b9)]['rectangle']&&(_0x4b96c9===undefined?(_0x4b96c9=_0x36f850['lng'],_0x58b074=_0x36f850[_0x45f254(_0xf92c43._0x500ed9)],_0x39e2ee=_0x36f850[_0x45f254(0xa1)],_0x13d5b1=_0x36f850['lat']):(_0x4b96c9=Math['min'](_0x4b96c9,_0x36f850['lng']),_0x58b074=Math['max'](_0x58b074,_0x36f850['lng']),_0x39e2ee=Math[_0x45f254(0x10d)](_0x39e2ee,_0x36f850['lat']),_0x13d5b1=Math['max'](_0x13d5b1,_0x36f850[_0x45f254(0xa1)]))),_0x5b9f44[_0x45f254(_0xf92c43._0x14f5d2)](_0x36f850);});_0x4b96c9===_0x58b074&&(_0x4b96c9-=0.000001,_0x58b074+=0.000001);_0x39e2ee===_0x13d5b1&&(_0x39e2ee-=0.000001,_0x13d5b1+=0.000001);let _0x1e8187=this[_0xcb05b3(_0xe0696c._0x13b925)]['rectangle']||{'xmin':_0x4b96c9,'xmax':_0x58b074,'ymin':_0x39e2ee,'ymax':_0x13d5b1};const _0x277c84=getMercatorBounds(_0x1e8187),_0x2e503a=Math['abs'](_0x277c84['xmax']-_0x277c84[_0xcb05b3(0xf2)]),_0x5253cc=Math[_0xcb05b3(0xc1)](_0x277c84['ymax']-_0x277c84['ymin']),_0x163f67=Math['max'](_0x2e503a,_0x5253cc),_0x5ef4c0=Math['min'](_0x2e503a,_0x5253cc);this[_0xcb05b3(0x99)]=_0x163f67;let _0x2c209e=0x1;if(_0x163f67>this[_0xcb05b3(_0xe0696c._0x13b925)]['maxCanvasSize'])_0x2c209e=_0x163f67/this['options']['maxCanvasSize'],_0x5ef4c0/_0x2c209e<this['options']['minCanvasSize']&&(_0x2c209e=_0x5ef4c0/this[_0xcb05b3(_0xe0696c._0x2d9534)]['minCanvasSize']);else _0x5ef4c0<this['options']['minCanvasSize']&&(_0x2c209e=_0x5ef4c0/this['options']['minCanvasSize'],_0x163f67/_0x2c209e>this['options']['maxCanvasSize']&&(_0x2c209e=_0x163f67/this['options']['maxCanvasSize']));const _0x29961f=this[_0xcb05b3(0x135)]['radius']*1.5,_0x46894b=_0x2e503a/_0x2c209e+_0x29961f*0x2,_0x1c22f1=_0x5253cc/_0x2c209e+_0x29961f*0x2,_0xb49e6e=_0x29961f*_0x2c209e;_0x277c84['xmin']-=_0xb49e6e,_0x277c84[_0xcb05b3(_0xe0696c._0x3a9a72)]-=_0xb49e6e,_0x277c84['xmax']+=_0xb49e6e,_0x277c84['ymax']+=_0xb49e6e,this['_scale']=_0x2c209e,_0x1e8187=geLatLngBounds(_0x277c84),this['_rectangle']=Cesium[_0xcb05b3(0x13b)]['fromDegrees'](_0x1e8187[_0xcb05b3(_0xe0696c._0x13ae40)],_0x1e8187['ymin'],_0x1e8187[_0xcb05b3(0x116)],_0x1e8187['ymax']);let _0x1a8ef2=_0x5b9f44[0x0]['value']??0x1,_0x470c97=_0x5b9f44[0x0]['value']??0x0;const _0x15cd01=[];_0x5b9f44['forEach'](_0x125cc6=>{var _0x5665c1=_0xcb05b3;const _0x1e83b1=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x125cc6['lng'],_0x125cc6['lat']]),_0x465ca1=_0x125cc6['value']||0x1,_0x1b2659=Math[_0x5665c1(0xfe)]((_0x1e83b1[0x0]-_0x277c84[_0x5665c1(0xf2)])/_0x2c209e),_0x494bd2=Math['round']((_0x277c84['ymax']-_0x1e83b1[0x1])/_0x2c209e);_0x1a8ef2=Math['max'](_0x1a8ef2,_0x465ca1),_0x470c97=Math['min'](_0x470c97,_0x465ca1),_0x15cd01['push']({'x':_0x1b2659,'y':_0x494bd2,'value':_0x465ca1});});const _0x100f31={'min':this[_0xcb05b3(0xda)]['min']??_0x470c97,'max':this['options']['max']??_0x1a8ef2,'data':_0x15cd01};this['_last_heatData']=_0x100f31;if(!this['_last_mBounds']||_0x277c84['xmin']!==this['_last_mBounds']['xmin']||_0x277c84['ymin']!==this['_last_mBounds']['ymin']||_0x277c84['xmax']!==this['_last_mBounds']['xmax']||_0x277c84['ymax']!==this['_last_mBounds'][_0xcb05b3(_0xe0696c._0x1c54e6)]){this[_0xcb05b3(0x12e)]=_0x277c84,this['_container']['style']['cssText']='width:'+_0x46894b+'px;height:'+_0x1c22f1+'px;';const _0x5a794a={...this['heatStyle'],'container':this[_0xcb05b3(_0xe0696c._0x2400ac)]};!this['_heat']?this[_0xcb05b3(0xb4)]=heatmap$1[_0xcb05b3(0xa3)]['create'](_0x5a794a):this['_heat'][_0xcb05b3(_0xe0696c._0x2ad6bd)](_0x5a794a);}this['_heat']['setData'](_0x100f31);const _0x57fed2=mars3d__namespace['DomUtil']['copyCanvas'](this['_heat']['_renderer']['canvas']);return _0x57fed2;}[_0x37e774(0xcd)](){var _0x430966={_0x22f974:0x125,_0x569764:0xf1,_0x20e500:0xfd,_0x55cf93:0xa0,_0x261ff9:0x135},_0x22a940=_0x37e774;this['_heat'][_0x22a940(0xa0)]({'radius':this['heatStyle']['radius']*this[_0x22a940(_0x430966._0x22f974)]['arcRadiusScale'],'blur':this['heatStyle'][_0x22a940(_0x430966._0x569764)]*this['style'][_0x22a940(0xbb)],'gradient':this['heatStyle']['gradientArc']||{0.25:'rgb(0,0,0)',0.55:_0x22a940(_0x430966._0x20e500),0.85:_0x22a940(0x98),0x1:'rgb(255,255,255)'}});const _0x1b4b38=mars3d__namespace['DomUtil'][_0x22a940(0xc7)](this['_heat']['_renderer']['canvas']);return this[_0x22a940(0xb4)][_0x22a940(_0x430966._0x55cf93)](this['options'][_0x22a940(_0x430966._0x261ff9)]),_0x1b4b38;}[_0x37e774(0xd2)](_0x48ee93){var _0x5baf0c={_0x48dcfe:0x131},_0x1f7206=_0x37e774;const _0x5b20e2=mars3d__namespace['LngLatPoint'][_0x1f7206(0x102)](_0x48ee93);if(!_0x5b20e2)return{};const _0x1027cd=mars3d__namespace[_0x1f7206(0xa5)]['lonlat2mercator']([_0x5b20e2[_0x1f7206(_0x5baf0c._0x48dcfe)],_0x5b20e2['lat']]),_0x24fc97=this[_0x1f7206(0x12e)],_0x128703=Math['round']((_0x1027cd[0x0]-_0x24fc97['xmin'])/this['_scale']),_0x495870=Math['round']((_0x24fc97[_0x1f7206(0xd4)]-_0x1027cd[0x1])/this['_scale']),_0x505bdb=this['_heat']['getValueAt']({'x':_0x128703,'y':_0x495870}),_0x3f9287=this['_heat']['_renderer']['ctx']['getImageData'](_0x128703-0x1,_0x495870-0x1,0x1,0x1)['data'];return{'x':_0x128703,'y':_0x495870,'value':_0x505bdb,'color':'rgba('+_0x3f9287[0x0]+','+_0x3f9287[0x1]+','+_0x3f9287[0x2]+','+_0x3f9287[0x3]+')'};}}mars3d__namespace['LayerUtil']['register'](_0x37e774(0xeb),HeatLayer),mars3d__namespace['layer'][_0x37e774(0x12d)]=HeatLayer,mars3d__namespace['h337']=h337;function getMercatorBounds(_0x134531){var _0x10f7cf={_0x5e32ec:0xa5,_0x1a6e25:0xaa,_0x268d18:0x132},_0x2ec8a8=_0x37e774;const _0x293ccc=mars3d__namespace[_0x2ec8a8(_0x10f7cf._0x5e32ec)]['lonlat2mercator']([_0x134531['xmin'],_0x134531[_0x2ec8a8(_0x10f7cf._0x1a6e25)]]),_0x2b5c3d=mars3d__namespace['PointTrans'][_0x2ec8a8(_0x10f7cf._0x268d18)]([_0x134531['xmax'],_0x134531['ymax']]);return{'xmin':_0x293ccc[0x0],'ymin':_0x293ccc[0x1],'xmax':_0x2b5c3d[0x0],'ymax':_0x2b5c3d[0x1]};}function geLatLngBounds(_0x5ab66f){var _0x3af6b7={_0x3bd221:0xaa},_0x2c08ed=_0x37e774;const _0x37337e=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x5ab66f['xmin'],_0x5ab66f[_0x2c08ed(_0x3af6b7._0x3bd221)]]),_0x4eb08c=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x5ab66f['xmax'],_0x5ab66f['ymax']]);return{'xmin':_0x37337e[0x0],'ymin':_0x37337e[0x1],'xmax':_0x4eb08c[0x0],'ymax':_0x4eb08c[0x1]};}function getVertexShaderSource(_0x805f96){return'in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20'+_0x805f96+';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a';}exports[_0x37e774(0x12d)]=HeatLayer,Object['defineProperty'](exports,'__esModule',{'value':!![]});
}));
