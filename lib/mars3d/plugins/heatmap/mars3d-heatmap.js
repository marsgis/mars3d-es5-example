/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.6.12
 * 编译日期：2023-11-07 21:56:03
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';const _0x3d1a65=_0x37e0;(function(_0x3f4675,_0x5f0d5c){const _0x2fb6e3={_0x2cc467:0x210,_0xac9e62:0x1ed,_0x3d7c17:0x211,_0x557eaf:0x227,_0x307d68:0x217},_0x543cad=_0x37e0,_0x442efe=_0x3f4675();while(!![]){try{const _0x1e510f=-parseInt(_0x543cad(0x232))/0x1+-parseInt(_0x543cad(_0x2fb6e3._0x2cc467))/0x2*(parseInt(_0x543cad(0x23e))/0x3)+parseInt(_0x543cad(0x22e))/0x4+-parseInt(_0x543cad(_0x2fb6e3._0xac9e62))/0x5+parseInt(_0x543cad(0x1fc))/0x6*(-parseInt(_0x543cad(_0x2fb6e3._0x3d7c17))/0x7)+-parseInt(_0x543cad(_0x2fb6e3._0x557eaf))/0x8+parseInt(_0x543cad(_0x2fb6e3._0x307d68))/0x9;if(_0x1e510f===_0x5f0d5c)break;else _0x442efe['push'](_0x442efe['shift']());}catch(_0x4bd31c){_0x442efe['push'](_0x442efe['shift']());}}}(_0x5edc,0xdcde0));function _0x5edc(){const _0x257f2d=['PointTrans','body','max','EllipsoidSurfaceAppearance','addGraphic','11156344WAMVQO','_heat','width:','StencilFunction','_layer','_scale','round','2784008zXjyBp','options',';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a','minCanvasSize','837981kjhmQd','granularity','bumpMap','xmin','REPLACE','style','ymax','lng','_updatePositionsHook','StencilOperation','BaseLayer','_last_mBounds','227973teCkUm','_removedHook','register','rectangle','green','push','fromCache','7472660DGATiJ','rgb(0,0,0)','create','_graphic2','min','mars3d-heatmap\x20mars3d-hideDiv','forEach','DomUtil','_getArcHeatCanvas','blur','blue','px;','fromDegrees','arcDirection','setOptions','191742bSwAzi','getImageData','lonlat2mercator','uniforms','Material','_rectangle','_positions','positions','diffHeight','mercator2lonlat','_getHeatCanvas','type','_mountedHook','removeLayer','ymin','image','_mBoundsMax','defineProperty','canvas','__esModule','4WrsMFJ','35egygtx','lat','LngLatPoint','ctx','xmax','splitNum','38227437DscivT','graphic','parse','HeatLayer','merge','BlendingState','heatStyle','KEEP','configure','_graphic','_renderer'];_0x5edc=function(){return _0x257f2d;};return _0x5edc();}function _interopNamespace(_0xb063f3){if(_0xb063f3&&_0xb063f3['__esModule'])return _0xb063f3;var _0x368ec9=Object['create'](null);return _0xb063f3&&Object['keys'](_0xb063f3)['forEach'](function(_0x139f9d){const _0x22b768=_0x37e0;if(_0x139f9d!=='default'){var _0x4e15aa=Object['getOwnPropertyDescriptor'](_0xb063f3,_0x139f9d);Object[_0x22b768(0x20d)](_0x368ec9,_0x139f9d,_0x4e15aa['get']?_0x4e15aa:{'enumerable':!![],'get':function(){return _0xb063f3[_0x139f9d];}});}}),_0x368ec9['default']=_0xb063f3,_0x368ec9;}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337),HeatMaterial='uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a';if(!h337__namespace['create'])throw new Error('请引入\x20heatmap.js\x20库\x20');const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace['layer'][_0x3d1a65(0x23c)],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:_0x3d1a65(0x1f7),0.6:_0x3d1a65(0x242),0.8:'yellow',0.9:'red'}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium['EllipsoidSurfaceAppearance']['VERTEX_FORMAT']};class HeatLayer extends BaseLayer{constructor(_0x21365c={}){const _0x166811={_0x430bbc:0x1f1,_0x2ac0eb:0x22f},_0x345590=_0x3d1a65;super(_0x21365c),this[_0x345590(0x22f)]['maxCanvasSize']=this['options']['maxCanvasSize']??document['body']['clientWidth'],this['options']['maxCanvasSize']=Math[_0x345590(_0x166811._0x430bbc)](this['options']['maxCanvasSize'],0x1388),this['options']['minCanvasSize']=this[_0x345590(_0x166811._0x2ac0eb)]['minCanvasSize']??document[_0x345590(0x223)]['clientHeight'],this['options']['minCanvasSize']=Math['max'](this['options'][_0x345590(0x231)],0x2bc),this['options']['heatStyle']={...DEF_HEATSTYLE,...this['options'][_0x345590(0x21d)]},this['options']['style']={...DEF_STYLE,...this['options']['style']};}get['layer'](){return this['_layer'];}get['heatStyle'](){const _0x51c3b2={_0x35615a:0x22f},_0x26bde9=_0x3d1a65;return this[_0x26bde9(_0x51c3b2._0x35615a)]['heatStyle'];}set[_0x3d1a65(0x21d)](_0x2687c1){const _0x211e87={_0x3c7a5f:0x21d},_0x3ef7ae=_0x3d1a65;this['options'][_0x3ef7ae(_0x211e87._0x3c7a5f)]=mars3d__namespace['Util']['merge'](this['options'][_0x3ef7ae(_0x211e87._0x3c7a5f)],_0x2687c1),this[_0x3ef7ae(0x228)]&&(this[_0x3ef7ae(0x228)]['configure'](this[_0x3ef7ae(0x22f)]['heatStyle']),this['_updatePositionsHook'](!![]));}get['style'](){const _0x20828d=_0x3d1a65;return this['options'][_0x20828d(0x237)];}set[_0x3d1a65(0x237)](_0x1daef1){const _0x4cc4be=_0x3d1a65;this['options']['style']=mars3d__namespace['Util'][_0x4cc4be(0x21b)](this['options']['style'],_0x1daef1);}get['positions'](){return this['_positions'];}set['positions'](_0x529e6a){this['setPositions'](_0x529e6a);}get['coordinates'](){const _0x11de8d=_0x3d1a65,_0x461d18=[];return this['points'][_0x11de8d(0x1f3)](_0x4109c6=>{_0x461d18['push'](_0x4109c6['toArray']());}),_0x461d18;}get[_0x3d1a65(0x241)](){return this['_rectangle'];}['_setOptionsHook'](_0x4564b8,_0x178b96){_0x4564b8['positions']&&(this['positions']=_0x4564b8['positions']);}[_0x3d1a65(0x208)](){const _0x2564a0={_0x47af06:0x22b},_0x391de4=_0x3d1a65;this['style']['type']==='image'?this['_layer']=new mars3d__namespace['layer']['ImageLayer']({'crs':'EPSG:3857','private':!![]}):this[_0x391de4(_0x2564a0._0x47af06)]=new mars3d__namespace['layer']['GraphicLayer']({'private':!![]});}['_addedHook'](){const _0x4487b5={_0x43aea2:0x203},_0xa8523d=_0x3d1a65;this['_map']['addLayer'](this['_layer']),this['_container']=mars3d__namespace[_0xa8523d(0x1f4)]['create']('div',_0xa8523d(0x1f2),this['_map']['container']),this['options'][_0xa8523d(_0x4487b5._0x43aea2)]&&(this['positions']=this['options']['positions']),this['options']['flyTo']&&this['flyToByAnimationEnd']();}[_0x3d1a65(0x23f)](){const _0x2a1a8e={_0x178086:0x1f4,_0x2e970d:0x209},_0x56537c=_0x3d1a65;this['_container']&&(mars3d__namespace[_0x56537c(_0x2a1a8e._0x178086)]['remove'](this['_container']),delete this['_container']),this['clear'](),this['_map'][_0x56537c(_0x2a1a8e._0x2e970d)](this['_layer']);}['addPosition'](_0xa4d6df,_0x494b72){const _0x1b163a={_0x36f69f:0x202},_0x161cec=_0x3d1a65;this['_positions']=this[_0x161cec(_0x1b163a._0x36f69f)]||[],this['_positions']['push'](_0xa4d6df),this['_updatePositionsHook'](_0x494b72);}['setPositions'](_0x486d1a,_0x240745){const _0x2e2f85=_0x3d1a65;this['_positions']=_0x486d1a,this[_0x2e2f85(0x23a)](_0x240745);}['clear'](){const _0x2d34ad={_0x94230b:0x220,_0x42f6ec:0x22b},_0x2aff5b=_0x3d1a65;this[_0x2aff5b(_0x2d34ad._0x94230b)]&&(this[_0x2aff5b(_0x2d34ad._0x42f6ec)]['removeGraphic'](this['_graphic'],!![]),delete this['_graphic']),this[_0x2aff5b(0x1f0)]&&(this['_layer']['removeGraphic'](this['_graphic2'],!![]),delete this['_graphic2']);}['_updatePositionsHook'](_0x4ee0f5){const _0x29a449={_0x1bf5ad:0x207,_0x2842cc:0x1fb,_0x4c04b6:0x237,_0x53bcf8:0x220,_0x3a9997:0x20b,_0x169c17:0x1ff},_0x92f09=_0x3d1a65;if(!this['show']||!this['_map']||!this['positions']||this[_0x92f09(0x203)]['length']===0x0)return this;const _0x3082b7=this['_getHeatCanvas']();if(this['style'][_0x92f09(_0x29a449._0x1bf5ad)]==='image')this['_layer'][_0x92f09(_0x29a449._0x2842cc)]({'url':_0x3082b7['toDataURL']('image/png'),'rectangle':this[_0x92f09(0x201)],'opacity':this[_0x92f09(0x237)]['opacity']});else this[_0x92f09(_0x29a449._0x4c04b6)]['arc']?this[_0x92f09(_0x29a449._0x53bcf8)]&&_0x4ee0f5?(this['_graphic']['uniforms'][_0x92f09(_0x29a449._0x3a9997)]=_0x3082b7,this['_graphic']['uniforms']['bumpMap']=this['_getArcHeatCanvas'](),this['_graphic2']&&(this['_graphic2']['uniforms'][_0x92f09(0x20b)]=_0x3082b7,this['_graphic2']['uniforms']['bumpMap']=this['_graphic']['uniforms'][_0x92f09(0x234)])):this['_createArcGraphic'](_0x3082b7):this['_graphic']&&_0x4ee0f5?this['_graphic'][_0x92f09(_0x29a449._0x169c17)]['image']=_0x3082b7:this['_createGraphic'](_0x3082b7);return this;}['_createGraphic'](_0x2711e6){const _0x5bb221={_0x3b0fcd:0x200},_0x2636d1=_0x3d1a65;this['clear'](),this['_graphic']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium[(_0x2636d1(0x225))]({'material':new Cesium[(_0x2636d1(_0x5bb221._0x3b0fcd))]({'fabric':{'uniforms':{'image':_0x2711e6},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})}),this['_layer']['addGraphic'](this[_0x2636d1(0x220)]);}['_createArcGraphic'](_0x7d3e7f){const _0x52fb16={_0x2e019f:0x1ec,_0xb9c871:0x23b,_0x354c9a:0x236,_0xbe664b:0x237,_0x43cea2:0x204,_0x51a2a7:0x233,_0x435352:0x1fa,_0x314b40:0x220,_0x4bdc10:0x218},_0x3c8bf8=_0x3d1a65;this['clear']();const _0x55fac6=Cesium['RenderState'][_0x3c8bf8(_0x52fb16._0x2e019f)]({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium[_0x3c8bf8(0x22a)]['ALWAYS'],'frontOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium['StencilOperation']['REPLACE']},'backFunction':Cesium[_0x3c8bf8(0x22a)]['ALWAYS'],'backOperation':{'fail':Cesium['StencilOperation'][_0x3c8bf8(0x21e)],'zFail':Cesium[_0x3c8bf8(_0x52fb16._0xb9c871)]['KEEP'],'zPass':Cesium['StencilOperation'][_0x3c8bf8(_0x52fb16._0x354c9a)]},'reference':0x2,'mask':0x2},'blending':Cesium[_0x3c8bf8(0x21c)]['ALPHA_BLEND']}),_0x3263da=Math['floor'](this[_0x3c8bf8(0x237)]['diffHeight']??this[_0x3c8bf8(0x20c)]*0.02)+0.1;this['style']['diffHeight']&&delete this[_0x3c8bf8(_0x52fb16._0xbe664b)][_0x3c8bf8(_0x52fb16._0x43cea2)];const _0x28c54a=(this['style'][_0x3c8bf8(0x216)],0x64);let _0x1c5ab6=Math['max'](this['_rectangle']['height'],this['_rectangle']['width']);this['style'][_0x3c8bf8(_0x52fb16._0x51a2a7)]=_0x1c5ab6/=_0x28c54a;const _0x56ac4d=new Cesium['Material']({'fabric':{'uniforms':{'image':_0x7d3e7f,'repeat':new Cesium['Cartesian2'](0x1,0x1),'color':new Cesium['Color'](0x1,0x1,0x1,0x0),'bumpMap':this['_getArcHeatCanvas']()},'source':HeatMaterial},'translucent':!![]}),_0x118e83=this['style'][_0x3c8bf8(_0x52fb16._0x435352)]||0x1;this[_0x3c8bf8(_0x52fb16._0x314b40)]=new mars3d__namespace['graphic']['RectanglePrimitive']({...this[_0x3c8bf8(0x22f)],'rectangle':this[_0x3c8bf8(0x201)],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x55fac6,'material':_0x56ac4d,'vertexShaderSource':getVertexShaderSource(_0x3263da*_0x118e83)})}),this[_0x3c8bf8(0x22b)][_0x3c8bf8(0x226)](this['_graphic']),this['style']['arcDirection']===0x0&&(this['_graphic2']=new mars3d__namespace[(_0x3c8bf8(_0x52fb16._0x4bdc10))]['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x55fac6,'material':_0x56ac4d,'vertexShaderSource':getVertexShaderSource(-_0x3263da)})}),this[_0x3c8bf8(0x22b)]['addGraphic'](this['_graphic2']));}['getRectangle'](_0x346668){const _0x3e35ab=_0x3d1a65;return _0x346668!==null&&_0x346668!==void 0x0&&_0x346668['isFormat']&&this['_rectangle']?mars3d__namespace['PolyUtil']['formatRectangle'](this[_0x3e35ab(0x201)]):this['_rectangle'];}[_0x3d1a65(0x206)](){const _0x367a56={_0x53d528:0x224,_0x26add3:0x1f1,_0x44d138:0x22f,_0x33e94f:0x231,_0x2cfc9a:0x215,_0x5ac10a:0x23d,_0x211335:0x235,_0x378f0e:0x238,_0x33c03f:0x23d,_0x5406d7:0x229,_0xa7353f:0x1f8,_0x560e40:0x228,_0x2ba968:0x1ef,_0x1d2dc9:0x21f},_0x357d24={_0x4613e9:0x219,_0xfff731:0x22f},_0x56b57d=_0x3d1a65,_0x358be0=this['_positions'],_0x51fbf5=[];let _0x34748e,_0xebda37,_0x3dabe9,_0x4b5114;_0x358be0['forEach'](_0x201c5c=>{const _0x1f329d=_0x37e0,_0x268e40=mars3d__namespace[_0x1f329d(0x213)][_0x1f329d(_0x357d24._0x4613e9)](_0x201c5c);if(!_0x268e40)return;_0x268e40['value']=_0x201c5c['value']||0x1,!this[_0x1f329d(_0x357d24._0xfff731)]['rectangle']&&(_0x34748e===undefined?(_0x34748e=_0x268e40['lng'],_0xebda37=_0x268e40['lng'],_0x3dabe9=_0x268e40['lat'],_0x4b5114=_0x268e40['lat']):(_0x34748e=Math['min'](_0x34748e,_0x268e40['lng']),_0xebda37=Math['max'](_0xebda37,_0x268e40['lng']),_0x3dabe9=Math['min'](_0x3dabe9,_0x268e40['lat']),_0x4b5114=Math['max'](_0x4b5114,_0x268e40['lat']))),_0x51fbf5['push'](_0x268e40);});_0x34748e===_0xebda37&&(_0x34748e-=0.000001,_0xebda37+=0.000001);_0x3dabe9===_0x4b5114&&(_0x3dabe9-=0.000001,_0x4b5114+=0.000001);let _0x3cdee2=this['options']['rectangle']||{'xmin':_0x34748e,'xmax':_0xebda37,'ymin':_0x3dabe9,'ymax':_0x4b5114};const _0x150b58=getMercatorBounds(_0x3cdee2),_0x3307f0=Math['abs'](_0x150b58['xmax']-_0x150b58[_0x56b57d(0x235)]),_0x41987f=Math['abs'](_0x150b58['ymax']-_0x150b58['ymin']),_0x5adebe=Math[_0x56b57d(_0x367a56._0x53d528)](_0x3307f0,_0x41987f),_0x5a350a=Math[_0x56b57d(_0x367a56._0x26add3)](_0x3307f0,_0x41987f);this['_mBoundsMax']=_0x5adebe;let _0x3fe8ea=0x1;if(_0x5adebe>this[_0x56b57d(_0x367a56._0x44d138)]['maxCanvasSize'])_0x3fe8ea=_0x5adebe/this['options']['maxCanvasSize'],_0x5a350a/_0x3fe8ea<this['options'][_0x56b57d(_0x367a56._0x33e94f)]&&(_0x3fe8ea=_0x5a350a/this[_0x56b57d(0x22f)]['minCanvasSize']);else _0x5a350a<this['options'][_0x56b57d(_0x367a56._0x33e94f)]&&(_0x3fe8ea=_0x5a350a/this[_0x56b57d(0x22f)]['minCanvasSize'],_0x5adebe/_0x3fe8ea>this['options']['maxCanvasSize']&&(_0x3fe8ea=_0x5adebe/this[_0x56b57d(0x22f)]['maxCanvasSize']));const _0x17d76f=this['heatStyle']['radius']*1.5,_0x4cfabf=_0x3307f0/_0x3fe8ea+_0x17d76f*0x2,_0x5e82a5=_0x41987f/_0x3fe8ea+_0x17d76f*0x2,_0x182066=_0x17d76f*_0x3fe8ea;_0x150b58['xmin']-=_0x182066,_0x150b58['ymin']-=_0x182066,_0x150b58['xmax']+=_0x182066,_0x150b58['ymax']+=_0x182066,this[_0x56b57d(0x22c)]=_0x3fe8ea,_0x3cdee2=geLatLngBounds(_0x150b58),this['_rectangle']=Cesium['Rectangle'][_0x56b57d(0x1f9)](_0x3cdee2['xmin'],_0x3cdee2['ymin'],_0x3cdee2[_0x56b57d(_0x367a56._0x2cfc9a)],_0x3cdee2['ymax']);let _0x43acc2=_0x51fbf5[0x0]['value']??0x1,_0x2f500b=_0x51fbf5[0x0]['value']??0x0;const _0x24fbfe=[];_0x51fbf5['forEach'](_0x4cb27c=>{const _0x43105d=_0x56b57d,_0x36ed2e=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x4cb27c['lng'],_0x4cb27c['lat']]),_0x168401=_0x4cb27c['value']||0x1,_0x43e6fa=Math['round']((_0x36ed2e[0x0]-_0x150b58['xmin'])/_0x3fe8ea),_0x59d639=Math['round']((_0x150b58['ymax']-_0x36ed2e[0x1])/_0x3fe8ea);_0x43acc2=Math['max'](_0x43acc2,_0x168401),_0x2f500b=Math['min'](_0x2f500b,_0x168401),_0x24fbfe[_0x43105d(0x1eb)]({'x':_0x43e6fa,'y':_0x59d639,'value':_0x168401});});const _0x5ac8d8={'min':this['options'][_0x56b57d(0x1f1)]??_0x2f500b,'max':this['options'][_0x56b57d(_0x367a56._0x53d528)]??_0x43acc2,'data':_0x24fbfe};this['_last_heatData']=_0x5ac8d8;if(!this['_last_mBounds']||_0x150b58[_0x56b57d(0x235)]!==this[_0x56b57d(_0x367a56._0x5ac10a)][_0x56b57d(_0x367a56._0x211335)]||_0x150b58['ymin']!==this['_last_mBounds'][_0x56b57d(0x20a)]||_0x150b58['xmax']!==this['_last_mBounds']['xmax']||_0x150b58[_0x56b57d(_0x367a56._0x378f0e)]!==this[_0x56b57d(_0x367a56._0x33c03f)][_0x56b57d(0x238)]){this['_last_mBounds']=_0x150b58,this['_container']['style']['cssText']=_0x56b57d(_0x367a56._0x5406d7)+_0x4cfabf+'px;height:'+_0x5e82a5+_0x56b57d(_0x367a56._0xa7353f);const _0x7299e4={...this['heatStyle'],'container':this['_container']};!this[_0x56b57d(_0x367a56._0x560e40)]?this['_heat']=h337__namespace[_0x56b57d(_0x367a56._0x2ba968)](_0x7299e4):this['_heat'][_0x56b57d(_0x367a56._0x1d2dc9)](_0x7299e4);}this['_heat']['setData'](_0x5ac8d8);const _0x106897=mars3d__namespace['DomUtil']['copyCanvas'](this['_heat']['_renderer'][_0x56b57d(0x20e)]);return _0x106897;}[_0x3d1a65(0x1f5)](){const _0x2523b6={_0x3568c5:0x21f,_0x2ae88d:0x1f6,_0xf1d2e0:0x228,_0x518924:0x221},_0x393be4=_0x3d1a65;this['_heat'][_0x393be4(_0x2523b6._0x3568c5)]({'radius':this['heatStyle']['radius']*this['style']['arcRadiusScale'],'blur':this['heatStyle'][_0x393be4(_0x2523b6._0x2ae88d)]*this['style']['arcBlurScale'],'gradient':this['heatStyle']['gradientArc']||{0.25:_0x393be4(0x1ee),0.55:'rgb(140,140,140)',0.85:'rgb(216,216,216)',0x1:'rgb(255,255,255)'}});const _0x30d465=mars3d__namespace['DomUtil']['copyCanvas'](this[_0x393be4(_0x2523b6._0xf1d2e0)][_0x393be4(_0x2523b6._0x518924)]['canvas']);return this['_heat']['configure'](this['options']['heatStyle']),_0x30d465;}['getPointData'](_0x3f7917){const _0x52579d={_0x2e324b:0x239,_0x1ba35c:0x212,_0x21f8f0:0x228,_0x5f3c43:0x221,_0x2abd1e:0x214},_0x150cbb=_0x3d1a65,_0x17c660=mars3d__namespace[_0x150cbb(0x213)]['parse'](_0x3f7917);if(!_0x17c660)return{};const _0x149a98=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x17c660[_0x150cbb(_0x52579d._0x2e324b)],_0x17c660[_0x150cbb(_0x52579d._0x1ba35c)]]),_0x346403=this['_last_mBounds'],_0x219444=Math[_0x150cbb(0x22d)]((_0x149a98[0x0]-_0x346403['xmin'])/this['_scale']),_0x3d2f9c=Math['round']((_0x346403['ymax']-_0x149a98[0x1])/this[_0x150cbb(0x22c)]),_0x5b09e1=this['_heat']['getValueAt']({'x':_0x219444,'y':_0x3d2f9c}),_0x3ca034=this[_0x150cbb(_0x52579d._0x21f8f0)][_0x150cbb(_0x52579d._0x5f3c43)][_0x150cbb(_0x52579d._0x2abd1e)][_0x150cbb(0x1fd)](_0x219444-0x1,_0x3d2f9c-0x1,0x1,0x1)['data'];return{'x':_0x219444,'y':_0x3d2f9c,'value':_0x5b09e1,'color':'rgba('+_0x3ca034[0x0]+','+_0x3ca034[0x1]+','+_0x3ca034[0x2]+','+_0x3ca034[0x3]+')'};}}mars3d__namespace['LayerUtil'][_0x3d1a65(0x240)]('heat',HeatLayer),mars3d__namespace['layer'][_0x3d1a65(0x21a)]=HeatLayer,mars3d__namespace['h337']=h337__namespace;function _0x37e0(_0x42760f,_0x1daf7d){const _0x5edcc0=_0x5edc();return _0x37e0=function(_0x37e0ae,_0x418ef0){_0x37e0ae=_0x37e0ae-0x1eb;let _0x34aa02=_0x5edcc0[_0x37e0ae];return _0x34aa02;},_0x37e0(_0x42760f,_0x1daf7d);}function getMercatorBounds(_0x53aa8e){const _0x3ee9b3={_0x2348dc:0x235,_0x5c58d9:0x1fe,_0x5ef64f:0x215},_0x2dbb1a=_0x3d1a65,_0x22c031=mars3d__namespace[_0x2dbb1a(0x222)]['lonlat2mercator']([_0x53aa8e[_0x2dbb1a(_0x3ee9b3._0x2348dc)],_0x53aa8e['ymin']]),_0x3126b0=mars3d__namespace['PointTrans'][_0x2dbb1a(_0x3ee9b3._0x5c58d9)]([_0x53aa8e[_0x2dbb1a(_0x3ee9b3._0x5ef64f)],_0x53aa8e['ymax']]);return{'xmin':_0x22c031[0x0],'ymin':_0x22c031[0x1],'xmax':_0x3126b0[0x0],'ymax':_0x3126b0[0x1]};}function geLatLngBounds(_0x57b62f){const _0x346147={_0x2956ca:0x20a,_0x4733f6:0x205},_0x401bf7=_0x3d1a65,_0xf0095b=mars3d__namespace[_0x401bf7(0x222)]['mercator2lonlat']([_0x57b62f['xmin'],_0x57b62f[_0x401bf7(_0x346147._0x2956ca)]]),_0x3d80ef=mars3d__namespace['PointTrans'][_0x401bf7(_0x346147._0x4733f6)]([_0x57b62f['xmax'],_0x57b62f['ymax']]);return{'xmin':_0xf0095b[0x0],'ymin':_0xf0095b[0x1],'xmax':_0x3d80ef[0x0],'ymax':_0x3d80ef[0x1]};}function getVertexShaderSource(_0x91a08f){const _0x109104={_0x31f6e6:0x230},_0x424c88=_0x3d1a65;return'in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20'+_0x91a08f+_0x424c88(_0x109104._0x31f6e6);}exports[_0x3d1a65(0x21a)]=HeatLayer,Object[_0x3d1a65(0x20d)](exports,_0x3d1a65(0x20f),{'value':!![]});
}));
