/**
 * Mars3D平台插件,支持气象 风向图 功能插件  mars3d-wind
 *
 * 版本信息：v3.8.4
 * 编译日期：2024-10-13 21:30:47
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2024-08-01
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-wind"] = {}, global.mars3d));
})(this, (function (exports, mars3d) { 
'use strict';(function(_0xff0ad5,_0x269cd7){function _0x365104(_0x2c45ea,_0x24cd6a){return _0x44b3(_0x24cd6a-0x30a,_0x2c45ea);}const _0x3bafbb=_0xff0ad5();function _0x24288d(_0x39f232,_0x1fe160){return _0x44b3(_0x1fe160-0x3b5,_0x39f232);}while(!![]){try{const _0x26833a=parseInt(_0x365104(0x3c5,0x43c))/0x1+-parseInt(_0x24288d(0x5cc,0x54f))/0x2*(parseInt(_0x365104(0x44c,0x4b1))/0x3)+parseInt(_0x24288d(0x55a,0x55b))/0x4*(-parseInt(_0x24288d(0x5b4,0x57a))/0x5)+parseInt(_0x365104(0x46a,0x4f0))/0x6+parseInt(_0x24288d(0x56c,0x557))/0x7+parseInt(_0x365104(0x4a9,0x4aa))/0x8*(-parseInt(_0x24288d(0x5ac,0x535))/0x9)+-parseInt(_0x365104(0x3f3,0x419))/0xa;if(_0x26833a===_0x269cd7)break;else _0x3bafbb['push'](_0x3bafbb['shift']());}catch(_0x3ef32b){_0x3bafbb['push'](_0x3bafbb['shift']());}}}(_0x7029,0xdacef));function _interopNamespace(_0x5d5815){if(_0x5d5815&&_0x5d5815['__esModule'])return _0x5d5815;var _0xd0d3d=Object['create'](null);function _0x4e029a(_0x31f715,_0x337c1a){return _0x44b3(_0x31f715-0x216,_0x337c1a);}_0x5d5815&&Object['keys'](_0x5d5815)[_0x4ec7ef(-0xe7,-0x12b)](function(_0x27b2fd){function _0x58e750(_0x53cdb8,_0x5ad27d){return _0x4ec7ef(_0x5ad27d-0x55d,_0x53cdb8);}if(_0x27b2fd!=='default'){var _0x78e7e5=Object['getOwnPropertyDescriptor'](_0x5d5815,_0x27b2fd);Object['defineProperty'](_0xd0d3d,_0x27b2fd,_0x78e7e5[_0x58e750(0x56a,0x4e5)]?_0x78e7e5:{'enumerable':!![],'get':function(){return _0x5d5815[_0x27b2fd];}});}});function _0x4ec7ef(_0xf152a3,_0x4baf01){return _0x44b3(_0xf152a3- -0x221,_0x4baf01);}return _0xd0d3d[_0x4e029a(0x37c,0x351)]=_0x5d5815,_0xd0d3d;}var mars3d__namespace=_interopNamespace(mars3d);const Cesium$7=mars3d__namespace[_0x3a94a7(0x4c2,0x45a)];function getU(_0x334f45,_0x3fae90){const _0x20edcd=_0x334f45*Math['cos'](Cesium$7[_0x10c183(-0xce,-0xab)]['toRadians'](_0x3fae90));function _0x10c183(_0x5eb5d1,_0x45a816){return _0x3a94a7(_0x5eb5d1- -0x5da,_0x45a816);}return _0x20edcd;}function getV(_0x40ff85,_0x5a608a){const _0x75cf64=_0x40ff85*Math['sin'](Cesium$7['Math'][_0x251b99(0x14e,0x13f)](_0x5a608a));function _0x251b99(_0x590f84,_0x513380){return _0x3a94a7(_0x513380- -0x2fc,_0x590f84);}return _0x75cf64;}function getSpeed(_0xe7355a,_0x1665df){function _0x591a91(_0x1739bb,_0x2b1fae){return _0x3a94a7(_0x1739bb- -0x31f,_0x2b1fae);}const _0x42b1e6=Math[_0x43e589(0x1ab,0x171)](Math['pow'](_0xe7355a,0x2)+Math[_0x591a91(0x14e,0x1bb)](_0x1665df,0x2));function _0x43e589(_0x1052f5,_0x23948f){return _0x3a94a7(_0x1052f5- -0x2d9,_0x23948f);}return _0x42b1e6;}function getDirection(_0x7f32af,_0x44dce3){let _0xcdd9cf=Cesium$7['Math']['toDegrees'](Math['atan2'](_0x44dce3,_0x7f32af));return _0xcdd9cf+=_0xcdd9cf<0x0?0x168:0x0,_0xcdd9cf;}const _0x63c3a7={};_0x63c3a7['__proto__']=null,_0x63c3a7['getU']=getU,_0x63c3a7['getV']=getV,_0x63c3a7['getSpeed']=getSpeed,_0x63c3a7['getDirection']=getDirection;var WindUtil=_0x63c3a7;const Cesium$6=mars3d__namespace[_0x3e9235(0x38c,0x416)];class CustomPrimitive{constructor(_0x4bea30){this[_0x183272(0x48e,0x491)]=_0x4bea30['commandType'],this['geometry']=_0x4bea30[_0x226b4a(0xda,0xbc)],this['attributeLocations']=_0x4bea30['attributeLocations'],this[_0x183272(0x560,0x582)]=_0x4bea30['primitiveType'],this[_0x226b4a(0x1d6,0x165)]=_0x4bea30['uniformMap'],this['vertexShaderSource']=_0x4bea30['vertexShaderSource'],this['fragmentShaderSource']=_0x4bea30['fragmentShaderSource'],this['rawRenderState']=_0x4bea30[_0x183272(0x4ce,0x537)];function _0x226b4a(_0x33fa6a,_0x43eab4){return _0x3a94a7(_0x43eab4- -0x36f,_0x33fa6a);}this['framebuffer']=_0x4bea30['framebuffer'],this['outputTexture']=_0x4bea30[_0x183272(0x539,0x52d)],this['autoClear']=_0x4bea30['autoClear']??![],this['preExecute']=_0x4bea30['preExecute'],this['show']=!![],this[_0x183272(0x514,0x58c)]=undefined,this[_0x183272(0x4f5,0x500)]=undefined;function _0x183272(_0x59162a,_0x110f9d){return _0x3a94a7(_0x59162a-0x28,_0x110f9d);}this['autoClear']&&(this['clearCommand']=new Cesium$6[(_0x226b4a(0x170,0x14b))]({'color':new Cesium$6[(_0x183272(0x4c8,0x45e))](0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':this[_0x226b4a(0x3f,0xc8)],'pass':Cesium$6['Pass']['OPAQUE']}));}['createCommand'](_0x60501f){function _0x1e2ecc(_0x346fde,_0x13aaa1){return _0x3e9235(_0x13aaa1,_0x346fde- -0x1c0);}function _0x529e5b(_0x3c0033,_0x26244f){return _0x3e9235(_0x3c0033,_0x26244f- -0x9b);}switch(this['commandType']){case'Draw':{const _0x10909e=Cesium$6['VertexArray'][_0x1e2ecc(0x1c6,0x230)]({'context':_0x60501f,'geometry':this[_0x1e2ecc(0x1bf,0x18c)],'attributeLocations':this['attributeLocations'],'bufferUsage':Cesium$6[_0x529e5b(0x3cf,0x3d2)][_0x1e2ecc(0x23e,0x2ae)]}),_0x38db2f={};_0x38db2f['context']=_0x60501f,_0x38db2f['attributeLocations']=this[_0x1e2ecc(0x26c,0x202)],_0x38db2f['vertexShaderSource']=this[_0x1e2ecc(0x1c7,0x1b9)],_0x38db2f['fragmentShaderSource']=this[_0x529e5b(0x40e,0x38f)];const _0x428a31=Cesium$6[_0x1e2ecc(0x28c,0x2b5)]['fromCache'](_0x38db2f),_0x19036b=Cesium$6[_0x1e2ecc(0x213,0x269)]['fromCache'](this['rawRenderState']);return new Cesium$6['DrawCommand']({'owner':this,'vertexArray':_0x10909e,'primitiveType':this['primitiveType'],'uniformMap':this['uniformMap'],'modelMatrix':Cesium$6['Matrix4']['IDENTITY'],'shaderProgram':_0x428a31,'framebuffer':this['framebuffer'],'renderState':_0x19036b,'pass':Cesium$6['Pass']['OPAQUE']});}case _0x529e5b(0x412,0x39f):{const _0x426808={};return _0x426808['owner']=this,_0x426808['fragmentShaderSource']=this['fragmentShaderSource'],_0x426808[_0x529e5b(0x32d,0x38d)]=this['uniformMap'],_0x426808[_0x529e5b(0x341,0x3ca)]=this['outputTexture'],_0x426808['persists']=!![],new Cesium$6['ComputeCommand'](_0x426808);}}}[_0x3e9235(0x46b,0x3e5)](_0x3d5136,_0x376947){this['geometry']=_0x376947;const _0x5608c4=Cesium$6[_0x47df08(0x391,0x352)]['fromGeometry']({'context':_0x3d5136,'geometry':this[_0x4fc8fa(0x1f8,0x252)],'attributeLocations':this['attributeLocations'],'bufferUsage':Cesium$6['BufferUsage'][_0x4fc8fa(0x277,0x285)]});function _0x4fc8fa(_0x1e560f,_0x418123){return _0x3e9235(_0x418123,_0x1e560f- -0x187);}function _0x47df08(_0x4988a1,_0x386dc3){return _0x3a94a7(_0x4988a1- -0xab,_0x386dc3);}this['commandToExecute']['vertexArray']=_0x5608c4;}['update'](_0x131169){if(!this['show'])return;if(_0x131169['mode']!==Cesium$6['SceneMode']['SCENE3D'])return;!Cesium$6['defined'](this['commandToExecute'])&&(this[_0x31de4c(-0x184,-0x179)]=this['createCommand'](_0x131169['context']));function _0x1441f0(_0x4943b7,_0x5b861a){return _0x3a94a7(_0x4943b7- -0x66f,_0x5b861a);}Cesium$6[_0x1441f0(-0x1dc,-0x205)](this['preExecute'])&&this[_0x31de4c(-0x1e0,-0x1c5)]();Cesium$6[_0x31de4c(-0x1dd,-0x21d)](this['clearCommand'])&&_0x131169['commandList']['push'](this['clearCommand']);function _0x31de4c(_0x44af1d,_0xb8a3d){return _0x3e9235(_0xb8a3d,_0x44af1d- -0x5c4);}_0x131169['commandList']['push'](this['commandToExecute']);}['isDestroyed'](){return![];}[_0x3e9235(0x379,0x3a3)](){function _0xffc780(_0x554f13,_0x1210b8){return _0x3e9235(_0x1210b8,_0x554f13- -0xb2);}if(this['clearCommand']){var _0x2a2f15,_0x1506be;(_0x2a2f15=this['clearCommand'])!==null&&_0x2a2f15!==void 0x0&&_0x2a2f15[_0xffc780(0x36d,0x3ba)]&&this[_0xffc780(0x36f,0x3f8)]['vertexArray']['destroy'](),(_0x1506be=this[_0x1225b6(-0x110,-0x128)])!==null&&_0x1506be!==void 0x0&&_0x1506be['shaderProgram']&&this[_0x1225b6(-0x110,-0x101)][_0x1225b6(-0xf9,-0x8b)][_0xffc780(0x2f1,0x2c4)](),delete this[_0x1225b6(-0x110,-0xf8)];}function _0x1225b6(_0x59c1c2,_0x5b52e4){return _0x3e9235(_0x5b52e4,_0x59c1c2- -0x531);}return this[_0x1225b6(-0xf1,-0xe7)]&&(this[_0xffc780(0x38e,0x3f5)]['vertexArray']&&this['commandToExecute'][_0xffc780(0x36d,0x36f)][_0xffc780(0x2f1,0x2c6)](),this[_0x1225b6(-0xf1,-0xae)]['shaderProgram']&&this['commandToExecute'][_0xffc780(0x386,0x30c)]['destroy'](),delete this['commandToExecute']),Cesium$6['destroyObject'](this);}}const Cesium$5=mars3d__namespace['Cesium'],Util=(function(){const _0x12acb2=function(){const _0x260ef3=new Cesium$5['Geometry']({'attributes':new Cesium$5['GeometryAttributes']({'position':new Cesium$5[(_0x185820(0x2ce,0x345))]({'componentDatatype':Cesium$5['ComponentDatatype']['FLOAT'],'componentsPerAttribute':0x3,'values':new Float32Array([-0x1,-0x1,0x0,0x1,-0x1,0x0,0x1,0x1,0x0,-0x1,0x1,0x0])}),'st':new Cesium$5['GeometryAttribute']({'componentDatatype':Cesium$5['ComponentDatatype']['FLOAT'],'componentsPerAttribute':0x2,'values':new Float32Array([0x0,0x0,0x1,0x0,0x1,0x1,0x0,0x1])})}),'indices':new Uint32Array([0x3,0x2,0x0,0x0,0x2,0x1])});function _0x185820(_0x34e85f,_0x77de6b){return _0x44b3(_0x77de6b-0x21a,_0x34e85f);}return _0x260ef3;},_0xbea186=function(_0x32d00c,_0x21876b){if(Cesium$5['defined'](_0x21876b)){const _0x12b964={};_0x12b964['arrayBufferView']=_0x21876b,_0x32d00c['source']=_0x12b964;}const _0x37f538=new Cesium$5['Texture'](_0x32d00c);return _0x37f538;},_0x25cb7=function(_0x3c3db3,_0x3fbfa0,_0x118ec1){function _0x2f89e3(_0x35e740,_0x34a5f8){return _0x44b3(_0x35e740-0x1d3,_0x34a5f8);}const _0x52fca3={};_0x52fca3[_0x2f89e3(0x3c4,0x3b7)]=_0x3c3db3,_0x52fca3['colorTextures']=[_0x3fbfa0],_0x52fca3['depthTexture']=_0x118ec1;const _0x1b05bd=new Cesium$5['Framebuffer'](_0x52fca3);return _0x1b05bd;},_0x2f84e5=function(_0x2f46f5){const _0x3ad50e=!![],_0x3a3664=![];function _0x52c379(_0x178cf4,_0x295bc2){return _0x44b3(_0x295bc2- -0x104,_0x178cf4);}const _0x2ec3bf={};_0x2ec3bf[_0x3495b1(-0x13,-0x77)]=_0x2f46f5['viewport'],_0x2ec3bf['depthTest']=_0x2f46f5['depthTest'],_0x2ec3bf['depthMask']=_0x2f46f5[_0x52c379(0xc1,0x86)],_0x2ec3bf['blending']=_0x2f46f5[_0x52c379(-0x2c,0x41)];function _0x3495b1(_0x576c4f,_0x444a11){return _0x44b3(_0x576c4f- -0x205,_0x444a11);}const _0x47ba04=_0x2ec3bf,_0x43bcb1=Cesium$5['Appearance'][_0x52c379(0xcd,0xa9)](_0x3ad50e,_0x3a3664,_0x47ba04);return _0x43bcb1;},_0x49de03=function(_0x30adc2){function _0x3add15(_0x10ce23,_0x90327c){return _0x44b3(_0x90327c- -0x1d9,_0x10ce23);}const _0x462d74={},_0x105d4f=Cesium$5['Math']['mod'](_0x30adc2[_0x3add15(-0xa9,-0x55)],Cesium$5[_0x27f9e9(0x245,0x21a)]['TWO_PI']),_0x4c2947=Cesium$5[_0x3add15(-0x57,-0x15)]['mod'](_0x30adc2['east'],Cesium$5['Math']['TWO_PI']),_0x4c46fc=_0x30adc2['width'];let _0x3dcc72,_0x12a20a;_0x4c46fc>Cesium$5['Math'][_0x27f9e9(0x218,0x1df)]?(_0x3dcc72=0x0,_0x12a20a=Cesium$5[_0x27f9e9(0x23a,0x21a)]['TWO_PI']):_0x4c2947-_0x105d4f<_0x4c46fc?(_0x3dcc72=_0x105d4f,_0x12a20a=_0x105d4f+_0x4c46fc):(_0x3dcc72=_0x105d4f,_0x12a20a=_0x4c2947);_0x462d74[_0x3add15(-0xa9,-0x7c)]={'min':Cesium$5[_0x27f9e9(0x204,0x21a)]['toDegrees'](_0x3dcc72),'max':Cesium$5['Math']['toDegrees'](_0x12a20a)};const _0x450849=_0x30adc2['south'];function _0x27f9e9(_0x349216,_0x553bf0){return _0x44b3(_0x553bf0-0x56,_0x349216);}const _0x2dd012=_0x30adc2['north'],_0x313b39=_0x30adc2[_0x3add15(-0xd,-0x19)],_0x35bbf2=_0x313b39>Cesium$5[_0x27f9e9(0x1ff,0x21a)]['PI']/0xc?_0x313b39/0x2:0x0;let _0x534e01=Cesium$5['Math'][_0x3add15(-0x5c,-0x6b)](_0x450849-_0x35bbf2),_0x53ee14=Cesium$5[_0x3add15(-0x32,-0x15)]['clampToLatitudeRange'](_0x2dd012+_0x35bbf2);return _0x534e01<-Cesium$5[_0x27f9e9(0x273,0x21a)]['PI_OVER_THREE']&&(_0x534e01=-Cesium$5['Math']['PI_OVER_TWO']),_0x53ee14>Cesium$5['Math']['PI_OVER_THREE']&&(_0x53ee14=Cesium$5[_0x27f9e9(0x23f,0x21a)]['PI_OVER_TWO']),_0x462d74['lat']={'min':Cesium$5['Math'][_0x3add15(-0x96,-0x72)](_0x534e01),'max':Cesium$5['Math'][_0x27f9e9(0x1e7,0x1bd)](_0x53ee14)},_0x462d74;},_0x3795f5={};return _0x3795f5['getFullscreenQuad']=_0x12acb2,_0x3795f5['createTexture']=_0xbea186,_0x3795f5['createFramebuffer']=_0x25cb7,_0x3795f5['createRawRenderState']=_0x2f84e5,_0x3795f5['viewRectangleToLonLatRange']=_0x49de03,_0x3795f5;}());var fullscreenVert='#version\x20300\x20es\x0a\x0ain\x20vec3\x20position;\x0ain\x20vec2\x20st;\x0a\x0aout\x20vec2\x20textureCoordinate;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20textureCoordinate\x20=\x20st;\x0a\x20\x20gl_Position\x20=\x20vec4(position,\x201.0f);\x0a}\x0a',screenDrawFrag='#version\x20300\x20es\x0a\x0auniform\x20sampler2D\x20trailsColorTexture;\x0auniform\x20sampler2D\x20trailsDepthTexture;\x0a\x0ain\x20vec2\x20textureCoordinate;\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20vec4\x20trailsColor\x20=\x20texture(trailsColorTexture,\x20textureCoordinate);\x0a\x20\x20float\x20trailsDepth\x20=\x20texture(trailsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20float\x20globeDepth\x20=\x20czm_unpackDepth(texture(czm_globeDepthTexture,\x20textureCoordinate));\x0a\x0a\x20\x20if(trailsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20trailsColor;\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(0.0f);\x0a\x20\x20}\x0a}\x0a',segmentDrawFrag=_0x3a94a7(0x486,0x4be),segmentDrawVert=_0x3a94a7(0x4a1,0x4ab),trailDrawFrag='#version\x20300\x20es\x0a\x0aprecision\x20highp\x20float;\x0a\x0ain\x20vec2\x20textureCoordinate;\x0a\x0auniform\x20sampler2D\x20segmentsColorTexture;\x0auniform\x20sampler2D\x20segmentsDepthTexture;\x0a\x0auniform\x20sampler2D\x20currentTrailsColor;\x0auniform\x20sampler2D\x20trailsDepthTexture;\x0a\x0auniform\x20float\x20fadeOpacity;\x0a\x0aout\x20vec4\x20fragColor;\x0avoid\x20main()\x20{\x0a\x20\x20vec4\x20pointsColor\x20=\x20texture(segmentsColorTexture,\x20textureCoordinate);\x0a\x20\x20vec4\x20trailsColor\x20=\x20texture(currentTrailsColor,\x20textureCoordinate);\x0a\x20\x20trailsColor\x20=\x20floor(fadeOpacity\x20*\x20255.0f\x20*\x20trailsColor)\x20/\x20255.0f;\x20//\x20make\x20sure\x20the\x20trailsColor\x20will\x20be\x20strictly\x20decreased\x0a\x0a\x20\x20float\x20pointsDepth\x20=\x20texture(segmentsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20float\x20trailsDepth\x20=\x20texture(trailsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20float\x20globeDepth\x20=\x20czm_unpackDepth(texture(czm_globeDepthTexture,\x20textureCoordinate));\x0a\x20\x20fragColor\x20=\x20vec4(0.0f);\x0a\x20\x20if(pointsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20fragColor\x20+\x20pointsColor;\x0a\x20\x20}\x0a\x20\x20if(trailsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20fragColor\x20+\x20trailsColor;\x0a\x20\x20}\x0a\x20\x20gl_FragDepth\x20=\x20min(pointsDepth,\x20trailsDepth);\x0a}\x0a';const Cesium$4=mars3d__namespace[_0x3e9235(0x482,0x416)];class ParticlesRendering{constructor(_0x49c077,_0x2d3003,_0x577d87,_0xda8dd4,_0x3e1fa){this[_0x3ec147(0x588,0x5f2)]=_0x577d87['colors']==='height',this['createRenderingTextures'](_0x49c077,_0x2d3003,_0x577d87['colors']),this['createRenderingFramebuffers'](_0x49c077);function _0x3ec147(_0x3e8561,_0x2339a7){return _0x3a94a7(_0x3e8561-0x57,_0x2339a7);}this['createRenderingPrimitives'](_0x49c077,_0x2d3003,_0x577d87,_0xda8dd4,_0x3e1fa);}['createRenderingTextures'](_0x164536,_0x2d6f7d,_0x226ada){const _0x51d2e8={};_0x51d2e8['context']=_0x164536,_0x51d2e8['width']=_0x164536['drawingBufferWidth'],_0x51d2e8['height']=_0x164536['drawingBufferHeight'];function _0x447467(_0x5473ad,_0x10bb9b){return _0x3a94a7(_0x5473ad- -0x219,_0x10bb9b);}_0x51d2e8['pixelFormat']=Cesium$4[_0x447467(0x27c,0x29f)]['RGBA'];function _0x5ac064(_0x504d18,_0x1f58cf){return _0x3e9235(_0x1f58cf,_0x504d18- -0x5f5);}_0x51d2e8[_0x5ac064(-0x268,-0x2ed)]=Cesium$4['PixelDatatype']['UNSIGNED_BYTE'];const _0x1f1591=_0x51d2e8,_0x4561c9={};_0x4561c9['context']=_0x164536,_0x4561c9[_0x5ac064(-0x1b8,-0x13b)]=_0x164536[_0x447467(0x255,0x27b)],_0x4561c9['height']=_0x164536[_0x5ac064(-0x21c,-0x223)],_0x4561c9['pixelFormat']=Cesium$4[_0x447467(0x27c,0x232)]['DEPTH_COMPONENT'],_0x4561c9['pixelDatatype']=Cesium$4[_0x447467(0x2ec,0x36a)]['UNSIGNED_INT'];const _0x1cf73d=_0x4561c9,_0x203d67=_0x226ada['length'],_0x65c7d6=new Float32Array(_0x203d67*0x3);for(let _0xedd0c9=0x0;_0xedd0c9<_0x203d67;_0xedd0c9++){const _0x566081=Cesium$4['Color']['fromCssColorString'](_0x226ada[_0xedd0c9]);_0x65c7d6[0x3*_0xedd0c9]=_0x566081['red'],_0x65c7d6[0x3*_0xedd0c9+0x1]=_0x566081[_0x447467(0x2a4,0x23b)],_0x65c7d6[0x3*_0xedd0c9+0x2]=_0x566081['blue'];}const _0x2985fe={'context':_0x164536,'width':_0x203d67,'height':0x1,'pixelFormat':Cesium$4['PixelFormat']['RGB'],'pixelDatatype':Cesium$4['PixelDatatype']['FLOAT'],'sampler':new Cesium$4['Sampler']({'minificationFilter':Cesium$4['TextureMinificationFilter']['LINEAR'],'magnificationFilter':Cesium$4['TextureMagnificationFilter']['LINEAR']})};this['textures']={'segmentsColor':Util['createTexture'](_0x1f1591),'segmentsDepth':Util[_0x447467(0x23f,0x2b2)](_0x1cf73d),'currentTrailsColor':Util['createTexture'](_0x1f1591),'currentTrailsDepth':Util['createTexture'](_0x1cf73d),'nextTrailsColor':Util['createTexture'](_0x1f1591),'nextTrailsDepth':Util['createTexture'](_0x1cf73d),'colorTable':Util[_0x447467(0x23f,0x280)](_0x2985fe,_0x65c7d6)};}[_0x3a94a7(0x520,0x57f)](_0x427ed2){function _0x56d4c8(_0x3bf38,_0x64e72d){return _0x3e9235(_0x64e72d,_0x3bf38- -0x1dc);}function _0x475dee(_0x39fd97,_0x10b06a){return _0x3a94a7(_0x39fd97- -0x5b8,_0x10b06a);}this[_0x56d4c8(0x1f6,0x22a)]={'segments':Util['createFramebuffer'](_0x427ed2,this[_0x475dee(-0x110,-0x163)]['segmentsColor'],this['textures']['segmentsDepth']),'currentTrails':Util[_0x475dee(-0x157,-0xff)](_0x427ed2,this[_0x56d4c8(0x220,0x1f4)]['currentTrailsColor'],this[_0x56d4c8(0x220,0x1ee)]['currentTrailsDepth']),'nextTrails':Util['createFramebuffer'](_0x427ed2,this['textures']['nextTrailsColor'],this['textures']['nextTrailsDepth'])};}['createSegmentsGeometry'](_0x585c40){const _0x51ea07=0x4;let _0x30420d=[];for(let _0x14c198=0x0;_0x14c198<_0x585c40['particlesTextureSize'];_0x14c198++){for(let _0xf09287=0x0;_0xf09287<_0x585c40['particlesTextureSize'];_0xf09287++){for(let _0x3f3781=0x0;_0x3f3781<_0x51ea07;_0x3f3781++){_0x30420d['push'](_0x14c198/_0x585c40[_0x2199f1(0x368,0x311)]),_0x30420d['push'](_0xf09287/_0x585c40[_0x21341a(0x253,0x20b)]);}}}_0x30420d=new Float32Array(_0x30420d);let _0x38eb03=[];function _0x21341a(_0x135801,_0x58dadc){return _0x3a94a7(_0x58dadc- -0x236,_0x135801);}function _0x2199f1(_0x184217,_0x3a76aa){return _0x3a94a7(_0x3a76aa- -0x130,_0x184217);}for(let _0x159346=0x0;_0x159346<_0x585c40[_0x2199f1(0x3de,0x3de)];_0x159346++){_0x38eb03['push'](-0x1,-0x1,0x0,-0x1,0x1,0x0,0x1,-0x1,0x0,0x1,0x1,0x0);}_0x38eb03=new Float32Array(_0x38eb03);let _0xb4e888=[];for(let _0x223187=0x0,_0x381d69=0x0;_0x223187<_0x585c40['maxParticles'];_0x223187++){_0xb4e888[_0x2199f1(0x383,0x3ea)](_0x381d69+0x0,_0x381d69+0x1,_0x381d69+0x2,_0x381d69+0x2,_0x381d69+0x1,_0x381d69+0x3),_0x381d69+=_0x51ea07;}_0xb4e888=new Uint32Array(_0xb4e888);const _0x5bca29=new Cesium$4['Geometry']({'attributes':new Cesium$4[(_0x21341a(0x263,0x2c5))]({'st':new Cesium$4['GeometryAttribute']({'componentDatatype':Cesium$4['ComponentDatatype']['FLOAT'],'componentsPerAttribute':0x2,'values':_0x30420d}),'normal':new Cesium$4['GeometryAttribute']({'componentDatatype':Cesium$4['ComponentDatatype'][_0x2199f1(0x42e,0x3db)],'componentsPerAttribute':0x3,'values':_0x38eb03})}),'indices':_0xb4e888});return _0x5bca29;}[_0x3a94a7(0x43a,0x49e)](_0x3b36e5,_0x4ca520,_0x2a2e4e,_0x1be9f7,_0x88b474){const _0x5c73e3=this,_0x36904e={};_0x36904e['st']=0x0,_0x36904e['normal']=0x1;const _0xdd44c0={};_0xdd44c0['sources']=[segmentDrawVert];const _0x56c946={};_0x56c946[_0x26f161(0xf1,0x99)]=[segmentDrawFrag];function _0x26f161(_0x2f176d,_0x33165f){return _0x3e9235(_0x2f176d,_0x33165f- -0x344);}const _0x4be5d5={};_0x4be5d5['enabled']=!![];const _0x293d28={};_0x293d28[_0x26f161(0x156,0x14a)]=undefined,_0x293d28[_0x26f161(0x10b,0x150)]=_0x4be5d5,_0x293d28['depthMask']=!![];const _0x2b59bf={};_0x2b59bf[_0x26f161(0x9b,0xf0)]=0x0,_0x2b59bf['st']=0x1;const _0x4e230c={};_0x4e230c[_0x280a8d(0x2ab,0x23c)]=['DISABLE_GL_POSITION_LOG_DEPTH'],_0x4e230c['sources']=[fullscreenVert];const _0x45ca6f={};function _0x280a8d(_0x309591,_0xade5a){return _0x3a94a7(_0x309591- -0x27f,_0xade5a);}_0x45ca6f['defines']=['DISABLE_LOG_DEPTH_FRAGMENT_WRITE'],_0x45ca6f['sources']=[trailDrawFrag];const _0x45d097={};_0x45d097['position']=0x0,_0x45d097['st']=0x1;const _0x4d00a1={};_0x4d00a1[_0x26f161(0xfd,0x13a)]=['DISABLE_GL_POSITION_LOG_DEPTH'],_0x4d00a1[_0x280a8d(0x20a,0x1f5)]=[fullscreenVert];const _0x245278={};_0x245278['defines']=[_0x26f161(0x153,0x132)],_0x245278[_0x280a8d(0x20a,0x1cb)]=[screenDrawFrag];const _0x12e378={};_0x12e378[_0x26f161(0x14e,0x10e)]=![];const _0x5132f4={};_0x5132f4[_0x26f161(0x8c,0x10e)]=!![],this[_0x26f161(0xba,0xaa)]={'segments':new CustomPrimitive({'commandType':_0x280a8d(0x1b7,0x21b),'attributeLocations':_0x36904e,'geometry':this['createSegmentsGeometry'](_0x2a2e4e),'primitiveType':Cesium$4[_0x26f161(0xa1,0xcb)]['TRIANGLES'],'uniformMap':{'previousParticlesPosition':function(){return _0x88b474['particlesTextures']['previousParticlesPosition'];},'currentParticlesPosition':function(){function _0x3af5f(_0x25e60b,_0x19aa17){return _0x280a8d(_0x19aa17- -0x290,_0x25e60b);}return _0x88b474[_0x3af5f(-0x75,-0x62)]['currentParticlesPosition'];},'postProcessingPosition':function(){function _0x565262(_0x5d59bb,_0x1d30e7){return _0x280a8d(_0x5d59bb-0x32,_0x1d30e7);}return _0x88b474['particlesTextures'][_0x565262(0x2e7,0x2e6)];},'particlesSpeed':function(){function _0x477296(_0x36c3ad,_0x1b060d){return _0x26f161(_0x1b060d,_0x36c3ad-0x27a);}return _0x88b474[_0x477296(0x337,0x2dc)]['particlesSpeed'];},'colorTable':function(){return _0x5c73e3['textures']['colorTable'];},'aspect':function(){function _0x19f4be(_0x46b781,_0xf031c0){return _0x26f161(_0xf031c0,_0x46b781-0x2a9);}return _0x3b36e5[_0x19f4be(0x327,0x31b)]/_0x3b36e5['drawingBufferHeight'];},'H':function(){function _0x46a0f1(_0x15dad6,_0x3c829c){return _0x26f161(_0x15dad6,_0x3c829c- -0x20e);}return _0x4ca520['H'][_0x46a0f1(-0xe8,-0x123)];},'hRange':function(){return new Cesium$4['Cartesian2'](_0x4ca520['H']['min'],_0x4ca520['H']['max']);},'uSpeedRange':function(){function _0x5ee0ab(_0x13fa62,_0x2f3dc4){return _0x26f161(_0x13fa62,_0x2f3dc4- -0x1ac);}function _0x3e051a(_0x4637fe,_0x41849f){return _0x280a8d(_0x41849f-0x27a,_0x4637fe);}return new Cesium$4[(_0x5ee0ab(-0xba,-0xc0))](_0x4ca520['U']['min'],_0x4ca520['U'][_0x3e051a(0x4b9,0x526)]);},'vSpeedRange':function(){function _0x473317(_0x1b3b63,_0x3fe0ed){return _0x26f161(_0x1b3b63,_0x3fe0ed-0x1e9);}function _0x390b29(_0x4d15f3,_0x3a4406){return _0x26f161(_0x3a4406,_0x4d15f3- -0x2b);}return new Cesium$4[(_0x473317(0x297,0x2d5))](_0x4ca520['V']['min'],_0x4ca520['V'][_0x390b29(0x110,0x93)]);},'wSpeedRange':function(){function _0x4b7362(_0x404d87,_0x1e19fc){return _0x280a8d(_0x404d87- -0x95,_0x1e19fc);}function _0x5777ae(_0x2c380c,_0x592237){return _0x280a8d(_0x592237-0x11b,_0x2c380c);}return new Cesium$4[(_0x5777ae(0x38d,0x378))](_0x4ca520['W'][_0x4b7362(0x177,0x1d6)],_0x4ca520['W'][_0x5777ae(0x37c,0x3c7)]);},'pixelSize':function(){return _0x1be9f7['pixelSize'];},'lineWidth':function(){function _0x20b53b(_0x5bce11,_0x4a3473){return _0x280a8d(_0x4a3473- -0xb3,_0x5bce11);}return _0x2a2e4e[_0x20b53b(0xb1,0xfc)];},'particleHeight':function(){function _0x266ed9(_0xa46701,_0x5966e4){return _0x26f161(_0xa46701,_0x5966e4-0x480);}return _0x2a2e4e[_0x266ed9(0x568,0x563)];},'colour':function(){return _0x5c73e3['colour'];}},'vertexShaderSource':new Cesium$4[(_0x26f161(-0x12,0x75))](_0xdd44c0),'fragmentShaderSource':new Cesium$4['ShaderSource'](_0x56c946),'rawRenderState':Util['createRawRenderState'](_0x293d28),'framebuffer':this[_0x280a8d(0x1ff,0x212)]['segments'],'autoClear':!![]}),'trails':new CustomPrimitive({'commandType':'Draw','attributeLocations':_0x2b59bf,'geometry':Util[_0x280a8d(0x1d5,0x24a)](),'primitiveType':Cesium$4[_0x280a8d(0x23c,0x1cb)]['TRIANGLES'],'uniformMap':{'segmentsColorTexture':function(){function _0x128185(_0x5227ac,_0x5b852b){return _0x26f161(_0x5227ac,_0x5b852b-0x149);}return _0x5c73e3[_0x128185(0x1b0,0x201)]['segmentsColor'];},'segmentsDepthTexture':function(){function _0x5c3ef8(_0x161093,_0x590a08){return _0x280a8d(_0x590a08-0x249,_0x161093);}return _0x5c73e3[_0x5c3ef8(0x48a,0x472)]['segmentsDepth'];},'currentTrailsColor':function(){function _0x5ce93b(_0x2711ec,_0x379481){return _0x280a8d(_0x379481-0xca,_0x2711ec);}return _0x5c73e3[_0x5ce93b(0x32c,0x2c9)]['currentTrails']['getColorTexture'](0x0);},'trailsDepthTexture':function(){function _0x24398f(_0x16c797,_0x2b3ce2){return _0x280a8d(_0x16c797- -0x197,_0x2b3ce2);}function _0x1c4aca(_0x27ed0b,_0x48a12f){return _0x26f161(_0x48a12f,_0x27ed0b-0x167);}return _0x5c73e3[_0x1c4aca(0x1f5,0x264)]['currentTrails'][_0x1c4aca(0x219,0x20f)];},'fadeOpacity':function(){return _0x2a2e4e['fadeOpacity'];}},'vertexShaderSource':new Cesium$4['ShaderSource'](_0x4e230c),'fragmentShaderSource':new Cesium$4['ShaderSource'](_0x45ca6f),'rawRenderState':Util[_0x280a8d(0x201,0x20c)]({'viewport':undefined,'depthTest':{'enabled':!![],'func':Cesium$4['DepthFunction']['ALWAYS']},'depthMask':!![]}),'framebuffer':this['framebuffers'][_0x26f161(0x31,0x61)],'autoClear':!![],'preExecute':function(){if(_0x2a2e4e['dynamic']){const _0x239e00=_0x5c73e3['framebuffers'][_0x1e2d30(0x2d8,0x24c)];_0x5c73e3['framebuffers']['currentTrails']=_0x5c73e3['framebuffers'][_0x1e2d30(0xff,0x174)],_0x5c73e3[_0x2b873f(-0x266,-0x28f)][_0x2b873f(-0x339,-0x2bc)]=_0x239e00;}_0x5c73e3[_0x2b873f(-0x2b9,-0x273)]['trails']['commandToExecute']['framebuffer']=_0x5c73e3['framebuffers'][_0x2b873f(-0x23f,-0x2bc)];function _0x1e2d30(_0x24923b,_0x2621c){return _0x280a8d(_0x2621c- -0x5e,_0x24923b);}function _0x2b873f(_0x29c837,_0x1bbcdd){return _0x26f161(_0x29c837,_0x1bbcdd- -0x31d);}_0x5c73e3['primitives']['trails']['clearCommand']['framebuffer']=_0x5c73e3['framebuffers'][_0x2b873f(-0x287,-0x2bc)];}}),'screen':new CustomPrimitive({'commandType':'Draw','attributeLocations':_0x45d097,'geometry':Util[_0x26f161(0xda,0x64)](),'primitiveType':Cesium$4['PrimitiveType']['TRIANGLES'],'uniformMap':{'trailsColorTexture':function(){function _0x5d64c9(_0x5d7030,_0x531b4e){return _0x280a8d(_0x5d7030- -0x26e,_0x531b4e);}function _0x4cd74a(_0x5f1ffa,_0x151e44){return _0x280a8d(_0x151e44- -0x84,_0x5f1ffa);}return _0x5c73e3[_0x4cd74a(0x173,0x17b)][_0x4cd74a(0x121,0x14e)]['getColorTexture'](0x0);},'trailsDepthTexture':function(){function _0x4ac560(_0x5e53f4,_0x56c688){return _0x280a8d(_0x56c688- -0x142,_0x5e53f4);}function _0x31084e(_0x34abb0,_0x14e9cb){return _0x280a8d(_0x14e9cb- -0x99,_0x34abb0);}return _0x5c73e3['framebuffers'][_0x4ac560(0xdc,0x90)][_0x31084e(0x100,0x18a)];}},'vertexShaderSource':new Cesium$4['ShaderSource'](_0x4d00a1),'fragmentShaderSource':new Cesium$4['ShaderSource'](_0x245278),'rawRenderState':Util['createRawRenderState']({'viewport':undefined,'depthTest':_0x12e378,'depthMask':!![],'blending':_0x5132f4}),'framebuffer':undefined})};}}var CalculateSpeedShader='#version\x20300\x20es\x0a\x0a//\x20the\x20size\x20of\x20UV\x20textures:\x20width\x20=\x20lon,\x20height\x20=\x20lat*lev\x0auniform\x20sampler2D\x20U;\x20//\x20eastward\x20wind\x0auniform\x20sampler2D\x20V;\x20//\x20northward\x20wind\x0auniform\x20sampler2D\x20W;\x20//\x20upward\x20wind\x0auniform\x20sampler2D\x20currentParticlesPosition;\x20//\x20(lon,\x20lat,\x20lev)\x0a\x0auniform\x20vec3\x20dimension;\x20//\x20(lon,\x20lat,\x20lev)\x0auniform\x20vec3\x20minimum;\x20//\x20minimum\x20of\x20each\x20dimension\x0auniform\x20vec3\x20maximum;\x20//\x20maximum\x20of\x20each\x20dimension\x0auniform\x20vec3\x20interval;\x20//\x20interval\x20of\x20each\x20dimension\x0a\x0a//\x20used\x20to\x20calculate\x20the\x20wind\x20norm\x0auniform\x20vec2\x20uSpeedRange;\x20//\x20(min,\x20max);\x0auniform\x20vec2\x20vSpeedRange;\x0auniform\x20vec2\x20wSpeedRange;\x0auniform\x20float\x20speedScaleFactor;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avec2\x20mapPositionToNormalizedIndex2D(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20ensure\x20the\x20range\x20of\x20longitude\x20and\x20latitude\x0a\x20\x20lonLatLev.x\x20=\x20clamp(lonLatLev.x,\x20minimum.x,\x20maximum.x);\x0a\x20\x20lonLatLev.y\x20=\x20clamp(lonLatLev.y,\x20minimum.y,\x20maximum.y);\x0a\x20\x20lonLatLev.z\x20=\x20clamp(lonLatLev.z,\x20minimum.z,\x20maximum.z);\x0a\x0a\x20\x20vec3\x20index3D\x20=\x20vec3(0.0f);\x0a\x20\x20index3D.x\x20=\x20(lonLatLev.x\x20-\x20minimum.x)\x20/\x20interval.x;\x0a\x20\x20index3D.y\x20=\x20(lonLatLev.y\x20-\x20minimum.y)\x20/\x20interval.y;\x0a\x20\x20\x20\x20//\x20map\x20the\x20z-axis\x20value\x20to\x20the\x20nearest\x20bit\x20plane\x20to\x20ensure\x20that\x20the\x20result\x20is\x20an\x20integer\x0a\x20\x20index3D.z\x20=\x20ceil((lonLatLev.z\x20-\x20minimum.z)\x20/\x20interval.z);\x0a\x0a\x20\x20\x20\x20//\x20the\x20st\x20texture\x20coordinate\x20corresponding\x20to\x20(col,\x20row)\x20index\x0a\x20\x20\x20\x20//\x20example\x0a\x20\x20\x20\x20//\x20data\x20array\x20is\x20[0,\x201,\x202,\x203,\x204,\x205,\x207,\x208,\x209],\x20width\x20=\x202,\x20height\x20=\x202,\x20level\x20=\x202\x0a\x20\x20\x20\x20//\x20the\x20content\x20of\x20texture\x20will\x20be\x0a\x20\x20\x20\x20//\x20t\x201.0\x0a\x20\x20\x20\x20//\x20\x20\x20\x20|\x20\x206\x207\x0a\x20\x20\x20\x20//\x20\x20\x20\x20|\x20\x204\x205\x0a\x20\x20\x20\x20//\x20\x20\x20\x20|\x20\x202\x203\x0a\x20\x20\x20\x20//\x20\x20\x20\x20|\x20\x200\x201\x0a\x20\x20\x20\x20//\x20\x20\x200.0------1.0\x20s\x0a\x0a\x20\x20vec2\x20index2D\x20=\x20vec2(index3D.x,\x20index3D.z\x20*\x20dimension.y\x20+\x20index3D.y);\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20vec2(index2D.x\x20/\x20dimension.x,\x20index2D.y\x20/\x20(dimension.y\x20*\x20dimension.z));\x0a\x20\x20return\x20normalizedIndex2D;\x0a}\x0a\x0afloat\x20getWindComponent(sampler2D\x20componentTexture,\x20vec3\x20lonLatLev)\x20{\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20mapPositionToNormalizedIndex2D(lonLatLev);\x0a\x20\x20float\x20result\x20=\x20texture(componentTexture,\x20normalizedIndex2D).r;\x0a\x20\x20return\x20result;\x0a}\x0a\x0afloat\x20interpolateTexture(sampler2D\x20componentTexture,\x20vec3\x20lonLatLev)\x20{\x0a\x20\x20float\x20lon\x20=\x20lonLatLev.x;\x0a\x20\x20float\x20lat\x20=\x20lonLatLev.y;\x0a\x20\x20float\x20lev\x20=\x20lonLatLev.z;\x0a\x0a\x20\x20float\x20lon0\x20=\x20floor(lon\x20/\x20interval.x)\x20*\x20interval.x;\x0a\x20\x20float\x20lon1\x20=\x20lon0\x20+\x201.0f\x20*\x20interval.x;\x0a\x20\x20float\x20lat0\x20=\x20floor(lat\x20/\x20interval.y)\x20*\x20interval.y;\x0a\x20\x20float\x20lat1\x20=\x20lat0\x20+\x201.0f\x20*\x20interval.y;\x0a\x0a\x20\x20float\x20lon0_lat0\x20=\x20getWindComponent(componentTexture,\x20vec3(lon0,\x20lat0,\x20lev));\x0a\x20\x20float\x20lon1_lat0\x20=\x20getWindComponent(componentTexture,\x20vec3(lon1,\x20lat0,\x20lev));\x0a\x20\x20float\x20lon0_lat1\x20=\x20getWindComponent(componentTexture,\x20vec3(lon0,\x20lat1,\x20lev));\x0a\x20\x20float\x20lon1_lat1\x20=\x20getWindComponent(componentTexture,\x20vec3(lon1,\x20lat1,\x20lev));\x0a\x0a\x20\x20float\x20lon_lat0\x20=\x20mix(lon0_lat0,\x20lon1_lat0,\x20lon\x20-\x20lon0);\x0a\x20\x20float\x20lon_lat1\x20=\x20mix(lon0_lat1,\x20lon1_lat1,\x20lon\x20-\x20lon0);\x0a\x20\x20float\x20lon_lat\x20=\x20mix(lon_lat0,\x20lon_lat1,\x20lat\x20-\x20lat0);\x0a\x20\x20return\x20lon_lat;\x0a}\x0a\x0avec3\x20linearInterpolation(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20https://en.wikipedia.org/wiki/Bilinear_interpolation\x0a\x20\x20float\x20u\x20=\x20interpolateTexture(U,\x20lonLatLev);\x0a\x20\x20float\x20v\x20=\x20interpolateTexture(V,\x20lonLatLev);\x0a\x20\x20float\x20w\x20=\x20interpolateTexture(W,\x20lonLatLev);\x0a\x20\x20return\x20vec3(u,\x20v,\x20w);\x0a}\x0a\x0avec2\x20lengthOfLonLat(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20unit\x20conversion:\x20meters\x20->\x20longitude\x20latitude\x20degrees\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Geographic_coordinate_system#Length_of_a_degree\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20the\x20length\x20of\x20a\x20degree\x20of\x20latitude\x20and\x20longitude\x20in\x20meters\x0a\x20\x20float\x20latitude\x20=\x20radians(lonLatLev.y);\x0a\x0a\x20\x20float\x20term1\x20=\x20111132.92f;\x0a\x20\x20float\x20term2\x20=\x20559.82f\x20*\x20cos(2.0f\x20*\x20latitude);\x0a\x20\x20float\x20term3\x20=\x201.175f\x20*\x20cos(4.0f\x20*\x20latitude);\x0a\x20\x20float\x20term4\x20=\x200.0023f\x20*\x20cos(6.0f\x20*\x20latitude);\x0a\x20\x20float\x20latLength\x20=\x20term1\x20-\x20term2\x20+\x20term3\x20-\x20term4;\x0a\x0a\x20\x20float\x20term5\x20=\x20111412.84f\x20*\x20cos(latitude);\x0a\x20\x20float\x20term6\x20=\x2093.5f\x20*\x20cos(3.0f\x20*\x20latitude);\x0a\x20\x20float\x20term7\x20=\x200.118f\x20*\x20cos(5.0f\x20*\x20latitude);\x0a\x20\x20float\x20longLength\x20=\x20term5\x20-\x20term6\x20+\x20term7;\x0a\x0a\x20\x20return\x20vec2(longLength,\x20latLength);\x0a}\x0a\x0avec3\x20convertSpeedUnitToLonLat(vec3\x20lonLatLev,\x20vec3\x20speed)\x20{\x0a\x20\x20vec2\x20lonLatLength\x20=\x20lengthOfLonLat(lonLatLev);\x0a\x20\x20float\x20u\x20=\x20speed.x\x20/\x20lonLatLength.x;\x0a\x20\x20float\x20v\x20=\x20speed.y\x20/\x20lonLatLength.y;\x0a\x20\x20float\x20w\x20=\x20speed.z;\x0a\x20\x20vec3\x20windVectorInLonLatLev\x20=\x20vec3(u,\x20v,\x20w);\x0a\x0a\x20\x20return\x20windVectorInLonLatLev;\x0a}\x0a\x0avec3\x20calculateSpeedByRungeKutta2(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods#Second-order_methods_with_two_stages\x20for\x20detail\x0a\x20\x20const\x20float\x20h\x20=\x200.5f;\x0a\x0a\x20\x20vec3\x20y_n\x20=\x20lonLatLev;\x0a\x20\x20vec3\x20f_n\x20=\x20linearInterpolation(lonLatLev);\x0a\x20\x20vec3\x20midpoint\x20=\x20y_n\x20+\x200.5f\x20*\x20h\x20*\x20convertSpeedUnitToLonLat(y_n,\x20f_n)\x20*\x20speedScaleFactor;\x0a\x20\x20vec3\x20speed\x20=\x20h\x20*\x20linearInterpolation(midpoint)\x20*\x20speedScaleFactor;\x0a\x0a\x20\x20return\x20speed;\x0a}\x0a\x0avec2\x20getRange(vec2\x20range)\x20{\x0a\x20\x20float\x20x1\x20=\x200.0f\x20-\x20range.x;\x0a\x20\x20float\x20x2\x20=\x20range.y\x20-\x200.0f;\x0a\x20\x20if(x1\x20<\x200.0f\x20||\x20x2\x20<\x200.0f)\x20{\x0a\x20\x20\x20\x20return\x20vec2(abs(x1),\x20abs(x2));\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20return\x20vec2(0.0f,\x20abs(max(x1,\x20x2)));\x0a\x20\x20}\x0a}\x0a\x0afloat\x20calculateWindNorm(vec3\x20speed)\x20{\x0a\x20\x20vec3\x20percent\x20=\x20vec3(0.0f);\x0a\x20\x20vec2\x20uRange\x20=\x20getRange(uSpeedRange);\x0a\x20\x20vec2\x20vRange\x20=\x20getRange(vSpeedRange);\x0a\x20\x20vec2\x20wRange\x20=\x20getRange(wSpeedRange);\x0a\x20\x20if(length(speed.xyz)\x20==\x200.0f)\x20{\x0a\x20\x20\x20\x20return\x200.0f;\x0a\x20\x20}\x0a\x0a\x20\x20percent.x\x20=\x20(abs(speed.x)\x20-\x20uRange.x)\x20/\x20(uRange.y\x20-\x20uRange.x);\x0a\x20\x20percent.y\x20=\x20(abs(speed.y)\x20-\x20vRange.x)\x20/\x20(vRange.y\x20-\x20vRange.x);\x0a\x20\x20if(wSpeedRange.y\x20==\x20wSpeedRange.x)\x20{\x0a\x20\x20\x20\x20percent.z\x20=\x200.0f;\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20percent.z\x20=\x20(abs(speed.z)\x20-\x20wRange.x)\x20/\x20(wRange.y\x20-\x20wRange.x);\x0a\x20\x20}\x0a\x20\x20float\x20norm\x20=\x20length(percent);\x0a\x0a\x20\x20return\x20norm;\x0a}\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20vec3\x20lonLatLev\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rgb;\x0a\x20\x20vec3\x20speedOrigin\x20=\x20linearInterpolation(lonLatLev);\x0a\x20\x20vec3\x20speed\x20=\x20calculateSpeedByRungeKutta2(lonLatLev);\x0a\x20\x20vec3\x20speedInLonLat\x20=\x20convertSpeedUnitToLonLat(lonLatLev,\x20speed);\x0a\x0a\x20\x20vec4\x20particleSpeed\x20=\x20vec4(speedInLonLat,\x20calculateWindNorm(speed\x20/\x20speedScaleFactor));\x0a\x20\x20\x20\x20//\x20gl_FragColor\x20=\x20particleSpeed;\x0a\x20\x20fragColor\x20=\x20vec4(speedInLonLat,\x20calculateWindNorm(speedOrigin));\x0a}\x0a',PostProcessingPositionShader=_0x3e9235(0x40f,0x424),UpdatePositionShader=_0x3a94a7(0x46f,0x4fa);const Cesium$3=mars3d__namespace['Cesium'];class ParticlesComputing{constructor(_0x8c0907,_0x545943,_0x362faf,_0x3a613d){function _0x435f84(_0x55df8b,_0x35b501){return _0x3e9235(_0x55df8b,_0x35b501- -0x228);}this[_0x2aabd7(-0x244,-0x228)]=_0x545943,this[_0x435f84(0x11e,0x1a0)](_0x8c0907,_0x545943),this['createParticlesTextures'](_0x8c0907,_0x362faf,_0x3a613d);function _0x2aabd7(_0x495853,_0x2786d3){return _0x3e9235(_0x495853,_0x2786d3- -0x646);}this['createComputingPrimitives'](_0x545943,_0x362faf,_0x3a613d);}['createWindTextures'](_0x336b64,_0x30f09c){function _0x4f2748(_0x15cf8a,_0x4ad537){return _0x3e9235(_0x4ad537,_0x15cf8a- -0xb9);}var _0x3dafd9;function _0x32bef8(_0x2d1bd4,_0xb78241){return _0x3a94a7(_0x2d1bd4- -0x6ce,_0xb78241);}const _0x5e0bf8={'context':_0x336b64,'width':_0x30f09c['dimensions'][_0x32bef8(-0x229,-0x1a4)],'height':_0x30f09c[_0x32bef8(-0x231,-0x1fe)]['lat']*(_0x30f09c[_0x32bef8(-0x231,-0x1d4)][_0x32bef8(-0x273,-0x2b8)]||0x1),'pixelFormat':Cesium$3['PixelFormat'][_0x32bef8(-0x1f1,-0x271)],'pixelDatatype':Cesium$3[_0x4f2748(0x3a0,0x3ce)][_0x32bef8(-0x1c3,-0x18f)],'flipY':![],'sampler':new Cesium$3['Sampler']({'minificationFilter':Cesium$3['TextureMinificationFilter']['NEAREST'],'magnificationFilter':Cesium$3['TextureMagnificationFilter'][_0x32bef8(-0x272,-0x20a)]})};this['windTextures']={'U':Util['createTexture'](_0x5e0bf8,_0x30f09c['U'][_0x32bef8(-0x1f3,-0x1d4)]),'V':Util['createTexture'](_0x5e0bf8,_0x30f09c['V']['array']),'W':Util[_0x4f2748(0x2f3,0x2af)](_0x5e0bf8,((_0x3dafd9=_0x30f09c['W'])===null||_0x3dafd9===void 0x0?void 0x0:_0x3dafd9['array'])??_0x30f09c['U'][_0x4f2748(0x376,0x3d7)]),'H':Util[_0x32bef8(-0x276,-0x2a4)](_0x5e0bf8,_0x30f09c['H']['array'])};}['createParticlesTextures'](_0x2de830,_0x2328a2,_0x1e16ad){const _0x5839a0={'context':_0x2de830,'width':_0x2328a2['particlesTextureSize'],'height':_0x2328a2['particlesTextureSize'],'pixelFormat':Cesium$3[_0x26d67c(-0x1ed,-0x194)][_0x3a3dc9(-0xc9,-0xcb)],'pixelDatatype':Cesium$3[_0x3a3dc9(0x50,0xd)]['FLOAT'],'flipY':![],'sampler':new Cesium$3[(_0x26d67c(-0x201,-0x18f))]({'minificationFilter':Cesium$3['TextureMinificationFilter']['NEAREST'],'magnificationFilter':Cesium$3['TextureMagnificationFilter'][_0x3a3dc9(-0x4c,-0x9c)]})};function _0x3a3dc9(_0x36dffc,_0x3efb35){return _0x3a94a7(_0x3efb35- -0x4f8,_0x36dffc);}function _0x26d67c(_0x2e6c57,_0x5180c2){return _0x3e9235(_0x5180c2,_0x2e6c57- -0x5d6);}const _0x17a81c=this['randomizeParticles'](_0x2328a2['maxParticles'],_0x1e16ad),_0x558090=new Float32Array(0x4*_0x2328a2['maxParticles'])[_0x26d67c(-0x1bb,-0x184)](0x0);this['particlesTextures']={'previousParticlesPosition':Util['createTexture'](_0x5839a0,_0x17a81c),'currentParticlesPosition':Util[_0x3a3dc9(-0xa4,-0xa0)](_0x5839a0,_0x17a81c),'nextParticlesPosition':Util['createTexture'](_0x5839a0,_0x17a81c),'postProcessingPosition':Util['createTexture'](_0x5839a0,_0x17a81c),'particlesSpeed':Util[_0x3a3dc9(-0xa8,-0xa0)](_0x5839a0,_0x558090)};}['randomizeParticles'](_0x31d144,_0x150b9d){const _0x9c1f7d=new Float32Array(0x4*_0x31d144);function _0x54d050(_0x276cae,_0x202c53){return _0x3a94a7(_0x202c53- -0x554,_0x276cae);}function _0x487490(_0x3edbb2,_0x3b5996){return _0x3e9235(_0x3edbb2,_0x3b5996- -0x238);}for(let _0x2608b3=0x0;_0x2608b3<_0x31d144;_0x2608b3++){_0x9c1f7d[0x4*_0x2608b3]=Cesium$3['Math']['randomBetween'](_0x150b9d['lonRange']['x'],_0x150b9d['lonRange']['y']),_0x9c1f7d[0x4*_0x2608b3+0x1]=Cesium$3['Math']['randomBetween'](_0x150b9d['latRange']['x'],_0x150b9d[_0x487490(0x29e,0x234)]['y']),_0x9c1f7d[0x4*_0x2608b3+0x2]=Cesium$3['Math']['randomBetween'](this[_0x487490(0x215,0x1e6)][_0x54d050(-0xad,-0xf9)]['min'],this['data'][_0x54d050(-0xf7,-0xf9)]['max']),_0x9c1f7d[0x4*_0x2608b3+0x3]=0x0;}return _0x9c1f7d;}[_0x3e9235(0x41d,0x446)](_0x1c90e9){const _0x214032=[_0x1c90e9['dimensions']['lon'],_0x1c90e9['dimensions'][_0xbc6d30(0x47e,0x4f3)],_0x1c90e9['dimensions'][_0x5c144d(0x4ef,0x529)]],_0x8a00aa=[_0x1c90e9['lon'][_0xbc6d30(0x40f,0x429)],_0x1c90e9['lat'][_0xbc6d30(0x40f,0x439)],_0x1c90e9[_0xbc6d30(0x3df,0x418)]['min']],_0x491b44=[_0x1c90e9['lon']['max'],_0x1c90e9['lat']['max'],_0x1c90e9['lev'][_0xbc6d30(0x4af,0x4ba)]],_0x270fed=[(_0x491b44[0x0]-_0x8a00aa[0x0])/(_0x214032[0x0]-0x1),(_0x491b44[0x1]-_0x8a00aa[0x1])/(_0x214032[0x1]-0x1),_0x214032[0x2]>0x1?(_0x491b44[0x2]-_0x8a00aa[0x2])/(_0x214032[0x2]-0x1):0x1],_0x333077=Math[_0xbc6d30(0x428,0x3b6)](Math['random']()*_0x1c90e9['U'][_0xbc6d30(0x45f,0x4ae)]['length']),_0x2e55fa=_0x333077%(_0x214032[0x0]*_0x214032[0x1]);function _0xbc6d30(_0x49739d,_0xe2e784){return _0x3e9235(_0xe2e784,_0x49739d-0x30);}const _0x4a0cf6=Math['floor'](_0x2e55fa/_0x214032[0x0]),_0x16c451=_0x2e55fa%_0x214032[0x0],_0x221e4a=Cesium$3['Math']['randomBetween'](_0x8a00aa[0x0]+_0x16c451*_0x270fed[0x0],_0x8a00aa[0x0]+(_0x16c451+0x1)*_0x270fed[0x0]);function _0x5c144d(_0x226c4e,_0x505121){return _0x3e9235(_0x505121,_0x226c4e-0x140);}const _0x57820a=Cesium$3[_0xbc6d30(0x490,0x42c)][_0x5c144d(0x5bc,0x549)](_0x8a00aa[0x1]+(_0x4a0cf6-0x1)*_0x270fed[0x1],_0x8a00aa[0x1]+_0x4a0cf6*_0x270fed[0x1]),_0x5729a0=_0x1c90e9['H']['array'][_0x333077]||0x0;return[_0x221e4a,_0x57820a,_0x5729a0];}[_0x3a94a7(0x438,0x437)](){Object['keys'](this['particlesTextures'])['forEach'](_0x294759=>{this['particlesTextures'][_0x294759]['destroy']();});}[_0x3a94a7(0x45e,0x3f7)](_0x294003,_0xe255f,_0x64d5fc){const _0x468051=new Cesium$3[(_0x38a911(0x3fa,0x444))](_0x294003[_0x47b7d0(-0x2ee,-0x26d)]['lon'],_0x294003['dimensions']['lat'],_0x294003['dimensions']['lev']),_0x1b25a5=new Cesium$3['Cartesian3'](_0x294003['lon']['min'],_0x294003['lat']['min'],_0x294003['lev'][_0x38a911(0x3de,0x425)]),_0x28b12a=new Cesium$3['Cartesian3'](_0x294003[_0x38a911(0x3f8,0x42a)]['max'],_0x294003['lat']['max'],_0x294003['lev']['max']),_0x5161c2=new Cesium$3['Cartesian3']((_0x28b12a['x']-_0x1b25a5['x'])/(_0x468051['x']-0x1),(_0x28b12a['y']-_0x1b25a5['y'])/(_0x468051['y']-0x1),_0x468051['z']>0x1?(_0x28b12a['z']-_0x1b25a5['z'])/(_0x468051['z']-0x1):0x1),_0x3c8693=new Cesium$3['Cartesian2'](_0x294003[_0x38a911(0x3f8,0x460)]['min'],_0x294003[_0x47b7d0(-0x1f8,-0x265)][_0x47b7d0(-0x1a8,-0x1df)]),_0x3d5ea3=new Cesium$3[(_0x47b7d0(-0x234,-0x22e))](_0x294003['lat'][_0x47b7d0(-0x293,-0x27f)],_0x294003['lat']['max']);function _0x38a911(_0x4a3236,_0x2a4c73){return _0x3e9235(_0x2a4c73,_0x4a3236- -0x1);}const _0x338564=new Cesium$3['Cartesian2'](_0x294003['U']['min'],_0x294003['U']['max']),_0x8ffeef=new Cesium$3['Cartesian2'](_0x294003['V']['min'],_0x294003['V']['max']),_0x5bd85d=new Cesium$3['Cartesian2'](_0x294003['W']['min'],_0x294003['W'][_0x38a911(0x47e,0x4c8)]),_0x394c12=this;function _0x47b7d0(_0x33bf3f,_0x192c98){return _0x3e9235(_0x33bf3f,_0x192c98- -0x65e);}const _0x4ff0db={};_0x4ff0db['U']=function(){function _0x114c13(_0x2a4a82,_0x2cf764){return _0x47b7d0(_0x2a4a82,_0x2cf764-0x4a2);}return _0x394c12[_0x114c13(0x1a9,0x1e1)]['U'];},_0x4ff0db['V']=function(){return _0x394c12['windTextures']['V'];},_0x4ff0db['W']=function(){function _0x22fb70(_0x45500f,_0x400b70){return _0x47b7d0(_0x400b70,_0x45500f-0x234);}return _0x394c12[_0x22fb70(-0x8d,-0xe7)]['W'];},_0x4ff0db[_0x47b7d0(-0x26a,-0x20b)]=function(){function _0x2c2664(_0x159fe2,_0x12bf44){return _0x38a911(_0x12bf44-0x3f,_0x159fe2);}return _0x394c12['particlesTextures'][_0x2c2664(0x417,0x491)];},_0x4ff0db['dimension']=function(){return _0x468051;},_0x4ff0db['minimum']=function(){return _0x1b25a5;},_0x4ff0db['maximum']=function(){return _0x28b12a;},_0x4ff0db['interval']=function(){return _0x5161c2;},_0x4ff0db['uSpeedRange']=function(){return _0x338564;},_0x4ff0db[_0x38a911(0x3bf,0x362)]=function(){return _0x8ffeef;},_0x4ff0db[_0x38a911(0x3a9,0x3be)]=function(){return _0x5bd85d;},_0x4ff0db['speedScaleFactor']=function(){function _0x20f4dc(_0x199d52,_0x23aa21){return _0x47b7d0(_0x23aa21,_0x199d52-0x3e5);}return _0x64d5fc['pixelSize']*_0xe255f[_0x20f4dc(0x144,0xc2)];};const _0x305c26={};_0x305c26[_0x38a911(0x3dc,0x42b)]=[CalculateSpeedShader];const _0x51cdb3={};_0x51cdb3['sources']=[UpdatePositionShader];const _0x3a67e7={};_0x3a67e7['sources']=[PostProcessingPositionShader],this['primitives']={'calculateSpeed':new CustomPrimitive({'commandType':_0x38a911(0x439,0x430),'uniformMap':_0x4ff0db,'fragmentShaderSource':new Cesium$3['ShaderSource'](_0x305c26),'outputTexture':this['particlesTextures']['particlesSpeed'],'preExecute':function(){function _0x4fe306(_0x5c2bef,_0x5dc4d5){return _0x38a911(_0x5c2bef- -0x29c,_0x5dc4d5);}if(_0xe255f!==undefined&&_0xe255f['dynamic']){const _0x426c4c=_0x394c12['particlesTextures']['previousParticlesPosition'];_0x394c12[_0x4fe306(0x164,0x11f)]['previousParticlesPosition']=_0x394c12['particlesTextures'][_0xfb7d01(0x475,0x3fe)],_0x394c12['particlesTextures']['currentParticlesPosition']=_0x394c12[_0xfb7d01(0x423,0x3d1)][_0xfb7d01(0x4aa,0x428)],_0x394c12['particlesTextures']['postProcessingPosition']=_0x426c4c;}function _0xfb7d01(_0x507d2c,_0x32e0d4){return _0x47b7d0(_0x32e0d4,_0x507d2c-0x680);}_0x394c12['primitives'][_0xfb7d01(0x4a8,0x441)]['commandToExecute']['outputTexture']=_0x394c12['particlesTextures'][_0xfb7d01(0x480,0x46e)];}}),'updatePosition':new CustomPrimitive({'commandType':'Compute','uniformMap':{'currentParticlesPosition':function(){return _0x394c12['particlesTextures']['currentParticlesPosition'];},'particlesSpeed':function(){function _0x2d047e(_0x56a9b5,_0x53a1e5){return _0x47b7d0(_0x56a9b5,_0x53a1e5-0x4fd);}return _0x394c12[_0x2d047e(0x2a5,0x2a0)]['particlesSpeed'];}},'fragmentShaderSource':new Cesium$3['ShaderSource'](_0x51cdb3),'outputTexture':this['particlesTextures']['nextParticlesPosition'],'preExecute':function(){function _0x2bb596(_0x21a8f0,_0x79ffc2){return _0x38a911(_0x79ffc2- -0x58,_0x21a8f0);}function _0x3c0a04(_0x3e4998,_0x405ccf){return _0x47b7d0(_0x405ccf,_0x3e4998-0x6a);}_0x394c12[_0x2bb596(0x356,0x395)]['updatePosition'][_0x2bb596(0x40b,0x3e7)]['outputTexture']=_0x394c12['particlesTextures']['nextParticlesPosition'];}}),'postProcessingPosition':new CustomPrimitive({'commandType':_0x38a911(0x439,0x3fd),'uniformMap':{'nextParticlesPosition':function(){function _0x4eda26(_0x30cf79,_0x14fc16){return _0x47b7d0(_0x14fc16,_0x30cf79-0x279);}return _0x394c12['particlesTextures'][_0x4eda26(0x71,0x80)];},'particlesSpeed':function(){function _0x2b417b(_0x267c09,_0x5db9a7){return _0x47b7d0(_0x5db9a7,_0x267c09-0x6df);}function _0x261b1e(_0xa2ce1b,_0x558aa6){return _0x47b7d0(_0xa2ce1b,_0x558aa6-0x141);}return _0x394c12[_0x2b417b(0x482,0x4d5)][_0x2b417b(0x4df,0x50e)];},'viewerLonRange':function(){return _0x64d5fc['lonRange'];},'viewerLatRange':function(){function _0x24b739(_0x3634fe,_0x48c579){return _0x47b7d0(_0x48c579,_0x3634fe-0x339);}return _0x64d5fc[_0x24b739(0x147,0xc6)];},'lonRange':function(){return _0x3c8693;},'latRange':function(){return _0x3d5ea3;},'dimension':function(){return _0x468051;},'minimum':function(){return _0x1b25a5;},'maximum':function(){return _0x28b12a;},'interval':function(){return _0x5161c2;},'H':function(){return _0x394c12['windTextures']['H'];},'randomCoefficient':function(){const _0xc87219=Math['random']();return _0xc87219;},'dropRate':function(){function _0x4bf647(_0x166cf4,_0x3b43ab){return _0x38a911(_0x166cf4- -0x196,_0x3b43ab);}return _0xe255f[_0x4bf647(0x24c,0x26b)];},'dropRateBump':function(){return _0xe255f['dropRateBump'];}},'fragmentShaderSource':new Cesium$3['ShaderSource'](_0x3a67e7),'outputTexture':this['particlesTextures']['postProcessingPosition'],'preExecute':function(){function _0x31b41d(_0x28ca57,_0x36f55f){return _0x38a911(_0x36f55f- -0x1b7,_0x28ca57);}function _0x587e09(_0x286e14,_0x586a6a){return _0x47b7d0(_0x286e14,_0x586a6a-0x5c8);}_0x394c12[_0x587e09(0x3e2,0x358)]['postProcessingPosition']['commandToExecute'][_0x31b41d(0x32a,0x2ad)]=_0x394c12[_0x31b41d(0x201,0x249)]['postProcessingPosition'];}})};}}const Cesium$2=mars3d__namespace['Cesium'];class ParticleSystem{constructor(_0x54b741,_0x2bdb4f,_0x3edaa6,_0x315e9c){this['context']=_0x54b741,_0x2bdb4f={..._0x2bdb4f};_0x2bdb4f['udata']&&_0x2bdb4f['vdata']&&(_0x2bdb4f['dimensions']={},_0x2bdb4f[_0x5d5476(0x41b,0x46e)]['lon']=_0x2bdb4f[_0x5d5476(0x42c,0x495)],_0x2bdb4f['dimensions']['lat']=_0x2bdb4f['rows'],_0x2bdb4f['dimensions'][_0x5d5476(0x3ba,0x42c)]=_0x2bdb4f[_0x5d5476(0x3e4,0x42c)]||0x1,_0x2bdb4f['lon']={},_0x2bdb4f[_0x207c21(0x3,0x29)]['min']=_0x2bdb4f['xmin'],_0x2bdb4f[_0x5d5476(0x4d1,0x476)][_0x5d5476(0x474,0x4fc)]=_0x2bdb4f[_0x5d5476(0x378,0x3fd)],_0x2bdb4f[_0x207c21(0xa,0x7e)]={},_0x2bdb4f['lat']['min']=_0x2bdb4f['ymin'],_0x2bdb4f[_0x207c21(0x13,0x7e)][_0x207c21(0xea,0xaf)]=_0x2bdb4f['ymax'],_0x2bdb4f['lev']={},_0x2bdb4f[_0x5d5476(0x4a5,0x42c)]['min']=_0x2bdb4f[_0x5d5476(0x4b4,0x4be)]??0x1,_0x2bdb4f[_0x207c21(-0x9e,-0x21)][_0x207c21(0x29,0xaf)]=_0x2bdb4f['levmax']??0x1,_0x2bdb4f['U']={},_0x2bdb4f['U']['array']=new Float32Array(_0x2bdb4f[_0x207c21(-0xa5,-0x52)]),_0x2bdb4f['U']['min']=_0x2bdb4f['umin']??Math['min'](..._0x2bdb4f['udata']),_0x2bdb4f['U']['max']=_0x2bdb4f[_0x5d5476(0x4d6,0x4d1)]??Math['max'](..._0x2bdb4f['udata']),_0x2bdb4f['V']={},_0x2bdb4f['V'][_0x5d5476(0x448,0x4ac)]=new Float32Array(_0x2bdb4f['vdata']),_0x2bdb4f['V'][_0x5d5476(0x3d7,0x45c)]=_0x2bdb4f['vmin']??Math['min'](..._0x2bdb4f['vdata']),_0x2bdb4f['V'][_0x5d5476(0x545,0x4fc)]=_0x2bdb4f[_0x207c21(-0x7,0x52)]??Math[_0x207c21(0xc0,0xaf)](..._0x2bdb4f['vdata']));!_0x2bdb4f['W']&&(_0x2bdb4f['W']={'array':new Float32Array(_0x2bdb4f['U']['array'][_0x5d5476(0x439,0x442)]),'min':0x0,'max':0x0});if(!_0x2bdb4f['H']){var _0x2aed60;_0x2bdb4f['H']={'array':new Float32Array(_0x2bdb4f['U']['array']['length']),'min':0x0,'max':0x0};if((_0x2aed60=_0x2bdb4f[_0x207c21(0x2f,-0x21)])!==null&&_0x2aed60!==void 0x0&&_0x2aed60['array']){const {lon:_0xa80336,lat:_0x3620c2,lev:_0x340b12}=_0x2bdb4f['dimensions'];for(let _0x5e4562=0x0;_0x5e4562<_0x340b12;_0x5e4562++){for(let _0x2318ec=0x0;_0x2318ec<_0x3620c2;_0x2318ec++){for(let _0x226e29=0x0;_0x226e29<_0xa80336;_0x226e29++){const _0x5bc77a=_0x5e4562*(_0xa80336*_0x3620c2)+_0x2318ec*_0xa80336+_0x226e29;_0x2bdb4f['H'][_0x207c21(-0xc,0x5f)][_0x5bc77a]=_0x2bdb4f['lev']['array'][_0x5e4562];}}}_0x2bdb4f['H']['min']=Math['min'](..._0x2bdb4f[_0x207c21(-0x7b,-0x21)]['array']),_0x2bdb4f['H']['max']=Math[_0x5d5476(0x581,0x4fc)](..._0x2bdb4f['lev']['array']);}}function _0x207c21(_0x367022,_0x2e22eb){return _0x3e9235(_0x367022,_0x2e22eb- -0x3d0);}function _0x5d5476(_0x455590,_0x30f111){return _0x3a94a7(_0x30f111- -0x2f,_0x455590);}this[_0x5d5476(0x522,0x49b)]=_0x2bdb4f,this[_0x5d5476(0x432,0x424)]=_0x3edaa6,this['viewerParameters']=_0x315e9c,this['particlesComputing']=new ParticlesComputing(this[_0x5d5476(0x489,0x50a)],this['data'],this['options'],this['viewerParameters']),this['particlesRendering']=new ParticlesRendering(this['context'],this['data'],this[_0x207c21(-0x2,-0x29)],this['viewerParameters'],this[_0x5d5476(0x3b2,0x431)]);}[_0x3a94a7(0x44c,0x441)](_0x566cfe){this[_0x2999b6(0x10d,0x136)]['destroyParticlesTextures'](),Object[_0x2999b6(0xf4,0x162)](this['particlesComputing'][_0x160d08(0x27d,0x26b)])[_0x160d08(0x2cc,0x2a4)](_0x188131=>{function _0x186363(_0x5dfd46,_0xb817c0){return _0x160d08(_0x5dfd46,_0xb817c0-0x278);}this[_0x186363(0x552,0x4fa)]['windTextures'][_0x188131]['destroy']();});function _0x2999b6(_0xc3855,_0x142959){return _0x3a94a7(_0x142959- -0x32a,_0xc3855);}this['particlesRendering']['textures']['colorTable']['destroy'](),Object[_0x2999b6(0x125,0x162)](this[_0x2999b6(0x197,0x1fa)]['framebuffers'])['forEach'](_0x15c6fd=>{function _0x1a9bff(_0x4d7ffc,_0x257b56){return _0x160d08(_0x257b56,_0x4d7ffc-0x3b);}this[_0x1a9bff(0x381,0x361)]['framebuffers'][_0x15c6fd]['destroy']();}),this['context']=_0x566cfe,this['particlesComputing']=new ParticlesComputing(this['context'],this['data'],this[_0x160d08(0x23c,0x275)],this[_0x2999b6(0x1f5,0x1fd)]);function _0x160d08(_0x30d2cd,_0x41b8af){return _0x3e9235(_0x30d2cd,_0x41b8af- -0x132);}this[_0x160d08(0x321,0x346)]=new ParticlesRendering(this['context'],this['data'],this[_0x160d08(0x29d,0x275)],this['viewerParameters'],this[_0x160d08(0x1fc,0x282)]);}[_0x3a94a7(0x53d,0x4d8)](){function _0x250e89(_0x538334,_0x3ff8c0){return _0x3e9235(_0x3ff8c0,_0x538334-0x114);}function _0x129cc9(_0x4bd08a,_0x5c8e78){return _0x3e9235(_0x5c8e78,_0x4bd08a- -0xdd);}const _0x265345=new Cesium$2[(_0x129cc9(0x331,0x32f))]({'color':new Cesium$2['Color'](0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':undefined,'pass':Cesium$2[_0x250e89(0x5a4,0x5c7)]['OPAQUE']});Object['keys'](this[_0x250e89(0x58c,0x5f3)][_0x250e89(0x4e6,0x4a5)])[_0x129cc9(0x2f9,0x374)](_0x28f9bd=>{function _0x5bb6c1(_0x335f41,_0x4f6a2e){return _0x129cc9(_0x4f6a2e-0xd5,_0x335f41);}_0x265345['framebuffer']=this[_0x5bb6c1(0x47d,0x470)]['framebuffers'][_0x28f9bd];function _0x168b77(_0x4a1a21,_0x7b6723){return _0x129cc9(_0x7b6723- -0x17,_0x4a1a21);}_0x265345[_0x168b77(0x2eb,0x2e8)](this['context']);});}[_0x3a94a7(0x4eb,0x501)](_0xa88174,_0x123998=!![]){function _0x50e205(_0x80d2a1,_0x23f263){return _0x3e9235(_0x80d2a1,_0x23f263- -0x5e7);}_0x123998&&(this[_0x3f53f1(0x16f,0x1df)](),this[_0x3f53f1(0x92,0xc0)]['destroyParticlesTextures'](),this['particlesComputing']['createParticlesTextures'](this['context'],this['options'],this['viewerParameters']));function _0x3f53f1(_0x3e2178,_0x1e0143){return _0x3a94a7(_0x3e2178- -0x3ce,_0x1e0143);}if(_0xa88174){var _0x5b2382;const _0x4ff3d4=this[_0x3f53f1(0x156,0xd3)]['createSegmentsGeometry'](this['options']);this['particlesRendering']['primitives']['segments']['geometry']=_0x4ff3d4;const _0x9a9703=Cesium$2['VertexArray']['fromGeometry']({'context':this['context'],'geometry':_0x4ff3d4,'attributeLocations':this[_0x50e205(-0x1e2,-0x16f)]['primitives'][_0x3f53f1(0xaa,0xda)][_0x3f53f1(0x10a,0xb5)],'bufferUsage':Cesium$2['BufferUsage'][_0x50e205(-0x19d,-0x1e9)]});(_0x5b2382=this[_0x3f53f1(0x156,0xd8)]['primitives'])!==null&&_0x5b2382!==void 0x0&&(_0x5b2382=_0x5b2382[_0x50e205(-0x1dd,-0x21b)])!==null&&_0x5b2382!==void 0x0&&_0x5b2382['commandToExecute']&&(this['particlesRendering']['primitives'][_0x3f53f1(0xaa,0xbf)]['commandToExecute']['vertexArray']=_0x9a9703);}}[_0x3a94a7(0x464,0x404)](_0x4efb54){let _0x2efe69=![];function _0x4034e9(_0x74bcc3,_0x7307e2){return _0x3a94a7(_0x74bcc3- -0x214,_0x7307e2);}this[_0x531dec(0x217,0x1b1)]['maxParticles']!==_0x4efb54['maxParticles']&&(_0x2efe69=!![]);function _0x531dec(_0x181eaa,_0x4d3074){return _0x3a94a7(_0x181eaa- -0x23c,_0x4d3074);}Object[_0x4034e9(0x278,0x224)](_0x4efb54)['forEach'](_0xcbe69e=>{function _0x336bb3(_0x1b65e0,_0x4f0ef5){return _0x4034e9(_0x1b65e0- -0x312,_0x4f0ef5);}this[_0x336bb3(-0xd3,-0x117)][_0xcbe69e]=_0x4efb54[_0xcbe69e];}),this[_0x4034e9(0x2d7,0x318)](_0x2efe69,_0x4efb54[_0x531dec(0x2b7,0x2ab)]);}[_0x3a94a7(0x46a,0x4d6)](_0x15555){function _0x26d0dc(_0x17bbcc,_0x3d7536){return _0x3a94a7(_0x17bbcc- -0x175,_0x3d7536);}Object[_0x26d0dc(0x317,0x2b9)](_0x15555)[_0x2507a1(-0x83,-0x7f)](_0x3708d1=>{this['viewerParameters'][_0x3708d1]=_0x15555[_0x3708d1];}),this['refreshParticles'](![]);function _0x2507a1(_0x1ad7ca,_0x5f3b84){return _0x3e9235(_0x5f3b84,_0x1ad7ca- -0x459);}!this[_0x2507a1(-0xb2,-0x9f)][_0x26d0dc(0x37e,0x344)]&&(this['options']['dynamic']=!![],this['setOptions'](this[_0x2507a1(-0xb2,-0x66)]),setTimeout(()=>{function _0x488422(_0x286346,_0x4f71a1){return _0x2507a1(_0x4f71a1- -0xb,_0x286346);}this['options'][_0x488422(-0x51,-0x1d)]=![];function _0xc7c542(_0x562335,_0x1606fb){return _0x2507a1(_0x1606fb-0x7d,_0x562335);}this[_0xc7c542(-0xe,-0x24)](this[_0x488422(-0xb1,-0xbd)]);},0x1f4));}['destroy'](){function _0x5ab77f(_0x4eca96,_0x4db9fe){return _0x3a94a7(_0x4eca96- -0x37d,_0x4db9fe);}clearTimeout(this['canrefresh']),this['particlesComputing']['destroyParticlesTextures'](),Object['keys'](this['particlesComputing']['windTextures'])['forEach'](_0x41e531=>{function _0x679f63(_0x100759,_0x562f67){return _0x44b3(_0x562f67-0x27f,_0x100759);}this[_0x679f63(0x411,0x397)]['windTextures'][_0x41e531]['destroy']();}),this['particlesRendering'][_0x56ab7c(0x1b6,0x148)]['colorTable']['destroy']();function _0x56ab7c(_0x3c9eff,_0x4b2ba0){return _0x3a94a7(_0x4b2ba0- -0x360,_0x3c9eff);}Object[_0x56ab7c(0x19f,0x12c)](this[_0x5ab77f(0x1a7,0x231)][_0x56ab7c(0x12b,0x11e)])['forEach'](_0x27afc2=>{function _0x4c672c(_0x485d51,_0x320e14){return _0x56ab7c(_0x320e14,_0x485d51- -0x94);}this['particlesRendering']['framebuffers'][_0x27afc2][_0x4c672c(0x5b,0x9f)]();});for(const _0x324bd2 in this){delete this[_0x324bd2];}}}const Cesium$1=mars3d__namespace[_0x3a94a7(0x4c2,0x51a)],BaseLayer$1=mars3d__namespace['layer'][_0x3e9235(0x436,0x40d)],_0x2dd6ae={};function _0x44b3(_0x2d7e40,_0xb44730){const _0x702969=_0x7029();return _0x44b3=function(_0x44b3a3,_0x31f16c){_0x44b3a3=_0x44b3a3-0xe2;let _0x4a2e67=_0x702969[_0x44b3a3];return _0x4a2e67;},_0x44b3(_0x2d7e40,_0xb44730);}_0x2dd6ae['particlesNumber']=0x1000,_0x2dd6ae[_0x3a94a7(0x523,0x507)]=0x0,_0x2dd6ae['fadeOpacity']=0.996,_0x2dd6ae[_0x3a94a7(0x48f,0x4eb)]=0.003,_0x2dd6ae['dropRateBump']=0.01,_0x2dd6ae['speedFactor']=0.5;function _0x3e9235(_0x5ba5ee,_0x16296a){return _0x44b3(_0x16296a-0x29c,_0x5ba5ee);}_0x2dd6ae[_0x3e9235(0x385,0x382)]=0x2,_0x2dd6ae[_0x3e9235(0x479,0x41a)]=['rgb(206,255,255)'],_0x2dd6ae[_0x3a94a7(0x4f3,0x4ec)]=!![];const DEF_OPTIONS=_0x2dd6ae;class WindLayer extends BaseLayer$1{constructor(_0x53e23d={}){_0x53e23d={...DEF_OPTIONS,..._0x53e23d},super(_0x53e23d),this['_setOptionsHook'](_0x53e23d);}get['layer'](){return this['primitives'];}get['data'](){function _0xc98dc5(_0x429cfa,_0x3c9ba7){return _0x3a94a7(_0x3c9ba7- -0x581,_0x429cfa);}return this[_0xc98dc5(-0x3e,-0x7a)];}set['data'](_0x4f6d0e){this['setData'](_0x4f6d0e);}get['colors'](){function _0x580a14(_0x1f1b60,_0x5a7e0e){return _0x3a94a7(_0x1f1b60- -0x2a,_0x5a7e0e);}return this['options'][_0x580a14(0x49c,0x441)];}set['colors'](_0x1c65a3){this['options']['colors']=_0x1c65a3;function _0x24eca5(_0x1d6581,_0x37bcc9){return _0x3e9235(_0x37bcc9,_0x1d6581- -0x473);}if(this[_0x97ea3e(0x5e,0x86)]){const _0x514acf={};_0x514acf[_0x24eca5(-0x59,0x30)]=_0x1c65a3,this[_0x97ea3e(0x5e,-0xf)][_0x97ea3e(-0x54,-0xbd)](_0x514acf);}function _0x97ea3e(_0x1fa8fb,_0x55f656){return _0x3a94a7(_0x1fa8fb- -0x4b8,_0x55f656);}this['resize']();}['_mountedHook'](){}['_addedHook'](){this[_0x454826(0x3df,0x463)]=this['_map']['scene'],this[_0x454826(0x4d1,0x4d6)]=this[_0x3b19ad(-0x32,-0x1a)][_0x454826(0x4ce,0x4d6)],this['primitives']=new Cesium$1['PrimitiveCollection'](),this['_map']['scene']['primitives']['add'](this['primitives']),this['viewerParameters']={'lonRange':new Cesium$1['Cartesian2'](),'latRange':new Cesium$1['Cartesian2'](),'pixelSize':0x0,'lonDisplayRange':new Cesium$1[(_0x454826(0x441,0x47f))](),'latDisplayRange':new Cesium$1['Cartesian2']()},this['globeBoundingSphere']=new Cesium$1['BoundingSphere'](Cesium$1[_0x3b19ad(0x1d,-0x1e)]['ZERO'],Cesium$1['Ellipsoid']['WGS84'][_0x454826(0x469,0x42d)]),this['updateViewerParameters'](),window[_0x454826(0x4df,0x4a6)]('resize',this['resize']['bind'](this),![]);function _0x454826(_0x2dd040,_0x3238a0){return _0x3a94a7(_0x3238a0- -0x5d,_0x2dd040);}this['mouse_down']=![],this['mouse_move']=![],this['_map']['on'](mars3d__namespace['EventType']['wheel'],this[_0x3b19ad(0xae,0x32)],this),this[_0x3b19ad(-0x8e,-0x1a)]['on'](mars3d__namespace['EventType'][_0x454826(0x460,0x4c2)],this[_0x454826(0x389,0x3d7)],this),this[_0x3b19ad(-0x52,-0x1a)]['on'](mars3d__namespace['EventType'][_0x454826(0x495,0x4c8)],this['_onMouseUpEvent'],this);function _0x3b19ad(_0x40d4f2,_0xf89540){return _0x3e9235(_0x40d4f2,_0xf89540- -0x419);}this[_0x3b19ad(0x2d,-0x1a)]['on'](mars3d__namespace['EventType']['mouseMove'],this[_0x454826(0x451,0x3e6)],this),this['_data']&&this['setData'](this[_0x454826(0x4ba,0x4aa)]);}['_removedHook'](){window[_0x286c1d(-0x239,-0x287)]('resize',this[_0x286c1d(-0x1ca,-0x177)]);function _0x5a3d57(_0x235f8f,_0x561932){return _0x3e9235(_0x561932,_0x235f8f- -0x62a);}this['_map']['off'](mars3d__namespace[_0x5a3d57(-0x233,-0x273)]['preRender'],this['_onMap_preRenderEvent'],this);function _0x286c1d(_0x177373,_0x2a3832){return _0x3a94a7(_0x177373- -0x689,_0x2a3832);}this['_map'][_0x5a3d57(-0x24f,-0x1ce)](mars3d__namespace['EventType'][_0x5a3d57(-0x1fd,-0x1f8)],this['_onMapWhellEvent'],this),this['_map']['off'](mars3d__namespace[_0x5a3d57(-0x233,-0x24c)]['mouseDown'],this['_onMouseDownEvent'],this),this['_map']['off'](mars3d__namespace['EventType']['mouseUp'],this[_0x286c1d(-0x213,-0x25c)],this),this[_0x286c1d(-0x1de,-0x248)]['off'](mars3d__namespace[_0x286c1d(-0x1e6,-0x1ad)]['mouseMove'],this['_onMouseMoveEvent'],this),this['primitives'][_0x5a3d57(-0x238,-0x1e3)](),this['_map']['scene'][_0x5a3d57(-0x23c,-0x26b)]['remove'](this['primitives']);}['resize'](){if(!this[_0x375a5a(-0x6a,-0x1f)]||!this['particleSystem'])return;function _0x112609(_0x3b9f04,_0x478771){return _0x3a94a7(_0x3b9f04- -0x29b,_0x478771);}this['primitives'][_0x112609(0x226,0x19b)]=![],this['primitives'][_0x112609(0x203,0x17c)]();function _0x375a5a(_0x4314dc,_0x28471e){return _0x3e9235(_0x28471e,_0x4314dc- -0x47f);}this[_0x375a5a(-0x80,-0x2c)]['once'](mars3d__namespace['EventType'][_0x375a5a(-0xee,-0xa0)],this[_0x375a5a(-0x93,-0xff)],this);}[_0x3a94a7(0x498,0x474)](_0x187b28){function _0x10ed01(_0x2847e1,_0x343ea7){return _0x3e9235(_0x2847e1,_0x343ea7- -0x476);}this['particleSystem']['canvasResize'](this[_0x10ed01(-0xdc,-0x62)]['context']),this['addPrimitives'](),this['primitives']['show']=!![];}[_0x3a94a7(0x4f7,0x47b)](_0x16836f){function _0x48461f(_0x3b3e32,_0x4345e0){return _0x3e9235(_0x3b3e32,_0x4345e0-0xe0);}clearTimeout(this['refreshTimer']);if(!this['show']||!this[_0x48461f(0x4ea,0x54a)])return;function _0x1a9b4a(_0x226686,_0x2429a3){return _0x3e9235(_0x226686,_0x2429a3- -0x5db);}this[_0x48461f(0x4ef,0x4ce)][_0x1a9b4a(-0x153,-0x1c6)]=![],this[_0x1a9b4a(-0x1db,-0x15a)]=setTimeout(()=>{function _0x17108c(_0x4f6e89,_0x19d539){return _0x48461f(_0x19d539,_0x4f6e89- -0x4a4);}if(!this['show'])return;this[_0x17108c(0x44,0x71)]();},0xc8);}['_onMouseDownEvent'](_0x832cb0){this['mouse_down']=!![];}['_onMouseMoveEvent'](_0x48b5f8){function _0xf234e1(_0x4ffbab,_0x181658){return _0x3e9235(_0x4ffbab,_0x181658- -0x51c);}function _0x213153(_0x26e158,_0x358811){return _0x3e9235(_0x26e158,_0x358811- -0x28a);}if(!this['show']||!this['particleSystem'])return;this[_0xf234e1(-0xce,-0xc4)]&&(this[_0x213153(0x157,0x164)]['show']=![],this[_0xf234e1(-0x143,-0x156)]=!![]);}['_onMouseUpEvent'](_0x1e0575){function _0x5e16a7(_0x2edbcb,_0x394595){return _0x3a94a7(_0x394595- -0x5a2,_0x2edbcb);}function _0x5d017b(_0x27e58d,_0x4aeea2){return _0x3e9235(_0x4aeea2,_0x27e58d- -0x5cb);}if(!this['show']||!this['particleSystem'])return;this[_0x5e16a7(-0xab,-0x9e)]&&this[_0x5e16a7(-0x183,-0x130)]&&this[_0x5d017b(-0x1c3,-0x167)](),this[_0x5d017b(-0x1dd,-0x22e)][_0x5e16a7(-0xec,-0xe1)]=!![],this['mouse_down']=![],this['mouse_move']=![];}[_0x3a94a7(0x4b4,0x4c9)](){if(!this['_map']||!this['show'])return;function _0x44904d(_0x307522,_0x2b0680){return _0x3a94a7(_0x2b0680- -0x13a,_0x307522);}this['updateViewerParameters'](),this['particleSystem']['applyViewerParameters'](this[_0x44904d(0x3e2,0x3ed)]),this['primitives']['show']=!![];}['setData'](_0x4a90a1){function _0x551b6a(_0x42f621,_0x2a0eb6){return _0x3a94a7(_0x2a0eb6- -0x30d,_0x42f621);}this[_0x551b6a(0x243,0x1fa)]=_0x4a90a1;this[_0x551b6a(0x181,0x209)]&&this[_0x551b6a(0x26f,0x209)]['destroy']();this['particleSystem']=new ParticleSystem(this[_0x551b6a(0x16f,0x1b3)]['context'],_0x4a90a1,this[_0x551b6a(0x143,0x187)](),this['viewerParameters']);function _0x2c4ba6(_0x2a5f29,_0x4357ba){return _0x3a94a7(_0x4357ba- -0x429,_0x2a5f29);}this['addPrimitives']();}['_setOptionsHook'](_0x430a78,_0x5aa3d1){if(_0x430a78)for(const _0x5d706 in _0x430a78){this[_0x5d706]=_0x430a78[_0x5d706];}function _0x3fa8fe(_0x41e822,_0x1fb611){return _0x3e9235(_0x41e822,_0x1fb611- -0x25b);}this['particleSystem']&&this['particleSystem']['setOptions'](this[_0x3fa8fe(0x158,0x18d)]());}['getOptions'](){const _0x30ab48=Math[_0x51c7c7(0x16c,0x16f)](Math['sqrt'](this['particlesNumber']));this[_0x51c7c7(0x1c9,0x23d)]=_0x30ab48*_0x30ab48;const _0x366d1c={};_0x366d1c[_0x51c7c7(0x153,0x1cb)]=_0x30ab48,_0x366d1c['maxParticles']=this['particlesNumber'],_0x366d1c['colors']=this['colors'],_0x366d1c['particleHeight']=this[_0x158603(0x5ef,0x5ad)],_0x366d1c['fadeOpacity']=this[_0x51c7c7(0x147,0x10a)],_0x366d1c['dropRate']=this[_0x158603(0x4c8,0x519)],_0x366d1c['dropRateBump']=this['dropRateBump'];function _0x51c7c7(_0x7a11ba,_0x11b76a){return _0x3a94a7(_0x7a11ba- -0x2ee,_0x11b76a);}_0x366d1c[_0x158603(0x4f5,0x4f3)]=this['speedFactor'],_0x366d1c['lineWidth']=this['lineWidth'];function _0x158603(_0x18738e,_0x16be5f){return _0x3a94a7(_0x16be5f-0x8a,_0x18738e);}return _0x366d1c[_0x51c7c7(0x205,0x1b4)]=this[_0x158603(0x51e,0x57d)],_0x366d1c;}['addPrimitives'](){this[_0x2af24d(0x53a,0x56a)]['add'](this['particleSystem'][_0x26900a(0x71,-0x15)]['primitives']['calculateSpeed']);function _0x26900a(_0x493965,_0x409dec){return _0x3a94a7(_0x409dec- -0x475,_0x493965);}function _0x2af24d(_0xe0ace6,_0x194fff){return _0x3a94a7(_0xe0ace6-0xa0,_0x194fff);}this[_0x26900a(-0x4c,0x25)][_0x2af24d(0x569,0x57f)](this[_0x26900a(0xb3,0xa1)]['particlesComputing']['primitives']['updatePosition']),this[_0x26900a(0x76,0x25)]['add'](this['particleSystem'][_0x26900a(-0x8e,-0x15)]['primitives'][_0x2af24d(0x5d4,0x5e2)]),this[_0x2af24d(0x53a,0x5c5)]['add'](this[_0x2af24d(0x5b6,0x601)][_0x2af24d(0x5c4,0x64e)]['primitives']['segments']),this['primitives']['add'](this['particleSystem'][_0x26900a(0x105,0xaf)][_0x2af24d(0x53a,0x546)]['trails']),this['primitives']['add'](this[_0x26900a(0x96,0xa1)]['particlesRendering']['primitives'][_0x26900a(0x74,0x69)]);}['updateViewerParameters'](){let _0x25c6c4=this[_0x21b670(0xbf,0xd4)]['computeViewRectangle'](this['scene']['globe']['ellipsoid']);if(!_0x25c6c4){const _0xe67fc4=this['_map'][_0x21b670(0x28,0xb1)]();_0x25c6c4=Cesium$1['Rectangle'][_0x38830e(0x295,0x2d6)](_0xe67fc4[_0x38830e(0x278,0x2b4)],_0xe67fc4[_0x21b670(-0x50,-0x1b)],_0xe67fc4['xmax'],_0xe67fc4[_0x21b670(0xc1,0x78)]);}function _0x38830e(_0x6fa9f4,_0x3089bd){return _0x3a94a7(_0x3089bd- -0x269,_0x6fa9f4);}const _0x125d8e=Util[_0x21b670(0x70,0xd0)](_0x25c6c4);this[_0x21b670(0xca,0xa8)]?(this['viewerParameters'][_0x38830e(0x1a4,0x214)]['x']=Math['max'](_0x125d8e['lon'][_0x38830e(0x29d,0x222)],this['_data']['xmin']),this['viewerParameters']['lonRange']['y']=Math['min'](_0x125d8e['lon']['max'],this['_data'][_0x21b670(0x0,-0x33)]),this['viewerParameters']['latRange']['x']=Math['max'](_0x125d8e[_0x21b670(0xe7,0x9b)]['min'],this['_data']['ymin']),this['viewerParameters'][_0x38830e(0x229,0x2af)]['y']=Math['min'](_0x125d8e['lat'][_0x21b670(0x43,0xcc)],this[_0x38830e(0x298,0x29e)]['ymax'])):(this['viewerParameters']['lonRange']['x']=_0x125d8e['lon']['min'],this['viewerParameters']['lonRange']['y']=_0x125d8e['lon'][_0x38830e(0x249,0x2c2)],this['viewerParameters'][_0x38830e(0x270,0x2af)]['x']=_0x125d8e['lat']['min'],this['viewerParameters'][_0x21b670(0x9e,0xb9)]['y']=_0x125d8e['lat']['max']);function _0x21b670(_0x27c82b,_0x1b0ded){return _0x3e9235(_0x27c82b,_0x1b0ded- -0x3b3);}let _0x278d0c=this['camera'][_0x38830e(0x18c,0x1f9)](this[_0x21b670(0x78,0x5d)],this[_0x21b670(0x27,0x61)]['drawingBufferWidth'],this['scene']['drawingBufferHeight']);const _0x1d456b=this['scene']['drawingBufferHeight']*0.3;_0x278d0c<_0x1d456b&&(_0x278d0c=_0x1d456b),this[_0x38830e(0x2bc,0x2be)]['pixelSize']=_0x278d0c;}}mars3d__namespace['LayerUtil'][_0x3a94a7(0x4f4,0x4b4)](_0x3e9235(0x441,0x480),WindLayer),mars3d__namespace['layer']['WindLayer']=WindLayer;class CanvasParticle{constructor(){this[_0x196881(-0xd0,-0x108)]=null,this[_0x4ce406(0x30c,0x2cd)]=null;function _0x4ce406(_0x17abcb,_0x2f3808){return _0x3a94a7(_0x2f3808- -0x22d,_0x17abcb);}this['tlng']=null,this[_0x196881(-0x109,-0x15c)]=null,this[_0x196881(-0xf2,-0x133)]=null;function _0x196881(_0x4a4782,_0x38db49){return _0x3a94a7(_0x4a4782- -0x538,_0x38db49);}this['speed']=null;}['destroy'](){for(const _0x2909e2 in this){delete this[_0x2909e2];}}}class CanvasWindField{constructor(_0x2ba8a4){this['setOptions'](_0x2ba8a4);}get[_0x3e9235(0x45b,0x48b)](){return this['_speedRate'];}set['speedRate'](_0x1fb584){this['_speedRate']=(0x64-(_0x1fb584>0x63?0x63:_0x1fb584))*0x64;function _0x1a27dc(_0x8f7a8a,_0x31aec0){return _0x3a94a7(_0x31aec0- -0x66f,_0x8f7a8a);}function _0x572714(_0x108c3c,_0x28053d){return _0x3e9235(_0x108c3c,_0x28053d- -0x2a0);}this['_calc_speedRate']=[(this['xmax']-this[_0x1a27dc(-0xe3,-0x152)])/this[_0x1a27dc(-0xe8,-0x158)],(this['ymax']-this['ymin'])/this['_speedRate']];}get['maxAge'](){function _0x3c9072(_0x4fb3dd,_0x183f86){return _0x3a94a7(_0x183f86- -0x1cc,_0x4fb3dd);}return this[_0x3c9072(0x317,0x2e0)];}set['maxAge'](_0x436c83){this['_maxAge']=_0x436c83;}['setOptions'](_0x237e3b){function _0x15a77b(_0x4057a6,_0x4395d6){return _0x3a94a7(_0x4395d6- -0x10f,_0x4057a6);}this['options']=_0x237e3b,this['maxAge']=_0x237e3b[_0x15a77b(0x2fd,0x350)]||0x78,this['speedRate']=_0x237e3b['speedRate']||0x32,this['particles']=[];const _0x124cb1=_0x237e3b[_0x15a77b(0x423,0x3a8)]||0x1000;function _0xe5c558(_0x3ffe8b,_0x46e00f){return _0x3a94a7(_0x3ffe8b- -0x67d,_0x46e00f);}for(let _0x560880=0x0;_0x560880<_0x124cb1;_0x560880++){const _0x8b9caa=this['_randomParticle'](new CanvasParticle());this[_0xe5c558(-0x233,-0x1ce)]['push'](_0x8b9caa);}}['setDate'](_0x4cae4b){this['rows']=_0x4cae4b['rows'],this['cols']=_0x4cae4b['cols'],this['xmin']=_0x4cae4b[_0xbb5c3f(0x436,0x498)],this['xmax']=_0x4cae4b[_0x5889be(0x5e,-0x27)],this['ymin']=_0x4cae4b['ymin'],this[_0x5889be(0x109,0xf3)]=_0x4cae4b[_0x5889be(0x109,0x172)],this['grid']=[];const _0x2808f3=_0x4cae4b[_0x5889be(0x5c,0x82)],_0x5eb829=_0x4cae4b['vdata'];let _0x51afad=![];_0x2808f3['length']===this['rows']&&_0x2808f3[0x0]['length']===this['cols']&&(_0x51afad=!![]);function _0xbb5c3f(_0x2e0f6e,_0x54ba94){return _0x3a94a7(_0x2e0f6e- -0xe7,_0x54ba94);}let _0x17accb=0x0,_0x33eac5=null,_0x55aa78=null;for(let _0x3c55db=0x0;_0x3c55db<this['rows'];_0x3c55db++){_0x33eac5=[];for(let _0x14a2a4=0x0;_0x14a2a4<this['cols'];_0x14a2a4++,_0x17accb++){_0x51afad?_0x55aa78=this['_calcUV'](_0x2808f3[_0x3c55db][_0x14a2a4],_0x5eb829[_0x3c55db][_0x14a2a4]):_0x55aa78=this[_0xbb5c3f(0x42e,0x40d)](_0x2808f3[_0x17accb],_0x5eb829[_0x17accb]),_0x33eac5['push'](_0x55aa78);}this['grid']['push'](_0x33eac5);}function _0x5889be(_0xbb10bb,_0x1e79bb){return _0x3a94a7(_0xbb10bb- -0x3ce,_0x1e79bb);}this['options']['reverseY']&&this[_0x5889be(0xc4,0xb7)]['reverse']();}['clear'](){delete this[_0x4ab768(-0x11a,-0x171)],delete this['cols'];function _0x4ab768(_0x231722,_0x1fa106){return _0x3e9235(_0x1fa106,_0x231722- -0x4e7);}delete this[_0x58c408(0x133,0xc5)],delete this[_0x58c408(0x1d,-0x2c)],delete this[_0x58c408(-0x2f,-0x14)],delete this['ymax'],delete this['grid'];function _0x58c408(_0x1e9005,_0xbebc5e){return _0x3e9235(_0x1e9005,_0xbebc5e- -0x3ac);}delete this[_0x58c408(-0x89,-0xe)];}[_0x3a94a7(0x448,0x488)](_0x19511f,_0x40f207){function _0x478e8a(_0x47b462,_0x47ad23){return _0x3a94a7(_0x47ad23- -0x465,_0x47b462);}const _0x416f4e=(_0x19511f-this['xmin'])/(this['xmax']-this[_0x21b4e6(-0xb0,-0x4f)])*(this[_0x21b4e6(-0x109,-0xf1)]-0x1),_0x545c0d=(this[_0x478e8a(0x50,0x72)]-_0x40f207)/(this['ymax']-this['ymin'])*(this['rows']-0x1);function _0x21b4e6(_0x3cbe69,_0x5d2b70){return _0x3a94a7(_0x3cbe69- -0x5cd,_0x5d2b70);}return[_0x416f4e,_0x545c0d];}[_0x3e9235(0x36a,0x3a6)](_0x23f0f6,_0xad2cbb){if(_0x23f0f6<0x0||_0x23f0f6>=this[_0x1ee508(-0x28d,-0x213)]||_0xad2cbb>=this['rows'])return[0x0,0x0,0x0];const _0x2cad86=Math['floor'](_0x23f0f6),_0x3e196d=Math['floor'](_0xad2cbb);if(_0x2cad86===_0x23f0f6&&_0x3e196d===_0xad2cbb)return this[_0x1ee508(-0x296,-0x245)][_0xad2cbb][_0x23f0f6];const _0x460afa=_0x2cad86+0x1,_0x40a15c=_0x3e196d+0x1,_0x3ee9f0=this['getUVByXY'](_0x2cad86,_0x3e196d),_0x266c9f=this['getUVByXY'](_0x460afa,_0x3e196d),_0x227013=this[_0x1ee508(-0x285,-0x285)](_0x2cad86,_0x40a15c);function _0x15aeaa(_0x1badff,_0x5cb0a4){return _0x3e9235(_0x5cb0a4,_0x1badff- -0x385);}const _0x50de8b=this['getUVByXY'](_0x460afa,_0x40a15c);let _0x30cdbb=null;function _0x1ee508(_0x381e3a,_0x1d88ea){return _0x3e9235(_0x381e3a,_0x1d88ea- -0x62b);}try{_0x30cdbb=this[_0x15aeaa(0x7f,-0x3)](_0x23f0f6-_0x2cad86,_0xad2cbb-_0x3e196d,_0x3ee9f0,_0x266c9f,_0x227013,_0x50de8b);}catch(_0x4d0ca1){console[_0x1ee508(-0x22b,-0x260)](_0x23f0f6,_0xad2cbb);}return _0x30cdbb;}['_bilinearInterpolation'](_0x36e68d,_0x2c77b1,_0x1bd9c6,_0x2499e4,_0x3c0caa,_0x2c1cae){const _0x862532=0x1-_0x36e68d,_0x50c644=0x1-_0x2c77b1,_0x4ab913=_0x862532*_0x50c644;function _0x40b039(_0x39ac04,_0x442012){return _0x3e9235(_0x442012,_0x39ac04- -0x5a6);}const _0x5422f1=_0x36e68d*_0x50c644,_0x41253d=_0x862532*_0x2c77b1,_0x3dbba7=_0x36e68d*_0x2c77b1,_0x5ba53a=_0x1bd9c6[0x0]*_0x4ab913+_0x2499e4[0x0]*_0x5422f1+_0x3c0caa[0x0]*_0x41253d+_0x2c1cae[0x0]*_0x3dbba7,_0x3b10ae=_0x1bd9c6[0x1]*_0x4ab913+_0x2499e4[0x1]*_0x5422f1+_0x3c0caa[0x1]*_0x41253d+_0x2c1cae[0x1]*_0x3dbba7;return this[_0x40b039(-0x13d,-0xc7)](_0x5ba53a,_0x3b10ae);}['_calcUV'](_0x1d8cb4,_0x3d16c6){function _0x353e66(_0x583669,_0x4a329b){return _0x3e9235(_0x4a329b,_0x583669- -0x2ba);}return[+_0x1d8cb4,+_0x3d16c6,Math[_0x353e66(0x11e,0x16f)](_0x1d8cb4*_0x1d8cb4+_0x3d16c6*_0x3d16c6)];}['getUVByPoint'](_0x10dee9,_0x7c3906){if(!this['isInExtent'](_0x10dee9,_0x7c3906))return null;const _0xcd7ac8=this['toGridXY'](_0x10dee9,_0x7c3906),_0x47c714=this['getUVByXY'](_0xcd7ac8[0x0],_0xcd7ac8[0x1]);return _0x47c714;}[_0x3a94a7(0x4e3,0x507)](_0x21bc3a,_0x1392b9){function _0xb2a0e9(_0x539cb0,_0x281861){return _0x3e9235(_0x539cb0,_0x281861-0x3b);}function _0x20f1c5(_0x3bdd9c,_0x12ec9b){return _0x3a94a7(_0x3bdd9c- -0x26f,_0x12ec9b);}return _0x21bc3a>=this['xmin']&&_0x21bc3a<=this['xmax']&&_0x1392b9>=this[_0xb2a0e9(0x43d,0x3d3)]&&_0x1392b9<=this[_0xb2a0e9(0x488,0x466)]?!![]:![];}['getRandomLatLng'](){const _0x369f5b=fRandomByfloat(this['xmin'],this['xmax']),_0x49ee53=fRandomByfloat(this[_0x3f1355(-0x13c,-0x1bb)],this[_0x3f1355(-0xe5,-0x128)]);function _0x3f1355(_0x2d8a7a,_0x4ec09a){return _0x3e9235(_0x2d8a7a,_0x4ec09a- -0x553);}const _0x48a686={};function _0x1cf6f7(_0x2973b6,_0x1e1de1){return _0x3e9235(_0x2973b6,_0x1e1de1-0xfb);}return _0x48a686['lat']=_0x49ee53,_0x48a686['lng']=_0x369f5b,_0x48a686;}['getParticles'](){let _0x472a7b,_0x106a6a,_0x3d4af3;function _0xf87bc0(_0x4d3dcd,_0x2425d4){return _0x3a94a7(_0x4d3dcd- -0x6f7,_0x2425d4);}for(let _0x14e877=0x0,_0x1bd452=this['particles']['length'];_0x14e877<_0x1bd452;_0x14e877++){let _0x5cba1a=this['particles'][_0x14e877];_0x5cba1a[_0xf87bc0(-0x2b1,-0x24c)]<=0x0&&(_0x5cba1a=this['_randomParticle'](_0x5cba1a));if(_0x5cba1a['age']>0x0){const _0xc75c55=_0x5cba1a[_0xf87bc0(-0x1c2,-0x1a3)],_0x3154f6=_0x5cba1a[_0xf87bc0(-0x2c8,-0x25b)];_0x3d4af3=this[_0x2181d3(-0x2ad,-0x2b1)](_0xc75c55,_0x3154f6),_0x3d4af3?(_0x472a7b=_0xc75c55+this[_0x2181d3(-0x22e,-0x1f8)][0x0]*_0x3d4af3[0x0],_0x106a6a=_0x3154f6+this['_calc_speedRate'][0x1]*_0x3d4af3[0x1],_0x5cba1a[_0x2181d3(-0x284,-0x24c)]=_0xc75c55,_0x5cba1a[_0x2181d3(-0x1f2,-0x1de)]=_0x3154f6,_0x5cba1a['tlng']=_0x472a7b,_0x5cba1a['tlat']=_0x106a6a,_0x5cba1a[_0xf87bc0(-0x212,-0x206)]=_0x3d4af3[0x2],_0x5cba1a['age']--):_0x5cba1a['age']=0x0;}}function _0x2181d3(_0x42a984,_0x39f509){return _0x3a94a7(_0x42a984- -0x6ec,_0x39f509);}return this[_0x2181d3(-0x2a2,-0x2f3)];}['_randomParticle'](_0x1ae2dd){let _0x104d2b,_0x77328f;for(let _0x38764f=0x0;_0x38764f<0x1e;_0x38764f++){_0x104d2b=this[_0x455ce6(0x3e6,0x3a8)](),_0x77328f=this['getUVByPoint'](_0x104d2b['lng'],_0x104d2b['lat']);if(_0x77328f&&_0x77328f[0x2]>0x0)break;}if(!_0x77328f)return _0x1ae2dd;const _0x20dc9e=_0x104d2b['lng']+this['_calc_speedRate'][0x0]*_0x77328f[0x0];function _0x455ce6(_0x1fc0a6,_0x1acb90){return _0x3a94a7(_0x1fc0a6- -0x85,_0x1acb90);}const _0x5264d9=_0x104d2b[_0x455ce6(0x475,0x3ed)]+this['_calc_speedRate'][0x1]*_0x77328f[0x1];_0x1ae2dd[_0x375173(0x18a,0x102)]=_0x104d2b['lng'],_0x1ae2dd['lat']=_0x104d2b['lat'],_0x1ae2dd['tlng']=_0x20dc9e,_0x1ae2dd['tlat']=_0x5264d9,_0x1ae2dd[_0x375173(0xb0,0xe0)]=Math['round'](Math['random']()*this['maxAge']),_0x1ae2dd[_0x375173(0x140,0x17f)]=_0x77328f[0x2];function _0x375173(_0x2037ff,_0x19a1ab){return _0x3e9235(_0x2037ff,_0x19a1ab- -0x2ba);}return _0x1ae2dd;}[_0x3a94a7(0x44f,0x471)](){for(const _0x4bddd2 in this){delete this[_0x4bddd2];}}}function fRandomByfloat(_0x3a7cc8,_0x553473){return _0x3a7cc8+Math['random']()*(_0x553473-_0x3a7cc8);}function _0x3a94a7(_0x3abdc7,_0x33c435){return _0x44b3(_0x3abdc7-0x348,_0x33c435);}const Cesium=mars3d__namespace[_0x3e9235(0x497,0x416)],BaseLayer=mars3d__namespace['layer'][_0x3a94a7(0x4b9,0x455)];function _0x7029(){const _0x47051d=['viewerParameters','randomBetween','currentTrails','defines','max','wind','refreshTimer','7791678LdzuNz','viewRectangleToLonLatRange','_canrefresh','colour','calculateSpeed','camera','postProcessingPosition','tlng','hidden','speedRate','primitiveType','context','viewport','color','Pass','clearFramebuffers','frameRate','fromDegrees','depthTest','udata','geometry','xmax','RGBA','lineWidth','tlat','SCENE3D','stroke','fromGeometry','vertexShaderSource','_onMouseDownEvent','fadeOpacity','Draw','framebuffer','destroyParticlesTextures','pixelDatatype','createRenderingPrimitives','toRadians','VertexArray','preRender','update','getUVByPoint','abs','particlesTextureSize','canvas','_onMouseMoveEvent','ymin','absolute','age','LayerUtil','toGridXY','windTextures','particles','windData','canvasResize','canvasWidth','lineTo','destroy','removeEventListener','nextTrails','getUVByXY','options','getFullscreenQuad','mouseHidden','wSpeedRange','1157980ytGgkq','createTexture','visible','ceil','lev','NEAREST','requestAnimationFrame','createComputingPrimitives','maxAge','particlesComputing','createFramebuffer','getPixelSize','canvasHeight','setOptions','ShaderSource','commandType','setData','lng','speedFactor','applyViewerParameters','getRandomLatLng','vSpeedRange','pow','drawingBufferWidth','#version\x20300\x20es\x0a\x0aprecision\x20highp\x20float;\x0a\x0auniform\x20sampler2D\x20currentParticlesPosition;\x20//\x20(lon,\x20lat,\x20lev)\x0auniform\x20sampler2D\x20particlesSpeed;\x20//\x20(u,\x20v,\x20w,\x20norm)\x20Unit\x20converted\x20to\x20degrees\x20of\x20longitude\x20and\x20latitude\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20vec3\x20lonLatLev\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rgb;\x0a\x20\x20vec3\x20speed\x20=\x20texture(particlesSpeed,\x20v_textureCoordinates).rgb;\x0a\x20\x20vec3\x20nextParticle\x20=\x20lonLatLev\x20+\x20speed;\x0a\x20\x20if(length(speed.rgb)\x20>\x200.0f)\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(nextParticle,\x200.0f);\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(0.0f);\x0a\x20\x20}\x0a}\x0a','_mountedHook','length','mouse_move','GeometryAttribute','createWindTextures','auto','_onMouseUpEvent','log','segments','rows','1173892CkmPUo','_pointerEvents','frameTime','lonRange','framebuffers','RenderState','createRawRenderState','Sampler','forEach','bind','sqrt','drawingBufferHeight','#version\x20300\x20es\x0a\x0auniform\x20sampler2D\x20colorTable;\x0auniform\x20bool\x20colour;\x0a\x0ain\x20float\x20heightNormalization;\x0ain\x20float\x20speedNormalization;\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20const\x20float\x20zero\x20=\x200.0f;\x0a\x20\x20if(speedNormalization\x20>\x20zero)\x20{\x0a\x20\x20\x20\x20if(colour)\x20{\x0a\x20\x20\x20\x20\x20\x20fragColor\x20=\x20texture(colorTable,\x20vec2(heightNormalization,\x20zero));\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20fragColor\x20=\x20texture(colorTable,\x20vec2(speedNormalization,\x20zero));\x0a\x20\x20\x20\x20}\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(zero);\x0a\x20\x20}\x0a}\x0a','off','execute','sources','minimumRadius','min','keys','blending','mouseMove','dropRate','preExecute','setGeometry','grid','defined','getOptions','PixelFormat','postMessage','globe','_onMap_preRenderEvent','PointTrans','primitives','canvasContext','now','dimensions','removeAll','CanvasWindField','Color','#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0ain\x20vec2\x20st;\x0a//\x20it\x20is\x20not\x20normal\x20itself,\x20but\x20used\x20to\x20control\x20lines\x20drawing\x0ain\x20vec3\x20normal;\x20//\x20(point\x20to\x20use,\x20offset\x20sign,\x20not\x20used\x20component)\x0auniform\x20vec2\x20hRange;\x0auniform\x20vec2\x20uSpeedRange;\x20//\x20(min,\x20max);\x0auniform\x20vec2\x20vSpeedRange;\x0auniform\x20vec2\x20wSpeedRange;\x0a\x0auniform\x20sampler2D\x20previousParticlesPosition;\x0auniform\x20sampler2D\x20currentParticlesPosition;\x0auniform\x20sampler2D\x20postProcessingPosition;\x0auniform\x20sampler2D\x20particlesSpeed;\x0a\x0auniform\x20float\x20particleHeight;\x0a\x0auniform\x20float\x20aspect;\x0auniform\x20float\x20pixelSize;\x0auniform\x20float\x20lineWidth;\x0a\x0astruct\x20adjacentPoints\x20{\x0a\x20\x20vec4\x20previous;\x0a\x20\x20vec4\x20current;\x0a\x20\x20vec4\x20next;\x0a};\x0a\x0aout\x20float\x20heightNormalization;\x0aout\x20float\x20speedNormalization;\x0avec3\x20convertCoordinate(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20WGS84\x20(lon,\x20lat,\x20lev)\x20->\x20ECEF\x20(x,\x20y,\x20z)\x0a\x20\x20\x20\x20//\x20read\x20https://en.wikipedia.org/wiki/Geographic_coordinate_conversion#From_geodetic_to_ECEF_coordinates\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20WGS\x2084\x20geometric\x20constants\x0a\x20\x20float\x20a\x20=\x206378137.0f;\x20//\x20Semi-major\x20axis\x0a\x20\x20float\x20b\x20=\x206356752.3142f;\x20//\x20Semi-minor\x20axis\x0a\x20\x20float\x20e2\x20=\x206.69437999014e-3f;\x20//\x20First\x20eccentricity\x20squared\x0a\x0a\x20\x20float\x20latitude\x20=\x20radians(lonLatLev.y);\x0a\x20\x20float\x20longitude\x20=\x20radians(lonLatLev.x);\x0a\x0a\x20\x20float\x20cosLat\x20=\x20cos(latitude);\x0a\x20\x20float\x20sinLat\x20=\x20sin(latitude);\x0a\x20\x20float\x20cosLon\x20=\x20cos(longitude);\x0a\x20\x20float\x20sinLon\x20=\x20sin(longitude);\x0a\x0a\x20\x20float\x20N_Phi\x20=\x20a\x20/\x20sqrt(1.0f\x20-\x20e2\x20*\x20sinLat\x20*\x20sinLat);\x0a\x20\x20float\x20h\x20=\x20particleHeight\x20+\x20lonLatLev.z;\x20//\x20it\x20should\x20be\x20high\x20enough\x20otherwise\x20the\x20particle\x20may\x20not\x20pass\x20the\x20terrain\x20depth\x20test\x0a\x20\x20vec3\x20cartesian\x20=\x20vec3(0.0f);\x0a\x20\x20cartesian.x\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20cosLon;\x0a\x20\x20cartesian.y\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20sinLon;\x0a\x20\x20cartesian.z\x20=\x20((b\x20*\x20b)\x20/\x20(a\x20*\x20a)\x20*\x20N_Phi\x20+\x20h)\x20*\x20sinLat;\x0a\x20\x20return\x20cartesian;\x0a}\x0a\x0avec4\x20calculateProjectedCoordinate(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20the\x20range\x20of\x20longitude\x20in\x20Cesium\x20is\x20[-180,\x20180]\x20but\x20the\x20range\x20of\x20longitude\x20in\x20the\x20NetCDF\x20file\x20is\x20[0,\x20360]\x0a\x20\x20\x20\x20//\x20[0,\x20180]\x20is\x20corresponding\x20to\x20[0,\x20180]\x20and\x20[180,\x20360]\x20is\x20corresponding\x20to\x20[-180,\x200]\x0a\x20\x20lonLatLev.x\x20=\x20mod(lonLatLev.x\x20+\x20180.0f,\x20360.0f)\x20-\x20180.0f;\x0a\x20\x20vec3\x20particlePosition\x20=\x20convertCoordinate(lonLatLev);\x0a\x20\x20vec4\x20projectedCoordinate\x20=\x20czm_modelViewProjection\x20*\x20vec4(particlePosition,\x201.0f);\x0a\x20\x20return\x20projectedCoordinate;\x0a}\x0a\x0avec4\x20calculateOffsetOnNormalDirection(vec4\x20pointA,\x20vec4\x20pointB,\x20float\x20offsetSign)\x20{\x0a\x20\x20vec2\x20aspectVec2\x20=\x20vec2(aspect,\x201.0f);\x0a\x20\x20vec2\x20pointA_XY\x20=\x20(pointA.xy\x20/\x20pointA.w)\x20*\x20aspectVec2;\x0a\x20\x20vec2\x20pointB_XY\x20=\x20(pointB.xy\x20/\x20pointB.w)\x20*\x20aspectVec2;\x0a\x0a\x20\x20float\x20offsetLength\x20=\x20lineWidth\x20/\x202.0f;\x0a\x20\x20vec2\x20direction\x20=\x20normalize(pointB_XY\x20-\x20pointA_XY);\x0a\x20\x20vec2\x20normalVector\x20=\x20vec2(-direction.y,\x20direction.x);\x0a\x20\x20normalVector.x\x20=\x20normalVector.x\x20/\x20aspect;\x0a\x20\x20normalVector\x20=\x20offsetLength\x20*\x20normalVector;\x0a\x0a\x20\x20vec4\x20offset\x20=\x20vec4(offsetSign\x20*\x20normalVector,\x200.0f,\x200.0f);\x0a\x20\x20return\x20offset;\x0a}\x0a\x0afloat\x20calculateWindNorm(vec3\x20speed)\x20{\x0a\x20\x20vec3\x20percent\x20=\x20vec3(0.0f);\x0a\x20\x20percent.x\x20=\x20(speed.x\x20-\x20uSpeedRange.x)\x20/\x20(uSpeedRange.y\x20-\x20uSpeedRange.x);\x0a\x20\x20percent.y\x20=\x20(speed.y\x20-\x20vSpeedRange.x)\x20/\x20(vSpeedRange.y\x20-\x20vSpeedRange.x);\x0a\x20\x20if(wSpeedRange.y\x20==\x20wSpeedRange.x)\x20{\x0a\x20\x20\x20\x20percent.z\x20=\x200.0f;\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20percent.z\x20=\x20(speed.z\x20-\x20wSpeedRange.x)\x20/\x20(wSpeedRange.y\x20-\x20wSpeedRange.x);\x0a\x20\x20}\x0a\x20\x20float\x20norm\x20=\x20length(percent);\x0a\x0a\x20\x20return\x20norm;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20vec2\x20particleIndex\x20=\x20st;\x0a\x0a\x20\x20vec3\x20previousPosition\x20=\x20texture(previousParticlesPosition,\x20particleIndex).rgb;\x0a\x20\x20vec3\x20currentPosition\x20=\x20texture(currentParticlesPosition,\x20particleIndex).rgb;\x0a\x20\x20vec3\x20nextPosition\x20=\x20texture(postProcessingPosition,\x20particleIndex).rgb;\x0a\x0a\x20\x20float\x20isAnyRandomPointUsed\x20=\x20texture(postProcessingPosition,\x20particleIndex).a\x20+\x0a\x20\x20\x20\x20texture(currentParticlesPosition,\x20particleIndex).a\x20+\x0a\x20\x20\x20\x20texture(previousParticlesPosition,\x20particleIndex).a;\x0a\x0a\x20\x20adjacentPoints\x20projectedCoordinates;\x0a\x20\x20if(isAnyRandomPointUsed\x20>\x200.0f)\x20{\x0a\x20\x20\x20\x20projectedCoordinates.previous\x20=\x20calculateProjectedCoordinate(previousPosition);\x0a\x20\x20\x20\x20projectedCoordinates.current\x20=\x20projectedCoordinates.previous;\x0a\x20\x20\x20\x20projectedCoordinates.next\x20=\x20projectedCoordinates.previous;\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20projectedCoordinates.previous\x20=\x20calculateProjectedCoordinate(previousPosition);\x0a\x20\x20\x20\x20projectedCoordinates.current\x20=\x20calculateProjectedCoordinate(currentPosition);\x0a\x20\x20\x20\x20projectedCoordinates.next\x20=\x20calculateProjectedCoordinate(nextPosition);\x0a\x20\x20}\x0a\x0a\x20\x20int\x20pointToUse\x20=\x20int(normal.x);\x0a\x20\x20float\x20offsetSign\x20=\x20normal.y;\x0a\x20\x20vec4\x20offset\x20=\x20vec4(0.0f);\x0a\x20\x20\x20\x20//\x20render\x20lines\x20with\x20triangles\x20and\x20miter\x20joint\x0a\x20\x20\x20\x20//\x20read\x20https://blog.scottlogic.com/2019/11/18/drawing-lines-with-webgl.html\x20for\x20detail\x0a\x20\x20if(pointToUse\x20==\x20-1)\x20{\x0a\x20\x20\x20\x20offset\x20=\x20pixelSize\x20*\x20calculateOffsetOnNormalDirection(projectedCoordinates.previous,\x20projectedCoordinates.current,\x20offsetSign);\x0a\x20\x20\x20\x20gl_Position\x20=\x20projectedCoordinates.previous\x20+\x20offset;\x0a\x20\x20}\x20else\x20if(pointToUse\x20==\x201)\x20{\x0a\x20\x20\x20\x20offset\x20=\x20pixelSize\x20*\x20calculateOffsetOnNormalDirection(projectedCoordinates.current,\x20projectedCoordinates.next,\x20offsetSign);\x0a\x20\x20\x20\x20gl_Position\x20=\x20projectedCoordinates.next\x20+\x20offset;\x0a\x20\x20}\x0a\x0a\x20\x20heightNormalization\x20=\x20(currentPosition.z\x20-\x20hRange.x)\x20/\x20(hRange.y\x20-\x20hRange.x);\x0a\x0a\x20\x20speedNormalization\x20=\x20texture(particlesSpeed,\x20particleIndex).a;\x0a}\x0a','depthTexture','EventType','floor','lon','rawRenderState','Cartesian3','textures','type','STATIC_DRAW','_map','_maxAge','particlesTextures','default','toDegrees','_bilinearInterpolation','_updateIng','left','zIndex','redraw','clear','clampToLatitudeRange','particlesNumber','reverseY','BaseLayer','ClearCommand','PrimitiveType','globeBoundingSphere','green','_calc_speedRate','resize','scene','show','Cesium','_tomap','cols','setDate','colors','fill','64521kFZkFT','add','data','vertexArray','west','clearCommand','vmax','_updateIng2','#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0auniform\x20sampler2D\x20nextParticlesPosition;\x0auniform\x20sampler2D\x20particlesSpeed;\x20//\x20(u,\x20v,\x20w,\x20norm)\x0a\x0auniform\x20sampler2D\x20H;\x20//\x20particles\x20height\x20textures\x0a\x0auniform\x20vec3\x20dimension;\x20//\x20(lon,\x20lat,\x20lev)\x0auniform\x20vec3\x20minimum;\x20//\x20minimum\x20of\x20each\x20dimension\x0auniform\x20vec3\x20maximum;\x20//\x20maximum\x20of\x20each\x20dimension\x0auniform\x20vec3\x20interval;\x20//\x20interval\x20of\x20each\x20dimension\x0a\x0a//\x20range\x20(min,\x20max)\x0auniform\x20vec2\x20lonRange;\x0auniform\x20vec2\x20latRange;\x0auniform\x20vec2\x20viewerLonRange;\x0auniform\x20vec2\x20viewerLatRange;\x0a\x0aconst\x20float\x20randomCoefficient\x20=\x200.1f;\x20//\x20use\x20to\x20improve\x20the\x20pseudo-random\x20generator\x0aconst\x20float\x20dropRate\x20=\x200.1f;\x20//\x20drop\x20rate\x20is\x20a\x20chance\x20a\x20particle\x20will\x20restart\x20at\x20random\x20position\x20to\x20avoid\x20degeneration\x0aconst\x20float\x20dropRateBump\x20=\x200.1f;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avec2\x20mapPositionToNormalizedIndex2D(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20ensure\x20the\x20range\x20of\x20longitude\x20and\x20latitude\x0a\x20\x20lonLatLev.x\x20=\x20clamp(lonLatLev.x,\x20minimum.x,\x20maximum.x);\x0a\x20\x20lonLatLev.y\x20=\x20clamp(lonLatLev.y,\x20minimum.y,\x20maximum.y);\x0a\x20\x20lonLatLev.z\x20=\x20clamp(lonLatLev.z,\x20minimum.z,\x20maximum.z);\x0a\x0a\x20\x20vec3\x20index3D\x20=\x20vec3(0.0f);\x0a\x20\x20index3D.x\x20=\x20(lonLatLev.x\x20-\x20minimum.x)\x20/\x20interval.x;\x0a\x20\x20index3D.y\x20=\x20(lonLatLev.y\x20-\x20minimum.y)\x20/\x20interval.y;\x0a\x20\x20index3D.z\x20=\x20ceil((lonLatLev.z\x20-\x20minimum.z)\x20/\x20interval.z);\x0a\x0a\x20\x20vec2\x20index2D\x20=\x20vec2(index3D.x,\x20index3D.z\x20*\x20dimension.y\x20+\x20index3D.y);\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20vec2(index2D.x\x20/\x20dimension.x,\x20index2D.y\x20/\x20(dimension.y\x20*\x20dimension.z));\x0a\x20\x20return\x20normalizedIndex2D;\x0a}\x0a\x0avec4\x20getTextureValue(sampler2D\x20componentTexture,\x20vec3\x20lonLatLev)\x20{\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20mapPositionToNormalizedIndex2D(lonLatLev);\x0a\x20\x20vec4\x20result\x20=\x20texture(componentTexture,\x20normalizedIndex2D);\x0a\x20\x20return\x20result;\x0a}\x0a\x0a//\x20pseudo-random\x20generator\x0aconst\x20vec3\x20randomConstants\x20=\x20vec3(12.9898f,\x2078.233f,\x204375.85453f);\x0aconst\x20vec2\x20normalRange\x20=\x20vec2(0.0f,\x201.0f);\x0afloat\x20rand(vec2\x20seed,\x20vec2\x20range)\x20{\x0a\x20\x20vec2\x20randomSeed\x20=\x20randomCoefficient\x20*\x20seed;\x0a\x20\x20float\x20temp\x20=\x20dot(randomConstants.xy,\x20randomSeed);\x0a\x20\x20temp\x20=\x20fract(sin(temp)\x20*\x20(randomConstants.z\x20+\x20temp));\x0a\x20\x20return\x20temp\x20*\x20(range.y\x20-\x20range.x)\x20+\x20range.x;\x0a}\x0a\x0abool\x20particleNoSpeed(vec3\x20particle)\x20{\x0a\x20\x20vec4\x20speed\x20=\x20getTextureValue(particlesSpeed,\x20particle);\x0a\x20\x20return\x20speed.r\x20==\x200.0f\x20&&\x20speed.g\x20==\x200.0f;\x0a}\x0a\x0avec3\x20generateRandomParticle(vec2\x20seed,\x20float\x20lev)\x20{\x0a\x20\x20\x20\x20//\x20ensure\x20the\x20longitude\x20is\x20in\x20[0,\x20360]\x0a\x20\x20float\x20randomLon\x20=\x20mod(rand(seed,\x20lonRange),\x20360.0f);\x0a\x20\x20float\x20randomLat\x20=\x20rand(-seed,\x20latRange);\x0a\x0a\x20\x20float\x20height\x20=\x20getTextureValue(H,\x20vec3(randomLon,\x20randomLat,\x20lev)).r;\x0a\x0a\x20\x20return\x20vec3(randomLon,\x20randomLat,\x20height);\x0a}\x0a\x0abool\x20particleOutbound(vec3\x20particle)\x20{\x0a\x20\x20return\x20particle.y\x20<\x20viewerLatRange.x\x20||\x20particle.y\x20>\x20viewerLatRange.y\x20||\x20particle.x\x20<\x20viewerLonRange.x\x20||\x20particle.x\x20>\x20viewerLonRange.y;\x0a}\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20vec3\x20nextParticle\x20=\x20texture(nextParticlesPosition,\x20v_textureCoordinates).rgb;\x0a\x20\x20vec4\x20nextSpeed\x20=\x20texture(particlesSpeed,\x20v_textureCoordinates);\x0a\x20\x20float\x20speedNorm\x20=\x20nextSpeed.a;\x0a\x20\x20float\x20particleDropRate\x20=\x20dropRate\x20+\x20dropRateBump\x20*\x20speedNorm;\x0a\x0a\x20\x20vec2\x20seed1\x20=\x20nextParticle.xy\x20+\x20v_textureCoordinates;\x0a\x20\x20vec2\x20seed2\x20=\x20nextSpeed.xy\x20+\x20v_textureCoordinates;\x0a\x20\x20vec3\x20randomParticle\x20=\x20generateRandomParticle(seed1,\x20nextParticle.z);\x0a\x20\x20float\x20randomNumber\x20=\x20rand(seed2,\x20normalRange);\x0a\x0a\x20\x20if(randomNumber\x20<\x20particleDropRate\x20||\x20particleOutbound(nextParticle))\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(randomParticle,\x201.0f);\x20//\x201.0\x20means\x20this\x20is\x20a\x20random\x20particle\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(nextParticle,\x200.0f);\x0a\x20\x20}\x0a}\x0a','THREE_PI_OVER_TWO','depthMask','particleHeight','uniformMap','moveTo','fragmentShaderSource','ymax','attributeLocations','wheel','globalCompositeOperation','array','Cartesian2','RED','screen','toWindowCoordinates','position','positionWC','2926jsIUZB','isInExtent','shaderProgram','speed','Compute','style','2000ITTLfB','width','6444760HLmaCl','refreshParticles','commandToExecute','levmin','36924zBBNjY','564niWhRa','_setOptionsHook','get','getValidRange','dynamic','register','getDefaultRenderState','init','_onMapWhellEvent','ShaderProgram','worker','lat','GeometryAttributes','layer','SceneMode','enabled','currentParticlesPosition','umax','isDestroy','nextParticlesPosition','addEventListener','mouse_down','PixelDatatype','none','_data','height','clientHeight','particlesSpeed','FLOAT','Math','170qGLQrL','maxParticles','windField','getExtent','outputTexture','isPointVisible','DomUtil','pointer-events','_calcUV','particleSystem','_speedRate','latRange','BufferUsage','push','fillRect','getContext','xmin','initWorker','mouseDown','createRenderingFramebuffers','clientWidth','DISABLE_LOG_DEPTH_FRAGMENT_WRITE','fixedHeight','particlesRendering','mouseUp','_colorRamp'];_0x7029=function(){return _0x47051d;};return _0x7029();}class CanvasWindLayer extends BaseLayer{constructor(_0x53c8e5={}){super(_0x53c8e5),this[_0x30f4b3(0x362,0x371)](_0x53c8e5),this['canvas']=null;function _0x22af7b(_0x34964d,_0x851023){return _0x3a94a7(_0x851023- -0x681,_0x34964d);}function _0x30f4b3(_0xf2efda,_0x5e8c36){return _0x3e9235(_0xf2efda,_0x5e8c36- -0xd3);}_0x53c8e5[_0x30f4b3(0x34f,0x347)]&&_0x53c8e5['steps']&&(this['_colorRamp']=new mars3d__namespace['ColorRamp'](_0x53c8e5));}['_setOptionsHook'](_0x725921,_0x39401b){this[_0x2c6964(0x10b,0x135)]=0x3e8/(_0x725921[_0x487c4c(0x3cd,0x413)]||0xa),this[_0x2c6964(0x1b8,0x134)]=this[_0x2c6964(0xc1,0x10c)]['pointerEvents']??![],this['color']=_0x725921[_0x487c4c(0x3c4,0x410)]||'#ffffff';function _0x487c4c(_0x1cd4d0,_0x4c492b){return _0x3e9235(_0x1cd4d0,_0x4c492b- -0x7f);}this['lineWidth']=_0x725921[_0x487c4c(0x2f3,0x303)]||0x1,this['fixedHeight']=_0x725921[_0x2c6964(0x175,0x1dc)]??0x0;function _0x2c6964(_0x4c4f56,_0x1ffb94){return _0x3e9235(_0x4c4f56,_0x1ffb94- -0x29b);}this[_0x2c6964(0x1fd,0x171)]=_0x725921[_0x2c6964(0x1d2,0x171)]??![],this[_0x2c6964(0x16c,0x1c8)]&&this[_0x487c4c(0x37d,0x3e4)]['setOptions'](_0x725921);}get[_0x3e9235(0x479,0x450)](){function _0x273d2c(_0x12d647,_0xb52162){return _0x3e9235(_0x12d647,_0xb52162- -0x15d);}return this[_0x273d2c(0x26f,0x239)];}get[_0x3a94a7(0x44d,0x497)](){function _0x2d258c(_0x56654c,_0x3f10a6){return _0x3a94a7(_0x56654c- -0x621,_0x3f10a6);}function _0x49366c(_0x2ebcdd,_0x4f8254){return _0x3e9235(_0x4f8254,_0x2ebcdd- -0x174);}return this[_0x49366c(0x28b,0x313)]['scene'][_0x49366c(0x222,0x2a8)]['clientWidth'];}get[_0x3a94a7(0x463,0x4a3)](){function _0x2a3d37(_0x41dd0e,_0x3d3a84){return _0x3a94a7(_0x41dd0e- -0x6ec,_0x3d3a84);}return this[_0x2a3d37(-0x241,-0x246)]['scene']['canvas']['clientHeight'];}get['pointerEvents'](){return this['_pointerEvents'];}set['pointerEvents'](_0x560be4){this['_pointerEvents']=_0x560be4;function _0x5961aa(_0x5e0881,_0x3e2880){return _0x3a94a7(_0x3e2880- -0xc0,_0x5e0881);}if(!this[_0x37f65a(0x121,0x9c)])return;function _0x37f65a(_0x4c0b1d,_0xbf0bf7){return _0x3e9235(_0xbf0bf7,_0x4c0b1d- -0x275);}_0x560be4?this[_0x37f65a(0x121,0xdd)]['style'][_0x5961aa(0x47c,0x454)]='all':this['canvas'][_0x37f65a(0x1c6,0x1df)][_0x5961aa(0x3f7,0x454)]=_0x37f65a(0x1e5,0x209);}get[_0x3e9235(0x42e,0x40b)](){function _0x5913e7(_0x364565,_0x20e2a9){return _0x3a94a7(_0x364565- -0x406,_0x20e2a9);}return this[_0x5913e7(0x4d,0xad)]['particlesNumber'];}set[_0x3a94a7(0x4b7,0x44f)](_0x49ba6d){function _0xcddaec(_0x15761e,_0x271775){return _0x3e9235(_0x271775,_0x15761e-0x54);}this[_0xcddaec(0x3fb,0x3fb)][_0x43e653(-0x1e5,-0x253)]=_0x49ba6d,clearTimeout(this[_0xcddaec(0x4d8,0x4b3)]);function _0x43e653(_0x12dc30,_0x56bf14){return _0x3a94a7(_0x56bf14- -0x70a,_0x12dc30);}this['_canrefresh']=setTimeout(()=>{function _0x162e7a(_0x33e18e,_0x2c333e){return _0xcddaec(_0x33e18e- -0x16a,_0x2c333e);}this[_0x162e7a(0x2f2,0x274)]();},0x1f4);}get['speedRate'](){function _0x4a9f3a(_0x475581,_0x406fb0){return _0x3e9235(_0x406fb0,_0x475581- -0x9f);}function _0xd63c69(_0x1001c8,_0x5991f2){return _0x3a94a7(_0x1001c8- -0x5ed,_0x5991f2);}return this[_0x4a9f3a(0x308,0x31c)][_0xd63c69(-0xb6,-0x6b)];}set[_0x3a94a7(0x537,0x5be)](_0x33c4a7){this['options']['speedRate']=_0x33c4a7;function _0x4fcf08(_0x5a58d6,_0x54eab2){return _0x3e9235(_0x54eab2,_0x5a58d6- -0x3f);}this[_0x4fcf08(0x424,0x43f)]&&(this['windField']['speedRate']=_0x33c4a7);}get['maxAge'](){return this['options']['maxAge'];}set['maxAge'](_0x4a0ec9){this['options']['maxAge']=_0x4a0ec9;function _0x5a68d4(_0x5b9cc2,_0x3f05a5){return _0x3e9235(_0x3f05a5,_0x5b9cc2-0xa8);}function _0x3ff128(_0x53d2b6,_0x35c178){return _0x3a94a7(_0x35c178- -0x584,_0x53d2b6);}this[_0x5a68d4(0x50b,0x503)]&&(this[_0x5a68d4(0x50b,0x512)]['maxAge']=_0x4a0ec9);}get[_0x3a94a7(0x4ca,0x53e)](){function _0x3cae37(_0x33a7f8,_0x584b37){return _0x3a94a7(_0x33a7f8- -0x6ae,_0x584b37);}return this[_0x3cae37(-0x263,-0x28a)];}set['data'](_0x38a9d6){function _0x378a4a(_0x56553c,_0x5b02b3){return _0x3e9235(_0x56553c,_0x5b02b3- -0x416);}this[_0x378a4a(-0x4c,-0x5b)](_0x38a9d6);}['_showHook'](_0x2a5ba5){function _0x5adc63(_0x1ff3c4,_0x344b2d){return _0x3e9235(_0x344b2d,_0x1ff3c4- -0x114);}function _0x25e502(_0x595817,_0x17c88d){return _0x3a94a7(_0x595817- -0x489,_0x17c88d);}_0x2a5ba5?this['_addedHook']():(this['windData']&&(this[_0x25e502(-0x36,-0xa1)]['data']=this[_0x25e502(-0x3e,-0x33)]),this['_removedHook']());}[_0x3a94a7(0x470,0x3ee)](){function _0x30de4e(_0x428db6,_0x24f92d){return _0x3a94a7(_0x428db6- -0x5fe,_0x24f92d);}function _0x2478e5(_0x1b6721,_0x47c5fc){return _0x3e9235(_0x1b6721,_0x47c5fc- -0x3c8);}this['options'][_0x2478e5(0xc6,0x85)]?this[_0x30de4e(-0xe0,-0x13e)]():this[_0x2478e5(0x79,0x9b)]=new CanvasWindField(this[_0x30de4e(-0x1ab,-0x225)]);}['_addedHook'](){this['canvas']=this['_createCanvas']();const _0x40d958={};_0x40d958['willReadFrequently']=!![],this['canvasContext']=this['canvas'][_0x1ef88e(0x21b,0x19c)]('2d',_0x40d958);function _0x5913a3(_0x4db4a7,_0x1e8c08){return _0x3a94a7(_0x1e8c08- -0x666,_0x4db4a7);}this['bindEvent']();function _0x1ef88e(_0xcea63,_0x40e8a4){return _0x3a94a7(_0xcea63- -0x301,_0x40e8a4);}this['options'][_0x5913a3(-0x191,-0x19c)]&&this['setData'](this[_0x1ef88e(0x152,0xd7)][_0x5913a3(-0x12e,-0x19c)]);}['_removedHook'](){this['clear'](),this['unbindEvent']();function _0x887fc4(_0x389439,_0x120033){return _0x3e9235(_0x389439,_0x120033- -0xfc);}function _0x2032db(_0x34302e,_0x523f86){return _0x3e9235(_0x523f86,_0x34302e- -0x2df);}this['canvas']&&(this['_map']['container']['removeChild'](this[_0x887fc4(0x23d,0x29a)]),delete this[_0x2032db(0xb7,0x4d)]);}['_createCanvas'](){const _0x4ac755=mars3d__namespace[_0x4d2ad7(0x5c,0xa1)]['create'](_0x4d2ad7(-0x75,-0xe4),'mars3d-canvasWind',this['_map']['container']);_0x4ac755[_0x4d2ad7(0x30,-0x25)]['position']=_0x105b05(0x7d,0x5),_0x4ac755[_0x105b05(0x65,0xa7)]['top']='0px',_0x4ac755['style'][_0x4d2ad7(-0x5,-0x6d)]='0px',_0x4ac755[_0x105b05(0x1c,0xa7)][_0x4d2ad7(0x32,0x1f)]=this['_map']['scene']['canvas']['clientWidth']+'px',_0x4ac755['style']['height']=this[_0x4d2ad7(-0xc,-0x27)]['scene'][_0x105b05(0x15,0x2)][_0x105b05(0xca,0xc9)]+'px',_0x4ac755['style']['pointerEvents']=this['_pointerEvents']?_0x4d2ad7(-0x42,-0x2e):'none';function _0x105b05(_0x4368fd,_0x41d9ea){return _0x3e9235(_0x4368fd,_0x41d9ea- -0x394);}_0x4ac755['style'][_0x4d2ad7(-0x4,0x2f)]=this['options']['zIndex']??0x9;function _0x4d2ad7(_0xd3e03c,_0x153d2d){return _0x3a94a7(_0xd3e03c- -0x4b7,_0x153d2d);}return _0x4ac755['width']=this['_map']['scene']['canvas'][_0x4d2ad7(0x6a,-0x8)],_0x4ac755['height']=this['_map']['scene'][_0x4d2ad7(-0x75,0xf)][_0x105b05(0x122,0xc9)],_0x4ac755;}[_0x3a94a7(0x4bf,0x4c5)](){function _0x241848(_0x57006d,_0x3360a2){return _0x3e9235(_0x57006d,_0x3360a2- -0x119);}function _0x34ebdf(_0x1e206b,_0x257175){return _0x3a94a7(_0x1e206b- -0x98,_0x257175);}this['canvas']&&(this['canvas']['style']['width']=this['_map']['scene']['canvas'][_0x34ebdf(0x489,0x496)]+'px',this[_0x34ebdf(0x3aa,0x365)]['style']['height']=this[_0x34ebdf(0x413,0x424)]['scene']['canvas']['clientHeight']+'px',this[_0x241848(0x234,0x27d)]['width']=this[_0x34ebdf(0x413,0x467)][_0x34ebdf(0x428,0x3cc)][_0x241848(0x1fa,0x27d)]['clientWidth'],this['canvas'][_0x34ebdf(0x470,0x438)]=this['_map']['scene']['canvas']['clientHeight']);}['bindEvent'](){function _0x57deba(_0x2a9964,_0x43acdb){return _0x3a94a7(_0x43acdb- -0x727,_0x2a9964);}const _0x1d3513=this;function _0x538bcd(_0x2eab1d,_0x1e75b2){return _0x3e9235(_0x2eab1d,_0x1e75b2- -0x202);}let _0x35fb2d=Date[_0x538bcd(0x23f,0x1ee)]();(function _0x1db616(){function _0x43b41c(_0x2521e2,_0x11e212){return _0x538bcd(_0x2521e2,_0x11e212- -0x310);}if(_0x1d3513[_0x43b41c(-0x3d,-0xbd)])return;_0x1d3513['_animateFrame']=window[_0xdddba1(0x12e,0x19b)](_0x1db616);function _0xdddba1(_0x3b2134,_0x147a64){return _0x538bcd(_0x147a64,_0x3b2134- -0x81);}if(_0x1d3513[_0x43b41c(-0x161,-0xfd)]&&_0x1d3513[_0xdddba1(0x1e0,0x1cc)]){const _0x528be7=Date[_0x43b41c(-0xab,-0x122)](),_0x556640=_0x528be7-_0x35fb2d;_0x556640>_0x1d3513[_0x43b41c(-0x109,-0x142)]&&(_0x35fb2d=_0x528be7-_0x556640%_0x1d3513[_0xdddba1(0x14d,0xe4)],_0x1d3513['update']());}}(),window['addEventListener']('resize',this['resize'][_0x57deba(-0x329,-0x2a4)](this),![]),this[_0x57deba(-0x22c,-0x223)]=![],this['mouse_move']=![],this['options'][_0x57deba(-0x260,-0x2d2)]&&(this['_map']['on'](mars3d__namespace['EventType']['wheel'],this['_onMapWhellEvent'],this),this['_map']['on'](mars3d__namespace['EventType']['mouseDown'],this[_0x57deba(-0x339,-0x2f3)],this),this['_map']['on'](mars3d__namespace['EventType']['mouseUp'],this['_onMouseUpEvent'],this)));}['unbindEvent'](){function _0x4b981e(_0x4ec662,_0x489637){return _0x3e9235(_0x489637,_0x4ec662-0x13a);}window['cancelAnimationFrame'](this['_animateFrame']);function _0x2fef23(_0x29c993,_0x1cff46){return _0x3a94a7(_0x29c993- -0x1c6,_0x1cff46);}delete this['_animateFrame'],window['removeEventListener']('resize',this['resize']),this['options']['mouseHidden']&&(this[_0x2fef23(0x2e5,0x28c)][_0x4b981e(0x515,0x590)](mars3d__namespace[_0x4b981e(0x531,0x5b6)]['wheel'],this['_onMapWhellEvent'],this),this['_map']['off'](mars3d__namespace['EventType']['mouseDown'],this['_onMouseDownEvent'],this),this[_0x2fef23(0x2e5,0x327)]['off'](mars3d__namespace[_0x2fef23(0x2dd,0x301)]['mouseUp'],this[_0x2fef23(0x2b0,0x2cd)],this),this[_0x2fef23(0x2e5,0x33e)][_0x4b981e(0x515,0x4a6)](mars3d__namespace[_0x4b981e(0x531,0x562)][_0x2fef23(0x2c8,0x270)],this['_onMouseMoveEvent'],this));}[_0x3e9235(0x407,0x44b)](_0x386438){clearTimeout(this['refreshTimer']);if(!this[_0x14e706(0x371,0x35d)]||!this['canvas'])return;this[_0x3b0fc6(-0xe7,-0x7b)]['style']['visibility']=_0x14e706(0x3e6,0x40e);function _0x14e706(_0x17a45f,_0x539b82){return _0x3e9235(_0x539b82,_0x17a45f- -0xa4);}function _0x3b0fc6(_0xf48dc6,_0x68c3c8){return _0x3a94a7(_0xf48dc6- -0x529,_0x68c3c8);}this['refreshTimer']=setTimeout(()=>{function _0x1f966d(_0x527e62,_0xa06f0b){return _0x14e706(_0x527e62- -0x4bc,_0xa06f0b);}if(!this[_0x2b3a47(-0xb7,-0x77)])return;this[_0x1f966d(-0x158,-0xec)]();function _0x2b3a47(_0x4db6fa,_0x4fb7ac){return _0x14e706(_0x4fb7ac- -0x3e8,_0x4db6fa);}this[_0x1f966d(-0x1ca,-0x1fe)]['style']['visibility']=_0x2b3a47(-0x13f,-0xdf);},0xc8);}[_0x3e9235(0x372,0x388)](_0xe1139){this[_0x19a09f(-0x52,0x2a)]=!![];function _0x184835(_0xa4f4fe,_0xdc3930){return _0x3a94a7(_0xdc3930- -0x42b,_0xa4f4fe);}function _0x19a09f(_0x4423e9,_0x17f80a){return _0x3a94a7(_0x17f80a- -0x4da,_0x4423e9);}this[_0x184835(-0xb,0x80)]['off'](mars3d__namespace['EventType'][_0x19a09f(-0x7e,-0x4c)],this[_0x19a09f(-0x38,-0x97)],this),this[_0x184835(0x3c,0x80)]['on'](mars3d__namespace['EventType'][_0x184835(0x9b,0x63)],this['_onMouseMoveEvent'],this);}['_onMouseMoveEvent'](_0x3fbd55){if(!this['show']||!this['canvas'])return;this['mouse_down']&&(this['canvas']['style']['visibility']='hidden',this['mouse_move']=!![]);}[_0x3a94a7(0x476,0x48c)](_0x2e4d27){if(!this['show']||!this[_0x4ffe7c(0xfe,0xda)])return;function _0x108c85(_0x4d90e6,_0x4018fa){return _0x3e9235(_0x4018fa,_0x4d90e6- -0x5a1);}this['_map']['off'](mars3d__namespace[_0x108c85(-0x1aa,-0x179)]['mouseMove'],this['_onMouseMoveEvent'],this);this['mouse_down']&&this['mouse_move']&&this['redraw']();function _0x4ffe7c(_0x188b9f,_0x5b9ed0){return _0x3a94a7(_0x5b9ed0- -0x368,_0x188b9f);}this['canvas']['style']['visibility']=_0x108c85(-0x1f4,-0x1b9),this['mouse_down']=![],this[_0x108c85(-0x1db,-0x205)]=![];}['setData'](_0x17270c){function _0x245266(_0x2a5790,_0x1c291b){return _0x3e9235(_0x2a5790,_0x1c291b- -0x247);}this['clear']();function _0x3ea105(_0x26fdeb,_0x4de7d6){return _0x3a94a7(_0x4de7d6- -0x12c,_0x26fdeb);}this[_0x245266(0x1ab,0x158)]=_0x17270c,this['windField'][_0x245266(0x1a5,0x1d2)](_0x17270c),this['redraw']();}[_0x3a94a7(0x4b4,0x4c5)](){if(!this[_0x48ce4a(0x160,0x1e5)])return;function _0x48ce4a(_0x1d13d5,_0x385ff0){return _0x3a94a7(_0x385ff0- -0x2dc,_0x1d13d5);}this['windField'][_0x126d34(-0x273,-0x28c)](this['options']);function _0x126d34(_0x3feadf,_0x1ad560){return _0x3a94a7(_0x3feadf- -0x6d7,_0x1ad560);}this[_0x48ce4a(0x14c,0x162)]();}[_0x3e9235(0x32d,0x392)](){function _0x319039(_0x23e4e2,_0xcbd756){return _0x3e9235(_0xcbd756,_0x23e4e2- -0x600);}if(this['_updateIng'])return;this[_0x32f394(0x518,0x4cf)]=!![];function _0x32f394(_0x4eef89,_0x2edeae){return _0x3e9235(_0x2edeae,_0x4eef89-0x113);}if(this[_0x32f394(0x560,0x594)])this['windField'][_0x32f394(0x4a5,0x444)]();else{const _0x5d5b4a=this[_0x32f394(0x576,0x5be)]['getParticles']();this['_drawLines'](_0x5d5b4a);}this[_0x32f394(0x518,0x542)]=![];}['_drawLines'](_0x28c955){this[_0x5bb612(0x472,0x41c)][_0x5bb612(0x4b1,0x4e7)]='destination-in',this['canvasContext'][_0x1bb404(0x2e1,0x28e)](0x0,0x0,this['canvasWidth'],this['canvasHeight']),this['canvasContext'][_0x5bb612(0x4b1,0x48d)]='lighter';function _0x1bb404(_0x35c721,_0x553e44){return _0x3a94a7(_0x553e44- -0x28d,_0x35c721);}this['canvasContext']['globalAlpha']=0.9;const _0x5c8b37=this['_map']['scene']['mode']!==Cesium[_0x5bb612(0x4d4,0x548)][_0x1bb404(0x1e5,0x1a3)];function _0x5bb612(_0x515237,_0x2fe971){return _0x3a94a7(_0x515237- -0x29,_0x2fe971);}const _0x1ee57b=this['canvasWidth']*0.25;if(this[_0x5bb612(0x4fd,0x523)])for(let _0x30e7a9=0x0,_0x46aa46=_0x28c955['length'];_0x30e7a9<_0x46aa46;_0x30e7a9++){const _0x2aa79c=_0x28c955[_0x30e7a9],_0x46ea78=this['_tomap'](_0x2aa79c[_0x5bb612(0x43f,0x484)],_0x2aa79c[_0x1bb404(0x2c0,0x26d)],_0x2aa79c),_0x33efa4=this[_0x5bb612(0x49a,0x466)](_0x2aa79c['tlng'],_0x2aa79c[_0x5bb612(0x406,0x391)],_0x2aa79c);if(!_0x46ea78||!_0x33efa4)continue;if(_0x5c8b37&&Math['abs'](_0x46ea78[0x0]-_0x33efa4[0x0])>=_0x1ee57b)continue;this['canvasContext']['beginPath'](),this['canvasContext']['lineWidth']=this['lineWidth'],this['canvasContext']['strokeStyle']=this['_colorRamp']['getColor'](_0x2aa79c['speed']),this['canvasContext'][_0x5bb612(0x4ac,0x528)](_0x46ea78[0x0],_0x46ea78[0x1]),this['canvasContext']['lineTo'](_0x33efa4[0x0],_0x33efa4[0x1]),this['canvasContext'][_0x5bb612(0x408,0x481)]();}else{this['canvasContext']['beginPath'](),this['canvasContext']['lineWidth']=this[_0x5bb612(0x405,0x438)],this['canvasContext']['strokeStyle']=this['color'];for(let _0x271ca1=0x0,_0x9b3a8d=_0x28c955['length'];_0x271ca1<_0x9b3a8d;_0x271ca1++){const _0x4eca2f=_0x28c955[_0x271ca1],_0x5a9585=this['_tomap'](_0x4eca2f['lng'],_0x4eca2f['lat'],_0x4eca2f),_0xf75b27=this['_tomap'](_0x4eca2f[_0x5bb612(0x50c,0x54e)],_0x4eca2f[_0x1bb404(0x19d,0x1a2)],_0x4eca2f);if(!_0x5a9585||!_0xf75b27)continue;if(_0x5c8b37&&Math[_0x1bb404(0x1f7,0x1b3)](_0x5a9585[0x0]-_0xf75b27[0x0])>=_0x1ee57b)continue;this[_0x1bb404(0x21d,0x20e)]['moveTo'](_0x5a9585[0x0],_0x5a9585[0x1]),this['canvasContext'][_0x1bb404(0x189,0x1c1)](_0xf75b27[0x0],_0xf75b27[0x1]);}this['canvasContext'][_0x5bb612(0x408,0x39e)]();}}[_0x3e9235(0x427,0x417)](_0x488812,_0x39456a,_0x3fbefb){function _0x45e683(_0x378a97,_0x4c3f70){return _0x3a94a7(_0x378a97- -0x3ad,_0x4c3f70);}const _0x30dd21=Cesium['Cartesian3']['fromDegrees'](_0x488812,_0x39456a,this[_0x45e683(0x176,0x184)]);function _0x17d7ad(_0x4f45b0,_0x217fb2){return _0x3a94a7(_0x217fb2- -0x307,_0x4f45b0);}const _0x124cc8=this['_map']['scene'];if(_0x124cc8['mode']===Cesium[_0x45e683(0x150,0x1bf)][_0x17d7ad(0xd3,0x129)]){const _0x8c9f2=new Cesium['EllipsoidalOccluder'](_0x124cc8[_0x17d7ad(0x152,0x190)]['ellipsoid'],_0x124cc8['camera'][_0x45e683(0x134,0xa9)]),_0x2c9e59=_0x8c9f2[_0x45e683(0x165,0x1ca)](_0x30dd21);if(!_0x2c9e59)return _0x3fbefb['age']=0x0,null;}const _0x43c8be=mars3d__namespace[_0x45e683(0xec,0x98)][_0x45e683(0x132,0x12a)](this['_map']['scene'],_0x30dd21);return _0x43c8be?[_0x43c8be['x'],_0x43c8be['y']]:null;}[_0x3e9235(0x3f2,0x409)](){this[_0x3a74b7(0x23c,0x1ce)]['clear']();function _0x3a74b7(_0x43f739,_0x629bc5){return _0x3a94a7(_0x43f739- -0x2d3,_0x629bc5);}delete this['windData'];}['initWorker'](){this['worker']=new Worker(this['options']['worker']),this[_0x38e21f(0x330,0x39c)]['onmessage']=_0x12cf9b=>{this['_drawLines'](_0x12cf9b[_0x276ad1(-0x9b,-0x1a)][_0x372cf5(-0xb1,-0x34)]);function _0x372cf5(_0x558185,_0x4c6bea){return _0x38e21f(_0x4c6bea- -0x2b5,_0x558185);}function _0x276ad1(_0x2bda9d,_0x4d3d2c){return _0x38e21f(_0x4d3d2c- -0x31b,_0x2bda9d);}this[_0x276ad1(-0x13,-0x15)]=![];},this['windField']={'init':_0x3eee35=>{const _0x4664bd={};function _0x4b4d57(_0x19f70f,_0x4708e6){return _0x38e21f(_0x4708e6-0x243,_0x19f70f);}_0x4664bd['type']=_0x4b4d57(0x541,0x570);function _0x434289(_0x4779b9,_0x34e697){return _0x38e21f(_0x34e697- -0x4bd,_0x4779b9);}_0x4664bd[_0x4b4d57(0x462,0x4cd)]=_0x3eee35,this['worker']['postMessage'](_0x4664bd);},'setOptions':_0x3c105b=>{function _0x5a0c2e(_0x56b979,_0x56c842){return _0x38e21f(_0x56c842- -0x69,_0x56b979);}const _0x3b32f6={};function _0x5b5f08(_0x298905,_0x5ae4c5){return _0x38e21f(_0x5ae4c5- -0x22f,_0x298905);}_0x3b32f6['type']='setOptions',_0x3b32f6[_0x5b5f08(0x83,0x5b)]=_0x3c105b,this['worker'][_0x5b5f08(0x19,0x9e)](_0x3b32f6);},'setDate':_0x780c14=>{const _0x30f3ad={};function _0x20ad8a(_0x293454,_0x3318dd){return _0x38e21f(_0x293454- -0x26f,_0x3318dd);}_0x30f3ad['type']=_0x52f890(-0x1a0,-0x15b),_0x30f3ad['data']=_0x780c14;function _0x52f890(_0x4ecc42,_0x2abc25){return _0x38e21f(_0x2abc25- -0x457,_0x4ecc42);}this['worker'][_0x52f890(-0x110,-0x18a)](_0x30f3ad);},'update':()=>{function _0xdddbaa(_0x5fccc6,_0x41b508){return _0x38e21f(_0x41b508- -0x27,_0x5fccc6);}if(this['_updateIng2'])return;this[_0x325bed(0x53b,0x52d)]=!![];const _0x3a7794={};function _0x325bed(_0x36c9a4,_0x653432){return _0x38e21f(_0x653432-0x227,_0x36c9a4);}_0x3a7794['type']='update',this[_0x325bed(0x4dd,0x557)]['postMessage'](_0x3a7794);},'clear':()=>{function _0x157dc1(_0x1afb0d,_0x22df23){return _0x38e21f(_0x1afb0d- -0xc5,_0x22df23);}const _0x5e2b70={};function _0x34e1b8(_0xe42c0d,_0x6e2cb4){return _0x38e21f(_0xe42c0d-0x130,_0x6e2cb4);}_0x5e2b70[_0x34e1b8(0x410,0x3de)]='clear',this[_0x157dc1(0x26b,0x204)][_0x157dc1(0x208,0x1bb)](_0x5e2b70);}};function _0x32ae3f(_0x5e87e4,_0xeaf7d4){return _0x3a94a7(_0xeaf7d4- -0x430,_0x5e87e4);}function _0x38e21f(_0x5d224c,_0x2ee39d){return _0x3a94a7(_0x5d224c- -0x1c9,_0x2ee39d);}this[_0x38e21f(0x346,0x3a2)][_0x38e21f(0x32d,0x2ff)](this[_0x32ae3f(0x8f,0x23)]);}}mars3d__namespace[_0x3a94a7(0x447,0x3f0)]['register']('canvasWind',CanvasWindLayer),mars3d__namespace['layer']['CanvasWindLayer']=CanvasWindLayer,mars3d__namespace['CanvasWindField']=CanvasWindField,mars3d__namespace['WindUtil']=WindUtil,exports[_0x3e9235(0x376,0x3f3)]=CanvasWindField,exports['CanvasWindLayer']=CanvasWindLayer,exports['WindLayer']=WindLayer,exports['WindUtil']=WindUtil;const _0x3eb116={};_0x3eb116['value']=!![],Object['defineProperty'](exports,'__esModule',_0x3eb116);
}));
