/**
 * Mars3D平台插件,支持气象 风向图 功能插件  mars3d-wind
 *
 * 版本信息：v3.8.9
 * 编译日期：2024-12-03 18:05
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2024-08-01
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-wind"] = {}, global.mars3d));
})(this, (function (exports, mars3d) { 
'use strict';(function(_0x308186,_0x36e34c){function _0xd5d602(_0x1e8324,_0x539225){return _0x3e17(_0x1e8324- -0x337,_0x539225);}function _0x61f9a7(_0x17f629,_0x3f5aae){return _0x3e17(_0x3f5aae- -0x260,_0x17f629);}const _0xc43639=_0x308186();while(!![]){try{const _0x291b38=parseInt(_0xd5d602(-0xc3,-0x92))/0x1+-parseInt(_0x61f9a7(-0xe4,-0x71))/0x2+parseInt(_0x61f9a7(0x3b,0x81))/0x3*(parseInt(_0xd5d602(-0xc5,-0x14a))/0x4)+parseInt(_0x61f9a7(0x4f,-0x36))/0x5*(-parseInt(_0x61f9a7(0x5,-0x38))/0x6)+parseInt(_0x61f9a7(0xb1,0x30))/0x7+parseInt(_0xd5d602(-0xba,-0xbc))/0x8+-parseInt(_0x61f9a7(0x42,0x70))/0x9;if(_0x291b38===_0x36e34c)break;else _0xc43639['push'](_0xc43639['shift']());}catch(_0x2acf59){_0xc43639['push'](_0xc43639['shift']());}}}(_0x1683,0x39ddc));function _interopNamespace(_0x2e825d){if(_0x2e825d&&_0x2e825d['__esModule'])return _0x2e825d;var _0x14232e=Object['create'](null);function _0x4a07b1(_0x44d4b6,_0x462e34){return _0x3e17(_0x44d4b6-0x245,_0x462e34);}_0x2e825d&&Object['keys'](_0x2e825d)[_0x3843e6(0x34c,0x3a3)](function(_0x362b49){function _0x424f58(_0x448249,_0x5bacf8){return _0x3843e6(_0x5bacf8-0x8b,_0x448249);}if(_0x362b49!=='default'){var _0xa65ba5=Object['getOwnPropertyDescriptor'](_0x2e825d,_0x362b49);Object[_0x424f58(0x4aa,0x42c)](_0x14232e,_0x362b49,_0xa65ba5['get']?_0xa65ba5:{'enumerable':!![],'get':function(){return _0x2e825d[_0x362b49];}});}});function _0x3843e6(_0x1ce62c,_0xecbfa9){return _0x3e17(_0x1ce62c-0x119,_0xecbfa9);}return _0x14232e[_0x3843e6(0x336,0x301)]=_0x2e825d,_0x14232e;}var mars3d__namespace=_interopNamespace(mars3d);const Cesium$7=mars3d__namespace[_0x27456a(0x515,0x4ec)];function getU(_0x726fd8,_0x200d81){const _0x2d8c0c=_0x726fd8*Math[_0x586438(-0x72,0x2)](Cesium$7[_0x5f5bb1(0x205,0x267)]['toRadians'](_0x200d81));function _0x586438(_0x54461a,_0x3500de){return _0x27456a(_0x3500de- -0x5af,_0x54461a);}function _0x5f5bb1(_0xf891e5,_0x4ab328){return _0x27456a(_0x4ab328- -0x37c,_0xf891e5);}return _0x2d8c0c;}function getV(_0x103820,_0x2ee14f){const _0xfdd476=_0x103820*Math['sin'](Cesium$7['Math']['toRadians'](_0x2ee14f));return _0xfdd476;}function getSpeed(_0x1f1789,_0x4b8dc7){function _0xd401e0(_0x3a1471,_0x9edfe4){return _0x27456a(_0x3a1471- -0x157,_0x9edfe4);}function _0x13ed5f(_0x2c0130,_0x5ca323){return _0x27456a(_0x2c0130- -0x48,_0x5ca323);}const _0x3a8c06=Math[_0x13ed5f(0x562,0x556)](Math[_0x13ed5f(0x5ce,0x5de)](_0x1f1789,0x2)+Math[_0x13ed5f(0x5ce,0x658)](_0x4b8dc7,0x2));return _0x3a8c06;}function getDirection(_0x4384a0,_0x11b8fc){function _0x9942c1(_0x2a08ed,_0x4f4d50){return _0x27456a(_0x4f4d50- -0x2d7,_0x2a08ed);}let _0x2d637c=Cesium$7[_0x9942c1(0x384,0x30c)]['toDegrees'](Math[_0x9942c1(0x36e,0x2f5)](_0x11b8fc,_0x4384a0));function _0x32430a(_0x40071d,_0x3294f9){return _0x27456a(_0x40071d- -0x1e0,_0x3294f9);}return _0x2d637c+=_0x2d637c<0x0?0x168:0x0,_0x2d637c;}const _0x16cb1d={};_0x16cb1d['__proto__']=null,_0x16cb1d['getU']=getU,_0x16cb1d[_0x27456a(0x512,0x550)]=getV,_0x16cb1d[_0x688102(0x484,0x4c2)]=getSpeed,_0x16cb1d[_0x688102(0x46c,0x498)]=getDirection;var WindUtil=_0x16cb1d;const Cesium$6=mars3d__namespace['Cesium'];class CustomPrimitive{constructor(_0x315cf6){function _0x205dfa(_0x2d7ed3,_0x4eccdd){return _0x27456a(_0x2d7ed3- -0x109,_0x4eccdd);}this['commandType']=_0x315cf6[_0x43ccb7(-0xb4,-0xcb)],this[_0x43ccb7(-0xfa,-0x144)]=_0x315cf6[_0x43ccb7(-0xfa,-0x173)],this[_0x43ccb7(-0xae,-0xe2)]=_0x315cf6['attributeLocations'],this['primitiveType']=_0x315cf6['primitiveType'],this[_0x43ccb7(-0xdf,-0x84)]=_0x315cf6[_0x43ccb7(-0xdf,-0xa0)],this[_0x43ccb7(-0xb1,-0xd9)]=_0x315cf6['vertexShaderSource'],this['fragmentShaderSource']=_0x315cf6['fragmentShaderSource'],this['rawRenderState']=_0x315cf6['rawRenderState'],this[_0x205dfa(0x47f,0x45e)]=_0x315cf6['framebuffer'],this['outputTexture']=_0x315cf6['outputTexture'],this[_0x43ccb7(-0x9,0x48)]=_0x315cf6['autoClear']??![],this[_0x205dfa(0x4ad,0x4cd)]=_0x315cf6['preExecute'],this['show']=!![],this[_0x205dfa(0x4b4,0x46c)]=undefined,this['clearCommand']=undefined;function _0x43ccb7(_0x1a68e7,_0x8e3845){return _0x27456a(_0x1a68e7- -0x610,_0x8e3845);}this[_0x43ccb7(-0x9,-0x7a)]&&(this['clearCommand']=new Cesium$6[(_0x43ccb7(-0xeb,-0x164))]({'color':new Cesium$6['Color'](0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':this[_0x43ccb7(-0x88,-0x63)],'pass':Cesium$6['Pass']['OPAQUE']}));}[_0x27456a(0x580,0x513)](_0xcb14fa){function _0x25b9b5(_0x400695,_0x322d70){return _0x27456a(_0x322d70- -0x485,_0x400695);}function _0x213413(_0x2c6a59,_0x10241a){return _0x27456a(_0x10241a- -0x4cc,_0x2c6a59);}switch(this[_0x213413(0xa0,0x90)]){case _0x25b9b5(0x191,0x152):{const _0x53374f=Cesium$6['VertexArray']['fromGeometry']({'context':_0xcb14fa,'geometry':this['geometry'],'attributeLocations':this[_0x25b9b5(0xd4,0xdd)],'bufferUsage':Cesium$6['BufferUsage'][_0x213413(0x13d,0xf9)]}),_0x3ff152={};_0x3ff152['context']=_0xcb14fa,_0x3ff152[_0x213413(0x46,0x96)]=this[_0x25b9b5(0x140,0xdd)],_0x3ff152['vertexShaderSource']=this['vertexShaderSource'],_0x3ff152['fragmentShaderSource']=this[_0x213413(0x133,0x133)];const _0x173de9=Cesium$6['ShaderProgram']['fromCache'](_0x3ff152),_0x32625f=Cesium$6['RenderState']['fromCache'](this['rawRenderState']);return new Cesium$6['DrawCommand']({'owner':this,'vertexArray':_0x53374f,'primitiveType':this['primitiveType'],'uniformMap':this['uniformMap'],'modelMatrix':Cesium$6[_0x213413(0x140,0x14d)]['IDENTITY'],'shaderProgram':_0x173de9,'framebuffer':this[_0x213413(0xbb,0xbc)],'renderState':_0x32625f,'pass':Cesium$6['Pass']['OPAQUE']});}case'Compute':{const _0x32eb89={};return _0x32eb89[_0x213413(0xfa,0xd3)]=this,_0x32eb89[_0x213413(0x1b6,0x133)]=this[_0x25b9b5(0x1dd,0x17a)],_0x32eb89['uniformMap']=this['uniformMap'],_0x32eb89['outputTexture']=this[_0x25b9b5(0xd5,0x96)],_0x32eb89[_0x213413(0x82,0xc3)]=!![],new Cesium$6['ComputeCommand'](_0x32eb89);}}}['setGeometry'](_0x37102b,_0x33b5a0){this[_0x35a5d2(0x18b,0x158)]=_0x33b5a0;function _0x6d09ec(_0x421e2a,_0x3c3a90){return _0x688102(_0x421e2a,_0x3c3a90- -0x318);}function _0x35a5d2(_0x3c59ac,_0x198d5d){return _0x688102(_0x198d5d,_0x3c59ac- -0x295);}const _0x155cc9=Cesium$6['VertexArray']['fromGeometry']({'context':_0x37102b,'geometry':this['geometry'],'attributeLocations':this['attributeLocations'],'bufferUsage':Cesium$6[_0x6d09ec(0x181,0x158)]['STATIC_DRAW']});this[_0x6d09ec(0x21c,0x1af)][_0x35a5d2(0x252,0x25a)]=_0x155cc9;}[_0x688102(0x546,0x4d7)](_0x9f022a){if(!this['show'])return;if(_0x9f022a['mode']!==Cesium$6['SceneMode'][_0x22d94f(0x4f7,0x4b3)])return;!Cesium$6['defined'](this['commandToExecute'])&&(this[_0x22d94f(0x52e,0x536)]=this['createCommand'](_0x9f022a[_0x14e77b(-0xf2,-0x11e)]));function _0x22d94f(_0x13c85a,_0x5786ca){return _0x27456a(_0x13c85a- -0x8f,_0x5786ca);}Cesium$6[_0x22d94f(0x533,0x4d6)](this['preExecute'])&&this['preExecute']();Cesium$6['defined'](this['clearCommand'])&&_0x9f022a[_0x14e77b(-0x8f,-0x7a)]['push'](this[_0x22d94f(0x564,0x588)]);function _0x14e77b(_0x5a3f93,_0x76001c){return _0x27456a(_0x5a3f93- -0x68d,_0x76001c);}_0x9f022a['commandList'][_0x14e77b(-0xd6,-0xd6)](this['commandToExecute']);}['isDestroyed'](){return![];}[_0x688102(0x4cc,0x449)](){if(this[_0x33065f(0x1b3,0x205)]){var _0x1d5520,_0x992694;(_0x1d5520=this['clearCommand'])!==null&&_0x1d5520!==void 0x0&&_0x1d5520[_0x33065f(0x19d,0x145)]&&this['clearCommand'][_0x33065f(0x19d,0x154)]['destroy'](),(_0x992694=this[_0x33065f(0x1b3,0x146)])!==null&&_0x992694!==void 0x0&&_0x992694['shaderProgram']&&this[_0x484339(0x5e7,0x5fd)]['shaderProgram']['destroy'](),delete this['clearCommand'];}this[_0x484339(0x5bb,0x5c7)]&&(this['commandToExecute']['vertexArray']&&this['commandToExecute']['vertexArray']['destroy'](),this['commandToExecute'][_0x484339(0x620,0x5ee)]&&this['commandToExecute'][_0x33065f(0x1a4,0x1c7)][_0x484339(0x51b,0x549)](),delete this['commandToExecute']);function _0x33065f(_0x49d4be,_0x28d1e1){return _0x27456a(_0x49d4be- -0x440,_0x28d1e1);}function _0x484339(_0x126aa7,_0x513361){return _0x27456a(_0x513361-0xa,_0x126aa7);}return Cesium$6['destroyObject'](this);}}const Cesium$5=mars3d__namespace['Cesium'],Util=(function(){const _0x474e2c=function(){function _0x595191(_0x2de078,_0x1c3e6a){return _0x3e17(_0x1c3e6a-0xeb,_0x2de078);}function _0x154dd7(_0x148de0,_0x2f285f){return _0x3e17(_0x148de0-0x1df,_0x2f285f);}const _0x839a61=new Cesium$5[(_0x595191(0x379,0x34b))]({'attributes':new Cesium$5['GeometryAttributes']({'position':new Cesium$5[(_0x595191(0x31e,0x335))]({'componentDatatype':Cesium$5['ComponentDatatype']['FLOAT'],'componentsPerAttribute':0x3,'values':new Float32Array([-0x1,-0x1,0x0,0x1,-0x1,0x0,0x1,0x1,0x0,-0x1,0x1,0x0])}),'st':new Cesium$5[(_0x154dd7(0x429,0x497))]({'componentDatatype':Cesium$5[_0x154dd7(0x471,0x4a4)]['FLOAT'],'componentsPerAttribute':0x2,'values':new Float32Array([0x0,0x0,0x1,0x0,0x1,0x1,0x0,0x1])})}),'indices':new Uint32Array([0x3,0x2,0x0,0x0,0x2,0x1])});return _0x839a61;},_0x337490=function(_0x4c90da,_0x5b56c6){if(Cesium$5[_0x1cb21e(0x410,0x415)](_0x5b56c6)){const _0x468db4={};_0x468db4[_0x26a6ee(0x40,0x7a)]=_0x5b56c6,_0x4c90da['source']=_0x468db4;}function _0x1cb21e(_0x1bd2f5,_0x5c9aa6){return _0x3e17(_0x1bd2f5-0x178,_0x5c9aa6);}function _0x26a6ee(_0x5c59be,_0x1ed0a4){return _0x3e17(_0x1ed0a4- -0x194,_0x5c59be);}const _0x5ec583=new Cesium$5[(_0x1cb21e(0x3c7,0x369))](_0x4c90da);return _0x5ec583;},_0x5560f0=function(_0x2cbd0a,_0x210ddf,_0x54dc8a){const _0x3a05d3={};_0x3a05d3[_0x288983(0x58b,0x5d4)]=_0x2cbd0a;function _0x179d6b(_0x2d37cb,_0x12813e){return _0x3e17(_0x12813e- -0x199,_0x2d37cb);}_0x3a05d3['colorTextures']=[_0x210ddf];function _0x288983(_0x4ebda3,_0x3beb2b){return _0x3e17(_0x3beb2b-0x363,_0x4ebda3);}_0x3a05d3[_0x179d6b(0x8d,0x113)]=_0x54dc8a;const _0x18e661=new Cesium$5['Framebuffer'](_0x3a05d3);return _0x18e661;},_0x3dc873=function(_0x4026ec){const _0x36ad8f=!![];function _0x53ac0f(_0x16df49,_0x356c43){return _0x3e17(_0x356c43-0x19b,_0x16df49);}const _0x2c88dc=![],_0x4391f2={};_0x4391f2[_0x218bb1(0x5a0,0x625)]=_0x4026ec[_0x218bb1(0x5a0,0x5ad)],_0x4391f2[_0x218bb1(0x586,0x55d)]=_0x4026ec['depthTest'];function _0x218bb1(_0x302f37,_0x4feeee){return _0x3e17(_0x302f37-0x366,_0x4feeee);}_0x4391f2[_0x53ac0f(0x3fe,0x384)]=_0x4026ec[_0x53ac0f(0x3c2,0x384)],_0x4391f2[_0x53ac0f(0x3f6,0x460)]=_0x4026ec['blending'];const _0x389b3d=_0x4391f2,_0x35a64b=Cesium$5['Appearance']['getDefaultRenderState'](_0x36ad8f,_0x2c88dc,_0x389b3d);return _0x35a64b;},_0x54be91=function(_0x5e2b09){const _0x1e62f4={},_0x20f43d=Cesium$5['Math'][_0x509462(0x525,0x4d3)](_0x5e2b09[_0x3f1208(0xec,0xef)],Cesium$5[_0x509462(0x573,0x52a)]['TWO_PI']),_0x18f3a6=Cesium$5['Math']['mod'](_0x5e2b09['east'],Cesium$5[_0x509462(0x573,0x501)][_0x509462(0x4f1,0x4e8)]),_0x31346f=_0x5e2b09['width'];let _0xd45f5,_0x460304;_0x31346f>Cesium$5[_0x509462(0x573,0x59b)]['THREE_PI_OVER_TWO']?(_0xd45f5=0x0,_0x460304=Cesium$5[_0x509462(0x573,0x599)][_0x3f1208(0x105,0x98)]):_0x18f3a6-_0x20f43d<_0x31346f?(_0xd45f5=_0x20f43d,_0x460304=_0x20f43d+_0x31346f):(_0xd45f5=_0x20f43d,_0x460304=_0x18f3a6);_0x1e62f4[_0x509462(0x498,0x47b)]={'min':Cesium$5['Math'][_0x3f1208(0xdf,0x7e)](_0xd45f5),'max':Cesium$5['Math']['toDegrees'](_0x460304)};function _0x509462(_0x16f4e3,_0x409de8){return _0x3e17(_0x16f4e3-0x2ba,_0x409de8);}const _0x113841=_0x5e2b09['south'],_0x24ffec=_0x5e2b09['north'],_0x11110d=_0x5e2b09[_0x509462(0x56f,0x522)],_0x29ed89=_0x11110d>Cesium$5['Math']['PI']/0xc?_0x11110d/0x2:0x0;let _0x451895=Cesium$5[_0x3f1208(0x187,0x11a)]['clampToLatitudeRange'](_0x113841-_0x29ed89),_0x35aaee=Cesium$5['Math']['clampToLatitudeRange'](_0x24ffec+_0x29ed89);function _0x3f1208(_0x4a694b,_0x175fb4){return _0x3e17(_0x4a694b- -0x132,_0x175fb4);}return _0x451895<-Cesium$5[_0x3f1208(0x187,0x1c0)]['PI_OVER_THREE']&&(_0x451895=-Cesium$5['Math'][_0x509462(0x511,0x49b)]),_0x35aaee>Cesium$5['Math'][_0x3f1208(0x10c,0x138)]&&(_0x35aaee=Cesium$5['Math']['PI_OVER_TWO']),_0x1e62f4[_0x509462(0x4ee,0x53c)]={'min':Cesium$5['Math'][_0x3f1208(0xdf,0x15f)](_0x451895),'max':Cesium$5['Math'][_0x509462(0x4cb,0x4d3)](_0x35aaee)},_0x1e62f4;},_0x56115f={};_0x56115f['getFullscreenQuad']=_0x474e2c;function _0x4b984c(_0x48250f,_0x1778a0){return _0x27456a(_0x48250f- -0x3a9,_0x1778a0);}_0x56115f[_0x4b984c(0x1f9,0x181)]=_0x337490;function _0x257190(_0x29c988,_0x1677ed){return _0x688102(_0x1677ed,_0x29c988- -0x126);}return _0x56115f[_0x4b984c(0x1a3,0x227)]=_0x5560f0,_0x56115f['createRawRenderState']=_0x3dc873,_0x56115f[_0x257190(0x34d,0x393)]=_0x54be91,_0x56115f;}());var fullscreenVert='#version\x20300\x20es\x0a\x0ain\x20vec3\x20position;\x0ain\x20vec2\x20st;\x0a\x0aout\x20vec2\x20textureCoordinate;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20textureCoordinate\x20=\x20st;\x0a\x20\x20gl_Position\x20=\x20vec4(position,\x201.0f);\x0a}\x0a';function _0x688102(_0x190bbb,_0x42730b){return _0x3e17(_0x42730b-0x234,_0x190bbb);}var screenDrawFrag='#version\x20300\x20es\x0a\x0auniform\x20sampler2D\x20trailsColorTexture;\x0auniform\x20sampler2D\x20trailsDepthTexture;\x0a\x0ain\x20vec2\x20textureCoordinate;\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20vec4\x20trailsColor\x20=\x20texture(trailsColorTexture,\x20textureCoordinate);\x0a\x20\x20float\x20trailsDepth\x20=\x20texture(trailsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20float\x20globeDepth\x20=\x20czm_unpackDepth(texture(czm_globeDepthTexture,\x20textureCoordinate));\x0a\x0a\x20\x20if(trailsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20trailsColor;\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(0.0f);\x0a\x20\x20}\x0a}\x0a';function _0x27456a(_0x20bfe5,_0xd282aa){return _0x3e17(_0x20bfe5-0x32a,_0xd282aa);}var segmentDrawFrag='#version\x20300\x20es\x0a\x0auniform\x20sampler2D\x20colorTable;\x0auniform\x20bool\x20colour;\x0a\x0ain\x20float\x20heightNormalization;\x0ain\x20float\x20speedNormalization;\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20const\x20float\x20zero\x20=\x200.0f;\x0a\x20\x20if(speedNormalization\x20>\x20zero)\x20{\x0a\x20\x20\x20\x20if(colour)\x20{\x0a\x20\x20\x20\x20\x20\x20fragColor\x20=\x20texture(colorTable,\x20vec2(heightNormalization,\x20zero));\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20fragColor\x20=\x20texture(colorTable,\x20vec2(speedNormalization,\x20zero));\x0a\x20\x20\x20\x20}\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(zero);\x0a\x20\x20}\x0a}\x0a',segmentDrawVert='#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0ain\x20vec2\x20st;\x0a//\x20it\x20is\x20not\x20normal\x20itself,\x20but\x20used\x20to\x20control\x20lines\x20drawing\x0ain\x20vec3\x20normal;\x20//\x20(point\x20to\x20use,\x20offset\x20sign,\x20not\x20used\x20component)\x0auniform\x20vec2\x20hRange;\x0auniform\x20vec2\x20uSpeedRange;\x20//\x20(min,\x20max);\x0auniform\x20vec2\x20vSpeedRange;\x0auniform\x20vec2\x20wSpeedRange;\x0a\x0auniform\x20sampler2D\x20previousParticlesPosition;\x0auniform\x20sampler2D\x20currentParticlesPosition;\x0auniform\x20sampler2D\x20postProcessingPosition;\x0auniform\x20sampler2D\x20particlesSpeed;\x0a\x0auniform\x20float\x20particleHeight;\x0a\x0auniform\x20float\x20aspect;\x0auniform\x20float\x20pixelSize;\x0auniform\x20float\x20lineWidth;\x0a\x0astruct\x20adjacentPoints\x20{\x0a\x20\x20vec4\x20previous;\x0a\x20\x20vec4\x20current;\x0a\x20\x20vec4\x20next;\x0a};\x0a\x0aout\x20float\x20heightNormalization;\x0aout\x20float\x20speedNormalization;\x0avec3\x20convertCoordinate(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20WGS84\x20(lon,\x20lat,\x20lev)\x20->\x20ECEF\x20(x,\x20y,\x20z)\x0a\x20\x20\x20\x20//\x20read\x20https://en.wikipedia.org/wiki/Geographic_coordinate_conversion#From_geodetic_to_ECEF_coordinates\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20WGS\x2084\x20geometric\x20constants\x0a\x20\x20float\x20a\x20=\x206378137.0f;\x20//\x20Semi-major\x20axis\x0a\x20\x20float\x20b\x20=\x206356752.3142f;\x20//\x20Semi-minor\x20axis\x0a\x20\x20float\x20e2\x20=\x206.69437999014e-3f;\x20//\x20First\x20eccentricity\x20squared\x0a\x0a\x20\x20float\x20latitude\x20=\x20radians(lonLatLev.y);\x0a\x20\x20float\x20longitude\x20=\x20radians(lonLatLev.x);\x0a\x0a\x20\x20float\x20cosLat\x20=\x20cos(latitude);\x0a\x20\x20float\x20sinLat\x20=\x20sin(latitude);\x0a\x20\x20float\x20cosLon\x20=\x20cos(longitude);\x0a\x20\x20float\x20sinLon\x20=\x20sin(longitude);\x0a\x0a\x20\x20float\x20N_Phi\x20=\x20a\x20/\x20sqrt(1.0f\x20-\x20e2\x20*\x20sinLat\x20*\x20sinLat);\x0a\x20\x20float\x20h\x20=\x20particleHeight\x20+\x20lonLatLev.z;\x20//\x20it\x20should\x20be\x20high\x20enough\x20otherwise\x20the\x20particle\x20may\x20not\x20pass\x20the\x20terrain\x20depth\x20test\x0a\x20\x20vec3\x20cartesian\x20=\x20vec3(0.0f);\x0a\x20\x20cartesian.x\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20cosLon;\x0a\x20\x20cartesian.y\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20sinLon;\x0a\x20\x20cartesian.z\x20=\x20((b\x20*\x20b)\x20/\x20(a\x20*\x20a)\x20*\x20N_Phi\x20+\x20h)\x20*\x20sinLat;\x0a\x20\x20return\x20cartesian;\x0a}\x0a\x0avec4\x20calculateProjectedCoordinate(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20the\x20range\x20of\x20longitude\x20in\x20Cesium\x20is\x20[-180,\x20180]\x20but\x20the\x20range\x20of\x20longitude\x20in\x20the\x20NetCDF\x20file\x20is\x20[0,\x20360]\x0a\x20\x20\x20\x20//\x20[0,\x20180]\x20is\x20corresponding\x20to\x20[0,\x20180]\x20and\x20[180,\x20360]\x20is\x20corresponding\x20to\x20[-180,\x200]\x0a\x20\x20lonLatLev.x\x20=\x20mod(lonLatLev.x\x20+\x20180.0f,\x20360.0f)\x20-\x20180.0f;\x0a\x20\x20vec3\x20particlePosition\x20=\x20convertCoordinate(lonLatLev);\x0a\x20\x20vec4\x20projectedCoordinate\x20=\x20czm_modelViewProjection\x20*\x20vec4(particlePosition,\x201.0f);\x0a\x20\x20return\x20projectedCoordinate;\x0a}\x0a\x0avec4\x20calculateOffsetOnNormalDirection(vec4\x20pointA,\x20vec4\x20pointB,\x20float\x20offsetSign)\x20{\x0a\x20\x20vec2\x20aspectVec2\x20=\x20vec2(aspect,\x201.0f);\x0a\x20\x20vec2\x20pointA_XY\x20=\x20(pointA.xy\x20/\x20pointA.w)\x20*\x20aspectVec2;\x0a\x20\x20vec2\x20pointB_XY\x20=\x20(pointB.xy\x20/\x20pointB.w)\x20*\x20aspectVec2;\x0a\x0a\x20\x20float\x20offsetLength\x20=\x20lineWidth\x20/\x202.0f;\x0a\x20\x20vec2\x20direction\x20=\x20normalize(pointB_XY\x20-\x20pointA_XY);\x0a\x20\x20vec2\x20normalVector\x20=\x20vec2(-direction.y,\x20direction.x);\x0a\x20\x20normalVector.x\x20=\x20normalVector.x\x20/\x20aspect;\x0a\x20\x20normalVector\x20=\x20offsetLength\x20*\x20normalVector;\x0a\x0a\x20\x20vec4\x20offset\x20=\x20vec4(offsetSign\x20*\x20normalVector,\x200.0f,\x200.0f);\x0a\x20\x20return\x20offset;\x0a}\x0a\x0afloat\x20calculateWindNorm(vec3\x20speed)\x20{\x0a\x20\x20vec3\x20percent\x20=\x20vec3(0.0f);\x0a\x20\x20percent.x\x20=\x20(speed.x\x20-\x20uSpeedRange.x)\x20/\x20(uSpeedRange.y\x20-\x20uSpeedRange.x);\x0a\x20\x20percent.y\x20=\x20(speed.y\x20-\x20vSpeedRange.x)\x20/\x20(vSpeedRange.y\x20-\x20vSpeedRange.x);\x0a\x20\x20if(wSpeedRange.y\x20==\x20wSpeedRange.x)\x20{\x0a\x20\x20\x20\x20percent.z\x20=\x200.0f;\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20percent.z\x20=\x20(speed.z\x20-\x20wSpeedRange.x)\x20/\x20(wSpeedRange.y\x20-\x20wSpeedRange.x);\x0a\x20\x20}\x0a\x20\x20float\x20norm\x20=\x20length(percent);\x0a\x0a\x20\x20return\x20norm;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20vec2\x20particleIndex\x20=\x20st;\x0a\x0a\x20\x20vec3\x20previousPosition\x20=\x20texture(previousParticlesPosition,\x20particleIndex).rgb;\x0a\x20\x20vec3\x20currentPosition\x20=\x20texture(currentParticlesPosition,\x20particleIndex).rgb;\x0a\x20\x20vec3\x20nextPosition\x20=\x20texture(postProcessingPosition,\x20particleIndex).rgb;\x0a\x0a\x20\x20float\x20isAnyRandomPointUsed\x20=\x20texture(postProcessingPosition,\x20particleIndex).a\x20+\x0a\x20\x20\x20\x20texture(currentParticlesPosition,\x20particleIndex).a\x20+\x0a\x20\x20\x20\x20texture(previousParticlesPosition,\x20particleIndex).a;\x0a\x0a\x20\x20adjacentPoints\x20projectedCoordinates;\x0a\x20\x20if(isAnyRandomPointUsed\x20>\x200.0f)\x20{\x0a\x20\x20\x20\x20projectedCoordinates.previous\x20=\x20calculateProjectedCoordinate(previousPosition);\x0a\x20\x20\x20\x20projectedCoordinates.current\x20=\x20projectedCoordinates.previous;\x0a\x20\x20\x20\x20projectedCoordinates.next\x20=\x20projectedCoordinates.previous;\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20projectedCoordinates.previous\x20=\x20calculateProjectedCoordinate(previousPosition);\x0a\x20\x20\x20\x20projectedCoordinates.current\x20=\x20calculateProjectedCoordinate(currentPosition);\x0a\x20\x20\x20\x20projectedCoordinates.next\x20=\x20calculateProjectedCoordinate(nextPosition);\x0a\x20\x20}\x0a\x0a\x20\x20int\x20pointToUse\x20=\x20int(normal.x);\x0a\x20\x20float\x20offsetSign\x20=\x20normal.y;\x0a\x20\x20vec4\x20offset\x20=\x20vec4(0.0f);\x0a\x20\x20\x20\x20//\x20render\x20lines\x20with\x20triangles\x20and\x20miter\x20joint\x0a\x20\x20\x20\x20//\x20read\x20https://blog.scottlogic.com/2019/11/18/drawing-lines-with-webgl.html\x20for\x20detail\x0a\x20\x20if(pointToUse\x20==\x20-1)\x20{\x0a\x20\x20\x20\x20offset\x20=\x20pixelSize\x20*\x20calculateOffsetOnNormalDirection(projectedCoordinates.previous,\x20projectedCoordinates.current,\x20offsetSign);\x0a\x20\x20\x20\x20gl_Position\x20=\x20projectedCoordinates.previous\x20+\x20offset;\x0a\x20\x20}\x20else\x20if(pointToUse\x20==\x201)\x20{\x0a\x20\x20\x20\x20offset\x20=\x20pixelSize\x20*\x20calculateOffsetOnNormalDirection(projectedCoordinates.current,\x20projectedCoordinates.next,\x20offsetSign);\x0a\x20\x20\x20\x20gl_Position\x20=\x20projectedCoordinates.next\x20+\x20offset;\x0a\x20\x20}\x0a\x0a\x20\x20heightNormalization\x20=\x20(currentPosition.z\x20-\x20hRange.x)\x20/\x20(hRange.y\x20-\x20hRange.x);\x0a\x0a\x20\x20speedNormalization\x20=\x20texture(particlesSpeed,\x20particleIndex).a;\x0a}\x0a',trailDrawFrag='#version\x20300\x20es\x0a\x0aprecision\x20highp\x20float;\x0a\x0ain\x20vec2\x20textureCoordinate;\x0a\x0auniform\x20sampler2D\x20segmentsColorTexture;\x0auniform\x20sampler2D\x20segmentsDepthTexture;\x0a\x0auniform\x20sampler2D\x20currentTrailsColor;\x0auniform\x20sampler2D\x20trailsDepthTexture;\x0a\x0auniform\x20float\x20fadeOpacity;\x0a\x0aout\x20vec4\x20fragColor;\x0avoid\x20main()\x20{\x0a\x20\x20vec4\x20pointsColor\x20=\x20texture(segmentsColorTexture,\x20textureCoordinate);\x0a\x20\x20vec4\x20trailsColor\x20=\x20texture(currentTrailsColor,\x20textureCoordinate);\x0a\x20\x20trailsColor\x20=\x20floor(fadeOpacity\x20*\x20255.0f\x20*\x20trailsColor)\x20/\x20255.0f;\x20//\x20make\x20sure\x20the\x20trailsColor\x20will\x20be\x20strictly\x20decreased\x0a\x0a\x20\x20float\x20pointsDepth\x20=\x20texture(segmentsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20float\x20trailsDepth\x20=\x20texture(trailsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20float\x20globeDepth\x20=\x20czm_unpackDepth(texture(czm_globeDepthTexture,\x20textureCoordinate));\x0a\x20\x20fragColor\x20=\x20vec4(0.0f);\x0a\x20\x20if(pointsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20fragColor\x20+\x20pointsColor;\x0a\x20\x20}\x0a\x20\x20if(trailsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20fragColor\x20+\x20trailsColor;\x0a\x20\x20}\x0a\x20\x20gl_FragDepth\x20=\x20min(pointsDepth,\x20trailsDepth);\x0a}\x0a';const Cesium$4=mars3d__namespace['Cesium'];class ParticlesRendering{constructor(_0x3a6a92,_0xd2b518,_0x54ae25,_0x3e6176,_0x139c2f){function _0x12a2c6(_0x580319,_0x29d5de){return _0x688102(_0x29d5de,_0x580319- -0x4b2);}this[_0x5d011f(0xb9,0x10e)]=_0x54ae25['colors']===_0x5d011f(0x172,0x191),this['createRenderingTextures'](_0x3a6a92,_0xd2b518,_0x54ae25[_0x5d011f(0x16e,0x130)]);function _0x5d011f(_0x4d096e,_0x20b443){return _0x688102(_0x20b443,_0x4d096e- -0x377);}this['createRenderingFramebuffers'](_0x3a6a92),this[_0x5d011f(0x12c,0x151)](_0x3a6a92,_0xd2b518,_0x54ae25,_0x3e6176,_0x139c2f);}['createRenderingTextures'](_0x54b62b,_0x3c76fd,_0x119153){function _0x480fba(_0x339267,_0x5604a8){return _0x27456a(_0x5604a8- -0x368,_0x339267);}const _0x8e3758={};_0x8e3758[_0x5dddd6(0x82,0x13)]=_0x54b62b,_0x8e3758[_0x5dddd6(-0x2c,-0x6b)]=_0x54b62b['drawingBufferWidth'],_0x8e3758['height']=_0x54b62b['drawingBufferHeight'],_0x8e3758[_0x5dddd6(-0x9,0x62)]=Cesium$4['PixelFormat']['RGBA'],_0x8e3758[_0x5dddd6(-0x64,-0x67)]=Cesium$4['PixelDatatype'][_0x5dddd6(-0x29,0x1d)];const _0x767a61=_0x8e3758,_0x5b2a3a={};function _0x5dddd6(_0x126a8c,_0x50c574){return _0x688102(_0x126a8c,_0x50c574- -0x492);}_0x5b2a3a[_0x480fba(0x21e,0x233)]=_0x54b62b,_0x5b2a3a[_0x5dddd6(-0x19,-0x6b)]=_0x54b62b[_0x5dddd6(-0x37,-0x6a)],_0x5b2a3a[_0x5dddd6(0x6b,0x57)]=_0x54b62b['drawingBufferHeight'],_0x5b2a3a['pixelFormat']=Cesium$4['PixelFormat'][_0x5dddd6(-0x28,-0xb)],_0x5b2a3a[_0x5dddd6(-0x7d,-0x67)]=Cesium$4[_0x5dddd6(-0x20,0x3)][_0x5dddd6(0xb9,0x7e)];const _0x3088f6=_0x5b2a3a,_0x52e822=_0x119153['length'],_0x2e7383=new Float32Array(_0x52e822*0x3);for(let _0x131b73=0x0;_0x131b73<_0x52e822;_0x131b73++){const _0x1682f6=Cesium$4['Color']['fromCssColorString'](_0x119153[_0x131b73]);_0x2e7383[0x3*_0x131b73]=_0x1682f6['red'],_0x2e7383[0x3*_0x131b73+0x1]=_0x1682f6['green'],_0x2e7383[0x3*_0x131b73+0x2]=_0x1682f6['blue'];}const _0x1248ca={'context':_0x54b62b,'width':_0x52e822,'height':0x1,'pixelFormat':Cesium$4['PixelFormat']['RGB'],'pixelDatatype':Cesium$4['PixelDatatype']['FLOAT'],'sampler':new Cesium$4['Sampler']({'minificationFilter':Cesium$4[_0x480fba(0x22d,0x225)]['LINEAR'],'magnificationFilter':Cesium$4['TextureMagnificationFilter']['LINEAR']})};this['textures']={'segmentsColor':Util['createTexture'](_0x767a61),'segmentsDepth':Util[_0x5dddd6(-0x65,0x1a)](_0x3088f6),'currentTrailsColor':Util['createTexture'](_0x767a61),'currentTrailsDepth':Util['createTexture'](_0x3088f6),'nextTrailsColor':Util[_0x5dddd6(0x37,0x1a)](_0x767a61),'nextTrailsDepth':Util[_0x480fba(0x21a,0x23a)](_0x3088f6),'colorTable':Util['createTexture'](_0x1248ca,_0x2e7383)};}['createRenderingFramebuffers'](_0x48e37b){function _0x5b54ab(_0x4c7f51,_0x5a1261){return _0x688102(_0x5a1261,_0x4c7f51- -0x2e6);}function _0x4692e7(_0x28f851,_0x5f213a){return _0x688102(_0x5f213a,_0x28f851- -0x110);}this['framebuffers']={'segments':Util[_0x4692e7(0x346,0x36f)](_0x48e37b,this[_0x4692e7(0x374,0x2fe)]['segmentsColor'],this['textures']['segmentsDepth']),'currentTrails':Util[_0x4692e7(0x346,0x363)](_0x48e37b,this['textures']['currentTrailsColor'],this[_0x4692e7(0x374,0x3c8)]['currentTrailsDepth']),'nextTrails':Util['createFramebuffer'](_0x48e37b,this[_0x4692e7(0x374,0x3cb)][_0x5b54ab(0x238,0x1e4)],this['textures']['nextTrailsDepth'])};}['createSegmentsGeometry'](_0x5d27f8){function _0x252db8(_0x16ab93,_0x1f2f49){return _0x688102(_0x16ab93,_0x1f2f49-0x43);}const _0x3bf9e4=0x4;let _0x591468=[];for(let _0x49f553=0x0;_0x49f553<_0x5d27f8['particlesTextureSize'];_0x49f553++){for(let _0x11fcc9=0x0;_0x11fcc9<_0x5d27f8[_0x4bd911(0x4cb,0x4f5)];_0x11fcc9++){for(let _0x1c7db0=0x0;_0x1c7db0<_0x3bf9e4;_0x1c7db0++){_0x591468['push'](_0x49f553/_0x5d27f8['particlesTextureSize']),_0x591468[_0x4bd911(0x4eb,0x4c2)](_0x11fcc9/_0x5d27f8[_0x4bd911(0x4cb,0x48d)]);}}}function _0x4bd911(_0x3a1e3c,_0x53937e){return _0x688102(_0x53937e,_0x3a1e3c-0x2a);}_0x591468=new Float32Array(_0x591468);let _0x13d7d6=[];for(let _0xaff3c7=0x0;_0xaff3c7<_0x5d27f8['maxParticles'];_0xaff3c7++){_0x13d7d6['push'](-0x1,-0x1,0x0,-0x1,0x1,0x0,0x1,-0x1,0x0,0x1,0x1,0x0);}_0x13d7d6=new Float32Array(_0x13d7d6);let _0x446356=[];for(let _0xad0e9b=0x0,_0x4a71fa=0x0;_0xad0e9b<_0x5d27f8[_0x252db8(0x53a,0x4c5)];_0xad0e9b++){_0x446356[_0x252db8(0x479,0x504)](_0x4a71fa+0x0,_0x4a71fa+0x1,_0x4a71fa+0x2,_0x4a71fa+0x2,_0x4a71fa+0x1,_0x4a71fa+0x3),_0x4a71fa+=_0x3bf9e4;}_0x446356=new Uint32Array(_0x446356);const _0x1eae86=new Cesium$4['Geometry']({'attributes':new Cesium$4['GeometryAttributes']({'st':new Cesium$4[(_0x252db8(0x488,0x4c1))]({'componentDatatype':Cesium$4[_0x4bd911(0x4f0,0x475)]['FLOAT'],'componentsPerAttribute':0x2,'values':_0x591468}),'normal':new Cesium$4['GeometryAttribute']({'componentDatatype':Cesium$4[_0x252db8(0x58b,0x509)]['FLOAT'],'componentsPerAttribute':0x3,'values':_0x13d7d6})}),'indices':_0x446356});return _0x1eae86;}['createRenderingPrimitives'](_0x1f63b6,_0x3473f4,_0x949b6c,_0x1407a3,_0x51aae8){const _0x5f2746=this,_0x1ab97c={};_0x1ab97c['st']=0x0,_0x1ab97c['normal']=0x1;const _0x45f81d={};_0x45f81d['sources']=[segmentDrawVert];const _0xff904a={};_0xff904a[_0x539cb8(-0x155,-0x18d)]=[segmentDrawFrag];const _0x29463b={};_0x29463b[_0x48591f(0x4f6,0x531)]=!![];const _0x594649={};_0x594649['viewport']=undefined,_0x594649[_0x48591f(0x44b,0x417)]=_0x29463b,_0x594649[_0x539cb8(-0x185,-0x1da)]=!![];const _0x4b7b5d={};_0x4b7b5d['position']=0x0,_0x4b7b5d['st']=0x1;const _0x1868cd={};_0x1868cd['defines']=[_0x539cb8(-0x188,-0x102)],_0x1868cd['sources']=[fullscreenVert];const _0x5596dc={};_0x5596dc['defines']=['DISABLE_LOG_DEPTH_FRAGMENT_WRITE'],_0x5596dc[_0x48591f(0x444,0x491)]=[trailDrawFrag];const _0x45b88e={};_0x45b88e[_0x48591f(0x44e,0x3c8)]=0x0,_0x45b88e['st']=0x1;const _0x5458c7={};_0x5458c7['defines']=[_0x539cb8(-0x188,-0x18b)],_0x5458c7[_0x539cb8(-0x155,-0x146)]=[fullscreenVert];const _0x40ea90={};function _0x539cb8(_0x26bc99,_0x242aa3){return _0x688102(_0x242aa3,_0x26bc99- -0x5a2);}_0x40ea90['defines']=['DISABLE_LOG_DEPTH_FRAGMENT_WRITE'],_0x40ea90[_0x539cb8(-0x155,-0x160)]=[screenDrawFrag];function _0x48591f(_0x57ba6b,_0x44a890){return _0x27456a(_0x57ba6b- -0xff,_0x44a890);}const _0x14dfb8={};_0x14dfb8['enabled']=![];const _0x1daf8e={};_0x1daf8e['enabled']=!![],this[_0x48591f(0x441,0x4ad)]={'segments':new CustomPrimitive({'commandType':_0x48591f(0x4d8,0x55f),'attributeLocations':_0x1ab97c,'geometry':this['createSegmentsGeometry'](_0x949b6c),'primitiveType':Cesium$4[_0x48591f(0x4df,0x52d)][_0x48591f(0x504,0x57a)],'uniformMap':{'previousParticlesPosition':function(){function _0x5999e3(_0x2a7a11,_0x3a1a20){return _0x48591f(_0x3a1a20- -0x37a,_0x2a7a11);}return _0x51aae8[_0x5999e3(0x1a8,0x127)]['previousParticlesPosition'];},'currentParticlesPosition':function(){function _0x2c5443(_0x1c8914,_0x389c83){return _0x48591f(_0x389c83- -0x3a1,_0x1c8914);}function _0x4c4713(_0x3bbaaa,_0x186995){return _0x48591f(_0x3bbaaa-0x162,_0x186995);}return _0x51aae8[_0x2c5443(0xd1,0x100)][_0x2c5443(0xb0,0x115)];},'postProcessingPosition':function(){return _0x51aae8['particlesTextures']['postProcessingPosition'];},'particlesSpeed':function(){function _0x3e5079(_0x3ea417,_0x89dcdd){return _0x48591f(_0x3ea417- -0x309,_0x89dcdd);}return _0x51aae8['particlesTextures'][_0x3e5079(0x18a,0x164)];},'colorTable':function(){function _0x3c0c05(_0x2a9781,_0x456b4e){return _0x539cb8(_0x2a9781-0x22,_0x456b4e);}return _0x5f2746[_0x3c0c05(-0xfc,-0xa1)]['colorTable'];},'aspect':function(){function _0x2b5a61(_0x34b532,_0x746b95){return _0x48591f(_0x34b532- -0x80,_0x746b95);}return _0x1f63b6[_0x2b5a61(0x39f,0x3f2)]/_0x1f63b6['drawingBufferHeight'];},'H':function(){function _0x19d91c(_0x50044d,_0x2e2284){return _0x539cb8(_0x2e2284-0xaa,_0x50044d);}return _0x3473f4['H'][_0x19d91c(0x91,0x14)];},'hRange':function(){return new Cesium$4['Cartesian2'](_0x3473f4['H']['min'],_0x3473f4['H']['max']);},'uSpeedRange':function(){function _0x44c356(_0x54ab40,_0x48ca0a){return _0x539cb8(_0x48ca0a-0x340,_0x54ab40);}return new Cesium$4[(_0x44c356(0x2e8,0x270))](_0x3473f4['U']['min'],_0x3473f4['U']['max']);},'vSpeedRange':function(){return new Cesium$4['Cartesian2'](_0x3473f4['V']['min'],_0x3473f4['V']['max']);},'wSpeedRange':function(){return new Cesium$4['Cartesian2'](_0x3473f4['W']['min'],_0x3473f4['W']['max']);},'pixelSize':function(){return _0x1407a3['pixelSize'];},'lineWidth':function(){return _0x949b6c['lineWidth'];},'particleHeight':function(){return _0x949b6c['particleHeight'];},'colour':function(){function _0x5de877(_0x3924bc,_0x4984e7){return _0x539cb8(_0x4984e7-0x1f,_0x3924bc);}return _0x5f2746[_0x5de877(-0x1dd,-0x153)];}},'vertexShaderSource':new Cesium$4[(_0x48591f(0x4a2,0x4ce))](_0x45f81d),'fragmentShaderSource':new Cesium$4['ShaderSource'](_0xff904a),'rawRenderState':Util[_0x539cb8(-0x18c,-0x1ad)](_0x594649),'framebuffer':this[_0x539cb8(-0x14a,-0xd3)]['segments'],'autoClear':!![]}),'trails':new CustomPrimitive({'commandType':'Draw','attributeLocations':_0x4b7b5d,'geometry':Util[_0x48591f(0x4c7,0x53b)](),'primitiveType':Cesium$4[_0x48591f(0x4df,0x4bf)][_0x48591f(0x504,0x523)],'uniformMap':{'segmentsColorTexture':function(){return _0x5f2746['textures']['segmentsColor'];},'segmentsDepthTexture':function(){return _0x5f2746['textures']['segmentsDepth'];},'currentTrailsColor':function(){function _0xb0459c(_0x2ab707,_0x596255){return _0x48591f(_0x596255- -0x45d,_0x2ab707);}function _0xc8e64e(_0x53d3e3,_0x2e73c5){return _0x539cb8(_0x53d3e3-0x412,_0x2e73c5);}return _0x5f2746[_0xc8e64e(0x2c8,0x2ef)][_0xc8e64e(0x2d1,0x28a)][_0xb0459c(-0x38,-0x2)](0x0);},'trailsDepthTexture':function(){function _0xff5f61(_0x64fdac,_0x166629){return _0x48591f(_0x64fdac- -0x60d,_0x166629);}return _0x5f2746[_0xff5f61(-0x1be,-0x1c3)]['currentTrails']['depthTexture'];},'fadeOpacity':function(){return _0x949b6c['fadeOpacity'];}},'vertexShaderSource':new Cesium$4[(_0x48591f(0x4a2,0x4c5))](_0x1868cd),'fragmentShaderSource':new Cesium$4[(_0x539cb8(-0xf7,-0xe4))](_0x5596dc),'rawRenderState':Util['createRawRenderState']({'viewport':undefined,'depthTest':{'enabled':!![],'func':Cesium$4[_0x48591f(0x41b,0x48a)]['ALWAYS']},'depthMask':!![]}),'framebuffer':this[_0x539cb8(-0x14a,-0x17c)]['nextTrails'],'autoClear':!![],'preExecute':function(){if(_0x949b6c['dynamic']){const _0x3db6c2=_0x5f2746['framebuffers'][_0x569251(0x2d7,0x29d)];_0x5f2746['framebuffers']['currentTrails']=_0x5f2746['framebuffers']['nextTrails'],_0x5f2746[_0x1d8520(0x30e,0x2b7)][_0x569251(0x379,0x3e0)]=_0x3db6c2;}function _0x1d8520(_0xcf697,_0x54b263){return _0x539cb8(_0x54b263-0x401,_0xcf697);}_0x5f2746[_0x1d8520(0x2ed,0x2a9)][_0x1d8520(0x2ee,0x332)]['commandToExecute']['framebuffer']=_0x5f2746[_0x1d8520(0x257,0x2b7)][_0x1d8520(0x359,0x362)];function _0x569251(_0x488fcd,_0x1b69f8){return _0x48591f(_0x488fcd- -0x181,_0x1b69f8);}_0x5f2746[_0x569251(0x2c0,0x33d)]['trails']['clearCommand']['framebuffer']=_0x5f2746['framebuffers']['nextTrails'];}}),'screen':new CustomPrimitive({'commandType':_0x48591f(0x4d8,0x55c),'attributeLocations':_0x45b88e,'geometry':Util[_0x48591f(0x4c7,0x511)](),'primitiveType':Cesium$4['PrimitiveType']['TRIANGLES'],'uniformMap':{'trailsColorTexture':function(){function _0x421b5c(_0x408023,_0x54357a){return _0x539cb8(_0x408023-0x420,_0x54357a);}return _0x5f2746['framebuffers']['nextTrails'][_0x421b5c(0x2e2,0x2ab)](0x0);},'trailsDepthTexture':function(){function _0x195953(_0x57b02e,_0x15b2c4){return _0x48591f(_0x57b02e- -0x109,_0x15b2c4);}return _0x5f2746[_0x195953(0x346,0x2db)]['nextTrails']['depthTexture'];}},'vertexShaderSource':new Cesium$4['ShaderSource'](_0x5458c7),'fragmentShaderSource':new Cesium$4['ShaderSource'](_0x40ea90),'rawRenderState':Util['createRawRenderState']({'viewport':undefined,'depthTest':_0x14dfb8,'depthMask':!![],'blending':_0x1daf8e}),'framebuffer':undefined})};}}var CalculateSpeedShader='#version\x20300\x20es\x0a\x0a//\x20the\x20size\x20of\x20UV\x20textures:\x20width\x20=\x20lon,\x20height\x20=\x20lat*lev\x0auniform\x20sampler2D\x20U;\x20//\x20eastward\x20wind\x0auniform\x20sampler2D\x20V;\x20//\x20northward\x20wind\x0auniform\x20sampler2D\x20W;\x20//\x20upward\x20wind\x0auniform\x20sampler2D\x20currentParticlesPosition;\x20//\x20(lon,\x20lat,\x20lev)\x0a\x0auniform\x20vec3\x20dimension;\x20//\x20(lon,\x20lat,\x20lev)\x0auniform\x20vec3\x20minimum;\x20//\x20minimum\x20of\x20each\x20dimension\x0auniform\x20vec3\x20maximum;\x20//\x20maximum\x20of\x20each\x20dimension\x0auniform\x20vec3\x20interval;\x20//\x20interval\x20of\x20each\x20dimension\x0a\x0a//\x20used\x20to\x20calculate\x20the\x20wind\x20norm\x0auniform\x20vec2\x20uSpeedRange;\x20//\x20(min,\x20max);\x0auniform\x20vec2\x20vSpeedRange;\x0auniform\x20vec2\x20wSpeedRange;\x0auniform\x20float\x20speedScaleFactor;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avec2\x20mapPositionToNormalizedIndex2D(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20ensure\x20the\x20range\x20of\x20longitude\x20and\x20latitude\x0a\x20\x20lonLatLev.x\x20=\x20clamp(lonLatLev.x,\x20minimum.x,\x20maximum.x);\x0a\x20\x20lonLatLev.y\x20=\x20clamp(lonLatLev.y,\x20minimum.y,\x20maximum.y);\x0a\x20\x20lonLatLev.z\x20=\x20clamp(lonLatLev.z,\x20minimum.z,\x20maximum.z);\x0a\x0a\x20\x20vec3\x20index3D\x20=\x20vec3(0.0f);\x0a\x20\x20index3D.x\x20=\x20(lonLatLev.x\x20-\x20minimum.x)\x20/\x20interval.x;\x0a\x20\x20index3D.y\x20=\x20(lonLatLev.y\x20-\x20minimum.y)\x20/\x20interval.y;\x0a\x20\x20\x20\x20//\x20map\x20the\x20z-axis\x20value\x20to\x20the\x20nearest\x20bit\x20plane\x20to\x20ensure\x20that\x20the\x20result\x20is\x20an\x20integer\x0a\x20\x20index3D.z\x20=\x20ceil((lonLatLev.z\x20-\x20minimum.z)\x20/\x20interval.z);\x0a\x0a\x20\x20\x20\x20//\x20the\x20st\x20texture\x20coordinate\x20corresponding\x20to\x20(col,\x20row)\x20index\x0a\x20\x20\x20\x20//\x20example\x0a\x20\x20\x20\x20//\x20data\x20array\x20is\x20[0,\x201,\x202,\x203,\x204,\x205,\x207,\x208,\x209],\x20width\x20=\x202,\x20height\x20=\x202,\x20level\x20=\x202\x0a\x20\x20\x20\x20//\x20the\x20content\x20of\x20texture\x20will\x20be\x0a\x20\x20\x20\x20//\x20t\x201.0\x0a\x20\x20\x20\x20//\x20\x20\x20\x20|\x20\x206\x207\x0a\x20\x20\x20\x20//\x20\x20\x20\x20|\x20\x204\x205\x0a\x20\x20\x20\x20//\x20\x20\x20\x20|\x20\x202\x203\x0a\x20\x20\x20\x20//\x20\x20\x20\x20|\x20\x200\x201\x0a\x20\x20\x20\x20//\x20\x20\x200.0------1.0\x20s\x0a\x0a\x20\x20vec2\x20index2D\x20=\x20vec2(index3D.x,\x20index3D.z\x20*\x20dimension.y\x20+\x20index3D.y);\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20vec2(index2D.x\x20/\x20dimension.x,\x20index2D.y\x20/\x20(dimension.y\x20*\x20dimension.z));\x0a\x20\x20return\x20normalizedIndex2D;\x0a}\x0a\x0afloat\x20getWindComponent(sampler2D\x20componentTexture,\x20vec3\x20lonLatLev)\x20{\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20mapPositionToNormalizedIndex2D(lonLatLev);\x0a\x20\x20float\x20result\x20=\x20texture(componentTexture,\x20normalizedIndex2D).r;\x0a\x20\x20return\x20result;\x0a}\x0a\x0afloat\x20interpolateTexture(sampler2D\x20componentTexture,\x20vec3\x20lonLatLev)\x20{\x0a\x20\x20float\x20lon\x20=\x20lonLatLev.x;\x0a\x20\x20float\x20lat\x20=\x20lonLatLev.y;\x0a\x20\x20float\x20lev\x20=\x20lonLatLev.z;\x0a\x0a\x20\x20float\x20lon0\x20=\x20floor(lon\x20/\x20interval.x)\x20*\x20interval.x;\x0a\x20\x20float\x20lon1\x20=\x20lon0\x20+\x201.0f\x20*\x20interval.x;\x0a\x20\x20float\x20lat0\x20=\x20floor(lat\x20/\x20interval.y)\x20*\x20interval.y;\x0a\x20\x20float\x20lat1\x20=\x20lat0\x20+\x201.0f\x20*\x20interval.y;\x0a\x0a\x20\x20float\x20lon0_lat0\x20=\x20getWindComponent(componentTexture,\x20vec3(lon0,\x20lat0,\x20lev));\x0a\x20\x20float\x20lon1_lat0\x20=\x20getWindComponent(componentTexture,\x20vec3(lon1,\x20lat0,\x20lev));\x0a\x20\x20float\x20lon0_lat1\x20=\x20getWindComponent(componentTexture,\x20vec3(lon0,\x20lat1,\x20lev));\x0a\x20\x20float\x20lon1_lat1\x20=\x20getWindComponent(componentTexture,\x20vec3(lon1,\x20lat1,\x20lev));\x0a\x0a\x20\x20float\x20lon_lat0\x20=\x20mix(lon0_lat0,\x20lon1_lat0,\x20lon\x20-\x20lon0);\x0a\x20\x20float\x20lon_lat1\x20=\x20mix(lon0_lat1,\x20lon1_lat1,\x20lon\x20-\x20lon0);\x0a\x20\x20float\x20lon_lat\x20=\x20mix(lon_lat0,\x20lon_lat1,\x20lat\x20-\x20lat0);\x0a\x20\x20return\x20lon_lat;\x0a}\x0a\x0avec3\x20linearInterpolation(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20https://en.wikipedia.org/wiki/Bilinear_interpolation\x0a\x20\x20float\x20u\x20=\x20interpolateTexture(U,\x20lonLatLev);\x0a\x20\x20float\x20v\x20=\x20interpolateTexture(V,\x20lonLatLev);\x0a\x20\x20float\x20w\x20=\x20interpolateTexture(W,\x20lonLatLev);\x0a\x20\x20return\x20vec3(u,\x20v,\x20w);\x0a}\x0a\x0avec2\x20lengthOfLonLat(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20unit\x20conversion:\x20meters\x20->\x20longitude\x20latitude\x20degrees\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Geographic_coordinate_system#Length_of_a_degree\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20the\x20length\x20of\x20a\x20degree\x20of\x20latitude\x20and\x20longitude\x20in\x20meters\x0a\x20\x20float\x20latitude\x20=\x20radians(lonLatLev.y);\x0a\x0a\x20\x20float\x20term1\x20=\x20111132.92f;\x0a\x20\x20float\x20term2\x20=\x20559.82f\x20*\x20cos(2.0f\x20*\x20latitude);\x0a\x20\x20float\x20term3\x20=\x201.175f\x20*\x20cos(4.0f\x20*\x20latitude);\x0a\x20\x20float\x20term4\x20=\x200.0023f\x20*\x20cos(6.0f\x20*\x20latitude);\x0a\x20\x20float\x20latLength\x20=\x20term1\x20-\x20term2\x20+\x20term3\x20-\x20term4;\x0a\x0a\x20\x20float\x20term5\x20=\x20111412.84f\x20*\x20cos(latitude);\x0a\x20\x20float\x20term6\x20=\x2093.5f\x20*\x20cos(3.0f\x20*\x20latitude);\x0a\x20\x20float\x20term7\x20=\x200.118f\x20*\x20cos(5.0f\x20*\x20latitude);\x0a\x20\x20float\x20longLength\x20=\x20term5\x20-\x20term6\x20+\x20term7;\x0a\x0a\x20\x20return\x20vec2(longLength,\x20latLength);\x0a}\x0a\x0avec3\x20convertSpeedUnitToLonLat(vec3\x20lonLatLev,\x20vec3\x20speed)\x20{\x0a\x20\x20vec2\x20lonLatLength\x20=\x20lengthOfLonLat(lonLatLev);\x0a\x20\x20float\x20u\x20=\x20speed.x\x20/\x20lonLatLength.x;\x0a\x20\x20float\x20v\x20=\x20speed.y\x20/\x20lonLatLength.y;\x0a\x20\x20float\x20w\x20=\x20speed.z;\x0a\x20\x20vec3\x20windVectorInLonLatLev\x20=\x20vec3(u,\x20v,\x20w);\x0a\x0a\x20\x20return\x20windVectorInLonLatLev;\x0a}\x0a\x0avec3\x20calculateSpeedByRungeKutta2(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods#Second-order_methods_with_two_stages\x20for\x20detail\x0a\x20\x20const\x20float\x20h\x20=\x200.5f;\x0a\x0a\x20\x20vec3\x20y_n\x20=\x20lonLatLev;\x0a\x20\x20vec3\x20f_n\x20=\x20linearInterpolation(lonLatLev);\x0a\x20\x20vec3\x20midpoint\x20=\x20y_n\x20+\x200.5f\x20*\x20h\x20*\x20convertSpeedUnitToLonLat(y_n,\x20f_n)\x20*\x20speedScaleFactor;\x0a\x20\x20vec3\x20speed\x20=\x20h\x20*\x20linearInterpolation(midpoint)\x20*\x20speedScaleFactor;\x0a\x0a\x20\x20return\x20speed;\x0a}\x0a\x0avec2\x20getRange(vec2\x20range)\x20{\x0a\x20\x20float\x20x1\x20=\x200.0f\x20-\x20range.x;\x0a\x20\x20float\x20x2\x20=\x20range.y\x20-\x200.0f;\x0a\x20\x20if(x1\x20<\x200.0f\x20||\x20x2\x20<\x200.0f)\x20{\x0a\x20\x20\x20\x20return\x20vec2(abs(x1),\x20abs(x2));\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20return\x20vec2(0.0f,\x20abs(max(x1,\x20x2)));\x0a\x20\x20}\x0a}\x0a\x0afloat\x20calculateWindNorm(vec3\x20speed)\x20{\x0a\x20\x20vec3\x20percent\x20=\x20vec3(0.0f);\x0a\x20\x20vec2\x20uRange\x20=\x20getRange(uSpeedRange);\x0a\x20\x20vec2\x20vRange\x20=\x20getRange(vSpeedRange);\x0a\x20\x20vec2\x20wRange\x20=\x20getRange(wSpeedRange);\x0a\x20\x20if(length(speed.xyz)\x20==\x200.0f)\x20{\x0a\x20\x20\x20\x20return\x200.0f;\x0a\x20\x20}\x0a\x0a\x20\x20percent.x\x20=\x20(abs(speed.x)\x20-\x20uRange.x)\x20/\x20(uRange.y\x20-\x20uRange.x);\x0a\x20\x20percent.y\x20=\x20(abs(speed.y)\x20-\x20vRange.x)\x20/\x20(vRange.y\x20-\x20vRange.x);\x0a\x20\x20if(wSpeedRange.y\x20==\x20wSpeedRange.x)\x20{\x0a\x20\x20\x20\x20percent.z\x20=\x200.0f;\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20percent.z\x20=\x20(abs(speed.z)\x20-\x20wRange.x)\x20/\x20(wRange.y\x20-\x20wRange.x);\x0a\x20\x20}\x0a\x20\x20float\x20norm\x20=\x20length(percent);\x0a\x0a\x20\x20return\x20norm;\x0a}\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20vec3\x20lonLatLev\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rgb;\x0a\x20\x20vec3\x20speedOrigin\x20=\x20linearInterpolation(lonLatLev);\x0a\x20\x20vec3\x20speed\x20=\x20calculateSpeedByRungeKutta2(lonLatLev);\x0a\x20\x20vec3\x20speedInLonLat\x20=\x20convertSpeedUnitToLonLat(lonLatLev,\x20speed);\x0a\x0a\x20\x20vec4\x20particleSpeed\x20=\x20vec4(speedInLonLat,\x20calculateWindNorm(speed\x20/\x20speedScaleFactor));\x0a\x20\x20\x20\x20//\x20gl_FragColor\x20=\x20particleSpeed;\x0a\x20\x20fragColor\x20=\x20vec4(speedInLonLat,\x20calculateWindNorm(speedOrigin));\x0a}\x0a',PostProcessingPositionShader='#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0auniform\x20sampler2D\x20nextParticlesPosition;\x0auniform\x20sampler2D\x20particlesSpeed;\x20//\x20(u,\x20v,\x20w,\x20norm)\x0a\x0auniform\x20sampler2D\x20H;\x20//\x20particles\x20height\x20textures\x0a\x0auniform\x20vec3\x20dimension;\x20//\x20(lon,\x20lat,\x20lev)\x0auniform\x20vec3\x20minimum;\x20//\x20minimum\x20of\x20each\x20dimension\x0auniform\x20vec3\x20maximum;\x20//\x20maximum\x20of\x20each\x20dimension\x0auniform\x20vec3\x20interval;\x20//\x20interval\x20of\x20each\x20dimension\x0a\x0a//\x20range\x20(min,\x20max)\x0auniform\x20vec2\x20lonRange;\x0auniform\x20vec2\x20latRange;\x0auniform\x20vec2\x20viewerLonRange;\x0auniform\x20vec2\x20viewerLatRange;\x0a\x0aconst\x20float\x20randomCoefficient\x20=\x200.1f;\x20//\x20use\x20to\x20improve\x20the\x20pseudo-random\x20generator\x0aconst\x20float\x20dropRate\x20=\x200.1f;\x20//\x20drop\x20rate\x20is\x20a\x20chance\x20a\x20particle\x20will\x20restart\x20at\x20random\x20position\x20to\x20avoid\x20degeneration\x0aconst\x20float\x20dropRateBump\x20=\x200.1f;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avec2\x20mapPositionToNormalizedIndex2D(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20ensure\x20the\x20range\x20of\x20longitude\x20and\x20latitude\x0a\x20\x20lonLatLev.x\x20=\x20clamp(lonLatLev.x,\x20minimum.x,\x20maximum.x);\x0a\x20\x20lonLatLev.y\x20=\x20clamp(lonLatLev.y,\x20minimum.y,\x20maximum.y);\x0a\x20\x20lonLatLev.z\x20=\x20clamp(lonLatLev.z,\x20minimum.z,\x20maximum.z);\x0a\x0a\x20\x20vec3\x20index3D\x20=\x20vec3(0.0f);\x0a\x20\x20index3D.x\x20=\x20(lonLatLev.x\x20-\x20minimum.x)\x20/\x20interval.x;\x0a\x20\x20index3D.y\x20=\x20(lonLatLev.y\x20-\x20minimum.y)\x20/\x20interval.y;\x0a\x20\x20index3D.z\x20=\x20ceil((lonLatLev.z\x20-\x20minimum.z)\x20/\x20interval.z);\x0a\x0a\x20\x20vec2\x20index2D\x20=\x20vec2(index3D.x,\x20index3D.z\x20*\x20dimension.y\x20+\x20index3D.y);\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20vec2(index2D.x\x20/\x20dimension.x,\x20index2D.y\x20/\x20(dimension.y\x20*\x20dimension.z));\x0a\x20\x20return\x20normalizedIndex2D;\x0a}\x0a\x0avec4\x20getTextureValue(sampler2D\x20componentTexture,\x20vec3\x20lonLatLev)\x20{\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20mapPositionToNormalizedIndex2D(lonLatLev);\x0a\x20\x20vec4\x20result\x20=\x20texture(componentTexture,\x20normalizedIndex2D);\x0a\x20\x20return\x20result;\x0a}\x0a\x0a//\x20pseudo-random\x20generator\x0aconst\x20vec3\x20randomConstants\x20=\x20vec3(12.9898f,\x2078.233f,\x204375.85453f);\x0aconst\x20vec2\x20normalRange\x20=\x20vec2(0.0f,\x201.0f);\x0afloat\x20rand(vec2\x20seed,\x20vec2\x20range)\x20{\x0a\x20\x20vec2\x20randomSeed\x20=\x20randomCoefficient\x20*\x20seed;\x0a\x20\x20float\x20temp\x20=\x20dot(randomConstants.xy,\x20randomSeed);\x0a\x20\x20temp\x20=\x20fract(sin(temp)\x20*\x20(randomConstants.z\x20+\x20temp));\x0a\x20\x20return\x20temp\x20*\x20(range.y\x20-\x20range.x)\x20+\x20range.x;\x0a}\x0a\x0abool\x20particleNoSpeed(vec3\x20particle)\x20{\x0a\x20\x20vec4\x20speed\x20=\x20getTextureValue(particlesSpeed,\x20particle);\x0a\x20\x20return\x20speed.r\x20==\x200.0f\x20&&\x20speed.g\x20==\x200.0f;\x0a}\x0a\x0avec3\x20generateRandomParticle(vec2\x20seed,\x20float\x20lev)\x20{\x0a\x20\x20\x20\x20//\x20ensure\x20the\x20longitude\x20is\x20in\x20[0,\x20360]\x0a\x20\x20float\x20randomLon\x20=\x20mod(rand(seed,\x20lonRange),\x20360.0f);\x0a\x20\x20float\x20randomLat\x20=\x20rand(-seed,\x20latRange);\x0a\x0a\x20\x20float\x20height\x20=\x20getTextureValue(H,\x20vec3(randomLon,\x20randomLat,\x20lev)).r;\x0a\x0a\x20\x20return\x20vec3(randomLon,\x20randomLat,\x20height);\x0a}\x0a\x0abool\x20particleOutbound(vec3\x20particle)\x20{\x0a\x20\x20return\x20particle.y\x20<\x20viewerLatRange.x\x20||\x20particle.y\x20>\x20viewerLatRange.y\x20||\x20particle.x\x20<\x20viewerLonRange.x\x20||\x20particle.x\x20>\x20viewerLonRange.y;\x0a}\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20vec3\x20nextParticle\x20=\x20texture(nextParticlesPosition,\x20v_textureCoordinates).rgb;\x0a\x20\x20vec4\x20nextSpeed\x20=\x20texture(particlesSpeed,\x20v_textureCoordinates);\x0a\x20\x20float\x20speedNorm\x20=\x20nextSpeed.a;\x0a\x20\x20float\x20particleDropRate\x20=\x20dropRate\x20+\x20dropRateBump\x20*\x20speedNorm;\x0a\x0a\x20\x20vec2\x20seed1\x20=\x20nextParticle.xy\x20+\x20v_textureCoordinates;\x0a\x20\x20vec2\x20seed2\x20=\x20nextSpeed.xy\x20+\x20v_textureCoordinates;\x0a\x20\x20vec3\x20randomParticle\x20=\x20generateRandomParticle(seed1,\x20nextParticle.z);\x0a\x20\x20float\x20randomNumber\x20=\x20rand(seed2,\x20normalRange);\x0a\x0a\x20\x20if(randomNumber\x20<\x20particleDropRate\x20||\x20particleOutbound(nextParticle))\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(randomParticle,\x201.0f);\x20//\x201.0\x20means\x20this\x20is\x20a\x20random\x20particle\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(nextParticle,\x200.0f);\x0a\x20\x20}\x0a}\x0a',UpdatePositionShader='#version\x20300\x20es\x0a\x0aprecision\x20highp\x20float;\x0a\x0auniform\x20sampler2D\x20currentParticlesPosition;\x20//\x20(lon,\x20lat,\x20lev)\x0auniform\x20sampler2D\x20particlesSpeed;\x20//\x20(u,\x20v,\x20w,\x20norm)\x20Unit\x20converted\x20to\x20degrees\x20of\x20longitude\x20and\x20latitude\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20vec3\x20lonLatLev\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rgb;\x0a\x20\x20vec3\x20speed\x20=\x20texture(particlesSpeed,\x20v_textureCoordinates).rgb;\x0a\x20\x20vec3\x20nextParticle\x20=\x20lonLatLev\x20+\x20speed;\x0a\x20\x20if(length(speed.rgb)\x20>\x200.0f)\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(nextParticle,\x200.0f);\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(0.0f);\x0a\x20\x20}\x0a}\x0a';const Cesium$3=mars3d__namespace['Cesium'];class ParticlesComputing{constructor(_0x75f299,_0x1e4924,_0x1c694a,_0x52bcfb){function _0x37c0b2(_0x574caf,_0xc74c68){return _0x27456a(_0xc74c68- -0x3e3,_0x574caf);}this['data']=_0x1e4924,this[_0x37c0b2(0xd9,0x156)](_0x75f299,_0x1e4924),this['createParticlesTextures'](_0x75f299,_0x1c694a,_0x52bcfb),this['createComputingPrimitives'](_0x1e4924,_0x1c694a,_0x52bcfb);}['createWindTextures'](_0x1b5c14,_0x17bf93){var _0x2d0320;const _0x1658a3={'context':_0x1b5c14,'width':_0x17bf93[_0x2b6efa(0x35b,0x372)][_0x29c54d(0x472,0x44b)],'height':_0x17bf93[_0x2b6efa(0x35b,0x35b)]['lat']*(_0x17bf93['dimensions']['lev']||0x1),'pixelFormat':Cesium$3['PixelFormat']['RED'],'pixelDatatype':Cesium$3[_0x2b6efa(0x353,0x38a)]['FLOAT'],'flipY':![],'sampler':new Cesium$3['Sampler']({'minificationFilter':Cesium$3['TextureMinificationFilter']['NEAREST'],'magnificationFilter':Cesium$3['TextureMagnificationFilter']['NEAREST']})};function _0x29c54d(_0x1e7213,_0x4df341){return _0x27456a(_0x4df341- -0xbd,_0x1e7213);}function _0x2b6efa(_0x1247fa,_0x58a34d){return _0x27456a(_0x1247fa- -0x238,_0x58a34d);}this[_0x2b6efa(0x354,0x39a)]={'U':Util[_0x29c54d(0x4d5,0x4e5)](_0x1658a3,_0x17bf93['U']['array']),'V':Util['createTexture'](_0x1658a3,_0x17bf93['V'][_0x29c54d(0x5c6,0x545)]),'W':Util['createTexture'](_0x1658a3,((_0x2d0320=_0x17bf93['W'])===null||_0x2d0320===void 0x0?void 0x0:_0x2d0320['array'])??_0x17bf93['U'][_0x2b6efa(0x3ca,0x3fb)]),'H':Util[_0x29c54d(0x481,0x4e5)](_0x1658a3,_0x17bf93['H']['array'])};}['createParticlesTextures'](_0x2b5bfc,_0x329767,_0x2454a2){const _0x13133b={'context':_0x2b5bfc,'width':_0x329767['particlesTextureSize'],'height':_0x329767['particlesTextureSize'],'pixelFormat':Cesium$3['PixelFormat'][_0x4b67bc(0x362,0x367)],'pixelDatatype':Cesium$3['PixelDatatype'][_0x2008fc(-0xad,-0xb3)],'flipY':![],'sampler':new Cesium$3['Sampler']({'minificationFilter':Cesium$3[_0x2008fc(-0x78,-0x87)]['NEAREST'],'magnificationFilter':Cesium$3['TextureMagnificationFilter']['NEAREST']})};function _0x4b67bc(_0x4d2575,_0x510421){return _0x27456a(_0x4d2575- -0x20a,_0x510421);}const _0x326007=this['randomizeParticles'](_0x329767['maxParticles'],_0x2454a2);function _0x2008fc(_0x4634f4,_0x1eff25){return _0x27456a(_0x4634f4- -0x605,_0x1eff25);}const _0x57cd41=new Float32Array(0x4*_0x329767['maxParticles'])['fill'](0x0);this['particlesTextures']={'previousParticlesPosition':Util[_0x4b67bc(0x398,0x38b)](_0x13133b,_0x326007),'currentParticlesPosition':Util['createTexture'](_0x13133b,_0x326007),'nextParticlesPosition':Util['createTexture'](_0x13133b,_0x326007),'postProcessingPosition':Util[_0x2008fc(-0x63,-0x38)](_0x13133b,_0x326007),'particlesSpeed':Util['createTexture'](_0x13133b,_0x57cd41)};}[_0x688102(0x53d,0x4b9)](_0x5db2b0,_0x46c4ae){function _0x3c0b4c(_0x1e3732,_0x1408c2){return _0x688102(_0x1e3732,_0x1408c2- -0x3f7);}const _0x2745f2=new Float32Array(0x4*_0x5db2b0);function _0x1268e5(_0x4eff00,_0x540ecd){return _0x27456a(_0x4eff00- -0x566,_0x540ecd);}for(let _0x3530cd=0x0;_0x3530cd<_0x5db2b0;_0x3530cd++){_0x2745f2[0x4*_0x3530cd]=Cesium$3[_0x3c0b4c(0xef,0xf6)][_0x1268e5(0x81,0x104)](_0x46c4ae[_0x3c0b4c(-0x48,0x40)]['x'],_0x46c4ae['lonRange']['y']),_0x2745f2[0x4*_0x3530cd+0x1]=Cesium$3['Math']['randomBetween'](_0x46c4ae[_0x3c0b4c(0x9f,0x63)]['x'],_0x46c4ae['latRange']['y']),_0x2745f2[0x4*_0x3530cd+0x2]=Cesium$3[_0x1268e5(0x7d,0xd6)][_0x3c0b4c(0x147,0xfa)](this[_0x1268e5(-0x36,-0x6d)]['lev']['min'],this['data']['lev'][_0x3c0b4c(0xdf,0x113)]),_0x2745f2[0x4*_0x3530cd+0x3]=0x0;}return _0x2745f2;}['getValidRange'](_0x543316){const _0x4c3627=[_0x543316['dimensions']['lon'],_0x543316['dimensions']['lat'],_0x543316['dimensions']['lev']],_0x3cda6d=[_0x543316['lon']['min'],_0x543316['lat']['min'],_0x543316['lev'][_0xd408bb(0x49f,0x512)]],_0x1c9cf3=[_0x543316['lon']['max'],_0x543316['lat'][_0xfc685(0x4be,0x456)],_0x543316[_0xd408bb(0x4ae,0x4fe)][_0xd408bb(0x597,0x5e6)]],_0xfa34c1=[(_0x1c9cf3[0x0]-_0x3cda6d[0x0])/(_0x4c3627[0x0]-0x1),(_0x1c9cf3[0x1]-_0x3cda6d[0x1])/(_0x4c3627[0x1]-0x1),_0x4c3627[0x2]>0x1?(_0x1c9cf3[0x2]-_0x3cda6d[0x2])/(_0x4c3627[0x2]-0x1):0x1],_0x6cd6f1=Math['floor'](Math['random']()*_0x543316['U'][_0xfc685(0x3d4,0x458)][_0xd408bb(0x54d,0x576)]);function _0xfc685(_0x1d107b,_0xb25b6a){return _0x27456a(_0xb25b6a- -0x1aa,_0x1d107b);}const _0x2e04db=_0x6cd6f1%(_0x4c3627[0x0]*_0x4c3627[0x1]);function _0xd408bb(_0x3b25f3,_0x7dbe79){return _0x688102(_0x3b25f3,_0x7dbe79-0xdc);}const _0x2d525=Math[_0xfc685(0x45e,0x462)](_0x2e04db/_0x4c3627[0x0]),_0x145491=_0x2e04db%_0x4c3627[0x0],_0x3be5f5=Cesium$3['Math']['randomBetween'](_0x3cda6d[0x0]+_0x145491*_0xfa34c1[0x0],_0x3cda6d[0x0]+(_0x145491+0x1)*_0xfa34c1[0x0]),_0x36d5f0=Cesium$3['Math']['randomBetween'](_0x3cda6d[0x1]+(_0x2d525-0x1)*_0xfa34c1[0x1],_0x3cda6d[0x1]+_0x2d525*_0xfa34c1[0x1]),_0x43142d=_0x543316['H'][_0xfc685(0x4c6,0x458)][_0x6cd6f1]||0x0;return[_0x3be5f5,_0x36d5f0,_0x43142d];}[_0x27456a(0x5f7,0x571)](){function _0x3cf44f(_0x399bc3,_0x124637){return _0x688102(_0x399bc3,_0x124637- -0x389);}Object['keys'](this[_0x3cf44f(0xca,0x121)])['forEach'](_0x137a18=>{this['particlesTextures'][_0x137a18]['destroy']();});}[_0x27456a(0x54b,0x5b9)](_0x480b2e,_0x2fe8b5,_0x315269){const _0xb0beaf=new Cesium$3['Cartesian3'](_0x480b2e['dimensions'][_0x4a495c(0x73,0x78)],_0x480b2e[_0x511cc9(-0x15d,-0x17d)]['lat'],_0x480b2e[_0x4a495c(0xfe,0xf1)][_0x511cc9(-0x1d8,-0x1a0)]),_0x1356a0=new Cesium$3['Cartesian3'](_0x480b2e[_0x4a495c(0x73,0xa)]['min'],_0x480b2e['lat']['min'],_0x480b2e['lev']['min']),_0x428bde=new Cesium$3['Cartesian3'](_0x480b2e[_0x4a495c(0x73,0x2d)]['max'],_0x480b2e[_0x511cc9(-0x192,-0x147)]['max'],_0x480b2e['lev']['max']),_0x585236=new Cesium$3['Cartesian3']((_0x428bde['x']-_0x1356a0['x'])/(_0xb0beaf['x']-0x1),(_0x428bde['y']-_0x1356a0['y'])/(_0xb0beaf['y']-0x1),_0xb0beaf['z']>0x1?(_0x428bde['z']-_0x1356a0['z'])/(_0xb0beaf['z']-0x1):0x1),_0x1c5411=new Cesium$3['Cartesian2'](_0x480b2e['lon'][_0x511cc9(-0x1c4,-0x1b9)],_0x480b2e['lon']['max']),_0x16ac56=new Cesium$3['Cartesian2'](_0x480b2e['lat']['min'],_0x480b2e['lat']['max']),_0x36793d=new Cesium$3['Cartesian2'](_0x480b2e['U']['min'],_0x480b2e['U'][_0x511cc9(-0xf0,-0x16c)]),_0x4c5f78=new Cesium$3['Cartesian2'](_0x480b2e['V']['min'],_0x480b2e['V']['max']),_0x566b80=new Cesium$3['Cartesian2'](_0x480b2e['W'][_0x511cc9(-0x1c4,-0x1d4)],_0x480b2e['W']['max']),_0xe966f4=this,_0x50b6d3={};_0x50b6d3['U']=function(){function _0x522c2e(_0x152df9,_0x2687ab){return _0x511cc9(_0x152df9-0x591,_0x2687ab);}return _0xe966f4[_0x522c2e(0x42d,0x45a)]['U'];},_0x50b6d3['V']=function(){function _0x2b2947(_0x58d826,_0x48bcd2){return _0x511cc9(_0x48bcd2-0x5d6,_0x58d826);}return _0xe966f4[_0x2b2947(0x40a,0x472)]['V'];},_0x50b6d3['W']=function(){return _0xe966f4['windTextures']['W'];};function _0x4a495c(_0x1e2da0,_0x29eafd){return _0x688102(_0x29eafd,_0x1e2da0- -0x39f);}_0x50b6d3['currentParticlesPosition']=function(){return _0xe966f4['particlesTextures']['currentParticlesPosition'];},_0x50b6d3['dimension']=function(){return _0xb0beaf;},_0x50b6d3[_0x4a495c(0x105,0x90)]=function(){return _0x1356a0;},_0x50b6d3['maximum']=function(){return _0x428bde;},_0x50b6d3['interval']=function(){return _0x585236;},_0x50b6d3[_0x4a495c(0x96,0x121)]=function(){return _0x36793d;};function _0x511cc9(_0x4ef67b,_0x17bcf2){return _0x27456a(_0x4ef67b- -0x6f0,_0x17bcf2);}_0x50b6d3['vSpeedRange']=function(){return _0x4c5f78;},_0x50b6d3[_0x4a495c(0xd6,0xde)]=function(){return _0x566b80;},_0x50b6d3[_0x4a495c(0x132,0xfc)]=function(){function _0x4c0825(_0x41a2dc,_0x3037d2){return _0x4a495c(_0x41a2dc- -0x6d,_0x3037d2);}return _0x315269[_0x4c0825(0x31,-0x2a)]*_0x2fe8b5['speedFactor'];};const _0x4373f6={};_0x4373f6['sources']=[CalculateSpeedShader];const _0x108e71={};_0x108e71['sources']=[UpdatePositionShader];const _0xac1805={};_0xac1805['sources']=[PostProcessingPositionShader],this['primitives']={'calculateSpeed':new CustomPrimitive({'commandType':_0x4a495c(0x179,0x158),'uniformMap':_0x50b6d3,'fragmentShaderSource':new Cesium$3[(_0x4a495c(0x10c,0xbe))](_0x4373f6),'outputTexture':this['particlesTextures']['particlesSpeed'],'preExecute':function(){function _0x1e2163(_0x55e6bf,_0x49b04d){return _0x4a495c(_0x55e6bf-0xcf,_0x49b04d);}if(_0x2fe8b5!==undefined&&_0x2fe8b5['dynamic']){const _0x583f28=_0xe966f4['particlesTextures']['previousParticlesPosition'];_0xe966f4[_0x1e2163(0x1da,0x208)][_0x1e2163(0x14e,0x156)]=_0xe966f4[_0x486d09(-0x158,-0x101)]['currentParticlesPosition'],_0xe966f4['particlesTextures'][_0x486d09(-0x15a,-0xec)]=_0xe966f4[_0x486d09(-0x15e,-0x101)]['postProcessingPosition'],_0xe966f4[_0x1e2163(0x1da,0x15d)]['postProcessingPosition']=_0x583f28;}function _0x486d09(_0xb69f,_0x1109f4){return _0x4a495c(_0x1109f4- -0x20c,_0xb69f);}_0xe966f4['primitives'][_0x1e2163(0x1a7,0x152)][_0x1e2163(0x1f7,0x23d)][_0x486d09(-0x1c3,-0x186)]=_0xe966f4['particlesTextures'][_0x486d09(-0x105,-0x10f)];}}),'updatePosition':new CustomPrimitive({'commandType':_0x511cc9(-0xe2,-0x113),'uniformMap':{'currentParticlesPosition':function(){return _0xe966f4['particlesTextures']['currentParticlesPosition'];},'particlesSpeed':function(){return _0xe966f4['particlesTextures']['particlesSpeed'];}},'fragmentShaderSource':new Cesium$3['ShaderSource'](_0x108e71),'outputTexture':this[_0x4a495c(0x10b,0x143)]['nextParticlesPosition'],'preExecute':function(){function _0x5a9f31(_0x76d2a9,_0x3a51a1){return _0x511cc9(_0x76d2a9-0x345,_0x3a51a1);}function _0x31fd79(_0x3d5977,_0x2f2c57){return _0x511cc9(_0x2f2c57-0x458,_0x3d5977);}_0xe966f4['primitives'][_0x31fd79(0x32d,0x341)][_0x5a9f31(0x212,0x293)]['outputTexture']=_0xe966f4[_0x31fd79(0x2d0,0x308)]['nextParticlesPosition'];}}),'postProcessingPosition':new CustomPrimitive({'commandType':'Compute','uniformMap':{'nextParticlesPosition':function(){function _0x265551(_0x1f6f2d,_0x135b5d){return _0x511cc9(_0x135b5d-0x750,_0x1f6f2d);}return _0xe966f4[_0x265551(0x5cd,0x600)]['nextParticlesPosition'];},'particlesSpeed':function(){return _0xe966f4['particlesTextures']['particlesSpeed'];},'viewerLonRange':function(){return _0x315269['lonRange'];},'viewerLatRange':function(){return _0x315269['latRange'];},'lonRange':function(){return _0x1c5411;},'latRange':function(){return _0x16ac56;},'dimension':function(){return _0xb0beaf;},'minimum':function(){return _0x1356a0;},'maximum':function(){return _0x428bde;},'interval':function(){return _0x585236;},'H':function(){function _0x60a276(_0x1ab6a5,_0x41233d){return _0x511cc9(_0x1ab6a5-0x4fd,_0x41233d);}return _0xe966f4[_0x60a276(0x399,0x39b)]['H'];},'randomCoefficient':function(){const _0x3ef285=Math['random']();return _0x3ef285;},'dropRate':function(){return _0x2fe8b5['dropRate'];},'dropRateBump':function(){return _0x2fe8b5['dropRateBump'];}},'fragmentShaderSource':new Cesium$3['ShaderSource'](_0xac1805),'outputTexture':this['particlesTextures'][_0x4a495c(0x12a,0xbd)],'preExecute':function(){function _0x71245c(_0x583516,_0xe848ca){return _0x4a495c(_0xe848ca- -0xb2,_0x583516);}function _0x5ccec1(_0x1e1edb,_0x3c0c17){return _0x4a495c(_0x1e1edb-0x7a,_0x3c0c17);}_0xe966f4[_0x71245c(0x5b,-0x7)][_0x71245c(0xe3,0x78)]['commandToExecute']['outputTexture']=_0xe966f4[_0x71245c(0x5,0x59)][_0x71245c(0xa,0x78)];}})};}}const Cesium$2=mars3d__namespace[_0x27456a(0x515,0x56a)];class ParticleSystem{constructor(_0x4ce1f2,_0x290ab7,_0x480694,_0x3138ad){this['context']=_0x4ce1f2;function _0x1226a9(_0x43af81,_0x4ae2cf){return _0x27456a(_0x4ae2cf- -0x316,_0x43af81);}_0x290ab7={..._0x290ab7};_0x290ab7['udata']&&_0x290ab7[_0x57191c(-0x138,-0x16e)]&&(_0x290ab7[_0x1226a9(0x2c5,0x27d)]={},_0x290ab7[_0x1226a9(0x2e6,0x27d)]['lon']=_0x290ab7['cols'],_0x290ab7['dimensions'][_0x57191c(-0x133,-0x1b1)]=_0x290ab7['rows'],_0x290ab7['dimensions']['lev']=_0x290ab7[_0x57191c(-0x179,-0x156)]||0x1,_0x290ab7['lon']={},_0x290ab7['lon']['min']=_0x290ab7['xmin'],_0x290ab7['lon']['max']=_0x290ab7['xmax'],_0x290ab7['lat']={},_0x290ab7['lat']['min']=_0x290ab7['ymin'],_0x290ab7[_0x57191c(-0x133,-0xbc)]['max']=_0x290ab7[_0x1226a9(0x1d7,0x214)],_0x290ab7['lev']={},_0x290ab7['lev']['min']=_0x290ab7['levmin']??0x1,_0x290ab7['lev']['max']=_0x290ab7['levmax']??0x1,_0x290ab7['U']={},_0x290ab7['U']['array']=new Float32Array(_0x290ab7['udata']),_0x290ab7['U']['min']=_0x290ab7[_0x1226a9(0x310,0x2d2)]??Math['min'](..._0x290ab7['udata']),_0x290ab7['U'][_0x57191c(-0x91,-0x23)]=_0x290ab7['umax']??Math['max'](..._0x290ab7['udata']),_0x290ab7['V']={},_0x290ab7['V'][_0x1226a9(0x2ec,0x2ec)]=new Float32Array(_0x290ab7[_0x1226a9(0x287,0x243)]),_0x290ab7['V'][_0x1226a9(0x29d,0x216)]=_0x290ab7['vmin']??Math['min'](..._0x290ab7['vdata']),_0x290ab7['V']['max']=_0x290ab7['vmax']??Math['max'](..._0x290ab7[_0x1226a9(0x2c3,0x243)]));!_0x290ab7['W']&&(_0x290ab7['W']={'array':new Float32Array(_0x290ab7['U']['array']['length']),'min':0x0,'max':0x0});if(!_0x290ab7['H']){var _0x1ef56d;_0x290ab7['H']={'array':new Float32Array(_0x290ab7['U']['array'][_0x1226a9(0x22c,0x27a)]),'min':0x0,'max':0x0};if((_0x1ef56d=_0x290ab7['lev'])!==null&&_0x1ef56d!==void 0x0&&_0x1ef56d['array']){const {lon:_0x52e30e,lat:_0x1ebed,lev:_0x2b99d2}=_0x290ab7[_0x57191c(-0xfe,-0x103)];for(let _0x1141ec=0x0;_0x1141ec<_0x2b99d2;_0x1141ec++){for(let _0x3c9c9b=0x0;_0x3c9c9b<_0x1ebed;_0x3c9c9b++){for(let _0x4f6f54=0x0;_0x4f6f54<_0x52e30e;_0x4f6f54++){const _0x5e6712=_0x1141ec*(_0x52e30e*_0x1ebed)+_0x3c9c9b*_0x52e30e+_0x4f6f54;_0x290ab7['H']['array'][_0x5e6712]=_0x290ab7[_0x57191c(-0x179,-0x203)]['array'][_0x1141ec];}}}_0x290ab7['H'][_0x1226a9(0x192,0x216)]=Math[_0x57191c(-0x165,-0x1a8)](..._0x290ab7['lev'][_0x57191c(-0x8f,-0xc5)]),_0x290ab7['H'][_0x1226a9(0x32f,0x2ea)]=Math[_0x57191c(-0x91,-0x49)](..._0x290ab7[_0x57191c(-0x179,-0x163)]['array']);}}this['data']=_0x290ab7;function _0x57191c(_0x7ae6c3,_0x171474){return _0x688102(_0x171474,_0x7ae6c3- -0x59b);}this['options']=_0x480694,this[_0x57191c(-0xe5,-0xf9)]=_0x3138ad,this[_0x1226a9(0x20e,0x1ee)]=new ParticlesComputing(this['context'],this['data'],this[_0x57191c(-0x14d,-0x13e)],this['viewerParameters']),this['particlesRendering']=new ParticlesRendering(this['context'],this['data'],this['options'],this[_0x1226a9(0x27d,0x296)],this['particlesComputing']);}[_0x27456a(0x585,0x507)](_0x1c48d5){function _0x1fd21c(_0x1f96e5,_0x3f3e5b){return _0x27456a(_0x1f96e5- -0xbf,_0x3f3e5b);}this[_0x1fd21c(0x445,0x49a)][_0x1fd21c(0x538,0x578)](),Object['keys'](this[_0x46b292(0x249,0x29f)]['windTextures'])['forEach'](_0x46b269=>{function _0x382c6c(_0x209f39,_0x40677e){return _0x1fd21c(_0x40677e- -0x3e4,_0x209f39);}function _0x59a4e8(_0x4f8fc7,_0x53ab98){return _0x46b292(_0x53ab98,_0x4f8fc7-0xfe);}this['particlesComputing'][_0x59a4e8(0x425,0x3b3)][_0x46b269][_0x59a4e8(0x3d8,0x356)]();}),this['particlesRendering']['textures'][_0x46b292(0x40f,0x3ae)][_0x1fd21c(0x480,0x3fd)]();function _0x46b292(_0x50171e,_0x5976a0){return _0x688102(_0x50171e,_0x5976a0- -0x16f);}Object['keys'](this[_0x46b292(0x355,0x30c)]['framebuffers'])[_0x46b292(0x37b,0x2f8)](_0x3eaee7=>{function _0x5be28a(_0x2f59ed,_0x362db6){return _0x46b292(_0x362db6,_0x2f59ed- -0x3d7);}this['particlesRendering']['framebuffers'][_0x3eaee7][_0x5be28a(-0xfd,-0xc4)]();}),this['context']=_0x1c48d5,this[_0x1fd21c(0x445,0x3df)]=new ParticlesComputing(this['context'],this['data'],this[_0x46b292(0x27a,0x2df)],this['viewerParameters']),this[_0x1fd21c(0x4b2,0x500)]=new ParticlesRendering(this[_0x46b292(0x2ec,0x336)],this['data'],this[_0x1fd21c(0x485,0x40c)],this['viewerParameters'],this[_0x1fd21c(0x445,0x46e)]);}['clearFramebuffers'](){function _0x309377(_0x3be480,_0x4a4660){return _0x688102(_0x3be480,_0x4a4660- -0x1dd);}const _0x216ede=new Cesium$2[(_0x309377(0x241,0x252))]({'color':new Cesium$2['Color'](0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':undefined,'pass':Cesium$2[_0x309377(0x2c6,0x2a2)]['OPAQUE']});function _0x223527(_0x12a308,_0x5e7b8b){return _0x688102(_0x12a308,_0x5e7b8b-0xa2);}Object['keys'](this[_0x309377(0x289,0x29e)]['framebuffers'])[_0x309377(0x2ec,0x28a)](_0x44608d=>{function _0x1c806e(_0x343743,_0xd0d22e){return _0x223527(_0xd0d22e,_0x343743-0x8d);}_0x216ede[_0x1c806e(0x5c1,0x648)]=this['particlesRendering'][_0x1c806e(0x587,0x521)][_0x44608d];function _0x322080(_0x207381,_0x4ebaf8){return _0x309377(_0x4ebaf8,_0x207381- -0x197);}_0x216ede[_0x322080(0x193,0x1de)](this['context']);});}['refreshParticles'](_0x4bce2c,_0x368a11=!![]){_0x368a11&&(this[_0xef1e0d(0x48d,0x45d)](),this[_0xef1e0d(0x3d8,0x375)]['destroyParticlesTextures'](),this['particlesComputing']['createParticlesTextures'](this[_0xef1e0d(0x3e3,0x40c)],this['options'],this['viewerParameters']));function _0xef1e0d(_0x45f72c,_0x5af2d9){return _0x27456a(_0x5af2d9- -0x18f,_0x45f72c);}function _0xba09ab(_0x238034,_0x362b32){return _0x688102(_0x362b32,_0x238034- -0xe7);}if(_0x4bce2c){var _0x48fe72;const _0x37d37c=this['particlesRendering'][_0xba09ab(0x365,0x336)](this[_0xba09ab(0x367,0x35b)]);this[_0xef1e0d(0x3c7,0x3e2)]['primitives'][_0xba09ab(0x3dc,0x42c)][_0xef1e0d(0x3e1,0x387)]=_0x37d37c;const _0x2f6d12=Cesium$2[_0xba09ab(0x3b7,0x385)]['fromGeometry']({'context':this['context'],'geometry':_0x37d37c,'attributeLocations':this['particlesRendering'][_0xef1e0d(0x385,0x3b1)][_0xef1e0d(0x43f,0x42a)][_0xef1e0d(0x3b5,0x3d3)],'bufferUsage':Cesium$2[_0xba09ab(0x389,0x3fd)][_0xba09ab(0x3e8,0x45b)]});(_0x48fe72=this['particlesRendering'][_0xef1e0d(0x3cb,0x3b1)])!==null&&_0x48fe72!==void 0x0&&(_0x48fe72=_0x48fe72['segments'])!==null&&_0x48fe72!==void 0x0&&_0x48fe72[_0xef1e0d(0x3d0,0x42e)]&&(this[_0xef1e0d(0x446,0x3e2)]['primitives'][_0xba09ab(0x3dc,0x408)]['commandToExecute'][_0xba09ab(0x400,0x423)]=_0x2f6d12);}}[_0x27456a(0x60d,0x693)](_0x47eb12){let _0x122f3a=![];function _0x2be5cc(_0x38e936,_0x438545){return _0x688102(_0x438545,_0x38e936-0xd2);}this['options'][_0x2be5cc(0x554,0x4db)]!==_0x47eb12[_0x2be5cc(0x554,0x5ca)]&&(_0x122f3a=!![]);Object['keys'](_0x47eb12)['forEach'](_0x14ee95=>{this['options'][_0x14ee95]=_0x47eb12[_0x14ee95];});function _0x5732ba(_0x2f24b8,_0x5aba7a){return _0x688102(_0x5aba7a,_0x2f24b8- -0x32d);}this['refreshParticles'](_0x122f3a,_0x47eb12['dynamic']);}['applyViewerParameters'](_0x4c31a4){function _0x57850d(_0x4fb9d4,_0x1d5f5b){return _0x688102(_0x1d5f5b,_0x4fb9d4- -0x286);}Object['keys'](_0x4c31a4)['forEach'](_0x10895a=>{function _0x29c8e3(_0x5391df,_0x524654){return _0x3e17(_0x5391df-0x70,_0x524654);}this[_0x29c8e3(0x2f2,0x332)][_0x10895a]=_0x4c31a4[_0x10895a];});function _0x3eb9c1(_0x1a998d,_0x3e32f1){return _0x27456a(_0x1a998d- -0x5b2,_0x3e32f1);}this[_0x57850d(0x1f3,0x23e)](![]),!this['options']['dynamic']&&(this[_0x57850d(0x1c8,0x1ce)]['dynamic']=!![],this[_0x57850d(0x291,0x2ca)](this[_0x3eb9c1(-0x6e,0xf)]),setTimeout(()=>{this['options']['dynamic']=![],this['setOptions'](this['options']);},0x1f4));}[_0x27456a(0x53f,0x5a6)](){clearTimeout(this['canrefresh']),this[_0x1252fe(0x572,0x599)]['destroyParticlesTextures']();function _0x2bc2ff(_0x125476,_0x967611){return _0x688102(_0x125476,_0x967611- -0x3ae);}Object['keys'](this[_0x1252fe(0x572,0x595)][_0x1252fe(0x5fa,0x63e)])[_0x1252fe(0x5cb,0x616)](_0x4cc4e9=>{function _0x2ec73a(_0x236184,_0x8180d4){return _0x2bc2ff(_0x8180d4,_0x236184-0x108);}function _0x51306b(_0x154805,_0x3e7017){return _0x2bc2ff(_0x154805,_0x3e7017-0x444);}this[_0x2ec73a(0x168,0xfa)]['windTextures'][_0x4cc4e9][_0x51306b(0x47f,0x4df)]();}),this['particlesRendering']['textures'][_0x1252fe(0x681,0x6d6)]['destroy']();function _0x1252fe(_0x1491fe,_0x3e85d3){return _0x27456a(_0x1491fe-0x6e,_0x3e85d3);}Object['keys'](this[_0x1252fe(0x5df,0x5d0)]['framebuffers'])[_0x1252fe(0x5cb,0x57a)](_0x1e3993=>{function _0x2a54d9(_0x321303,_0x3044ef){return _0x2bc2ff(_0x3044ef,_0x321303-0x35d);}function _0xb726ce(_0x2eaed3,_0x1fb8c4){return _0x2bc2ff(_0x2eaed3,_0x1fb8c4-0x3d);}this[_0x2a54d9(0x42a,0x474)][_0xb726ce(0x15a,0xe7)][_0x1e3993][_0xb726ce(0xc9,0xd8)]();});for(const _0x4317d2 in this){delete this[_0x4317d2];}}}const Cesium$1=mars3d__namespace['Cesium'],BaseLayer$1=mars3d__namespace['layer'][_0x27456a(0x610,0x5d1)],_0x53b579={};function _0x3e17(_0x2136b6,_0xc9f479){const _0x16833b=_0x1683();return _0x3e17=function(_0x3e175c,_0x2e6dcc){_0x3e175c=_0x3e175c-0x1da;let _0x54852e=_0x16833b[_0x3e175c];return _0x54852e;},_0x3e17(_0x2136b6,_0xc9f479);}_0x53b579['particlesNumber']=0x1000,_0x53b579['fixedHeight']=0x0,_0x53b579['fadeOpacity']=0.996,_0x53b579[_0x688102(0x489,0x413)]=0.003,_0x53b579['dropRateBump']=0.01,_0x53b579['speedFactor']=0.5,_0x53b579['lineWidth']=0x2,_0x53b579[_0x27456a(0x5db,0x5aa)]=[_0x27456a(0x51f,0x4e0)],_0x53b579['dynamic']=!![];const DEF_OPTIONS=_0x53b579;class WindLayer extends BaseLayer$1{constructor(_0x1ac2df={}){function _0x545802(_0x476507,_0x135a78){return _0x688102(_0x135a78,_0x476507- -0x23b);}_0x1ac2df={...DEF_OPTIONS,..._0x1ac2df},super(_0x1ac2df),this[_0x545802(0x2c5,0x2c0)](_0x1ac2df);}get['layer'](){function _0x4db0b6(_0x49205e,_0x5683f1){return _0x688102(_0x5683f1,_0x49205e- -0x4e3);}return this[_0x4db0b6(-0x99,-0x9f)];}get['data'](){function _0x398193(_0x3efc95,_0x241ee5){return _0x27456a(_0x241ee5- -0xc7,_0x3efc95);}return this[_0x398193(0x5ab,0x54a)];}set['data'](_0x47435f){function _0x15cc6a(_0xe3b617,_0x4a1f47){return _0x688102(_0x4a1f47,_0xe3b617- -0x5bc);}this[_0x15cc6a(-0xc1,-0xc8)](_0x47435f);}get[_0x688102(0x4ed,0x4e5)](){function _0x4739a4(_0x26a30f,_0x5dfec2){return _0x688102(_0x5dfec2,_0x26a30f- -0x4ac);}function _0x84184b(_0x1904c9,_0x10565b){return _0x27456a(_0x1904c9- -0x64c,_0x10565b);}return this[_0x84184b(-0x108,-0x131)][_0x4739a4(0x39,0x71)];}set['colors'](_0x35292c){this[_0x59fbb8(0x5c0,0x63f)][_0x3fcf81(0x171,0xf7)]=_0x35292c;if(this['particleSystem']){const _0x4ef164={};_0x4ef164['colors']=_0x35292c,this[_0x3fcf81(0x112,0xc0)]['setOptions'](_0x4ef164);}function _0x59fbb8(_0x1b0db5,_0x863b1e){return _0x688102(_0x863b1e,_0x1b0db5-0x172);}function _0x3fcf81(_0x7311,_0x2928ec){return _0x27456a(_0x7311- -0x46a,_0x2928ec);}this[_0x59fbb8(0x651,0x64d)]();}['_mountedHook'](){}['_addedHook'](){this['scene']=this['_map']['scene'],this[_0x1a6569(0x43f,0x43d)]=this['_map']['camera'];function _0x1163f0(_0x253c4f,_0x1f46a6){return _0x27456a(_0x1f46a6- -0x464,_0x253c4f);}this['primitives']=new Cesium$1[(_0x1163f0(0x89,0xdd))]();function _0x1a6569(_0x55bcd8,_0x71a304){return _0x27456a(_0x55bcd8- -0x1c9,_0x71a304);}this['_map'][_0x1163f0(0xeb,0xa2)]['primitives'][_0x1163f0(0x1fd,0x17e)](this['primitives']),this[_0x1a6569(0x3e3,0x3ba)]={'lonRange':new Cesium$1[(_0x1163f0(0x1cf,0x164))](),'latRange':new Cesium$1[(_0x1163f0(0x1ca,0x164))](),'pixelSize':0x0,'lonDisplayRange':new Cesium$1['Cartesian2'](),'latDisplayRange':new Cesium$1[(_0x1163f0(0x175,0x164))]()},this[_0x1a6569(0x33e,0x37b)]=new Cesium$1[(_0x1a6569(0x3f8,0x3ee))](Cesium$1['Cartesian3'][_0x1163f0(0xfd,0x185)],Cesium$1['Ellipsoid']['WGS84']['minimumRadius']),this[_0x1a6569(0x36b,0x32b)](),window[_0x1a6569(0x348,0x2c1)](_0x1163f0(0x11e,0x171),this[_0x1a6569(0x40c,0x3be)]['bind'](this),![]),this[_0x1a6569(0x34e,0x3d9)]=![],this['mouse_move']=![],this[_0x1a6569(0x35e,0x3da)]['on'](mars3d__namespace['EventType']['wheel'],this[_0x1163f0(0x10c,0x181)],this),this['_map']['on'](mars3d__namespace[_0x1163f0(0x17d,0x1b3)]['mouseDown'],this[_0x1163f0(0x1ae,0x166)],this),this[_0x1a6569(0x35e,0x3a6)]['on'](mars3d__namespace[_0x1a6569(0x44e,0x4c5)]['mouseUp'],this['_onMouseUpEvent'],this),this['_map']['on'](mars3d__namespace['EventType'][_0x1a6569(0x342,0x2e3)],this[_0x1a6569(0x3eb,0x383)],this),this['_data']&&this[_0x1163f0(0x215,0x18d)](this['_data']);}['_removedHook'](){window[_0x5241d9(0x2af,0x310)]('resize',this['resize']),this[_0x5241d9(0x2f5,0x2e1)]['off'](mars3d__namespace['EventType'][_0x2fbc76(0x619,0x645)],this['_onMap_preRenderEvent'],this);function _0x2fbc76(_0x70ca2,_0x13746d){return _0x688102(_0x70ca2,_0x13746d-0x19e);}this['_map']['off'](mars3d__namespace['EventType']['wheel'],this[_0x2fbc76(0x69d,0x68d)],this),this['_map'][_0x5241d9(0x31f,0x2e2)](mars3d__namespace['EventType']['mouseDown'],this['_onMouseDownEvent'],this);function _0x5241d9(_0x10fc10,_0x855040){return _0x688102(_0x10fc10,_0x855040- -0x150);}this['_map'][_0x5241d9(0x295,0x2e2)](mars3d__namespace[_0x2fbc76(0x70d,0x6bf)]['mouseUp'],this['_onMouseUpEvent'],this),this['_map'][_0x2fbc76(0x5e7,0x5d0)](mars3d__namespace[_0x2fbc76(0x6fa,0x6bf)]['mouseMove'],this['_onMouseMoveEvent'],this),this['primitives'][_0x5241d9(0x328,0x2f7)](),this[_0x2fbc76(0x57c,0x5cf)]['scene']['primitives']['remove'](this['primitives']);}['resize'](){if(!this['show']||!this['particleSystem'])return;function _0x1b6b7c(_0x13dc13,_0x37ccf5){return _0x688102(_0x13dc13,_0x37ccf5-0x193);}this[_0x1b6b7c(0x5e3,0x5dd)]['show']=![],this[_0x1b6b7c(0x5ff,0x5dd)][_0x1b6b7c(0x5c7,0x5da)]();function _0x51ee88(_0x38efd3,_0xf49cf1){return _0x688102(_0x38efd3,_0xf49cf1-0x98);}this['_map']['once'](mars3d__namespace['EventType']['preRender'],this['_onMap_preRenderEvent'],this);}['_onMap_preRenderEvent'](_0x59a4ae){this['particleSystem']['canvasResize'](this['scene']['context']);function _0xab5881(_0x4e9e73,_0x459177){return _0x688102(_0x459177,_0x4e9e73- -0x57c);}this['addPrimitives'](),this['primitives'][_0xab5881(-0xb4,-0x69)]=!![];}['_onMapWhellEvent'](_0x236368){clearTimeout(this['refreshTimer']);if(!this['show']||!this[_0x2cfb04(0x16b,0x146)])return;function _0x2cfb04(_0x59afd9,_0x41941b){return _0x27456a(_0x59afd9- -0x411,_0x41941b);}this['primitives']['show']=![],this['refreshTimer']=setTimeout(()=>{if(!this['show'])return;this['redraw']();},0xc8);}['_onMouseDownEvent'](_0x3c1062){this['mouse_down']=!![];}[_0x688102(0x483,0x4be)](_0x7b0aff){if(!this[_0x3af3a3(-0x145,-0x177)]||!this['particleSystem'])return;function _0x3af3a3(_0x39c7ba,_0x8b6734){return _0x27456a(_0x39c7ba- -0x703,_0x8b6734);}function _0x529755(_0x315047,_0x5d8cae){return _0x688102(_0x315047,_0x5d8cae- -0x32);}this[_0x3af3a3(-0x1ec,-0x269)]&&(this['primitives']['show']=![],this[_0x529755(0x4c5,0x4a9)]=!![]);}['_onMouseUpEvent'](_0x36912a){function _0x4a83ad(_0x58adba,_0x4ea8c0){return _0x27456a(_0x4ea8c0- -0x2e,_0x58adba);}if(!this['show']||!this['particleSystem'])return;function _0x1dbe1e(_0x34baa6,_0x552d14){return _0x688102(_0x552d14,_0x34baa6-0x155);}this['mouse_down']&&this['mouse_move']&&this['redraw'](),this[_0x1dbe1e(0x59f,0x52a)][_0x4a83ad(0x5f5,0x590)]=!![],this['mouse_down']=![],this['mouse_move']=![];}['redraw'](){if(!this[_0x485cbc(-0x1a0,-0x160)]||!this['show'])return;function _0x17eadd(_0x329ad2,_0x1ae659){return _0x688102(_0x1ae659,_0x329ad2- -0x2df);}this[_0x485cbc(-0x193,-0x129)]();function _0x485cbc(_0x2c93a8,_0x11451e){return _0x27456a(_0x2c93a8- -0x6c7,_0x11451e);}this['particleSystem']['applyViewerParameters'](this['viewerParameters']),this['primitives']['show']=!![];}['setData'](_0x4f0177){function _0x5396fb(_0x17b482,_0x5e1ae4){return _0x688102(_0x17b482,_0x5e1ae4- -0x35b);}this['_data']=_0x4f0177;this[_0x5396fb(0x16e,0x12b)]&&this['particleSystem'][_0x1631ae(0x5ad,0x566)]();function _0x1631ae(_0x44d60a,_0x3f83fa){return _0x27456a(_0x44d60a-0x6e,_0x3f83fa);}this['particleSystem']=new ParticleSystem(this[_0x5396fb(0xd3,0xb5)]['context'],_0x4f0177,this[_0x1631ae(0x64f,0x616)](),this['viewerParameters']),this['addPrimitives']();}['_setOptionsHook'](_0x5b2a57,_0x5ac592){function _0x3344b8(_0x21bd6c,_0x38f0bc){return _0x688102(_0x21bd6c,_0x38f0bc- -0x84);}if(_0x5b2a57)for(const _0x2f159d in _0x5b2a57){this[_0x2f159d]=_0x5b2a57[_0x2f159d];}this[_0x3344b8(0x3d0,0x402)]&&this['particleSystem']['setOptions'](this['getOptions']());}['getOptions'](){const _0x430f78=Math['ceil'](Math[_0x806354(-0xc6,-0x87)](this['particlesNumber']));this['particlesNumber']=_0x430f78*_0x430f78;function _0x3eeb9d(_0x1fe31d,_0x4a0912){return _0x27456a(_0x4a0912- -0x2ff,_0x1fe31d);}const _0x3c0b9f={};_0x3c0b9f[_0x806354(-0xce,-0x9a)]=_0x430f78,_0x3c0b9f['maxParticles']=this['particlesNumber'],_0x3c0b9f['colors']=this['colors'],_0x3c0b9f['particleHeight']=this[_0x3eeb9d(0x28b,0x236)],_0x3c0b9f['fadeOpacity']=this[_0x806354(0x0,-0x39)],_0x3c0b9f['dropRate']=this[_0x806354(-0x19c,-0x128)],_0x3c0b9f['dropRateBump']=this['dropRateBump'];function _0x806354(_0xd3f838,_0x2e3e86){return _0x27456a(_0x2e3e86- -0x631,_0xd3f838);}return _0x3c0b9f['speedFactor']=this['speedFactor'],_0x3c0b9f['lineWidth']=this['lineWidth'],_0x3c0b9f[_0x3eeb9d(0x255,0x223)]=this['dynamic'],_0x3c0b9f;}['addPrimitives'](){function _0x1d27ad(_0x58e54b,_0x45e2a6){return _0x27456a(_0x45e2a6-0x47,_0x58e54b);}function _0x8f79fa(_0x2025c6,_0x186580){return _0x27456a(_0x2025c6- -0x367,_0x186580);}this['primitives'][_0x1d27ad(0x5f6,0x629)](this['particleSystem']['particlesComputing']['primitives'][_0x8f79fa(0x206,0x241)]),this['primitives']['add'](this['particleSystem']['particlesComputing'][_0x8f79fa(0x1d9,0x1b7)]['updatePosition']),this[_0x8f79fa(0x1d9,0x15c)]['add'](this[_0x8f79fa(0x215,0x1da)][_0x8f79fa(0x19d,0x14d)]['primitives']['postProcessingPosition']),this['primitives'][_0x8f79fa(0x27b,0x302)](this[_0x1d27ad(0x64b,0x5c3)][_0x1d27ad(0x594,0x5b8)]['primitives'][_0x8f79fa(0x252,0x2da)]),this['primitives']['add'](this['particleSystem']['particlesRendering']['primitives'][_0x8f79fa(0x262,0x239)]),this['primitives'][_0x8f79fa(0x27b,0x238)](this['particleSystem'][_0x8f79fa(0x20a,0x188)][_0x8f79fa(0x1d9,0x15e)][_0x8f79fa(0x264,0x258)]);}['updateViewerParameters'](){let _0x365eb3=this['camera'][_0x189732(0x9c,0xa0)](this['scene']['globe']['ellipsoid']);if(!_0x365eb3){const _0x3a14b0=this['_map']['getExtent']();_0x365eb3=Cesium$1[_0x2e6c62(-0x30,-0x99)][_0x2e6c62(0x3b,0xae)](_0x3a14b0[_0x189732(0x17f,0x118)],_0x3a14b0['ymin'],_0x3a14b0['xmax'],_0x3a14b0['ymax']);}const _0x409ad6=Util['viewRectangleToLonLatRange'](_0x365eb3);this['_data']?(this['viewerParameters'][_0x2e6c62(-0x6a,-0xf1)]['x']=Math['max'](_0x409ad6['lon']['min'],this[_0x189732(0x117,0x183)]['xmin']),this['viewerParameters'][_0x2e6c62(-0x6a,-0xd8)]['y']=Math[_0x189732(0x39,0x9e)](_0x409ad6['lon']['max'],this[_0x2e6c62(0x7a,0x99)][_0x189732(0x145,0xf1)]),this['viewerParameters'][_0x2e6c62(-0x47,0xc)]['x']=Math['max'](_0x409ad6['lat']['min'],this['_data']['ymin']),this[_0x2e6c62(0x15,0x2e)][_0x189732(0x132,0xc2)]['y']=Math['min'](_0x409ad6['lat'][_0x2e6c62(0x69,0x76)],this[_0x2e6c62(0x7a,-0x2)]['ymax'])):(this[_0x2e6c62(0x15,-0x4)]['lonRange']['x']=_0x409ad6[_0x189732(0xc7,0x7a)][_0x2e6c62(-0x6b,-0x79)],this['viewerParameters']['lonRange']['y']=_0x409ad6['lon'][_0x2e6c62(0x69,-0x20)],this[_0x2e6c62(0x15,-0x5)][_0x189732(0x79,0xc2)]['x']=_0x409ad6['lat'][_0x2e6c62(-0x6b,-0xe3)],this[_0x189732(0x99,0x11e)][_0x189732(0x12b,0xc2)]['y']=_0x409ad6[_0x189732(0x9a,0xd0)]['max']);let _0x507219=this['camera']['getPixelSize'](this['globeBoundingSphere'],this[_0x189732(0xa6,0x78)][_0x189732(0xf5,0x90)],this[_0x189732(0xd0,0x78)][_0x2e6c62(0x38,0x24)]);const _0x29ebe8=this[_0x2e6c62(-0x91,-0xf9)]['drawingBufferHeight']*0.3;function _0x2e6c62(_0x1252d5,_0x445a91){return _0x688102(_0x445a91,_0x1252d5- -0x4a1);}_0x507219<_0x29ebe8&&(_0x507219=_0x29ebe8);function _0x189732(_0x33027c,_0x2ff608){return _0x688102(_0x33027c,_0x2ff608- -0x398);}this['viewerParameters'][_0x2e6c62(-0x64,0x1b)]=_0x507219;}}mars3d__namespace[_0x688102(0x3b0,0x426)][_0x27456a(0x573,0x4f9)]('wind',WindLayer),mars3d__namespace[_0x27456a(0x609,0x61c)][_0x688102(0x389,0x40f)]=WindLayer;class CanvasParticle{constructor(){this['lng']=null,this['lat']=null,this[_0x552e23(0x1,0x35)]=null;function _0x21eaa7(_0x35e88d,_0x21dbc3){return _0x27456a(_0x35e88d-0xb6,_0x21dbc3);}function _0x552e23(_0x1df88c,_0x3689b6){return _0x688102(_0x3689b6,_0x1df88c- -0x4ef);}this['tlat']=null,this[_0x552e23(0xd,0x47)]=null,this['speed']=null;}[_0x688102(0x4b0,0x449)](){for(const _0x5618d7 in this){delete this[_0x5618d7];}}}class CanvasWindField{constructor(_0x416059){this['setOptions'](_0x416059);}get[_0x27456a(0x570,0x5e9)](){return this['_speedRate'];}set['speedRate'](_0x346278){this['_speedRate']=(0x64-(_0x346278>0x63?0x63:_0x346278))*0x64,this['_calc_speedRate']=[(this['xmax']-this['xmin'])/this['_speedRate'],(this['ymax']-this['ymin'])/this['_speedRate']];}get['maxAge'](){function _0x170f9c(_0x2471d3,_0x4fe530){return _0x688102(_0x2471d3,_0x4fe530- -0x4b5);}return this[_0x170f9c(-0x5a,-0x6f)];}set['maxAge'](_0x483bee){function _0x5a1d65(_0x1fb132,_0x13034b){return _0x27456a(_0x1fb132- -0x4b4,_0x13034b);}this[_0x5a1d65(0x88,0x23)]=_0x483bee;}['setOptions'](_0x306568){this['options']=_0x306568,this['maxAge']=_0x306568['maxAge']||0x78;function _0x383a18(_0x117359,_0x3bd1af){return _0x688102(_0x3bd1af,_0x117359- -0x307);}this['speedRate']=_0x306568[_0x383a18(0x173,0x1b0)]||0x32;function _0x2643b9(_0xb52c11,_0x7241b5){return _0x27456a(_0xb52c11- -0x4a9,_0x7241b5);}this[_0x2643b9(0x158,0x19a)]=[];const _0x1533f7=_0x306568['particlesNumber']||0x1000;for(let _0x35b4fd=0x0;_0x35b4fd<_0x1533f7;_0x35b4fd++){const _0x1153ce=this['_randomParticle'](new CanvasParticle());this[_0x2643b9(0x158,0x146)]['push'](_0x1153ce);}}['setDate'](_0x33c677){this[_0x378b00(0x617,0x66b)]=_0x33c677['rows'],this['cols']=_0x33c677[_0x21eeb8(0x4e5,0x47c)],this['xmin']=_0x33c677['xmin'],this['xmax']=_0x33c677['xmax'];function _0x378b00(_0xf483bf,_0x482a49){return _0x688102(_0x482a49,_0xf483bf-0x15a);}this[_0x378b00(0x673,0x62b)]=_0x33c677[_0x21eeb8(0x4e2,0x49d)],this[_0x378b00(0x58e,0x5bd)]=_0x33c677['ymax'],this[_0x378b00(0x5fa,0x65b)]=[];const _0x86c642=_0x33c677['udata'],_0x1ac6ba=_0x33c677[_0x378b00(0x5bd,0x5c4)];let _0x1236f9=![];_0x86c642['length']===this[_0x21eeb8(0x486,0x48c)]&&_0x86c642[0x0]['length']===this['cols']&&(_0x1236f9=!![]);let _0x3c9da9=0x0,_0xef06a7=null,_0x1b8f03=null;function _0x21eeb8(_0x3887fc,_0x5e154b){return _0x688102(_0x5e154b,_0x3887fc- -0x37);}for(let _0x3af97b=0x0;_0x3af97b<this['rows'];_0x3af97b++){_0xef06a7=[];for(let _0x1c9ca7=0x0;_0x1c9ca7<this['cols'];_0x1c9ca7++,_0x3c9da9++){_0x1236f9?_0x1b8f03=this[_0x21eeb8(0x3f3,0x39f)](_0x86c642[_0x3af97b][_0x1c9ca7],_0x1ac6ba[_0x3af97b][_0x1c9ca7]):_0x1b8f03=this['_calcUV'](_0x86c642[_0x3c9da9],_0x1ac6ba[_0x3c9da9]),_0xef06a7[_0x21eeb8(0x48a,0x470)](_0x1b8f03);}this[_0x21eeb8(0x469,0x438)]['push'](_0xef06a7);}this['options'][_0x378b00(0x5fc,0x5fc)]&&this[_0x378b00(0x5fa,0x611)][_0x378b00(0x5aa,0x534)]();}[_0x27456a(0x549,0x586)](){function _0x1dd9cf(_0x2cb2c1,_0x4f0c96){return _0x27456a(_0x4f0c96- -0x46b,_0x2cb2c1);}function _0xdac7f4(_0x583d78,_0x541606){return _0x27456a(_0x583d78- -0x3ef,_0x541606);}delete this['rows'],delete this['cols'],delete this[_0x1dd9cf(0xc0,0x13b)],delete this['xmax'],delete this['ymin'],delete this['ymax'],delete this[_0x1dd9cf(0x135,0x12b)],delete this[_0x1dd9cf(0x186,0x196)];}[_0x27456a(0x56e,0x506)](_0x121dab,_0x7eb4fc){function _0x4af32a(_0xe45ed,_0x40891d){return _0x688102(_0xe45ed,_0x40891d- -0x3bd);}const _0x2a0e6c=(_0x121dab-this['xmin'])/(this[_0x4af32a(0x142,0xcc)]-this['xmin'])*(this['cols']-0x1),_0xf07410=(this['ymax']-_0x7eb4fc)/(this['ymax']-this[_0x4af32a(0x11b,0x15c)])*(this['rows']-0x1);function _0x5c4311(_0x3f40f9,_0x3156f0){return _0x688102(_0x3156f0,_0x3f40f9-0x136);}return[_0x2a0e6c,_0xf07410];}['getUVByXY'](_0xc419e6,_0x3c32b4){if(_0xc419e6<0x0||_0xc419e6>=this['cols']||_0x3c32b4>=this['rows'])return[0x0,0x0,0x0];const _0x550650=Math[_0x4d93c9(0x1e6,0x1ee)](_0xc419e6),_0x272fa6=Math['floor'](_0x3c32b4);if(_0x550650===_0xc419e6&&_0x272fa6===_0x3c32b4)return this['grid'][_0x3c32b4][_0xc419e6];const _0x397a13=_0x550650+0x1;function _0xae7c2c(_0x41c478,_0x243959){return _0x688102(_0x243959,_0x41c478- -0xa);}const _0x488457=_0x272fa6+0x1,_0x1adbfc=this['getUVByXY'](_0x550650,_0x272fa6),_0x12b558=this['getUVByXY'](_0x397a13,_0x272fa6),_0x10f6cf=this[_0xae7c2c(0x505,0x4db)](_0x550650,_0x488457);function _0x4d93c9(_0x1bec5b,_0x5b22cf){return _0x688102(_0x1bec5b,_0x5b22cf- -0x328);}const _0x138721=this['getUVByXY'](_0x397a13,_0x488457);let _0x2e1498=null;try{_0x2e1498=this[_0x4d93c9(0xfa,0x127)](_0xc419e6-_0x550650,_0x3c32b4-_0x272fa6,_0x1adbfc,_0x12b558,_0x10f6cf,_0x138721);}catch(_0x7702fa){console['log'](_0xc419e6,_0x3c32b4);}return _0x2e1498;}['_bilinearInterpolation'](_0x57d512,_0x6ad145,_0x3f94d4,_0x144e72,_0x223284,_0x478ab6){const _0x3d48f1=0x1-_0x57d512,_0x314a24=0x1-_0x6ad145,_0x56d13d=_0x3d48f1*_0x314a24,_0x130108=_0x57d512*_0x314a24,_0x48e0a4=_0x3d48f1*_0x6ad145,_0x834fb2=_0x57d512*_0x6ad145,_0x431dee=_0x3f94d4[0x0]*_0x56d13d+_0x144e72[0x0]*_0x130108+_0x223284[0x0]*_0x48e0a4+_0x478ab6[0x0]*_0x834fb2,_0x2c7686=_0x3f94d4[0x1]*_0x56d13d+_0x144e72[0x1]*_0x130108+_0x223284[0x1]*_0x48e0a4+_0x478ab6[0x1]*_0x834fb2;function _0x55f1ae(_0x15b861,_0x3e10b4){return _0x688102(_0x15b861,_0x3e10b4- -0xd0);}return this[_0x55f1ae(0x361,0x35a)](_0x431dee,_0x2c7686);}['_calcUV'](_0x28841e,_0x2b1cbf){function _0x23f881(_0x399007,_0x5623e9){return _0x27456a(_0x399007- -0x495,_0x5623e9);}return[+_0x28841e,+_0x2b1cbf,Math[_0x23f881(0x115,0xa4)](_0x28841e*_0x28841e+_0x2b1cbf*_0x2b1cbf)];}[_0x688102(0x43c,0x4b8)](_0x14907b,_0x34f8da){function _0x3c78b4(_0x30e875,_0x13ad7d){return _0x27456a(_0x30e875-0x5f,_0x13ad7d);}if(!this[_0x39ffca(0x147,0x124)](_0x14907b,_0x34f8da))return null;const _0x20991=this[_0x3c78b4(0x5cd,0x58c)](_0x14907b,_0x34f8da);function _0x39ffca(_0x233948,_0x30f9ea){return _0x27456a(_0x233948- -0x4a6,_0x30f9ea);}const _0x2e5e6e=this[_0x3c78b4(0x664,0x5e6)](_0x20991[0x0],_0x20991[0x1]);return _0x2e5e6e;}['isInExtent'](_0xfccfc0,_0x32d763){function _0x26db5b(_0x65d89a,_0xee3b48){return _0x688102(_0x65d89a,_0xee3b48- -0x6a);}function _0x2e525d(_0x3659e2,_0x1e4a8e){return _0x27456a(_0x1e4a8e- -0x61e,_0x3659e2);}return _0xfccfc0>=this[_0x26db5b(0x3eb,0x446)]&&_0xfccfc0<=this['xmax']&&_0x32d763>=this['ymin']&&_0x32d763<=this[_0x2e525d(-0xfa,-0xf4)]?!![]:![];}['getRandomLatLng'](){const _0x13d064=fRandomByfloat(this[_0x295588(0x559,0x5d3)],this[_0x23e0e7(0x40d,0x38e)]),_0x5dbfcd=fRandomByfloat(this['ymin'],this['ymax']),_0x194abb={};_0x194abb['lat']=_0x5dbfcd;function _0x295588(_0x30468a,_0x49a28e){return _0x27456a(_0x49a28e-0x2d,_0x30468a);}_0x194abb['lng']=_0x13d064;function _0x23e0e7(_0x1ee1a8,_0x411800){return _0x688102(_0x1ee1a8,_0x411800- -0xfb);}return _0x194abb;}['getParticles'](){function _0x22232c(_0x264d39,_0x4f626e){return _0x27456a(_0x264d39- -0x58d,_0x4f626e);}let _0x795236,_0x26b789,_0x1519ee;for(let _0x11c60a=0x0,_0x438b0d=this[_0x22232c(0x74,0x91)][_0x22232c(0x3,-0x3c)];_0x11c60a<_0x438b0d;_0x11c60a++){let _0x125f17=this[_0x36c724(0x485,0x4e2)][_0x11c60a];_0x125f17['age']<=0x0&&(_0x125f17=this[_0x22232c(-0xa,-0x57)](_0x125f17));if(_0x125f17['age']>0x0){const _0x40e14d=_0x125f17['tlng'],_0x32deac=_0x125f17['tlat'];_0x1519ee=this['getUVByPoint'](_0x40e14d,_0x32deac),_0x1519ee?(_0x795236=_0x40e14d+this['_calc_speedRate'][0x0]*_0x1519ee[0x0],_0x26b789=_0x32deac+this['_calc_speedRate'][0x1]*_0x1519ee[0x1],_0x125f17[_0x36c724(0x3d6,0x453)]=_0x40e14d,_0x125f17[_0x22232c(-0x2f,-0x41)]=_0x32deac,_0x125f17[_0x22232c(0x59,0x17)]=_0x795236,_0x125f17['tlat']=_0x26b789,_0x125f17[_0x22232c(-0x16,-0x9c)]=_0x1519ee[0x2],_0x125f17['age']--):_0x125f17['age']=0x0;}}function _0x36c724(_0x25f209,_0x2f8600){return _0x688102(_0x25f209,_0x2f8600- -0x29);}return this[_0x36c724(0x50f,0x4e2)];}['_randomParticle'](_0x1389aa){let _0x44543e,_0x5d4424;for(let _0x142fc1=0x0;_0x142fc1<0x1e;_0x142fc1++){_0x44543e=this[_0x5d6051(0x391,0x31f)](),_0x5d4424=this['getUVByPoint'](_0x44543e[_0x3de062(0x55d,0x51d)],_0x44543e['lat']);if(_0x5d4424&&_0x5d4424[0x2]>0x0)break;}function _0x5d6051(_0x592ba3,_0x21b720){return _0x27456a(_0x592ba3- -0x1d2,_0x21b720);}function _0x3de062(_0x49c4fd,_0x4a6c50){return _0x27456a(_0x4a6c50- -0x55,_0x49c4fd);}if(!_0x5d4424)return _0x1389aa;const _0xfd1b33=_0x44543e['lng']+this['_calc_speedRate'][0x0]*_0x5d4424[0x0],_0xf5b6de=_0x44543e[_0x5d6051(0x38c,0x376)]+this['_calc_speedRate'][0x1]*_0x5d4424[0x1];return _0x1389aa[_0x3de062(0x538,0x51d)]=_0x44543e[_0x3de062(0x4be,0x51d)],_0x1389aa['lat']=_0x44543e['lat'],_0x1389aa['tlng']=_0xfd1b33,_0x1389aa[_0x3de062(0x4bc,0x4e1)]=_0xf5b6de,_0x1389aa[_0x3de062(0x5e1,0x59d)]=Math['round'](Math['random']()*this['maxAge']),_0x1389aa['speed']=_0x5d4424[0x2],_0x1389aa;}['destroy'](){for(const _0x5b9cd3 in this){delete this[_0x5b9cd3];}}}function fRandomByfloat(_0x35e1d0,_0x10c4b0){function _0x1ed0f8(_0x3b05ca,_0x5d7430){return _0x27456a(_0x3b05ca- -0x5af,_0x5d7430);}return _0x35e1d0+Math[_0x1ed0f8(0x15,0x65)]()*(_0x10c4b0-_0x35e1d0);}const Cesium=mars3d__namespace[_0x27456a(0x515,0x49c)],BaseLayer=mars3d__namespace['layer'][_0x688102(0x53e,0x51a)];class CanvasWindLayer extends BaseLayer{constructor(_0x83dcdb={}){super(_0x83dcdb),this[_0x203bb4(0x35f,0x379)](_0x83dcdb);function _0x203bb4(_0x1ce624,_0x39c335){return _0x688102(_0x39c335,_0x1ce624- -0x1a1);}function _0x4f1085(_0x5ca081,_0x556afc){return _0x688102(_0x5ca081,_0x556afc- -0x204);}this[_0x4f1085(0x24b,0x297)]=null,_0x83dcdb['colors']&&_0x83dcdb[_0x4f1085(0x237,0x2a9)]&&(this['_colorRamp']=new mars3d__namespace['ColorRamp'](_0x83dcdb));}['_setOptionsHook'](_0x2428ee,_0x3188ec){this['frameTime']=0x3e8/(_0x2428ee[_0x298d25(0x559,0x50c)]||0xa),this['_pointerEvents']=this['options'][_0xb1a13d(0x312,0x325)]??![],this[_0xb1a13d(0x2b1,0x2d2)]=_0x2428ee[_0xb1a13d(0x2ab,0x2d2)]||_0x298d25(0x521,0x4c3),this['lineWidth']=_0x2428ee['lineWidth']||0x1,this[_0x298d25(0x4b8,0x498)]=_0x2428ee['fixedHeight']??0x0;function _0x298d25(_0x4f967e,_0x168ebe){return _0x27456a(_0x168ebe- -0x9d,_0x4f967e);}function _0xb1a13d(_0x120ade,_0xcb289f){return _0x27456a(_0xcb289f- -0x2d6,_0x120ade);}this['reverseY']=_0x2428ee[_0xb1a13d(0x2a9,0x2c2)]??![],this['windField']&&this[_0xb1a13d(0x1bf,0x238)][_0x298d25(0x50e,0x570)](_0x2428ee);}get[_0x27456a(0x609,0x665)](){return this['canvas'];}get[_0x688102(0x440,0x43c)](){return this['_map']['scene']['canvas']['clientWidth'];}get[_0x27456a(0x576,0x533)](){function _0x1c753c(_0x11ab88,_0x5b896c){return _0x688102(_0x5b896c,_0x11ab88- -0xd6);}function _0x1dc424(_0x3db912,_0x382478){return _0x688102(_0x3db912,_0x382478-0x49);}return this[_0x1dc424(0x4bb,0x47a)]['scene'][_0x1c753c(0x3c5,0x383)]['clientHeight'];}get['pointerEvents'](){function _0x40782e(_0x556220,_0x554bf1){return _0x688102(_0x554bf1,_0x556220- -0x4e0);}return this[_0x40782e(-0xad,-0x12f)];}set[_0x688102(0x552,0x505)](_0x1f3346){this['_pointerEvents']=_0x1f3346;if(!this[_0x14c051(-0x13,0x30)])return;function _0x544833(_0x4e50d9,_0x56eea0){return _0x688102(_0x4e50d9,_0x56eea0- -0x4a);}function _0x14c051(_0x555747,_0x2382b4){return _0x27456a(_0x2382b4- -0x561,_0x555747);}_0x1f3346?this['canvas'][_0x14c051(0xf7,0x6d)]['pointer-events']='all':this['canvas']['style']['pointer-events']='none';}get['particlesNumber'](){return this['options']['particlesNumber'];}set[_0x688102(0x4e7,0x46f)](_0x19a6b1){this[_0x1dcb9c(0x34e,0x38e)][_0x1dcb9c(0x36f,0x34d)]=_0x19a6b1;function _0x1dcb9c(_0x56373e,_0x4aa307){return _0x688102(_0x4aa307,_0x56373e- -0x100);}clearTimeout(this['_canrefresh']);function _0x4d75f5(_0x428ae8,_0x33a3e4){return _0x688102(_0x33a3e4,_0x428ae8- -0x38e);}this[_0x1dcb9c(0x3da,0x412)]=setTimeout(()=>{function _0x2f791a(_0x9f824,_0x34ee8c){return _0x4d75f5(_0x34ee8c- -0x21a,_0x9f824);}this[_0x2f791a(-0x10d,-0xae)]();},0x1f4);}get['speedRate'](){return this['options']['speedRate'];}set['speedRate'](_0x228ca1){this['options']['speedRate']=_0x228ca1;function _0x510c4f(_0x57d64e,_0x38b4e9){return _0x27456a(_0x38b4e9- -0xe4,_0x57d64e);}this['windField']&&(this['windField'][_0x510c4f(0x488,0x48c)]=_0x228ca1);}get['maxAge'](){return this['options']['maxAge'];}set['maxAge'](_0x8feaf6){function _0x4a1732(_0x1014da,_0x3559c1){return _0x688102(_0x3559c1,_0x1014da- -0x2c3);}function _0x4211f3(_0x272f0b,_0x5f4b45){return _0x688102(_0x5f4b45,_0x272f0b- -0x5c2);}this[_0x4a1732(0x18b,0x203)][_0x4a1732(0x154,0x1cf)]=_0x8feaf6,this['windField']&&(this[_0x4a1732(0x155,0xda)]['maxAge']=_0x8feaf6);}get[_0x27456a(0x530,0x542)](){return this['windData'];}set[_0x688102(0x491,0x43a)](_0x570845){function _0x596f55(_0x3f2555,_0x2f583c){return _0x27456a(_0x3f2555- -0x482,_0x2f583c);}this[_0x596f55(0x16f,0x119)](_0x570845);}get['rectangle'](){let _0x31d256=this['windData']['xmin'],_0x2cc05f=this['windData']['xmax'],_0x59bf1a=this[_0x5bd081(-0x71,-0x23)][_0x223354(0x4ad,0x43b)],_0xebc395=this['windData'][_0x223354(0x2fc,0x356)];_0x2cc05f>=0x167&&_0x31d256===0x0&&(_0x31d256=-0xb4,_0x2cc05f=0xb4);function _0x5bd081(_0x2dd67b,_0x4137f6){return _0x27456a(_0x4137f6- -0x5fb,_0x2dd67b);}function _0x223354(_0x4b1abb,_0xd63ce7){return _0x688102(_0x4b1abb,_0xd63ce7- -0xde);}return _0x31d256=Math['max'](_0x31d256,-0xb4),_0x2cc05f=Math['min'](_0x2cc05f,0xb4),_0x59bf1a=Math[_0x223354(0x3d1,0x42c)](_0x59bf1a,-0x5a),_0xebc395=Math[_0x223354(0x397,0x358)](_0xebc395,0x5a),Cesium[_0x223354(0x418,0x393)][_0x5bd081(-0x3b,-0x29)](_0x31d256,_0x59bf1a,_0x2cc05f,_0xebc395);}['_showHook'](_0x429e01){function _0x178e88(_0x5c3504,_0x1d1034){return _0x27456a(_0x1d1034- -0x50e,_0x5c3504);}function _0x2ac242(_0x20d360,_0x89e331){return _0x688102(_0x89e331,_0x20d360- -0x47e);}_0x429e01?this[_0x2ac242(0xa,0x6d)]():(this['windData']&&(this['options'][_0x2ac242(-0x44,0x1d)]=this['windData']),this[_0x178e88(0xb2,0x9d)]());}['_mountedHook'](){function _0x210cd6(_0x3ba5a0,_0x42bdeb){return _0x688102(_0x42bdeb,_0x3ba5a0- -0x369);}function _0x685847(_0x3d7819,_0x3dfbb6){return _0x27456a(_0x3d7819- -0x550,_0x3dfbb6);}this['options']['worker']?this[_0x210cd6(0x14e,0x127)]():this[_0x210cd6(0xaf,0xc8)]=new CanvasWindField(this['options']);}[_0x27456a(0x57e,0x603)](){function _0x2c1570(_0x5e9dcd,_0x2bd639){return _0x688102(_0x5e9dcd,_0x2bd639- -0x238);}this[_0x2c1570(0x1fe,0x263)]=this['_createCanvas']();const _0x7e7bd5={};_0x7e7bd5['willReadFrequently']=!![],this[_0xb9c7d9(0x404,0x3b3)]=this['canvas']['getContext']('2d',_0x7e7bd5),this[_0x2c1570(0x2e2,0x2d6)]();function _0xb9c7d9(_0x56387c,_0x51749b){return _0x688102(_0x56387c,_0x51749b- -0x161);}this[_0xb9c7d9(0x2d7,0x2ed)]['data']&&this['setData'](this[_0x2c1570(0x266,0x216)]['data']);}[_0x27456a(0x5ab,0x5ef)](){this['clear']();function _0x3803e8(_0x56b465,_0x1333ba){return _0x27456a(_0x56b465- -0x61,_0x1333ba);}function _0x139c28(_0x246d9a,_0x54a865){return _0x688102(_0x246d9a,_0x54a865-0x95);}this['unbindEvent'](),this['canvas']&&(this[_0x139c28(0x4f2,0x4c6)]['container'][_0x3803e8(0x4d6,0x537)](this[_0x3803e8(0x530,0x5ba)]),delete this['canvas']);}['_createCanvas'](){const _0x5a3f37=mars3d__namespace['DomUtil']['create'](_0x26ac24(0x3c6,0x403),_0x26ac24(0x44c,0x42d),this[_0x12c591(0x416,0x3ed)]['container']);_0x5a3f37['style'][_0x26ac24(0x3ad,0x3bf)]=_0x26ac24(0x434,0x48a),_0x5a3f37['style'][_0x12c591(0x43f,0x3ea)]='0px',_0x5a3f37[_0x26ac24(0x42e,0x440)]['left']='0px',_0x5a3f37[_0x12c591(0x506,0x494)]['width']=this['_map']['scene'][_0x26ac24(0x473,0x403)][_0x26ac24(0x4a8,0x466)]+'px',_0x5a3f37['style']['height']=this[_0x12c591(0x40e,0x3ed)]['scene']['canvas'][_0x12c591(0x49f,0x499)]+'px',_0x5a3f37['style']['pointerEvents']=this['_pointerEvents']?'auto':'none',_0x5a3f37['style'][_0x26ac24(0x3cb,0x3b0)]=this['options']['zIndex']??0x9,_0x5a3f37[_0x26ac24(0x402,0x38f)]=this['_map'][_0x12c591(0x374,0x3cc)]['canvas'][_0x26ac24(0x4e1,0x466)];function _0x26ac24(_0x2754ec,_0x485757){return _0x27456a(_0x485757- -0x18e,_0x2754ec);}function _0x12c591(_0x43c49e,_0x1fb996){return _0x27456a(_0x1fb996- -0x13a,_0x43c49e);}return _0x5a3f37[_0x26ac24(0x3c8,0x451)]=this['_map']['scene']['canvas']['clientHeight'],_0x5a3f37;}['resize'](){function _0x2213eb(_0x11d44e,_0x2d4f5b){return _0x27456a(_0x2d4f5b-0x19,_0x11d44e);}function _0x55be4c(_0x264e3a,_0x360f13){return _0x688102(_0x264e3a,_0x360f13- -0x1b8);}this['canvas']&&(this['canvas']['style'][_0x55be4c(0x2f7,0x26f)]=this['_map']['scene']['canvas']['clientWidth']+'px',this[_0x2213eb(0x5ce,0x5aa)]['style'][_0x55be4c(0x343,0x331)]=this[_0x2213eb(0x541,0x540)]['scene'][_0x2213eb(0x5ca,0x5aa)][_0x2213eb(0x5fa,0x5ec)]+'px',this['canvas']['width']=this[_0x2213eb(0x59a,0x540)]['scene']['canvas']['clientWidth'],this[_0x55be4c(0x2ed,0x2e3)][_0x55be4c(0x2bd,0x331)]=this[_0x55be4c(0x223,0x279)]['scene'][_0x2213eb(0x5c7,0x5aa)]['clientHeight']);}[_0x27456a(0x604,0x650)](){const _0x4d0f87=this;function _0x2e6091(_0x5baa7c,_0x2cff8a){return _0x27456a(_0x2cff8a- -0x118,_0x5baa7c);}let _0x540775=Date['now']();(function _0x4388c5(){function _0x3ec00d(_0x1e206a,_0x154958){return _0x3e17(_0x1e206a-0xc1,_0x154958);}if(_0x4d0f87['isDestroy'])return;function _0x5c7f0e(_0x49ceec,_0x2fd17a){return _0x3e17(_0x49ceec- -0x272,_0x2fd17a);}_0x4d0f87['_animateFrame']=window[_0x3ec00d(0x377,0x336)](_0x4388c5);if(_0x4d0f87['show']&&_0x4d0f87['windField']){const _0x162cc5=Date['now'](),_0x482ae7=_0x162cc5-_0x540775;_0x482ae7>_0x4d0f87[_0x5c7f0e(0x60,0x65)]&&(_0x540775=_0x162cc5-_0x482ae7%_0x4d0f87['frameTime'],_0x4d0f87['update']());}}(),window['addEventListener']('resize',this['resize']['bind'](this),![]),this[_0x2e6091(0x461,0x3ff)]=![],this[_0x5a6e06(0x2d,0x59)]=![]);function _0x5a6e06(_0x1c25d3,_0x36490f){return _0x27456a(_0x36490f- -0x578,_0x1c25d3);}this[_0x5a6e06(-0x6f,-0x34)]['mouseHidden']&&(this[_0x2e6091(0x3c6,0x40f)]['on'](mars3d__namespace[_0x2e6091(0x549,0x4ff)]['wheel'],this['_onMapWhellEvent'],this),this['_map']['on'](mars3d__namespace['EventType']['mouseDown'],this[_0x5a6e06(-0x2a,0x52)],this),this['_map']['on'](mars3d__namespace['EventType'][_0x2e6091(0x45f,0x43d)],this[_0x5a6e06(-0x42,-0x29)],this));}['unbindEvent'](){function _0x576f1a(_0x30c720,_0x5a5b07){return _0x27456a(_0x30c720- -0x20a,_0x5a5b07);}function _0xdf8da2(_0x1ec99d,_0x3cea81){return _0x688102(_0x3cea81,_0x1ec99d-0x25);}window['cancelAnimationFrame'](this[_0x576f1a(0x37f,0x3e3)]),delete this['_animateFrame'],window[_0x576f1a(0x34c,0x2fd)]('resize',this['resize']),this['options']['mouseHidden']&&(this[_0x576f1a(0x31d,0x38d)]['off'](mars3d__namespace['EventType']['wheel'],this['_onMapWhellEvent'],this),this['_map'][_0x576f1a(0x31e,0x39b)](mars3d__namespace['EventType']['mouseDown'],this[_0x576f1a(0x3c0,0x34e)],this),this['_map'][_0x576f1a(0x31e,0x2a5)](mars3d__namespace['EventType'][_0xdf8da2(0x484,0x4c0)],this[_0xdf8da2(0x47e,0x4b6)],this),this[_0xdf8da2(0x456,0x3cb)]['off'](mars3d__namespace['EventType']['mouseMove'],this[_0xdf8da2(0x4e3,0x4f0)],this));}['_onMapWhellEvent'](_0x35ecd4){function _0x46a1e3(_0x3c961f,_0x1a996c){return _0x27456a(_0x3c961f- -0x1b9,_0x1a996c);}clearTimeout(this['refreshTimer']);if(!this[_0x46a1e3(0x405,0x3b6)]||!this[_0x3a3bea(-0x4e,-0x3b)])return;function _0x3a3bea(_0x348712,_0xcd8cfa){return _0x27456a(_0x348712- -0x5df,_0xcd8cfa);}this['canvas']['style'][_0x3a3bea(-0x2f,0xf)]=_0x46a1e3(0x421,0x44b),this['refreshTimer']=setTimeout(()=>{function _0x524799(_0x35ba62,_0x5caedb){return _0x3a3bea(_0x5caedb-0x5b5,_0x35ba62);}if(!this['show'])return;function _0x39c468(_0x4f930e,_0x47d6f6){return _0x46a1e3(_0x47d6f6- -0x357,_0x4f930e);}this[_0x524799(0x5c0,0x5c6)](),this[_0x524799(0x553,0x567)][_0x39c468(0x4c,0xbe)]['visibility']='visible';},0xc8);}['_onMouseDownEvent'](_0x2fc521){function _0x101fb7(_0x5ae2c9,_0x3985f7){return _0x27456a(_0x5ae2c9- -0x4b1,_0x3985f7);}this[_0x101fb7(0x66,0x27)]=!![],this['_map'][_0x101fb7(0x77,0xed)](mars3d__namespace[_0x101fb7(0x166,0xeb)][_0x550518(0x4e,0x42)],this['_onMouseMoveEvent'],this);function _0x550518(_0x5486f2,_0x14b8dc){return _0x688102(_0x14b8dc,_0x5486f2- -0x3c7);}this['_map']['on'](mars3d__namespace['EventType']['mouseMove'],this[_0x550518(0xf7,0x16d)],this);}['_onMouseMoveEvent'](_0x102eb7){function _0x51fd53(_0x107bf4,_0x129826){return _0x27456a(_0x129826- -0x16d,_0x107bf4);}if(!this[_0x50f001(0x292,0x2ce)]||!this['canvas'])return;function _0x50f001(_0x3362be,_0x4721bc){return _0x688102(_0x4721bc,_0x3362be- -0x236);}this['mouse_down']&&(this['canvas'][_0x51fd53(0x408,0x461)]['visibility']=_0x50f001(0x2ae,0x26c),this['mouse_move']=!![]);}['_onMouseUpEvent'](_0x3bd1e0){if(!this['show']||!this['canvas'])return;function _0x31359c(_0x5aed68,_0x2e27d3){return _0x27456a(_0x2e27d3- -0x2e3,_0x5aed68);}this['_map'][_0x31359c(0x1e8,0x245)](mars3d__namespace['EventType'][_0x31359c(0x1c0,0x228)],this['_onMouseMoveEvent'],this);this['mouse_down']&&this[_0x12fb92(-0x33,0x13)]&&this[_0x12fb92(0x14,0x32)]();function _0x12fb92(_0x28f346,_0x5ba602){return _0x27456a(_0x5ba602- -0x5be,_0x28f346);}this['canvas'][_0x12fb92(0x43,0x10)]['visibility']='visible',this[_0x12fb92(-0xd2,-0xa7)]=![],this['mouse_move']=![];}['setData'](_0x110113){this['clear'](),this['windData']=_0x110113,this['windField']['setDate'](_0x110113);function _0x5f0ebd(_0xac4904,_0x5a1d31){return _0x688102(_0x5a1d31,_0xac4904- -0x1f0);}this[_0x5f0ebd(0x30a,0x31b)]();}['redraw'](){if(!this['show'])return;function _0x13cb22(_0x5bffae,_0x4f3ca9){return _0x688102(_0x5bffae,_0x4f3ca9- -0x5bd);}this[_0x13cb22(-0x1a3,-0x1a5)]['setOptions'](this['options']),this['update']();}[_0x688102(0x4fb,0x4d7)](){if(this[_0x3124c9(0x49c,0x486)])return;this['_updateIng']=!![];function _0x3124c9(_0x4da3a8,_0x21efd3){return _0x688102(_0x21efd3,_0x4da3a8- -0x5c);}if(this[_0x16d455(-0x42,0x23)])this['windField']['update']();else{const _0x181b1d=this[_0x16d455(-0x110,-0x11c)]['getParticles']();this['_drawLines'](_0x181b1d);}function _0x16d455(_0xd75c18,_0x403f3c){return _0x27456a(_0xd75c18- -0x61e,_0x403f3c);}this['_updateIng']=![];}['_drawLines'](_0x449186){function _0x2726aa(_0x5200a9,_0x4720fe){return _0x27456a(_0x4720fe- -0x62b,_0x5200a9);}this['_canvasParticles']=_0x449186,this['canvasContext']['globalCompositeOperation']=_0x20a07f(0x270,0x1f1),this['canvasContext'][_0x2726aa(-0xcc,-0x11c)](0x0,0x0,this['canvasWidth'],this[_0x2726aa(-0x93,-0xb5)]),this[_0x20a07f(0x2f6,0x2d7)]['globalCompositeOperation']=_0x2726aa(-0x2c,-0xb0),this[_0x20a07f(0x2f6,0x2fe)]['globalAlpha']=0.9;function _0x20a07f(_0x26a6c9,_0x2002df){return _0x27456a(_0x26a6c9- -0x314,_0x2002df);}const _0x4ac714=this[_0x2726aa(-0xc5,-0x104)][_0x20a07f(0x1f2,0x26d)]['mode']!==Cesium['SceneMode']['SCENE3D'],_0x2233d6=this['canvasWidth']*0.25;if(this['_colorRamp'])for(let _0x5398b3=0x0,_0x2f8cbf=_0x449186[_0x2726aa(-0x10f,-0x9b)];_0x5398b3<_0x2f8cbf;_0x5398b3++){const _0x89e3d=_0x449186[_0x5398b3],_0x2f6b54=this[_0x20a07f(0x21b,0x216)](_0x89e3d,_0x89e3d['lng'],_0x89e3d['lat'],_0x89e3d[_0x20a07f(0x20f,0x1d8)]),_0x1c2723=this['_tomap'](_0x89e3d,_0x89e3d['tlng'],_0x89e3d['tlat'],_0x89e3d['talt']);if(!_0x2f6b54||!_0x1c2723)continue;if(_0x4ac714&&Math['abs'](_0x2f6b54[0x0]-_0x1c2723[0x0])>=_0x2233d6)continue;this['canvasContext']['beginPath'](),this[_0x20a07f(0x2f6,0x29a)]['lineWidth']=this['lineWidth'],this['canvasContext']['strokeStyle']=this[_0x2726aa(-0x84,-0x40)]['getColor'](_0x89e3d['speed']),this['canvasContext'][_0x2726aa(-0xd4,-0x68)](_0x2f6b54[0x0],_0x2f6b54[0x1]),this[_0x20a07f(0x2f6,0x2f0)]['lineTo'](_0x1c2723[0x0],_0x1c2723[0x1]),this[_0x2726aa(-0x7f,-0x21)][_0x20a07f(0x23d,0x204)]();}else{this['canvasContext']['beginPath'](),this[_0x20a07f(0x2f6,0x2b4)]['lineWidth']=this['lineWidth'],this[_0x2726aa(0x7,-0x21)]['strokeStyle']=this[_0x2726aa(-0x60,-0x83)];for(let _0x4de8e6=0x0,_0x5b5ba5=_0x449186['length'];_0x4de8e6<_0x5b5ba5;_0x4de8e6++){const _0x30bb25=_0x449186[_0x4de8e6],_0x2a2e66=this['_tomap'](_0x30bb25,_0x30bb25[_0x2726aa(-0x30,-0xb9)],_0x30bb25['lat'],_0x30bb25[_0x2726aa(-0x113,-0x108)]),_0x2e6677=this[_0x20a07f(0x21b,0x28f)](_0x30bb25,_0x30bb25['tlng'],_0x30bb25[_0x20a07f(0x222,0x226)],_0x30bb25['talt']);if(!_0x2a2e66||!_0x2e6677)continue;if(_0x4ac714&&Math['abs'](_0x2a2e66[0x0]-_0x2e6677[0x0])>=_0x2233d6)continue;this['canvasContext'][_0x2726aa(-0xbd,-0x68)](_0x2a2e66[0x0],_0x2a2e66[0x1]),this['canvasContext'][_0x20a07f(0x23f,0x1b7)](_0x2e6677[0x0],_0x2e6677[0x1]);}this[_0x2726aa(0x60,-0x21)][_0x20a07f(0x23d,0x27e)]();}}['_tomap'](_0x3ce6bc,_0x11b60a,_0x58beb5,_0x5b9dfa){const _0x56ee93=Cesium['Cartesian3']['fromDegrees'](_0x11b60a,_0x58beb5,_0x5b9dfa??this[_0x464e05(0x41,0x18)]),_0x55e3cf=this[_0x464e05(0x6a,0xa)]['scene'];if(_0x55e3cf['mode']===Cesium['SceneMode']['SCENE3D']){const _0x369a85=new Cesium['EllipsoidalOccluder'](_0x55e3cf[_0x464e05(0x92,0x6a)]['ellipsoid'],_0x55e3cf[_0x464e05(0x115,0xeb)]['positionWC']),_0x4d8321=_0x369a85['isPointVisible'](_0x56ee93);if(!_0x4d8321)return _0x3ce6bc['age']=0x0,null;}function _0x464e05(_0x1b8be8,_0xcc5248){return _0x688102(_0x1b8be8,_0xcc5248- -0x427);}const _0xc8621=mars3d__namespace[_0xbd8e11(0x23,0x8a)][_0x464e05(0xd2,0xb7)](this[_0x464e05(0x3c,0xa)][_0x464e05(0x24,-0x17)],_0x56ee93);function _0xbd8e11(_0x3c1dfc,_0x952148){return _0x688102(_0x3c1dfc,_0x952148- -0x3ea);}return _0xc8621?[_0xc8621['x'],_0xc8621['y']]:null;}['clear'](){function _0x11d44d(_0x3ecc38,_0x371e0b){return _0x27456a(_0x371e0b- -0x32f,_0x3ecc38);}this[_0x11d44d(0x172,0x1df)]['clear'](),delete this['windData'];}[_0x27456a(0x5ad,0x61a)](){function _0x5bd647(_0x6358d6,_0x79f79b){return _0x27456a(_0x79f79b- -0x587,_0x6358d6);}function _0x443805(_0x156408,_0x38fa32){return _0x27456a(_0x38fa32- -0x440,_0x156408);}this[_0x443805(0x1bd,0x19c)]=new Worker(this['options']['worker']),this[_0x443805(0x11e,0x19c)]['onmessage']=_0x4f131c=>{function _0x54ee90(_0x33b69f,_0x57bad6){return _0x443805(_0x33b69f,_0x57bad6-0xce);}this['_drawLines'](_0x4f131c['data'][_0x54ee90(0x218,0x28f)]),this['_updateIng2']=![];},this['windField']={'init':_0xd66932=>{function _0x31d3e9(_0x78fe82,_0x3578d3){return _0x443805(_0x3578d3,_0x78fe82-0x340);}const _0x2acc11={};function _0x37f568(_0x5c7d47,_0x318ec3){return _0x5bd647(_0x318ec3,_0x5c7d47- -0xb5);}_0x2acc11['type']='init',_0x2acc11[_0x31d3e9(0x444,0x45a)]=_0xd66932,this[_0x31d3e9(0x4dc,0x48b)]['postMessage'](_0x2acc11);},'setOptions':_0x5b1341=>{const _0x566c91={};function _0x2135ea(_0x50f1dd,_0x34de47){return _0x5bd647(_0x34de47,_0x50f1dd- -0x8d);}_0x566c91['type']='setOptions';function _0x6aa499(_0x29de3f,_0x2f562a){return _0x5bd647(_0x2f562a,_0x29de3f- -0x13f);}_0x566c91[_0x6aa499(-0x182,-0x18f)]=_0x5b1341,this[_0x2135ea(-0x38,-0x87)]['postMessage'](_0x566c91);},'setDate':_0x15fa1a=>{function _0x141ca1(_0x4d5a01,_0x55a797){return _0x5bd647(_0x55a797,_0x4d5a01-0x3fa);}function _0x4c381b(_0x4238b9,_0x31f727){return _0x5bd647(_0x4238b9,_0x31f727-0xab);}const _0x203503={};_0x203503[_0x4c381b(-0xa,0x5e)]=_0x4c381b(0x36,0x7f),_0x203503[_0x4c381b(0x61,0x54)]=_0x15fa1a,this[_0x4c381b(0xce,0x100)]['postMessage'](_0x203503);},'update':()=>{function _0x3aa797(_0x49adaa,_0x50d0ab){return _0x5bd647(_0x50d0ab,_0x49adaa-0x5aa);}function _0x4341f3(_0x3f081c,_0x3939ad){return _0x443805(_0x3939ad,_0x3f081c-0x491);}if(this[_0x3aa797(0x52d,0x53e)])return;this['_updateIng2']=!![];const _0x4aef65={};_0x4aef65[_0x4341f3(0x58b,0x57f)]=_0x3aa797(0x5f0,0x633),this[_0x3aa797(0x5ff,0x5da)][_0x3aa797(0x638,0x5ca)](_0x4aef65);},'clear':()=>{function _0x152bd4(_0x5e5045,_0x2d9180){return _0x443805(_0x5e5045,_0x2d9180-0x4ed);}const _0x5f4084={};function _0x26278f(_0x46b32b,_0x4a5184){return _0x443805(_0x4a5184,_0x46b32b- -0x1d9);}_0x5f4084[_0x152bd4(0x5dd,0x5e7)]='clear',this['worker'][_0x152bd4(0x648,0x6c2)](_0x5f4084);}},this[_0x5bd647(-0x7b,-0x79)]['init'](this[_0x443805(0xcc,0x104)]);}}function _0x1683(){const _0x860f35=['Math','shaderProgram','_onMapWhellEvent','tlng','randomBetween','umin','ZERO','pixelFormat','_colorRamp','clearFramebuffers','isInExtent','_updateIng','blending','redraw','setData','age','clearCommand','clientWidth','enabled','_setOptionsHook','destroyParticlesTextures','fadeOpacity','nextTrails','3138336qjqOYK','pointerEvents','frameTime','execute','commandList','fragmentShaderSource','max','particles','array','TRIANGLES','bindEvent','getUVByXY','UNSIGNED_INT','autoClear','camera','layer','canvasContext','434049AWsGnW','floor','setOptions','Compute','ymin','BaseLayer','_data','cols','colorTable','nextTrailsColor','postMessage','pow','EventType','absolute','Matrix4','particlesComputing','WindLayer','scene','globeBoundingSphere','lon','dropRate','_updateIng2','mouseMove','createRawRenderState','maxAge','windField','fillRect','DISABLE_GL_POSITION_LOG_DEPTH','addEventListener','getV','depthMask','previousParticlesPosition','Cesium','geometry','mouse_down','lev','103908xvQChh','DepthFunction','outputTexture','LayerUtil','width','drawingBufferWidth','rgb(206,255,255)','_calcUV','pixelDatatype','dynamic','alt','top','ClearCommand','colour','_map','off','_pointerEvents','ymax','uSpeedRange','min','lonRange','computeViewRectangle','_tomap','data','uniformMap','canvasWidth','pixelSize','updateViewerParameters','fixedHeight','tlat','removeChild','arrayBufferView','createWindTextures','type','toDegrees','_maxAge','removeAll','zIndex','destroy','primitives','PrimitiveCollection','createSegmentsGeometry','sources','options','_bilinearInterpolation','reverse','default','west','clear','depthTest','createComputingPrimitives','createFramebuffer','position','framebuffers','_onMouseUpEvent','latRange','stroke','830598ABewxH','lineTo','5HiLfqH','mouseUp','removeEventListener','currentTrails','FLOAT','vdata','getColorTexture','setDate','commandType','forEach','lat','vertexShaderSource','#ffffff','TWO_PI','attributeLocations','getRandomLatLng','viewport','particlesNumber','BufferUsage','Rectangle','PI_OVER_THREE','viewRectangleToLonLatRange','PointTrans','wSpeedRange','RGBA','calculateSpeed','toGridXY','refreshParticles','speedRate','particlesRendering','lng','register','GeometryAttribute','Pass','canvasHeight','speed','maxParticles','Texture','textures','lighter','particleSystem','DEPTH_COMPONENT','_addedHook','xmax','createCommand','PI_OVER_TWO','__esModule','_randomParticle','destination-in','canvasResize','SCENE3D','globe','framebuffer','_animateFrame','Geometry','PixelDatatype','windTextures','TextureMinificationFilter','getDirection','persists','length','canvas','particlesSpeed','dimensions','VertexArray','mod','grid','particlesTextureSize','reverseY','createRenderingPrimitives','minimum','context','4iIbueA','preRender','100258wZKGqo','owner','particlesTextures','ShaderSource','createTexture','steps','CanvasWindField','UNSIGNED_BYTE','xmin','3089544HhiXMl','color','frameRate','sqrt','_removedHook','viewerParameters','initWorker','getUVByPoint','randomizeParticles','visibility','cos','defineProperty','rows','_onMouseMoveEvent','currentParticlesPosition','preExecute','push','getSpeed','segments','1014839WBDhnt','mars3d-canvasWind','ComponentDatatype','commandToExecute','show','postProcessingPosition','CanvasWindLayer','BoundingSphere','defined','moveTo','random','STATIC_DRAW','getFullscreenQuad','speedScaleFactor','Cartesian2','trails','_onMouseDownEvent','screen','atan2','update','style','drawingBufferHeight','_canrefresh','mouse_move','fromDegrees','clientHeight','toWindowCoordinates','resize','depthTexture','Draw','windData','updatePosition','hidden','colors','worker','vertexArray','PrimitiveType','height','requestAnimationFrame','getOptions','add'];_0x1683=function(){return _0x860f35;};return _0x1683();}mars3d__namespace[_0x688102(0x480,0x426)]['register']('canvasWind',CanvasWindLayer),mars3d__namespace[_0x688102(0x59a,0x513)][_0x27456a(0x5c0,0x5b0)]=CanvasWindLayer,mars3d__namespace['CanvasWindField']=CanvasWindField,mars3d__namespace['WindUtil']=WindUtil,exports[_0x27456a(0x5a4,0x5c9)]=CanvasWindField,exports['CanvasWindLayer']=CanvasWindLayer,exports['WindLayer']=WindLayer,exports['WindUtil']=WindUtil;const _0x43afe1={};_0x43afe1['value']=!![],Object['defineProperty'](exports,_0x688102(0x4f1,0x48c),_0x43afe1);
}));
