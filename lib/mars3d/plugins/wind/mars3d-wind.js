/**
 * Mars3D平台插件,支持气象 风向图 功能插件  mars3d-wind
 *
 * 版本信息：v3.9.4
 * 编译日期：2025-03-23 21:04
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：火星科技免费公开版 ，2025-02-01
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-wind"] = {}, global.mars3d));
})(this, (function (exports, mars3d) { 
'use strict';(function(_0x4f6034,_0x18bace){function _0x3adedc(_0x46d6a6,_0x1c6e06){return _0x5224(_0x46d6a6-0x37b,_0x1c6e06);}function _0x135b0a(_0x1bcd72,_0x475a4c){return _0x5224(_0x475a4c-0x8,_0x1bcd72);}const _0x3aae6a=_0x4f6034();while(!![]){try{const _0x4e6995=parseInt(_0x3adedc(0x4b9,0x4e7))/0x1+-parseInt(_0x135b0a(0x1ac,0x189))/0x2*(parseInt(_0x3adedc(0x55e,0x57d))/0x3)+-parseInt(_0x135b0a(0x1a6,0x1f0))/0x4+-parseInt(_0x3adedc(0x5ba,0x5b0))/0x5+parseInt(_0x3adedc(0x4f2,0x470))/0x6*(parseInt(_0x3adedc(0x5b4,0x5a5))/0x7)+-parseInt(_0x3adedc(0x59d,0x5a5))/0x8+parseInt(_0x3adedc(0x551,0x5a0))/0x9;if(_0x4e6995===_0x18bace)break;else _0x3aae6a['push'](_0x3aae6a['shift']());}catch(_0x1ed339){_0x3aae6a['push'](_0x3aae6a['shift']());}}}(_0x14fc,0xa0441));function _interopNamespace(_0x480a1e){if(_0x480a1e&&_0x480a1e['__esModule'])return _0x480a1e;var _0x5958f4=Object['create'](null);_0x480a1e&&Object['keys'](_0x480a1e)[_0x2efcea(0x35b,0x313)](function(_0x40c26b){function _0x1df039(_0x34669c,_0x29ef1c){return _0x2efcea(_0x34669c,_0x29ef1c- -0x2cf);}function _0x23e10a(_0x2d842c,_0x22e932){return _0x2efcea(_0x22e932,_0x2d842c- -0xe2);}if(_0x40c26b!=='default'){var _0x1cb85d=Object[_0x1df039(0x11,0x28)](_0x480a1e,_0x40c26b);Object['defineProperty'](_0x5958f4,_0x40c26b,_0x1cb85d[_0x1df039(-0x5b,-0x91)]?_0x1cb85d:{'enumerable':!![],'get':function(){return _0x480a1e[_0x40c26b];}});}});_0x5958f4[_0xa0b1fd(0xe1,0x16e)]=_0x480a1e;function _0xa0b1fd(_0x2c5de6,_0x6e6efd){return _0x5224(_0x6e6efd-0x3d,_0x2c5de6);}function _0x2efcea(_0x429a6c,_0x1a20df){return _0x5224(_0x1a20df-0x10b,_0x429a6c);}return _0x5958f4;}var mars3d__namespace=_interopNamespace(mars3d);const Cesium$2=mars3d__namespace[_0x419219(-0x12c,-0x152)];function getU(_0x44a471,_0x41e5c0){const _0x42eb33=_0x44a471*Math['cos'](Cesium$2[_0x243d0f(0x24a,0x1d0)]['toRadians'](_0x41e5c0));function _0x243d0f(_0x4dae4e,_0x446416){return _0x419219(_0x4dae4e,_0x446416-0x2b1);}return _0x42eb33;}function getV(_0x4fa628,_0x41f6b7){function _0x1a3671(_0x281c6a,_0x3e1a34){return _0x419219(_0x281c6a,_0x3e1a34-0x498);}const _0x1a6223=_0x4fa628*Math['sin'](Cesium$2['Math'][_0x1a3671(0x332,0x34b)](_0x41f6b7));return _0x1a6223;}function getSpeed(_0x5e1293,_0x30dab4){const _0x57b621=Math['sqrt'](Math['pow'](_0x5e1293,0x2)+Math['pow'](_0x30dab4,0x2));return _0x57b621;}function _0x14fc(){const _0xa652b4=['getUVByXY','geometry','getPostProcessingPositionShader','color','316326VRGwKZ','OPAQUE','colors','rectangle','hasOwnProperty','updatePosition','bounds','pointerEvents','array','_calc_speedRate','2Fbqzpm','canvas','fixedHeight','enabled','blending','computing','vdata','bind','scene','STATIC_DRAW','Cartesian2','layer','east','push','Unknown\x20command\x20type','min\x20is\x20undefined,\x20calculate\x20min','fragmentShaderSource','dynamic','LINEAR','lineLength','_onMouseMoveEvent','destroy','options','segmentsColor','Cartesian3','north','camera','particlesTextureSize','onColorTableChange','worker','pixelDatatype','_canvasParticles','isDynamic','_updateIng','onmessage','pass','mouse_down','WindUtil','createCommand','createRawRenderState','postProcessingPosition','PointTrans','drawingBufferWidth','DEPTH_COMPONENT','particlesSpeed','reCreateWindTextures','segments','getSpeed','alpha','quietPeriod','context','particlesNumber','now','rows','call','bufferUsage','DomUtil','getSegmentDrawVertexShader','particlesTextures','drawingBufferHeight','defineProperty','Math','max','setOptions','dropRateBump','mouseUp','#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0auniform\x20sampler2D\x20nextParticlesPosition;\x0auniform\x20sampler2D\x20particlesSpeed;\x20//\x20(u,\x20v,\x20norm)\x0a\x0a//\x20range\x20(min,\x20max)\x0auniform\x20vec2\x20lonRange;\x0auniform\x20vec2\x20latRange;\x0a\x0a//\x20range\x20(min,\x20max)\x0auniform\x20vec2\x20dataLonRange;\x0auniform\x20vec2\x20dataLatRange;\x0a\x0auniform\x20float\x20randomCoefficient;\x0auniform\x20float\x20dropRate;\x0auniform\x20float\x20dropRateBump;\x0a\x0a//\x20添加新的\x20uniform\x20变量\x0auniform\x20bool\x20useViewerBounds;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0a//\x20pseudo-random\x20generator\x0aconst\x20vec3\x20randomConstants\x20=\x20vec3(12.9898f,\x2078.233f,\x204375.85453f);\x0aconst\x20vec2\x20normalRange\x20=\x20vec2(0.0f,\x201.0f);\x0afloat\x20rand(vec2\x20seed,\x20vec2\x20range)\x20{\x0a\x20\x20vec2\x20randomSeed\x20=\x20randomCoefficient\x20*\x20seed;\x0a\x20\x20float\x20temp\x20=\x20dot(randomConstants.xy,\x20randomSeed);\x0a\x20\x20temp\x20=\x20fract(sin(temp)\x20*\x20(randomConstants.z\x20+\x20temp));\x0a\x20\x20return\x20temp\x20*\x20(range.y\x20-\x20range.x)\x20+\x20range.x;\x0a}\x0a\x0avec2\x20generateRandomParticle(vec2\x20seed)\x20{\x0a\x20\x20vec2\x20range;\x0a\x20\x20float\x20randomLon,\x20randomLat;\x0a\x0a\x20\x20if(useViewerBounds)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20在当前视域范围内生成粒子\x0a\x20\x20\x20\x20randomLon\x20=\x20rand(seed,\x20lonRange);\x0a\x20\x20\x20\x20randomLat\x20=\x20rand(-seed,\x20latRange);\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20在数据范围内生成粒子\x0a\x20\x20\x20\x20randomLon\x20=\x20rand(seed,\x20dataLonRange);\x0a\x20\x20\x20\x20randomLat\x20=\x20rand(-seed,\x20dataLatRange);\x0a\x20\x20}\x0a\x0a\x20\x20return\x20vec2(randomLon,\x20randomLat);\x0a}\x0a\x0abool\x20particleOutbound(vec2\x20particle)\x20{\x0a\x20\x20return\x20particle.y\x20<\x20dataLatRange.x\x20||\x20particle.y\x20>\x20dataLatRange.y\x20||\x20particle.x\x20<\x20dataLonRange.x\x20||\x20particle.x\x20>\x20dataLonRange.y;\x0a}\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20vec2\x20nextParticle\x20=\x20texture(nextParticlesPosition,\x20v_textureCoordinates).rg;\x0a\x20\x20vec4\x20nextSpeed\x20=\x20texture(particlesSpeed,\x20v_textureCoordinates);\x0a\x20\x20float\x20speedNorm\x20=\x20nextSpeed.a;\x0a\x20\x20float\x20particleDropRate\x20=\x20dropRate\x20+\x20dropRateBump\x20*\x20speedNorm;\x0a\x0a\x20\x20vec2\x20seed1\x20=\x20nextParticle.xy\x20+\x20v_textureCoordinates;\x0a\x20\x20vec2\x20seed2\x20=\x20nextSpeed.rg\x20+\x20v_textureCoordinates;\x0a\x20\x20vec2\x20randomParticle\x20=\x20generateRandomParticle(seed1);\x0a\x20\x20float\x20randomNumber\x20=\x20rand(seed2,\x20normalRange);\x0a\x0a\x20\x20if(randomNumber\x20<\x20particleDropRate\x20||\x20particleOutbound(nextParticle))\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(randomParticle,\x200.0f,\x201.0f);\x20//\x201.0\x20means\x20this\x20is\x20a\x20random\x20particle\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(nextParticle,\x200.0f,\x200.0f);\x0a\x20\x20}\x0a}\x0a','requestRender','minificationFilter','MIN_VALUE','xmax','clear','tlng','isArray','_calcUV','_onMouseUpEvent','textures','frameRate','random','clientHeight','strokeStyle','ellipsoid','frameRateAdjustment','speed','fillRect','23988645UDlufL','grid','_drawLines','red','createParticlesTextures','lineTo','data','style','height','speedFactor','_updateIng2','flatMap','vertexShaderSource','2094249glKydF','talt','sources','latRange','none','1666552dUEjbR','wrapS','getParticles','componentDatatype','getOwnPropertyDescriptor','UNSIGNED_BYTE','outputTexture','fromDegrees','_onMapWhellEvent','onParticlesTextureSizeChange','dropRate','object','visibility','stringify','south','age','windData','type','initWorker','rendering','getUVByPoint','lng','segmentsDepth','__proto__','values','clientWidth','clearCommand','changeOptions','globalCompositeOperation','displayRange','tlat','createRenderingFramebuffers','forEach','colorTable','requestAnimationFrame','canvasContext','number','commandList','container','blendFuncDestination','primitives','rawRenderState','mouseDown','getPrimitives','register','LayerUtil','_colorRamp','floor','BaseLayer','destination-in','mode','unbindEvent','width','applyViewerParameters','percentageChanged','alt','#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0auniform\x20sampler2D\x20currentParticlesPosition;\x0auniform\x20sampler2D\x20particlesSpeed;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20获取当前粒子的位置\x0a\x20\x20vec2\x20currentPos\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rg;\x0a\x20\x20\x20\x20//\x20获取粒子的速度\x0a\x20\x20vec2\x20speed\x20=\x20texture(particlesSpeed,\x20v_textureCoordinates).rg;\x0a\x20\x20\x20\x20//\x20计算下一个位置\x0a\x20\x20vec2\x20nextPos\x20=\x20currentPos\x20+\x20speed;\x0a\x0a\x20\x20\x20\x20//\x20将新的位置写入\x20fragColor\x0a\x20\x20fragColor\x20=\x20vec4(nextPos,\x200.0f,\x201.0f);\x0a}\x0a','canvasHeight','3651496xcKAWG','frameRateMonitor','pixelFormat','all','nextParticlesPosition','min','shaderProgram','moveTo','mouse_move','domain','cartesianToCartographic','_speedRate','redraw','toDegrees','morphComplete','addEventListener','add','FLOAT','commandToExecute','commandType','NEAREST','_addedHook','CLAMP_TO_EDGE','77zQMXLy','globalAlpha','warn','createSegmentsGeometry','createRenderingTextures','_map','6059385dwnsJm','Compute','viewport','fromGeometry','processWindData','EventType','currentParticlesPosition','getDefaultRenderState','particles','west','setDate','Draw','zIndex','default','ONE_MINUS_SRC_ALPHA','get','hidden','clearFramebuffers','ymin','update','lat','abs','framebuffer','SCENE3D','bindEvent','blendFuncSource','194148UjYkHU','__esModule','_randomParticle','setData','off','xmin','WindLayer','flipY','uniformMap','maxAge','remove','_removedHook','windTextures','lineWidth','UNSIGNED_INT','Cesium','getSegmentDrawFragmentShader','attributeLocations','framebuffers','getUpdatePositionShader','toRadians','show','_animateFrame','init','windField','_pointerEvents','length','auto','RED','getCalculateSpeedShader','umax','particleSystem','CanvasWindField','atan2','resize','viewerParameters','preExecute','cols','initFrameRate','renderState','removeEventListener','_onMouseDownEvent','updateViewerParameters','ymax','createPrimitives','ColorRamp','_maxAge','Invalid\x20particlesTextureSize.\x20Using\x20default\x20value\x20of\x20256.','pixelSize','globe','magnificationFilter','_tomap','sceneMode'];_0x14fc=function(){return _0xa652b4;};return _0x14fc();}function getDirection(_0x2497e8,_0x59ab0b){function _0x1a9a30(_0x41ed8b,_0x45c109){return _0x419219(_0x41ed8b,_0x45c109- -0x135);}let _0x30772b=Cesium$2['Math'][_0x4bf004(0xcc,0xfc)](Math[_0x4bf004(-0x5d,0x2c)](_0x59ab0b,_0x2497e8));_0x30772b+=_0x30772b<0x0?0x168:0x0;function _0x4bf004(_0x3480e1,_0x1261c5){return _0x419219(_0x3480e1,_0x1261c5-0x16c);}return _0x30772b;}const _0xe0bf67={};function _0x48c643(_0x419bcd,_0x13924d){return _0x5224(_0x419bcd- -0x392,_0x13924d);}_0xe0bf67[_0x48c643(-0x193,-0x194)]=null,_0xe0bf67['getU']=getU,_0xe0bf67['getV']=getV,_0xe0bf67[_0x48c643(-0x1e2,-0x1a7)]=getSpeed,_0xe0bf67['getDirection']=getDirection;var WindUtil=_0xe0bf67,updatePositionShader=_0x48c643(-0x172,-0x123),calculateSpeedShader='#version\x20300\x20es\x0a\x0a//\x20the\x20size\x20of\x20UV\x20textures:\x20width\x20=\x20lon,\x20height\x20=\x20lat\x0auniform\x20sampler2D\x20U;\x20//\x20eastward\x20wind\x0auniform\x20sampler2D\x20V;\x20//\x20northward\x20wind\x0auniform\x20sampler2D\x20currentParticlesPosition;\x20//\x20(lon,\x20lat,\x20lev)\x0a\x0auniform\x20vec2\x20uRange;\x20//\x20(min,\x20max)\x0auniform\x20vec2\x20vRange;\x20//\x20(min,\x20max)\x0auniform\x20vec2\x20speedRange;\x20//\x20(min,\x20max)\x0auniform\x20vec2\x20dimension;\x20//\x20(lon,\x20lat)\x0auniform\x20vec2\x20minimum;\x20//\x20minimum\x20of\x20each\x20dimension\x0auniform\x20vec2\x20maximum;\x20//\x20maximum\x20of\x20each\x20dimension\x0a\x0auniform\x20float\x20speedScaleFactor;\x0auniform\x20float\x20frameRateAdjustment;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avec2\x20getInterval(vec2\x20maximum,\x20vec2\x20minimum,\x20vec2\x20dimension)\x20{\x0a\x20\x20return\x20(maximum\x20-\x20minimum)\x20/\x20(dimension\x20-\x201.0f);\x0a}\x0a\x0avec2\x20mapPositionToNormalizedIndex2D(vec2\x20lonLat)\x20{\x0a\x20\x20\x20\x20//\x20ensure\x20the\x20range\x20of\x20longitude\x20and\x20latitude\x0a\x20\x20lonLat.x\x20=\x20clamp(lonLat.x,\x20minimum.x,\x20maximum.x);\x0a\x20\x20lonLat.y\x20=\x20clamp(lonLat.y,\x20minimum.y,\x20maximum.y);\x0a\x0a\x20\x20vec2\x20interval\x20=\x20getInterval(maximum,\x20minimum,\x20dimension);\x0a\x0a\x20\x20vec2\x20index2D\x20=\x20vec2(0.0f);\x0a\x20\x20index2D.x\x20=\x20(lonLat.x\x20-\x20minimum.x)\x20/\x20interval.x;\x0a\x20\x20index2D.y\x20=\x20(lonLat.y\x20-\x20minimum.y)\x20/\x20interval.y;\x0a\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20vec2(index2D.x\x20/\x20dimension.x,\x20index2D.y\x20/\x20dimension.y);\x0a\x20\x20return\x20normalizedIndex2D;\x0a}\x0a\x0afloat\x20getWindComponent(sampler2D\x20componentTexture,\x20vec2\x20lonLat)\x20{\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20mapPositionToNormalizedIndex2D(lonLat);\x0a\x20\x20float\x20result\x20=\x20texture(componentTexture,\x20normalizedIndex2D).r;\x0a\x20\x20return\x20result;\x0a}\x0a\x0avec2\x20getWindComponents(vec2\x20lonLat)\x20{\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20mapPositionToNormalizedIndex2D(lonLat);\x0a\x20\x20float\x20u\x20=\x20texture(U,\x20normalizedIndex2D).r;\x0a\x20\x20float\x20v\x20=\x20texture(V,\x20normalizedIndex2D).r;\x0a\x20\x20return\x20vec2(u,\x20v);\x0a}\x0a\x0avec2\x20bilinearInterpolation(vec2\x20lonLat)\x20{\x0a\x20\x20float\x20lon\x20=\x20lonLat.x;\x0a\x20\x20float\x20lat\x20=\x20lonLat.y;\x0a\x0a\x20\x20vec2\x20interval\x20=\x20getInterval(maximum,\x20minimum,\x20dimension);\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20grid\x20cell\x20coordinates\x0a\x20\x20float\x20lon0\x20=\x20floor(lon\x20/\x20interval.x)\x20*\x20interval.x;\x0a\x20\x20float\x20lon1\x20=\x20lon0\x20+\x20interval.x;\x0a\x20\x20float\x20lat0\x20=\x20floor(lat\x20/\x20interval.y)\x20*\x20interval.y;\x0a\x20\x20float\x20lat1\x20=\x20lat0\x20+\x20interval.y;\x0a\x0a\x20\x20\x20\x20//\x20Get\x20wind\x20vectors\x20at\x20four\x20corners\x0a\x20\x20vec2\x20v00\x20=\x20getWindComponents(vec2(lon0,\x20lat0));\x0a\x20\x20vec2\x20v10\x20=\x20getWindComponents(vec2(lon1,\x20lat0));\x0a\x20\x20vec2\x20v01\x20=\x20getWindComponents(vec2(lon0,\x20lat1));\x0a\x20\x20vec2\x20v11\x20=\x20getWindComponents(vec2(lon1,\x20lat1));\x0a\x0a\x20\x20\x20\x20//\x20Check\x20if\x20all\x20wind\x20vectors\x20are\x20zero\x0a\x20\x20if(length(v00)\x20==\x200.0f\x20&&\x20length(v10)\x20==\x200.0f\x20&&\x20length(v01)\x20==\x200.0f\x20&&\x20length(v11)\x20==\x200.0f)\x20{\x0a\x20\x20\x20\x20return\x20vec2(0.0f,\x200.0f);\x0a\x20\x20}\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20interpolation\x20weights\x0a\x20\x20float\x20s\x20=\x20(lon\x20-\x20lon0)\x20/\x20interval.x;\x0a\x20\x20float\x20t\x20=\x20(lat\x20-\x20lat0)\x20/\x20interval.y;\x0a\x0a\x20\x20\x20\x20//\x20Perform\x20bilinear\x20interpolation\x20on\x20vector\x20components\x0a\x20\x20vec2\x20v0\x20=\x20mix(v00,\x20v10,\x20s);\x0a\x20\x20vec2\x20v1\x20=\x20mix(v01,\x20v11,\x20s);\x0a\x20\x20return\x20mix(v0,\x20v1,\x20t);\x0a}\x0a\x0avec2\x20lengthOfLonLat(vec2\x20lonLat)\x20{\x0a\x20\x20\x20\x20//\x20unit\x20conversion:\x20meters\x20->\x20longitude\x20latitude\x20degrees\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Geographic_coordinate_system#Length_of_a_degree\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20the\x20length\x20of\x20a\x20degree\x20of\x20latitude\x20and\x20longitude\x20in\x20meters\x0a\x20\x20float\x20latitude\x20=\x20radians(lonLat.y);\x0a\x0a\x20\x20float\x20term1\x20=\x20111132.92f;\x0a\x20\x20float\x20term2\x20=\x20559.82f\x20*\x20cos(2.0f\x20*\x20latitude);\x0a\x20\x20float\x20term3\x20=\x201.175f\x20*\x20cos(4.0f\x20*\x20latitude);\x0a\x20\x20float\x20term4\x20=\x200.0023f\x20*\x20cos(6.0f\x20*\x20latitude);\x0a\x20\x20float\x20latLength\x20=\x20term1\x20-\x20term2\x20+\x20term3\x20-\x20term4;\x0a\x0a\x20\x20float\x20term5\x20=\x20111412.84f\x20*\x20cos(latitude);\x0a\x20\x20float\x20term6\x20=\x2093.5f\x20*\x20cos(3.0f\x20*\x20latitude);\x0a\x20\x20float\x20term7\x20=\x200.118f\x20*\x20cos(5.0f\x20*\x20latitude);\x0a\x20\x20float\x20longLength\x20=\x20term5\x20-\x20term6\x20+\x20term7;\x0a\x0a\x20\x20return\x20vec2(longLength,\x20latLength);\x0a}\x0a\x0avec2\x20convertSpeedUnitToLonLat(vec2\x20lonLat,\x20vec2\x20speed)\x20{\x0a\x20\x20vec2\x20lonLatLength\x20=\x20lengthOfLonLat(lonLat);\x0a\x20\x20float\x20u\x20=\x20speed.x\x20/\x20lonLatLength.x;\x0a\x20\x20float\x20v\x20=\x20speed.y\x20/\x20lonLatLength.y;\x0a\x20\x20vec2\x20windVectorInLonLat\x20=\x20vec2(u,\x20v);\x0a\x0a\x20\x20return\x20windVectorInLonLat;\x0a}\x0a\x0avec2\x20calculateSpeedByRungeKutta2(vec2\x20lonLat)\x20{\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods#Second-order_methods_with_two_stages\x20for\x20detail\x0a\x20\x20const\x20float\x20h\x20=\x200.5f;\x0a\x0a\x20\x20vec2\x20y_n\x20=\x20lonLat;\x0a\x20\x20vec2\x20f_n\x20=\x20bilinearInterpolation(lonLat);\x0a\x20\x20vec2\x20midpoint\x20=\x20y_n\x20+\x200.5f\x20*\x20h\x20*\x20convertSpeedUnitToLonLat(y_n,\x20f_n)\x20*\x20speedScaleFactor;\x0a\x20\x20vec2\x20speed\x20=\x20h\x20*\x20bilinearInterpolation(midpoint)\x20*\x20speedScaleFactor;\x0a\x0a\x20\x20return\x20speed;\x0a}\x0a\x0avec2\x20calculateWindNorm(vec2\x20speed)\x20{\x0a\x20\x20float\x20speedLength\x20=\x20length(speed.xy);\x0a\x20\x20if(speedLength\x20==\x200.0f)\x20{\x0a\x20\x20\x20\x20return\x20vec2(0.0f);\x0a\x20\x20}\x0a\x0a\x20\x20\x20\x20//\x20Clamp\x20speedLength\x20to\x20range\x0a\x20\x20float\x20clampedSpeed\x20=\x20clamp(speedLength,\x20speedRange.x,\x20speedRange.y);\x0a\x20\x20float\x20normalizedSpeed\x20=\x20(clampedSpeed\x20-\x20speedRange.x)\x20/\x20(speedRange.y\x20-\x20speedRange.x);\x0a\x20\x20return\x20vec2(speedLength,\x20normalizedSpeed);\x0a}\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20vec2\x20lonLat\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rg;\x0a\x20\x20vec2\x20speedOrigin\x20=\x20bilinearInterpolation(lonLat);\x0a\x20\x20vec2\x20speed\x20=\x20calculateSpeedByRungeKutta2(lonLat)\x20*\x20frameRateAdjustment;\x0a\x20\x20vec2\x20speedInLonLat\x20=\x20convertSpeedUnitToLonLat(lonLat,\x20speed);\x0a\x0a\x20\x20fragColor\x20=\x20vec4(speedInLonLat,\x20calculateWindNorm(speedOrigin));\x0a}\x0a',postProcessingPositionFragmentShader=_0x48c643(-0x1cf,-0x256),renderParticlesFragmentShader='#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0ain\x20vec4\x20speed;\x0ain\x20float\x20v_segmentPosition;\x0ain\x20vec2\x20textureCoordinate;\x0a\x0auniform\x20vec2\x20domain;\x0auniform\x20vec2\x20displayRange;\x0auniform\x20sampler2D\x20colorTable;\x0auniform\x20sampler2D\x20segmentsDepthTexture;\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20const\x20float\x20zero\x20=\x200.0f;\x0a\x20\x20if(speed.a\x20>\x20zero\x20&&\x20speed.b\x20>\x20displayRange.x\x20&&\x20speed.b\x20<\x20displayRange.y)\x20{\x0a\x20\x20\x20\x20float\x20speedLength\x20=\x20clamp(speed.b,\x20domain.x,\x20domain.y);\x0a\x20\x20\x20\x20float\x20normalizedSpeed\x20=\x20(speedLength\x20-\x20domain.x)\x20/\x20(domain.y\x20-\x20domain.x);\x0a\x20\x20\x20\x20vec4\x20baseColor\x20=\x20texture(colorTable,\x20vec2(normalizedSpeed,\x20zero));\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20使用更平滑的渐变效果\x0a\x20\x20\x20\x20float\x20alpha\x20=\x20smoothstep(0.0f,\x201.0f,\x20v_segmentPosition);\x0a\x20\x20\x20\x20alpha\x20=\x20pow(alpha,\x201.5f);\x20//\x20调整透明度渐变曲线\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20根据速度调整透明度\x0a\x20\x20\x20\x20float\x20speedAlpha\x20=\x20mix(0.3f,\x201.0f,\x20speed.a);\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20组合颜色和透明度\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(baseColor.rgb,\x20baseColor.a\x20*\x20alpha\x20*\x20speedAlpha);\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(zero);\x0a\x20\x20}\x0a\x0a\x20\x20float\x20segmentsDepth\x20=\x20texture(segmentsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20float\x20globeDepth\x20=\x20czm_unpackDepth(texture(czm_globeDepthTexture,\x20textureCoordinate));\x0a\x20\x20if(segmentsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(zero);\x0a\x20\x20}\x0a}\x0a',renderParticlesVertexShader='#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0ain\x20vec2\x20st;\x0ain\x20vec3\x20normal;\x0a\x0auniform\x20sampler2D\x20previousParticlesPosition;\x0auniform\x20sampler2D\x20currentParticlesPosition;\x0auniform\x20sampler2D\x20postProcessingPosition;\x0auniform\x20sampler2D\x20particlesSpeed;\x0a\x0auniform\x20float\x20frameRateAdjustment;\x0auniform\x20float\x20particleHeight;\x0auniform\x20float\x20aspect;\x0auniform\x20float\x20pixelSize;\x0auniform\x20vec2\x20lineWidth;\x0auniform\x20vec2\x20lineLength;\x0auniform\x20vec2\x20domain;\x0auniform\x20bool\x20is3D;\x0a\x0a//\x20添加输出变量传递给片元着色器\x0aout\x20vec4\x20speed;\x0aout\x20float\x20v_segmentPosition;\x0aout\x20vec2\x20textureCoordinate;\x0a\x0a//\x20添加结构体定义\x0astruct\x20adjacentPoints\x20{\x0a\x20\x20vec4\x20previous;\x0a\x20\x20vec4\x20current;\x0a\x20\x20vec4\x20next;\x0a};\x0a\x0avec3\x20convertCoordinate(vec2\x20lonLat)\x20{\x0a\x20\x20\x20\x20//\x20WGS84\x20(lon,\x20lat,\x20lev)\x20->\x20ECEF\x20(x,\x20y,\x20z)\x0a\x20\x20\x20\x20//\x20read\x20https://en.wikipedia.org/wiki/Geographic_coordinate_conversion#From_geodetic_to_ECEF_coordinates\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20WGS\x2084\x20geometric\x20constants\x0a\x20\x20float\x20a\x20=\x206378137.0f;\x20//\x20Semi-major\x20axis\x0a\x20\x20float\x20b\x20=\x206356752.3142f;\x20//\x20Semi-minor\x20axis\x0a\x20\x20float\x20e2\x20=\x206.69437999014e-3f;\x20//\x20First\x20eccentricity\x20squared\x0a\x0a\x20\x20float\x20latitude\x20=\x20radians(lonLat.y);\x0a\x20\x20float\x20longitude\x20=\x20radians(lonLat.x);\x0a\x0a\x20\x20float\x20cosLat\x20=\x20cos(latitude);\x0a\x20\x20float\x20sinLat\x20=\x20sin(latitude);\x0a\x20\x20float\x20cosLon\x20=\x20cos(longitude);\x0a\x20\x20float\x20sinLon\x20=\x20sin(longitude);\x0a\x0a\x20\x20float\x20N_Phi\x20=\x20a\x20/\x20sqrt(1.0f\x20-\x20e2\x20*\x20sinLat\x20*\x20sinLat);\x0a\x20\x20float\x20h\x20=\x20particleHeight;\x20//\x20it\x20should\x20be\x20high\x20enough\x20otherwise\x20the\x20particle\x20may\x20not\x20pass\x20the\x20terrain\x20depth\x20test\x0a\x20\x20vec3\x20cartesian\x20=\x20vec3(0.0f);\x0a\x20\x20cartesian.x\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20cosLon;\x0a\x20\x20cartesian.y\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20sinLon;\x0a\x20\x20cartesian.z\x20=\x20((b\x20*\x20b)\x20/\x20(a\x20*\x20a)\x20*\x20N_Phi\x20+\x20h)\x20*\x20sinLat;\x0a\x20\x20return\x20cartesian;\x0a}\x0a\x0avec4\x20calculateProjectedCoordinate(vec2\x20lonLat)\x20{\x0a\x20\x20if(is3D)\x20{\x0a\x20\x20\x20\x20vec3\x20particlePosition\x20=\x20convertCoordinate(lonLat);\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20使用\x20modelViewProjection\x20矩阵进行投影变换\x0a\x20\x20\x20\x20vec4\x20projectedPosition\x20=\x20czm_modelViewProjection\x20*\x20vec4(particlePosition,\x201.0f);\x0a\x20\x20\x20\x20return\x20projectedPosition;\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20vec3\x20position2D\x20=\x20vec3(radians(lonLat.x),\x20radians(lonLat.y),\x200.0f);\x0a\x20\x20\x20\x20return\x20czm_modelViewProjection\x20*\x20vec4(position2D,\x201.0f);\x0a\x20\x20}\x0a}\x0a\x0avec4\x20calculateOffsetOnNormalDirection(vec4\x20pointA,\x20vec4\x20pointB,\x20float\x20offsetSign,\x20float\x20widthFactor)\x20{\x0a\x20\x20vec2\x20aspectVec2\x20=\x20vec2(aspect,\x201.0f);\x0a\x20\x20vec2\x20pointA_XY\x20=\x20(pointA.xy\x20/\x20pointA.w)\x20*\x20aspectVec2;\x0a\x20\x20vec2\x20pointB_XY\x20=\x20(pointB.xy\x20/\x20pointB.w)\x20*\x20aspectVec2;\x0a\x0a\x20\x20\x20\x20//\x20计算方向向量\x0a\x20\x20vec2\x20direction\x20=\x20normalize(pointB_XY\x20-\x20pointA_XY);\x0a\x0a\x20\x20\x20\x20//\x20计算法向量\x0a\x20\x20vec2\x20normalVector\x20=\x20vec2(-direction.y,\x20direction.x);\x0a\x20\x20normalVector.x\x20=\x20normalVector.x\x20/\x20aspect;\x0a\x0a\x20\x20\x20\x20//\x20使用\x20widthFactor\x20调整宽度\x0a\x20\x20float\x20offsetLength\x20=\x20widthFactor\x20*\x20lineWidth.y;\x0a\x20\x20normalVector\x20=\x20offsetLength\x20*\x20normalVector;\x0a\x0a\x20\x20vec4\x20offset\x20=\x20vec4(offsetSign\x20*\x20normalVector,\x200.0f,\x200.0f);\x0a\x20\x20return\x20offset;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20翻转\x20Y\x20轴坐标\x0a\x20\x20vec2\x20flippedIndex\x20=\x20vec2(st.x,\x201.0f\x20-\x20st.y);\x0a\x0a\x20\x20vec2\x20particleIndex\x20=\x20flippedIndex;\x0a\x20\x20speed\x20=\x20texture(particlesSpeed,\x20particleIndex);\x0a\x0a\x20\x20vec2\x20previousPosition\x20=\x20texture(previousParticlesPosition,\x20particleIndex).rg;\x0a\x20\x20vec2\x20currentPosition\x20=\x20texture(currentParticlesPosition,\x20particleIndex).rg;\x0a\x20\x20vec2\x20nextPosition\x20=\x20texture(postProcessingPosition,\x20particleIndex).rg;\x0a\x0a\x20\x20float\x20isAnyRandomPointUsed\x20=\x20texture(postProcessingPosition,\x20particleIndex).a\x20+\x0a\x20\x20\x20\x20texture(currentParticlesPosition,\x20particleIndex).a\x20+\x0a\x20\x20\x20\x20texture(previousParticlesPosition,\x20particleIndex).a;\x0a\x0a\x20\x20adjacentPoints\x20projectedCoordinates;\x0a\x20\x20if(isAnyRandomPointUsed\x20>\x200.0f)\x20{\x0a\x20\x20\x20\x20projectedCoordinates.previous\x20=\x20calculateProjectedCoordinate(previousPosition);\x0a\x20\x20\x20\x20projectedCoordinates.current\x20=\x20projectedCoordinates.previous;\x0a\x20\x20\x20\x20projectedCoordinates.next\x20=\x20projectedCoordinates.previous;\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20projectedCoordinates.previous\x20=\x20calculateProjectedCoordinate(previousPosition);\x0a\x20\x20\x20\x20projectedCoordinates.current\x20=\x20calculateProjectedCoordinate(currentPosition);\x0a\x20\x20\x20\x20projectedCoordinates.next\x20=\x20calculateProjectedCoordinate(nextPosition);\x0a\x20\x20}\x0a\x0a\x20\x20int\x20pointToUse\x20=\x20int(normal.x);\x0a\x20\x20float\x20offsetSign\x20=\x20normal.y;\x0a\x20\x20vec4\x20offset\x20=\x20vec4(0.0f);\x0a\x0a\x20\x20\x20\x20//\x20计算速度相关的宽度和长度因子\x0a\x20\x20float\x20speedLength\x20=\x20clamp(speed.b,\x20domain.x,\x20domain.y);\x0a\x20\x20float\x20normalizedSpeed\x20=\x20(speedLength\x20-\x20domain.x)\x20/\x20(domain.y\x20-\x20domain.x);\x0a\x0a\x20\x20\x20\x20//\x20根据速度计算宽度\x0a\x20\x20float\x20widthFactor\x20=\x20mix(lineWidth.x,\x20lineWidth.y,\x20normalizedSpeed);\x0a\x20\x20widthFactor\x20*=\x20(pointToUse\x20<\x200\x20?\x201.0f\x20:\x200.5f);\x20//\x20头部更宽，尾部更窄\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20length\x20based\x20on\x20speed\x0a\x20\x20float\x20lengthFactor\x20=\x20mix(lineLength.x,\x20lineLength.y,\x20normalizedSpeed)\x20*\x20pixelSize;\x0a\x0a\x20\x20if(pointToUse\x20==\x201)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20头部位置\x0a\x20\x20\x20\x20offset\x20=\x20pixelSize\x20*\x20calculateOffsetOnNormalDirection(projectedCoordinates.previous,\x20projectedCoordinates.current,\x20offsetSign,\x20widthFactor);\x0a\x20\x20\x20\x20gl_Position\x20=\x20projectedCoordinates.previous\x20+\x20offset;\x0a\x20\x20\x20\x20v_segmentPosition\x20=\x200.0f;\x20//\x20头部\x0a\x20\x20}\x20else\x20if(pointToUse\x20==\x20-1)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20Get\x20direction\x20and\x20normalize\x20it\x20to\x20length\x201.0\x0a\x20\x20\x20\x20vec4\x20direction\x20=\x20normalize(projectedCoordinates.next\x20-\x20projectedCoordinates.current);\x0a\x20\x20\x20\x20vec4\x20extendedPosition\x20=\x20projectedCoordinates.current\x20+\x20direction\x20*\x20lengthFactor;\x0a\x0a\x20\x20\x20\x20offset\x20=\x20pixelSize\x20*\x20calculateOffsetOnNormalDirection(projectedCoordinates.current,\x20extendedPosition,\x20offsetSign,\x20widthFactor);\x0a\x20\x20\x20\x20gl_Position\x20=\x20extendedPosition\x20+\x20offset;\x0a\x20\x20\x20\x20v_segmentPosition\x20=\x201.0f;\x20//\x20尾部\x0a\x20\x20}\x0a\x0a\x20\x20textureCoordinate\x20=\x20st;\x0a}\x0a';const {ShaderSource:ShaderSource$1}=mars3d__namespace[_0x48c643(-0x245,-0x1fa)];class ShaderManager{static[_0x48c643(-0x237,-0x1aa)](){const _0x42f752={};return _0x42f752['sources']=[calculateSpeedShader],new ShaderSource$1(_0x42f752);}static[_0x48c643(-0x241,-0x239)](){const _0x1e6cc0={};return _0x1e6cc0['sources']=[updatePositionShader],new ShaderSource$1(_0x1e6cc0);}static['getSegmentDrawVertexShader'](){const _0x135df1={};_0x135df1[_0x51c102(0x118,0x133)]=[renderParticlesVertexShader];function _0x51c102(_0x38feea,_0x1a643b){return _0x419219(_0x1a643b,_0x38feea-0x1d2);}return new ShaderSource$1(_0x135df1);}static[_0x48c643(-0x244,-0x1c5)](){const _0x1982c2={};_0x1982c2[_0x7ee5ab(0x334,0x3ae)]=[renderParticlesFragmentShader];function _0x7ee5ab(_0x163ae4,_0x5e620e){return _0x48c643(_0x5e620e-0x55b,_0x163ae4);}return new ShaderSource$1(_0x1982c2);}static['getPostProcessingPositionShader'](){const _0x4b47f5={};return _0x4b47f5['sources']=[postProcessingPositionFragmentShader],new ShaderSource$1(_0x4b47f5);}}function _0x5224(_0x5718d2,_0x4ed0e7){const _0x14fcc0=_0x14fc();return _0x5224=function(_0x522483,_0x3f8e95){_0x522483=_0x522483-0x12f;let _0x16e6ba=_0x14fcc0[_0x522483];return _0x16e6ba;},_0x5224(_0x5718d2,_0x4ed0e7);}const {BufferUsage:BufferUsage$1,ClearCommand:ClearCommand$1,Color:Color$2,ComputeCommand,DrawCommand,Geometry:Geometry$1,Matrix4,Pass:Pass$1,PrimitiveType:PrimitiveType$1,RenderState,ShaderProgram,ShaderSource,VertexArray:VertexArray$1,defined,destroyObject}=mars3d__namespace['Cesium'];class CustomPrimitive{constructor(_0x2a5941){this[_0x4c2090(0x48c,0x45e)]=_0x2a5941['commandType'],this[_0x4c2090(0x3cb,0x356)]=_0x2a5941['geometry'],this['attributeLocations']=_0x2a5941['attributeLocations'];function _0x4629b8(_0x2e5188,_0x35e2b4){return _0x419219(_0x2e5188,_0x35e2b4-0x37e);}this['primitiveType']=_0x2a5941['primitiveType'],this['uniformMap']=_0x2a5941['uniformMap']||{},this[_0x4c2090(0x439,0x467)]=_0x2a5941[_0x4c2090(0x439,0x428)],this[_0x4629b8(0x20e,0x270)]=_0x2a5941['fragmentShaderSource'],this[_0x4c2090(0x468,0x3f5)]=_0x2a5941['rawRenderState'],this[_0x4c2090(0x391,0x3aa)]=_0x2a5941[_0x4629b8(0x296,0x219)],this[_0x4c2090(0x445,0x457)]=_0x2a5941['outputTexture'],this['autoClear']=_0x2a5941['autoClear']??![],this['preExecute']=_0x2a5941['preExecute'],this[_0x4629b8(0x287,0x232)]=!![];function _0x4c2090(_0x183624,_0x298d3e){return _0x419219(_0x298d3e,_0x183624-0x4f6);}this['commandToExecute']=undefined,this[_0x4c2090(0x459,0x41b)]=undefined,this['isDynamic']=_0x2a5941['isDynamic']??(()=>!![]),this['autoClear']&&(this['clearCommand']=new ClearCommand$1({'color':new Color$2(0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':this['framebuffer'],'pass':Pass$1['OPAQUE']}));}['createCommand'](_0x12cfd2){function _0x53db7f(_0x5c6bfe,_0x35b032){return _0x48c643(_0x35b032-0x65a,_0x5c6bfe);}function _0x285b64(_0x376af6,_0x1625ef){return _0x419219(_0x1625ef,_0x376af6-0x3c1);}if(this[_0x285b64(0x357,0x3b3)]===_0x53db7f(0x371,0x3f7)){const _0x4dde8f={};_0x4dde8f['context']=_0x12cfd2,_0x4dde8f[_0x285b64(0x296,0x23a)]=this['geometry'],_0x4dde8f['attributeLocations']=this['attributeLocations'],_0x4dde8f[_0x285b64(0x2da,0x30d)]=BufferUsage$1[_0x285b64(0x2ac,0x23c)];const _0x3f9ee4=VertexArray$1['fromGeometry'](_0x4dde8f),_0x1cd9e3={};_0x1cd9e3['context']=_0x12cfd2,_0x1cd9e3[_0x53db7f(0x488,0x4aa)]=this['vertexShaderSource'],_0x1cd9e3['fragmentShaderSource']=this['fragmentShaderSource'],_0x1cd9e3['attributeLocations']=this[_0x285b64(0x271,0x233)];const _0x2eb264=ShaderProgram['fromCache'](_0x1cd9e3),_0x525826=RenderState['fromCache'](this['rawRenderState']),_0xf801b1={};return _0xf801b1['owner']=this,_0xf801b1['vertexArray']=_0x3f9ee4,_0xf801b1['primitiveType']=this['primitiveType'],_0xf801b1['modelMatrix']=Matrix4['IDENTITY'],_0xf801b1[_0x285b64(0x287,0x2ce)]=_0x525826,_0xf801b1[_0x285b64(0x34a,0x2d2)]=_0x2eb264,_0xf801b1['framebuffer']=this[_0x285b64(0x25c,0x287)],_0xf801b1['uniformMap']=this[_0x53db7f(0x483,0x40e)],_0xf801b1[_0x285b64(0x2c6,0x26a)]=Pass$1[_0x285b64(0x29a,0x2dd)],new DrawCommand(_0xf801b1);}else{if(this[_0x53db7f(0x53f,0x4fd)]==='Compute'){const _0x4c4523={};return _0x4c4523['owner']=this,_0x4c4523['fragmentShaderSource']=this['fragmentShaderSource'],_0x4c4523['uniformMap']=this['uniformMap'],_0x4c4523[_0x285b64(0x310,0x285)]=this['outputTexture'],_0x4c4523['persists']=!![],new ComputeCommand(_0x4c4523);}else throw new Error(_0x285b64(0x2b1,0x296));}}['setGeometry'](_0x1798a9,_0xf14398){function _0x4b089d(_0x597a15,_0x5cd4ff){return _0x419219(_0x597a15,_0x5cd4ff-0x674);}function _0xa873b7(_0x5f06ee,_0x5a62f9){return _0x48c643(_0x5a62f9- -0x3d,_0x5f06ee);}this[_0x4b089d(0x5a0,0x549)]=_0xf14398,defined(this[_0x4b089d(0x677,0x609)])&&(this[_0xa873b7(-0x164,-0x19b)]['vertexArray']=VertexArray$1['fromGeometry']({'context':_0x1798a9,'geometry':this['geometry'],'attributeLocations':this[_0xa873b7(-0x235,-0x280)],'bufferUsage':BufferUsage$1['STATIC_DRAW']}));}[_0x419219(-0x183,-0x168)](_0x4e961f){function _0x5a1dd3(_0x468b41,_0x1c5dd4){return _0x48c643(_0x468b41-0x709,_0x1c5dd4);}if(!this[_0x5a1dd3(0x518,0x4bf)]())return;if(!this[_0x5a1dd3(0x4ca,0x54d)]||!defined(_0x4e961f))return;function _0x555a12(_0x16b068,_0x7b7743){return _0x419219(_0x7b7743,_0x16b068-0x207);}!defined(this[_0x555a12(0x19c,0x186)])&&(this[_0x555a12(0x19c,0x217)]=this[_0x555a12(0x10f,0xdf)](_0x4e961f['context']));defined(this[_0x555a12(0xca,0xbe)])&&this[_0x555a12(0xca,0x144)]();if(!_0x4e961f['commandList']){console['warn']('frameState.commandList\x20is\x20undefined');return;}defined(this[_0x5a1dd3(0x579,0x575)])&&_0x4e961f[_0x5a1dd3(0x584,0x5bf)][_0x555a12(0xf6,0xfe)](this[_0x5a1dd3(0x579,0x5c4)]),defined(this['commandToExecute'])&&_0x4e961f['commandList'][_0x5a1dd3(0x505,0x4d6)](this['commandToExecute']);}['isDestroyed'](){return![];}['destroy'](){if(defined(this['commandToExecute'])){var _0x19c653;(_0x19c653=this[_0x165e37(-0xba,-0x34)][_0x2d5b79(0x3cb,0x3dc)])===null||_0x19c653===void 0x0||_0x19c653['destroy'](),this['commandToExecute'][_0x2d5b79(0x3b7,0x3dc)]=undefined;}function _0x165e37(_0x19845f,_0x37e700){return _0x419219(_0x19845f,_0x37e700-0x37);}function _0x2d5b79(_0x330b83,_0x109edc){return _0x419219(_0x330b83,_0x109edc-0x453);}return destroyObject(this);}}function deepMerge(_0x5e4b62,_0x577b5e){if(!_0x5e4b62)return _0x577b5e;if(!_0x577b5e)return _0x5e4b62;const _0x2b0144={..._0x577b5e},_0x3cd4a2=_0x2b0144;for(const _0x406832 in _0x5e4b62){if(Object['prototype'][_0x3d0d76(0x520,0x54c)][_0x20c4cc(0xf,-0x17)](_0x5e4b62,_0x406832)){const _0x513f8d=_0x5e4b62[_0x406832],_0x32a225=_0x577b5e[_0x406832];if(Array[_0x20c4cc(-0x5a,-0x4)](_0x513f8d)){_0x3cd4a2[_0x406832]=_0x513f8d['slice']();continue;}if(_0x513f8d&&typeof _0x513f8d===_0x3d0d76(0x5fd,0x5c4)){_0x3cd4a2[_0x406832]=deepMerge(_0x513f8d,_0x32a225||{});continue;}_0x513f8d!==undefined&&(_0x3cd4a2[_0x406832]=_0x513f8d);}}function _0x3d0d76(_0x1abeca,_0x2eca2d){return _0x419219(_0x1abeca,_0x2eca2d-0x670);}function _0x20c4cc(_0x2cff78,_0xaf794){return _0x419219(_0x2cff78,_0xaf794-0xd1);}return _0x3cd4a2;}const {Cartesian2:Cartesian2$1,FrameRateMonitor,PixelDatatype:PixelDatatype$1,PixelFormat:PixelFormat$1,Sampler:Sampler$1,Texture:Texture$1,TextureMagnificationFilter:TextureMagnificationFilter$1,TextureMinificationFilter:TextureMinificationFilter$1}=mars3d__namespace[_0x419219(-0x173,-0x152)];class WindParticlesComputing{constructor(_0x3cf42f,_0x3700a0,_0x98a196,_0xe99384,_0x469cdc){function _0x15924a(_0x2ef332,_0xafdc6b){return _0x48c643(_0x2ef332-0x763,_0xafdc6b);}this['context']=_0x3cf42f,this['options']=_0x98a196,this['viewerParameters']=_0xe99384,this['windData']=_0x3700a0,this['frameRate']=0x3c,this['frameRateAdjustment']=0x1;const _0x52e7b6={};_0x52e7b6['scene']=_0x469cdc,_0x52e7b6['samplingWindow']=0x1,_0x52e7b6[_0x872cd4(0x567,0x4fa)]=0x0,this[_0x15924a(0x5f4,0x65b)]=new FrameRateMonitor(_0x52e7b6);function _0x872cd4(_0x2e5465,_0x234f72){return _0x48c643(_0x234f72-0x6da,_0x2e5465);}this[_0x15924a(0x535,0x5b1)](),this['createWindTextures'](),this[_0x872cd4(0x4fa,0x522)](),this['createComputingPrimitives']();}['initFrameRate'](){function _0x235231(_0x203c37,_0x4ba7ca){return _0x419219(_0x4ba7ca,_0x203c37-0x326);}const _0x42d14b=()=>{function _0x384e45(_0x375af3,_0xb2eb87){return _0x5224(_0xb2eb87- -0x39f,_0x375af3);}function _0x3c9c25(_0x3ab8b1,_0x38bc11){return _0x5224(_0x38bc11- -0x39a,_0x3ab8b1);}this['frameRateMonitor']['lastFramesPerSecond']>0x14&&(this['frameRate']=this['frameRateMonitor']['lastFramesPerSecond'],this[_0x384e45(-0x215,-0x1cc)]=0x3c/Math['max'](this[_0x3c9c25(-0x182,-0x1cc)],0x1));};_0x42d14b();function _0x502045(_0x4cd68a,_0x36ae3b){return _0x419219(_0x36ae3b,_0x4cd68a-0x5e5);}const _0x2af56b=setInterval(_0x42d14b,0x3e8),_0x206e2e=this['destroy'][_0x235231(0x20f,0x1f4)](this);this[_0x502045(0x4dc,0x4ac)]=()=>{clearInterval(_0x2af56b),_0x206e2e();};}['createWindTextures'](){function _0x2e49d8(_0x19e088,_0x26bf5e){return _0x48c643(_0x19e088-0x59e,_0x26bf5e);}const _0x2073cc={};_0x2073cc[_0x1eea7e(0x524,0x599)]=TextureMinificationFilter$1['LINEAR'],_0x2073cc[_0x2e49d8(0x37c,0x329)]=TextureMagnificationFilter$1['LINEAR'];const _0x5df76b={'context':this['context'],'width':this[_0x1eea7e(0x5e5,0x5cc)][_0x1eea7e(0x5d9,0x5f0)],'height':this[_0x1eea7e(0x587,0x5cc)]['height'],'pixelFormat':PixelFormat$1[_0x2e49d8(0x366,0x2e4)],'pixelDatatype':PixelDatatype$1['FLOAT'],'flipY':this['options']['flipY']??![],'sampler':new Sampler$1(_0x2073cc)};function _0x1eea7e(_0x380470,_0x79c259){return _0x48c643(_0x79c259-0x766,_0x380470);}this['windTextures']={'U':new Texture$1({..._0x5df76b,'source':{'arrayBufferView':new Float32Array(this['windData']['u'][_0x1eea7e(0x5ca,0x553)])}}),'V':new Texture$1({..._0x5df76b,'source':{'arrayBufferView':new Float32Array(this[_0x1eea7e(0x649,0x5cc)]['v'][_0x2e49d8(0x38b,0x32a)])}})};}[_0x48c643(-0x1b8,-0x1b5)](){function _0x37f1c1(_0x588c61,_0x30ac47){return _0x48c643(_0x30ac47-0xaa,_0x588c61);}const _0x13c8bc={};_0x13c8bc['minificationFilter']=TextureMinificationFilter$1[_0x37f1c1(-0x58,-0xb2)],_0x13c8bc['magnificationFilter']=TextureMagnificationFilter$1[_0x9c52f2(0x143,0x1af)];const _0x451861={'context':this['context'],'width':this[_0x9c52f2(0x147,0x110)]['particlesTextureSize'],'height':this[_0x37f1c1(-0x12b,-0x151)][_0x37f1c1(-0x197,-0x14c)],'pixelFormat':PixelFormat$1['RGBA'],'pixelDatatype':PixelDatatype$1['FLOAT'],'flipY':![],'source':{'arrayBufferView':new Float32Array(this['options']['particlesTextureSize']*this['options']['particlesTextureSize']*0x4)['fill'](0x0)},'sampler':new Sampler$1(_0x13c8bc)};function _0x9c52f2(_0x242a50,_0x56a074){return _0x419219(_0x242a50,_0x56a074-0x218);}this[_0x37f1c1(-0x101,-0x12d)]={'previousParticlesPosition':new Texture$1(_0x451861),'currentParticlesPosition':new Texture$1(_0x451861),'nextParticlesPosition':new Texture$1(_0x451861),'postProcessingPosition':new Texture$1(_0x451861),'particlesSpeed':new Texture$1(_0x451861)};}['destroyParticlesTextures'](){function _0x5e5c12(_0x53bf27,_0x58b611){return _0x419219(_0x53bf27,_0x58b611-0x136);}function _0x11ca87(_0x399531,_0x220fd6){return _0x48c643(_0x220fd6-0x43f,_0x399531);}Object[_0x5e5c12(0x79,0x97)](this['particlesTextures'])[_0x5e5c12(0xe7,0x9f)](_0x3c4250=>_0x3c4250['destroy']());}['createComputingPrimitives'](){function _0x2158e0(_0x25a4c2,_0x510a6d){return _0x48c643(_0x25a4c2-0x69e,_0x510a6d);}function _0x18f957(_0x5b237b,_0x20eb5a){return _0x419219(_0x20eb5a,_0x5b237b- -0x74);}this['primitives']={'calculateSpeed':new CustomPrimitive({'commandType':_0x2158e0(0x54c,0x580),'uniformMap':{'U':()=>this['windTextures']['U'],'V':()=>this['windTextures']['V'],'uRange':()=>new Cartesian2$1(this[_0x2158e0(0x504,0x514)]['u'][_0x2158e0(0x533,0x55a)],this[_0x18f957(-0x11b,-0x15b)]['u'][_0x2158e0(0x4cb,0x4c7)]),'vRange':()=>new Cartesian2$1(this['windData']['v'][_0x18f957(-0xec,-0xeb)],this[_0x18f957(-0x11b,-0x169)]['v']['max']),'speedRange':()=>new Cartesian2$1(this[_0x2158e0(0x504,0x57f)][_0x2158e0(0x4e0,0x4f9)]['min'],this[_0x2158e0(0x504,0x536)][_0x18f957(-0x13f,-0x133)]['max']),'currentParticlesPosition':()=>this[_0x2158e0(0x4c7,0x526)]['currentParticlesPosition'],'speedScaleFactor':()=>{function _0x487c37(_0x3ffaf3,_0x1f3d28){return _0x2158e0(_0x3ffaf3- -0x6f1,_0x1f3d28);}function _0x1572b6(_0x2e3f8d,_0x4dd3fb){return _0x2158e0(_0x4dd3fb- -0x66b,_0x2e3f8d);}return(this['viewerParameters'][_0x1572b6(-0x171,-0x1f1)]+0x32)*this[_0x1572b6(-0x16a,-0x1c8)]['speedFactor'];},'frameRateAdjustment':()=>this['frameRateAdjustment'],'dimension':()=>new Cartesian2$1(this['windData'][_0x2158e0(0x528,0x5a1)],this[_0x18f957(-0x11b,-0xda)][_0x2158e0(0x4ea,0x4ab)]),'minimum':()=>new Cartesian2$1(this[_0x2158e0(0x504,0x54b)]['bounds']['west'],this[_0x2158e0(0x504,0x535)][_0x2158e0(0x489,0x450)]['south']),'maximum':()=>new Cartesian2$1(this['windData'][_0x18f957(-0x196,-0x14c)][_0x18f957(-0x186,-0x146)],this['windData']['bounds']['north'])},'fragmentShaderSource':ShaderManager['getCalculateSpeedShader'](),'outputTexture':this['particlesTextures']['particlesSpeed'],'preExecute':()=>{const _0x488774=this[_0x3529c1(0x38d,0x35d)]['previousParticlesPosition'];this[_0x1786c3(0x87,0x3d)]['previousParticlesPosition']=this['particlesTextures']['currentParticlesPosition'],this['particlesTextures'][_0x3529c1(0x417,0x46f)]=this['particlesTextures']['postProcessingPosition'];function _0x3529c1(_0x4ab3d0,_0x741e3){return _0x2158e0(_0x4ab3d0- -0x13a,_0x741e3);}function _0x1786c3(_0xab5254,_0x300562){return _0x18f957(_0x300562-0x195,_0xab5254);}this['particlesTextures']['postProcessingPosition']=_0x488774,this[_0x3529c1(0x3e2,0x35f)]['calculateSpeed']['commandToExecute']&&(this['primitives']['calculateSpeed']['commandToExecute']['outputTexture']=this['particlesTextures']['particlesSpeed']);},'isDynamic':()=>this['options'][_0x18f957(-0x181,-0x178)]}),'updatePosition':new CustomPrimitive({'commandType':'Compute','uniformMap':{'currentParticlesPosition':()=>this[_0x18f957(-0x158,-0xe8)][_0x2158e0(0x551,0x5d0)],'particlesSpeed':()=>this['particlesTextures'][_0x2158e0(0x4b9,0x4ea)]},'fragmentShaderSource':ShaderManager[_0x2158e0(0x45d,0x430)](),'outputTexture':this[_0x18f957(-0x158,-0x116)]['nextParticlesPosition'],'preExecute':()=>{function _0x264700(_0x20cdc7,_0x2dc139){return _0x2158e0(_0x2dc139- -0x196,_0x20cdc7);}function _0x26a781(_0x58d89c,_0x54d502){return _0x18f957(_0x54d502-0x3f8,_0x58d89c);}this[_0x26a781(0x2f8,0x2f5)][_0x264700(0x2e6,0x2f2)]['commandToExecute']&&(this['primitives']['updatePosition']['commandToExecute']['outputTexture']=this['particlesTextures'][_0x264700(0x340,0x39c)]);},'isDynamic':()=>this[_0x2158e0(0x4a3,0x47b)]['dynamic']}),'postProcessingPosition':new CustomPrimitive({'commandType':_0x2158e0(0x54c,0x50b),'uniformMap':{'nextParticlesPosition':()=>this[_0x2158e0(0x4c7,0x4f9)][_0x2158e0(0x532,0x513)],'particlesSpeed':()=>this['particlesTextures']['particlesSpeed'],'lonRange':()=>this['viewerParameters']['lonRange'],'latRange':()=>this[_0x18f957(-0x1b2,-0x18e)][_0x2158e0(0x4f2,0x518)],'dataLonRange':()=>new Cartesian2$1(this[_0x18f957(-0x11b,-0x153)]['bounds']['west'],this[_0x2158e0(0x504,0x57f)]['bounds'][_0x18f957(-0x186,-0x1d9)]),'dataLatRange':()=>new Cartesian2$1(this[_0x2158e0(0x504,0x4a6)][_0x18f957(-0x196,-0x13c)][_0x2158e0(0x502,0x4fd)],this['windData']['bounds']['north']),'randomCoefficient':function(){function _0x1f8ee4(_0x9105db,_0x53724c){return _0x18f957(_0x53724c-0x2a5,_0x9105db);}return Math[_0x1f8ee4(0x131,0x161)]();},'dropRate':()=>this['options']['dropRate'],'dropRateBump':()=>this[_0x2158e0(0x4a3,0x4e2)][_0x2158e0(0x4cd,0x494)],'useViewerBounds':()=>this['options']['useViewerBounds']},'fragmentShaderSource':ShaderManager[_0x18f957(-0x19e,-0x1dd)](),'outputTexture':this[_0x18f957(-0x158,-0x12b)][_0x18f957(-0x16a,-0x142)],'preExecute':()=>{function _0x476141(_0xc38b7f,_0x33fc99){return _0x2158e0(_0xc38b7f- -0x502,_0x33fc99);}function _0x4881ba(_0x599d41,_0x10b5cb){return _0x18f957(_0x599d41-0x3c2,_0x10b5cb);}this['primitives'][_0x4881ba(0x258,0x1e8)][_0x476141(0x3e,0x8b)]&&(this['primitives'][_0x4881ba(0x258,0x209)][_0x4881ba(0x2e3,0x264)]['outputTexture']=this[_0x476141(-0x3b,-0x66)]['postProcessingPosition']);},'isDynamic':()=>this['options']['dynamic']})};}['reCreateWindTextures'](){this[_0x498b39(-0x4c,-0x31)]['U']['destroy'](),this['windTextures']['V']['destroy']();function _0x498b39(_0x2990e8,_0x4c6b7b){return _0x48c643(_0x4c6b7b-0x217,_0x2990e8);}this['createWindTextures']();}['updateWindData'](_0x1f2172){this['windData']=_0x1f2172,this['reCreateWindTextures']();}['updateOptions'](_0x45344c){function _0x108511(_0x11b6cd,_0x8df9dd){return _0x419219(_0x8df9dd,_0x11b6cd-0x3f4);}const _0x472400=_0x45344c[_0x10a4a7(-0xd7,-0x153)]!==undefined&&_0x45344c[_0x10a4a7(-0xd7,-0x138)]!==this[_0x10a4a7(-0x85,-0x98)][_0x108511(0x29a,0x223)];this['options']=deepMerge(_0x45344c,this['options']);function _0x10a4a7(_0x3b5b0a,_0x5c889d){return _0x419219(_0x5c889d,_0x3b5b0a-0x83);}_0x472400&&this[_0x108511(0x303,0x2e8)]();}['processWindData'](_0x52a0c2){const {array:_0x5dde78}=_0x52a0c2;let {min:_0x228096,max:_0x3abb50}=_0x52a0c2;const _0x4df59e=new Float32Array(_0x5dde78['length']);_0x228096===undefined&&(console[_0x21d9c6(0x2d7,0x258)](_0x1c05c7(0xfa,0xa8)),_0x228096=Math['min'](..._0x5dde78));_0x3abb50===undefined&&(console['warn']('max\x20is\x20undefined,\x20calculate\x20max'),_0x3abb50=Math['max'](..._0x5dde78));const _0x44897a=Math['max'](Math['abs'](_0x228096),Math['abs'](_0x3abb50));for(let _0x15c452=0x0;_0x15c452<_0x5dde78['length'];_0x15c452++){const _0x4db029=_0x5dde78[_0x15c452]/_0x44897a;_0x4df59e[_0x15c452]=_0x4db029;}function _0x21d9c6(_0x3b5274,_0x5abad6){return _0x419219(_0x5abad6,_0x3b5274-0x33b);}function _0x1c05c7(_0x43186f,_0x349491){return _0x48c643(_0x349491-0x2aa,_0x43186f);}return _0x4df59e;}['destroy'](){function _0xfbd112(_0x2d5dec,_0x304580){return _0x48c643(_0x304580-0x600,_0x2d5dec);}function _0x35dcbb(_0x307a85,_0xb3399f){return _0x419219(_0x307a85,_0xb3399f-0x5dd);}Object[_0x35dcbb(0x58e,0x53e)](this[_0xfbd112(0x3cf,0x3b8)])[_0xfbd112(0x4bd,0x476)](_0x488eb4=>_0x488eb4['destroy']()),Object[_0x35dcbb(0x4bc,0x53e)](this['particlesTextures'])['forEach'](_0x567bc1=>_0x567bc1[_0xfbd112(0x463,0x404)]()),Object['values'](this[_0xfbd112(0x503,0x47e)])['forEach'](_0x41928c=>_0x41928c['destroy']()),this['frameRateMonitor']['destroy']();}}const {Appearance,BufferUsage,Cartesian2,Color:Color$1,ComponentDatatype,Framebuffer,Geometry,GeometryAttribute,GeometryAttributes,PixelDatatype,PixelFormat,PrimitiveType,Sampler,SceneMode,Texture,TextureMagnificationFilter,TextureMinificationFilter,TextureWrap,VertexArray}=mars3d__namespace['Cesium'];class WindParticlesRendering{constructor(_0x40af52,_0x1d7a8f,_0x4a189c,_0x5cf3b6){this['context']=_0x40af52;function _0x379d43(_0x4694b9,_0x2d6517){return _0x419219(_0x4694b9,_0x2d6517-0x32a);}this[_0x379d43(0x284,0x222)]=_0x1d7a8f,this['viewerParameters']=_0x4a189c,this['computing']=_0x5cf3b6;(typeof this['options']['particlesTextureSize']!==_0x379d43(0x21b,0x297)||this[_0x379d43(0x208,0x222)]['particlesTextureSize']<=0x0)&&(console['error'](_0x379d43(0x1e0,0x1f8)),this['options']['particlesTextureSize']=0x100);function _0x548774(_0x378796,_0x28b1a5){return _0x48c643(_0x28b1a5-0x34c,_0x378796);}this['colorTable']=this['createColorTableTexture'](),this['textures']=this[_0x379d43(0x345,0x2c8)](),this[_0x379d43(0x1b5,0x1db)]=this[_0x548774(0x1ee,0x1c1)](),this['primitives']=this['createPrimitives']();}['createRenderingTextures'](){const _0x490105={};_0x490105['context']=this['context'],_0x490105['width']=this['context']['drawingBufferWidth'],_0x490105[_0x29910c(0x360,0x324)]=this[_0xab7be7(-0x1be,-0x207)][_0x29910c(0x33e,0x30f)],_0x490105['pixelFormat']=PixelFormat['RGBA'],_0x490105[_0xab7be7(-0x1d2,-0x18a)]=PixelDatatype[_0xab7be7(-0x184,-0x14b)];const _0x28206a=_0x490105,_0x5954b8={};function _0x29910c(_0x51bab1,_0x26d600){return _0x419219(_0x26d600,_0x51bab1-0x421);}_0x5954b8['context']=this[_0xab7be7(-0x1be,-0x141)],_0x5954b8[_0xab7be7(-0x155,-0x18e)]=this['context'][_0x29910c(0x32d,0x3aa)];function _0xab7be7(_0x47c683,_0x58f2c8){return _0x48c643(_0x47c683-0x21,_0x58f2c8);}_0x5954b8[_0x29910c(0x360,0x38a)]=this['context']['drawingBufferHeight'],_0x5954b8[_0xab7be7(-0x14d,-0x1c0)]=PixelFormat[_0xab7be7(-0x1c5,-0x179)],_0x5954b8['pixelDatatype']=PixelDatatype[_0xab7be7(-0x225,-0x262)];const _0x12f1ea=_0x5954b8;return{'segmentsColor':new Texture(_0x28206a),'segmentsDepth':new Texture(_0x12f1ea)};}['createRenderingFramebuffers'](){const _0x5e1842={};_0x5e1842['context']=this[_0x29f661(0x515,0x50b)],_0x5e1842['colorTextures']=[this[_0x29f661(0x534,0x525)][_0x40c4ef(0x48d,0x493)]];function _0x29f661(_0x3f1757,_0x1f1d57){return _0x419219(_0x3f1757,_0x1f1d57-0x5f7);}_0x5e1842['depthTexture']=this[_0x40c4ef(0x4c2,0x482)][_0x29f661(0x4d8,0x556)];function _0x40c4ef(_0x3a36c9,_0x1cacaa){return _0x419219(_0x1cacaa,_0x3a36c9-0x594);}return{'segments':new Framebuffer(_0x5e1842)};}['destoryRenderingFramebuffers'](){Object['values'](this['framebuffers'])['forEach'](_0x5c73ca=>{function _0x445384(_0x43b3c4,_0x4955a){return _0x5224(_0x43b3c4- -0x1fe,_0x4955a);}_0x5c73ca[_0x445384(-0x68,0x1d)]();});}['createColorTableTexture'](){const _0xc273cd=new Float32Array(this[_0x1fae76(0xb0,0x77)]['colors'][_0x1fae76(0xfa,0xa8)](_0x1d049a=>{function _0x13cb9d(_0x4ee10a,_0x31c943){return _0x56cf28(_0x31c943,_0x4ee10a- -0x2e8);}const _0x1e2b38=Color$1['fromCssColorString'](_0x1d049a);function _0x8dcc26(_0x352d64,_0x1723e4){return _0x56cf28(_0x1723e4,_0x352d64- -0x2da);}return[_0x1e2b38[_0x13cb9d(0x202,0x230)],_0x1e2b38['green'],_0x1e2b38['blue'],_0x1e2b38[_0x13cb9d(0x1da,0x16b)]];})),_0x5b4159={};_0x5b4159['minificationFilter']=TextureMinificationFilter[_0x56cf28(0x4c8,0x4a4)],_0x5b4159[_0x1fae76(0x89,0xda)]=TextureMagnificationFilter['LINEAR'],_0x5b4159[_0x1fae76(0x102,0x8a)]=TextureWrap[_0x56cf28(0x56f,0x549)],_0x5b4159['wrapT']=TextureWrap['CLAMP_TO_EDGE'];function _0x56cf28(_0x560051,_0x4c2cd0){return _0x48c643(_0x4c2cd0-0x6a3,_0x560051);}function _0x1fae76(_0x10ebda,_0x375ab1){return _0x48c643(_0x10ebda-0x2ab,_0x375ab1);}return new Texture({'context':this['context'],'width':this[_0x56cf28(0x460,0x4a8)]['colors'][_0x56cf28(0x4d4,0x469)],'height':0x1,'pixelFormat':PixelFormat['RGBA'],'pixelDatatype':PixelDatatype['FLOAT'],'sampler':new Sampler(_0x5b4159),'source':{'width':this[_0x1fae76(0xb0,0x24)][_0x1fae76(0x92,0x71)]['length'],'height':0x1,'arrayBufferView':_0xc273cd}});}['createSegmentsGeometry'](){const _0x5ad234=0x4,_0x2e74a5=this['options']['particlesTextureSize'];let _0x5837c8=[];for(let _0x93f556=0x0;_0x93f556<_0x2e74a5;_0x93f556++){for(let _0x245991=0x0;_0x245991<_0x2e74a5;_0x245991++){for(let _0x56ea69=0x0;_0x56ea69<_0x5ad234;_0x56ea69++){_0x5837c8['push'](_0x93f556/_0x2e74a5),_0x5837c8[_0x33364c(0x41,0x74)](_0x245991/_0x2e74a5);}}}_0x5837c8=new Float32Array(_0x5837c8);const _0x45848b=this['options']['particlesTextureSize']**0x2;let _0xf7d3bf=[];for(let _0x4ac1b8=0x0;_0x4ac1b8<_0x45848b;_0x4ac1b8++){_0xf7d3bf['push'](-0x1,-0x1,0x0,-0x1,0x1,0x0,0x1,-0x1,0x0,0x1,0x1,0x0);}_0xf7d3bf=new Float32Array(_0xf7d3bf);let _0x51cd26=[];function _0x33364c(_0x392a4c,_0x3052b0){return _0x419219(_0x392a4c,_0x3052b0-0x185);}for(let _0x531524=0x0,_0xb2f960=0x0;_0x531524<_0x45848b;_0x531524++){_0x51cd26[_0x316e29(0x2de,0x2b7)](_0xb2f960+0x0,_0xb2f960+0x1,_0xb2f960+0x2,_0xb2f960+0x2,_0xb2f960+0x1,_0xb2f960+0x3),_0xb2f960+=_0x5ad234;}_0x51cd26=new Uint32Array(_0x51cd26);const _0xc56490={};_0xc56490[_0x316e29(0x33b,0x3a4)]=ComponentDatatype[_0x33364c(0x155,0x119)],_0xc56490['componentsPerAttribute']=0x2,_0xc56490['values']=_0x5837c8;const _0x18aefd={};_0x18aefd[_0x33364c(0x118,0xd1)]=ComponentDatatype['FLOAT'],_0x18aefd['componentsPerAttribute']=0x3,_0x18aefd['values']=_0xf7d3bf;const _0x11ff33=new Geometry({'attributes':new GeometryAttributes({'st':new GeometryAttribute(_0xc56490),'normal':new GeometryAttribute(_0x18aefd)}),'indices':_0x51cd26});function _0x316e29(_0x899fdf,_0x29350b){return _0x419219(_0x29350b,_0x899fdf-0x3ef);}return _0x11ff33;}[_0x419219(-0x184,-0xf7)](_0x291531){const _0x5370ea={'viewport':undefined,'depthTest':undefined,'depthMask':undefined,'blending':undefined,..._0x291531};function _0x432d17(_0x425aa3,_0x10199b){return _0x419219(_0x10199b,_0x425aa3-0x241);}return Appearance[_0x432d17(0x1e8,0x260)](!![],![],_0x5370ea);}[_0x48c643(-0x228,-0x1ef)](){const _0x5391f8={};_0x5391f8['st']=0x0,_0x5391f8['normal']=0x1;const _0x2d9f55={};_0x2d9f55['enabled']=!![];function _0x21db1c(_0x3d7400,_0x3054d1){return _0x48c643(_0x3d7400- -0x39,_0x3054d1);}const _0x30bf2a={};_0x30bf2a[_0x5cc21b(0x287,0x221)]=!![],_0x30bf2a['blendEquation']=WebGLRenderingContext['FUNC_ADD'],_0x30bf2a[_0x5cc21b(0x259,0x1da)]=WebGLRenderingContext['SRC_ALPHA'],_0x30bf2a[_0x5cc21b(0x2aa,0x2ac)]=WebGLRenderingContext[_0x5cc21b(0x24b,0x1cf)];const _0x5b259e={};_0x5b259e[_0x5cc21b(0x364,0x2de)]=undefined,_0x5b259e['depthTest']=_0x2d9f55,_0x5b259e['depthMask']=!![],_0x5b259e[_0x21db1c(-0x246,-0x27d)]=_0x30bf2a;const _0x12df4b=new CustomPrimitive({'commandType':'Draw','attributeLocations':_0x5391f8,'geometry':this['createSegmentsGeometry'](),'primitiveType':PrimitiveType['TRIANGLES'],'uniformMap':{'previousParticlesPosition':()=>this[_0x5cc21b(0x23f,0x223)]['particlesTextures']['previousParticlesPosition'],'currentParticlesPosition':()=>this['computing']['particlesTextures']['currentParticlesPosition'],'postProcessingPosition':()=>this['computing'][_0x5cc21b(0x289,0x258)]['postProcessingPosition'],'particlesSpeed':()=>this[_0x5cc21b(0x264,0x223)]['particlesTextures']['particlesSpeed'],'frameRateAdjustment':()=>this['computing'][_0x21db1c(-0x1f8,-0x1f0)],'colorTable':()=>this['colorTable'],'domain':()=>{function _0x2dc7d5(_0x269ae8,_0x23a20b){return _0x21db1c(_0x269ae8-0x1db,_0x23a20b);}var _0x5baab7,_0x300025;function _0x278edb(_0x4e2d44,_0x564930){return _0x21db1c(_0x4e2d44-0x577,_0x564930);}const _0xdffa13=new Cartesian2(((_0x5baab7=this['options'][_0x278edb(0x3d7,0x38a)])===null||_0x5baab7===void 0x0?void 0x0:_0x5baab7[_0x278edb(0x3d3,0x3c1)])??this['computing']['windData'][_0x278edb(0x380,0x3f2)]['min'],((_0x300025=this['options'][_0x278edb(0x3d7,0x381)])===null||_0x300025===void 0x0?void 0x0:_0x300025[_0x278edb(0x36b,0x3ba)])??this[_0x2dc7d5(-0x6a,-0x99)][_0x278edb(0x3a4,0x3d7)]['speed']['max']);return _0xdffa13;},'displayRange':()=>{function _0x292ead(_0x1f2421,_0x328f3c){return _0x21db1c(_0x328f3c-0x80,_0x1f2421);}function _0x177d52(_0x266222,_0x5d7644){return _0x21db1c(_0x266222-0x1a7,_0x5d7644);}var _0x7e8f25,_0x5f4fbd;const _0x5b80cb=new Cartesian2(((_0x7e8f25=this[_0x177d52(-0x8d,-0x107)]['displayRange'])===null||_0x7e8f25===void 0x0?void 0x0:_0x7e8f25[_0x292ead(-0xb1,-0x124)])??this['computing'][_0x177d52(-0x2c,0x16)]['speed'][_0x177d52(0x3,0x7c)],((_0x5f4fbd=this['options'][_0x177d52(-0x1f,0x62)])===null||_0x5f4fbd===void 0x0?void 0x0:_0x5f4fbd['max'])??this[_0x177d52(-0x9e,-0x116)]['windData'][_0x292ead(-0x110,-0x177)][_0x292ead(-0x1ad,-0x18c)]);return _0x5b80cb;},'particleHeight':()=>this['options'][_0x21db1c(-0x248,-0x26c)]||0x0,'aspect':()=>this['context'][_0x21db1c(-0x220,-0x195)]/this[_0x21db1c(-0x218,-0x25f)][_0x21db1c(-0x20f,-0x1e4)],'pixelSize':()=>this[_0x21db1c(-0x26a,-0x2ea)]['pixelSize'],'lineWidth':()=>{const _0x5a1e5b={};_0x5a1e5b['min']=0x1,_0x5a1e5b['max']=0x2;const _0x5df469=this['options']['lineWidth']||_0x5a1e5b;return new Cartesian2(_0x5df469['min'],_0x5df469['max']);},'lineLength':()=>{function _0x16de3f(_0x30957d,_0x4289b8){return _0x5cc21b(_0x30957d,_0x4289b8- -0x246);}const _0x310c16={};function _0x19facf(_0x47705f,_0x2dee35){return _0x21db1c(_0x47705f-0x1b9,_0x2dee35);}_0x310c16[_0x16de3f(0xe3,0x7e)]=0x14,_0x310c16['max']=0x64;const _0x29a36c=this['options'][_0x19facf(-0x7e,-0x11)]||_0x310c16;return new Cartesian2(_0x29a36c['min'],_0x29a36c[_0x19facf(-0x53,-0x92)]);},'is3D':()=>this[_0x5cc21b(0x1bc,0x1fe)][_0x5cc21b(0x18d,0x20f)]===SceneMode[_0x21db1c(-0x290,-0x25c)],'segmentsDepthTexture':()=>this['textures'][_0x21db1c(-0x1cd,-0x1e7)]},'vertexShaderSource':ShaderManager[_0x21db1c(-0x211,-0x295)](),'fragmentShaderSource':ShaderManager['getSegmentDrawFragmentShader'](),'rawRenderState':this[_0x5cc21b(0x259,0x245)](_0x5b259e)}),_0x4ad84f={};_0x4ad84f['segments']=_0x12df4b;function _0x5cc21b(_0x2df4ef,_0xe37226){return _0x48c643(_0xe37226-0x42f,_0x2df4ef);}return _0x4ad84f;}[_0x419219(-0x12d,-0xae)](){function _0x5365df(_0x4a6117,_0x530cdd){return _0x48c643(_0x4a6117-0x4cc,_0x530cdd);}const _0x33e8c5=this[_0x42be68(0x3e,0x33)]();this[_0x42be68(0x12,0x7e)]['segments'][_0x5365df(0x2ae,0x2e2)]=_0x33e8c5;const _0x5030b8={};_0x5030b8['context']=this['context'],_0x5030b8['geometry']=_0x33e8c5;function _0x42be68(_0x3435b6,_0x48d8ce){return _0x48c643(_0x3435b6-0x194,_0x48d8ce);}_0x5030b8['attributeLocations']=this[_0x5365df(0x34a,0x389)][_0x42be68(-0x4f,-0xbc)][_0x5365df(0x289,0x271)],_0x5030b8['bufferUsage']=BufferUsage['STATIC_DRAW'];const _0x32d9e2=VertexArray[_0x42be68(0x44,0xa2)](_0x5030b8);this[_0x5365df(0x34a,0x364)][_0x5365df(0x2e9,0x2bc)][_0x42be68(0x36,0xd)]&&(this[_0x5365df(0x34a,0x33e)][_0x5365df(0x2e9,0x2db)]['commandToExecute']['vertexArray']=_0x32d9e2);}[_0x419219(-0x176,-0x102)](){function _0x1543c9(_0x12dfde,_0x508c97){return _0x48c643(_0x508c97-0x4e6,_0x12dfde);}function _0x212376(_0x355b67,_0xf5572c){return _0x48c643(_0x355b67-0x690,_0xf5572c);}this[_0x1543c9(0x3c1,0x35d)]['destroy'](),this[_0x212376(0x507,0x574)]=this['createColorTableTexture']();}['updateOptions'](_0x24fa79){const _0xbb81fa=_0x24fa79['colors']&&JSON[_0x3203b8(0x51,0xcd)](_0x24fa79[_0x3203b8(0x1d,0x51)])!==JSON[_0x3203b8(0x131,0xcd)](this[_0x3203b8(0xb,0x6f)]['colors']);function _0x3203b8(_0x5bb835,_0x310ead){return _0x48c643(_0x310ead-0x26a,_0x5bb835);}function _0x321cae(_0x2b97a2,_0x57d719){return _0x419219(_0x57d719,_0x2b97a2-0x285);}this['options']=deepMerge(_0x24fa79,this[_0x3203b8(0x5a,0x6f)]),_0xbb81fa&&this[_0x3203b8(0x75,0x75)]();}['destroy'](){Object['values'](this[_0x1776de(0x50,0xbe)])['forEach'](_0x2a3426=>{_0x2a3426['destroy']();}),Object['values'](this[_0x1776de(0x1ba,0x17e)])['forEach'](_0x135d25=>{_0x135d25['destroy']();});function _0x1776de(_0x936cf4,_0x181f45){return _0x48c643(_0x181f45-0x300,_0x936cf4);}function _0x2d1536(_0x39fdc7,_0x1b414f){return _0x419219(_0x1b414f,_0x39fdc7-0x1fa);}this['colorTable']['destroy']();}}const {ClearCommand,Color,Pass}=mars3d__namespace['Cesium'];class WindParticleSystem{constructor(_0x25a722,_0x2481bf,_0x1512ff,_0x3305b3,_0x3bd31c){this['context']=_0x25a722,this['options']=_0x1512ff,this[_0x4b2b85(0xa2,0x6d)]=_0x3305b3;function _0x57f074(_0x9231df,_0x2dbd2f){return _0x419219(_0x2dbd2f,_0x9231df-0x408);}function _0x4b2b85(_0x5164dd,_0x2285a3){return _0x48c643(_0x5164dd-0x2d3,_0x2285a3);}this[_0x4b2b85(0xc7,0x9a)]=new WindParticlesComputing(_0x25a722,_0x2481bf,_0x1512ff,_0x3305b3,_0x3bd31c),this['rendering']=new WindParticlesRendering(_0x25a722,_0x1512ff,_0x3305b3,this['computing']),this[_0x4b2b85(0x76,0x3f)]();}[_0x48c643(-0x17f,-0x176)](){function _0x45caf8(_0x5f0f51,_0x1af0c5){return _0x48c643(_0x1af0c5-0x3a1,_0x5f0f51);}function _0x4b2461(_0x679e26,_0x4bc129){return _0x419219(_0x679e26,_0x4bc129-0x5c5);}const _0x48d3e9=[this['computing']['primitives']['calculateSpeed'],this['computing']['primitives'][_0x4b2461(0x42f,0x4a2)],this[_0x4b2461(0x46b,0x4ac)][_0x45caf8(0x1c6,0x21f)]['postProcessingPosition'],this[_0x45caf8(0x22c,0x20a)][_0x4b2461(0x4ec,0x536)][_0x4b2461(0x45b,0x4d5)]];return _0x48d3e9;}['clearFramebuffers'](){const _0x60c198=new ClearCommand({'color':new Color(0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':undefined,'pass':Pass['OPAQUE']});function _0x140a54(_0x133468,_0x36971e){return _0x48c643(_0x36971e-0x10d,_0x133468);}function _0x8ab80b(_0x500081,_0x4bcedd){return _0x419219(_0x4bcedd,_0x500081-0x538);}Object['keys'](this[_0x8ab80b(0x494,0x48c)]['framebuffers'])[_0x140a54(-0x7f,-0x7d)](_0x21382e=>{function _0x2ae9eb(_0x223b48,_0x534d3d){return _0x140a54(_0x223b48,_0x534d3d-0x283);}_0x60c198['framebuffer']=this['rendering'][_0x2ae9eb(0x17c,0x14e)][_0x21382e];function _0x5ef356(_0xb008b5,_0x506c15){return _0x140a54(_0xb008b5,_0x506c15-0x62d);}_0x60c198['execute'](this[_0x2ae9eb(0x13b,0x1b1)]);});}[_0x419219(-0x2e,-0x9c)](_0x59fc48){let _0x15a0dc=![];_0x59fc48['particlesTextureSize']&&this['options'][_0xe327cd(0x164,0x133)]!==_0x59fc48['particlesTextureSize']&&(_0x15a0dc=!![]);const _0x326598=deepMerge(_0x59fc48,this[_0x187bd4(-0x43,-0x60)]);if(_0x326598['particlesTextureSize']<0x1)throw new Error('particlesTextureSize\x20must\x20be\x20greater\x20than\x200');this[_0xe327cd(0x15f,0x1bd)]=_0x326598,this[_0x187bd4(0x21,0x92)]['updateOptions'](_0x59fc48);function _0xe327cd(_0x3c1c88,_0x2cadb9){return _0x419219(_0x2cadb9,_0x3c1c88-0x267);}this['computing']['updateOptions'](_0x59fc48);function _0x187bd4(_0x1ff64a,_0x310080){return _0x48c643(_0x1ff64a-0x1b8,_0x310080);}_0x15a0dc&&(this[_0xe327cd(0x14e,0xc3)]['destroyParticlesTextures'](),this[_0x187bd4(-0x54,-0x80)]['createParticlesTextures'](),this[_0x187bd4(0x21,0x98)]['onParticlesTextureSizeChange']());}['applyViewerParameters'](_0x10bf56){function _0x3619d1(_0x15b626,_0x28d04f){return _0x419219(_0x15b626,_0x28d04f-0x210);}function _0x662372(_0x184a7e,_0x3b0da2){return _0x419219(_0x184a7e,_0x3b0da2- -0x112);}this[_0x3619d1(0x8f,0xd2)]=_0x10bf56,this[_0x3619d1(0xce,0xf7)]['viewerParameters']=_0x10bf56,this['rendering'][_0x3619d1(0x8c,0xd2)]=_0x10bf56;}[_0x48c643(-0x1fc,-0x260)](){function _0x38dbf7(_0x224d60,_0x26aa27){return _0x48c643(_0x26aa27-0x5bf,_0x224d60);}this[_0x1c6f2d(0x429,0x3f0)]['destroy']();function _0x1c6f2d(_0x3555d9,_0x564c85){return _0x419219(_0x3555d9,_0x564c85-0x509);}this[_0x38dbf7(0x433,0x428)][_0x38dbf7(0x43e,0x3c3)]();}}const Cesium$1=mars3d__namespace[_0x419219(-0x1d8,-0x152)],BaseLayer$1=mars3d__namespace['layer']['BaseLayer'],_0x513fa1={};_0x513fa1['min']=0x1,_0x513fa1['max']=0x2;const _0x4af58b={};_0x4af58b[_0x419219(-0x6a,-0x78)]=0x14,_0x4af58b[_0x419219(-0x169,-0xe0)]=0x64;const _0x585531={};_0x585531[_0x419219(-0x152,-0x103)]=0x64,_0x585531[_0x419219(-0x17b,-0x11c)]=0x0,_0x585531[_0x419219(-0x1a7,-0x154)]=_0x513fa1,_0x585531[_0x48c643(-0x1fe,-0x21c)]=_0x4af58b,_0x585531[_0x419219(-0x50,-0xc0)]=0x1,_0x585531[_0x419219(-0x126,-0xad)]=0.003,_0x585531['dropRateBump']=0.001,_0x585531['colors']=['rgb(206,255,255)'],_0x585531['flipY']=![],_0x585531[_0x48c643(-0x200,-0x176)]=!![];const DEF_OPTIONS=_0x585531;class WindLayer extends BaseLayer$1{constructor(_0x1c3ec3={}){_0x1c3ec3={...DEF_OPTIONS,..._0x1c3ec3},super(_0x1c3ec3),this['_setOptionsHook'](_0x1c3ec3,_0x1c3ec3);}get['layer'](){return this['primitives'];}get['data'](){function _0x51016b(_0x552f2a,_0x5f2826){return _0x48c643(_0x552f2a-0xe7,_0x5f2826);}return this['options'][_0x51016b(-0xcf,-0x13a)];}set[_0x419219(-0xf5,-0xc3)](_0x1d8ea2){function _0x29fcfd(_0x2bba53,_0xa48463){return _0x419219(_0x2bba53,_0xa48463-0x221);}this['options'][_0x4e1015(-0x1d4,-0x222)]=_0x1d8ea2;function _0x4e1015(_0x152946,_0x59db07){return _0x419219(_0x59db07,_0x152946- -0x111);}this[_0x29fcfd(0x130,0xc3)](_0x1d8ea2);}get[_0x419219(-0x123,-0x126)](){function _0x2f305c(_0x42a094,_0x3aa5c0){return _0x419219(_0x3aa5c0,_0x42a094-0x469);}return this['options'][_0x2f305c(0x343,0x30f)];}set['colors'](_0x264e7d){function _0x3661d9(_0x2bbb45,_0x13dc43){return _0x419219(_0x2bbb45,_0x13dc43-0x549);}this[_0xff4386(0x49b,0x4d4)]['colors']=_0x264e7d;const _0x2289d8={};function _0xff4386(_0x2e9ac0,_0x3bf5de){return _0x48c643(_0x3bf5de-0x6cf,_0x2e9ac0);}_0x2289d8[_0xff4386(0x437,0x4b6)]=_0x264e7d,this['_setOptionsHook'](this[_0x3661d9(0x4c9,0x441)],_0x2289d8);}['_mountedHook'](){}['_addedHook'](){this[_0x5aaff5(0xe8,0xf2)]=this['_map'][_0x5aaff5(0xe8,0x129)],this['camera']=this[_0x352346(0x33a,0x302)][_0x5aaff5(0xfa,0x73)];this[_0x352346(0x22d,0x25b)][_0x352346(0x2e7,0x2a0)]&&this[_0x352346(0x181,0x205)](this['options'][_0x352346(0x2b2,0x2a0)]);if(!this['windData'])return;this[_0x5aaff5(0xc0,0x62)]={'lonRange':new Cesium$1['Cartesian2'](-0xb4,0xb4),'latRange':new Cesium$1['Cartesian2'](-0x5a,0x5a),'pixelSize':0x3e8,'sceneMode':this['scene']['mode']},this[_0x5aaff5(0xc7,0x83)](),this[_0x352346(0x230,0x221)]=new WindParticleSystem(this['scene']['context'],this[_0x5aaff5(0x157,0x1ad)],this['options'],this['viewerParameters'],this[_0x352346(0x225,0x24d)]),this['primitives']=this[_0x352346(0x19d,0x221)]['getPrimitives'](),this[_0x5aaff5(0x16f,0x124)]['forEach'](_0x32e3a6=>{function _0x1c0f7b(_0x347f93,_0x2307c9){return _0x352346(_0x347f93,_0x2307c9- -0x13f);}function _0x3565ae(_0x3f3d3d,_0x143055){return _0x352346(_0x143055,_0x3f3d3d-0x22a);}this[_0x3565ae(0x477,0x40b)]['primitives'][_0x3565ae(0x520,0x4ce)](_0x32e3a6);}),this['camera'][_0x352346(0x346,0x2e2)]=0.01;function _0x5aaff5(_0x22121c,_0x57076c){return _0x419219(_0x57076c,_0x22121c-0x1fe);}function _0x352346(_0x1beb9b,_0x39b409){return _0x419219(_0x1beb9b,_0x39b409-0x363);}this['camera']['changed'][_0x5aaff5(0x190,0x128)](this[_0x5aaff5(0xc7,0x155)]['bind'](this)),this['scene'][_0x352346(0x381,0x2f4)]['addEventListener'](this['updateViewerParameters']['bind'](this)),window['addEventListener']('resize',this[_0x5aaff5(0xc7,0x10f)][_0x5aaff5(0xe7,0x137)](this));}[_0x419219(-0xf9,-0x156)](){this[_0x5f0e5a(0x34a,0x390)]['changed']['removeEventListener'](this['updateViewerParameters']['bind'](this)),this[_0x5f0e5a(0x3fe,0x37e)]['morphComplete']['removeEventListener'](this['updateViewerParameters']['bind'](this));function _0x5f0e5a(_0x3d19d2,_0x5ba385){return _0x419219(_0x3d19d2,_0x5ba385-0x494);}window[_0x35f49d(0x2ec,0x2d2)](_0x35f49d(0x347,0x2cc),this[_0x5f0e5a(0x305,0x35d)]['bind'](this));function _0x35f49d(_0x5eaa6c,_0x277c5b){return _0x419219(_0x5eaa6c,_0x277c5b-0x40b);}this[_0x5f0e5a(0x488,0x405)]&&(this['primitives']['forEach'](_0x178451=>{function _0x4e89b1(_0x4ade6f,_0x2d6e7e){return _0x35f49d(_0x4ade6f,_0x2d6e7e- -0x475);}function _0x5d90c0(_0x2d8ee5,_0x4aaa90){return _0x35f49d(_0x4aaa90,_0x2d8ee5- -0x418);}this['scene'][_0x4e89b1(-0x14c,-0xf9)][_0x5d90c0(-0x164,-0x189)](_0x178451);}),delete this['primitives']),this[_0x5f0e5a(0x329,0x352)]&&(this['particleSystem']['destroy'](),delete this['particleSystem']);}['setData'](_0x268dec,_0x2d03c1){this[_0x153061(0x3e3,0x44a)]=this['processWindData'](_0x268dec);if(_0x2d03c1){this['_removedHook'](),this['_addedHook']();return;}function _0x153061(_0x502928,_0x48515e){return _0x419219(_0x502928,_0x48515e-0x4f1);}this['particleSystem']?(this['particleSystem']['computing']['updateWindData'](this['windData']),this['scene']['requestRender']()):this['_addedHook']();}['_setOptionsHook'](_0xaba8f4,_0x5a420b){function _0x526b17(_0x155894,_0x5730c4){return _0x419219(_0x155894,_0x5730c4-0x4b8);}function _0xfb33ae(_0x10b8cf,_0x1b427e){return _0x419219(_0x10b8cf,_0x1b427e-0x62e);}this['particleSystem']&&(this['particleSystem'][_0x526b17(0x3d1,0x41c)](_0x5a420b),this['scene'][_0x526b17(0x423,0x3dd)]());}[_0x419219(-0x2,-0x5c)](_0x21b9e1){var _0x494a6e,_0x360756;function _0x265c56(_0xf77df3,_0x2ca135){return _0x48c643(_0xf77df3-0x658,_0x2ca135);}const _0x3858ab={..._0x21b9e1},_0x3d203e=_0x3858ab;!_0x3d203e['height']&&_0x3d203e['rows']&&(_0x3d203e[_0x265c56(0x4a4,0x4d7)]=_0x3d203e['rows']);!_0x3d203e['width']&&_0x3d203e['cols']&&(_0x3d203e[_0x265c56(0x4e2,0x4b0)]=_0x3d203e['cols']);!_0x3d203e[_0x308c85(0x11e,0x17b)]&&(_0x3d203e[_0x308c85(0x164,0x17b)]={'west':_0x3d203e['xmin'],'south':_0x3d203e[_0x308c85(0x143,0x134)],'east':_0x3d203e['xmax'],'north':_0x3d203e[_0x265c56(0x42f,0x45c)]});if(!_0x3d203e['u']){const _0x1779a5={};_0x1779a5['array']=_0x21b9e1['udata'],_0x1779a5['min']=_0x21b9e1['umin'],_0x1779a5['max']=_0x21b9e1[_0x308c85(0x160,0x15a)],_0x3d203e['u']=_0x1779a5;}function _0x308c85(_0x535d92,_0x5a0d47){return _0x48c643(_0x5a0d47-0x390,_0x535d92);}if(!_0x3d203e['v']){const _0x16eaf3={};_0x16eaf3['array']=_0x21b9e1[_0x308c85(0x20c,0x185)],_0x16eaf3['min']=_0x21b9e1['vmin'],_0x16eaf3[_0x308c85(0x1d5,0x1bd)]=_0x21b9e1['vmax'],_0x3d203e['v']=_0x16eaf3;}if(((_0x494a6e=_0x3d203e['speed'])===null||_0x494a6e===void 0x0?void 0x0:_0x494a6e['min'])===undefined||((_0x360756=_0x3d203e[_0x308c85(0x216,0x1d2)])===null||_0x360756===void 0x0?void 0x0:_0x360756['max'])===undefined||_0x3d203e['speed']['array']===undefined){const _0x2f34c0={'array':new Float32Array(_0x3d203e['u']['array']['length']),'min':Number['MAX_VALUE'],'max':Number[_0x308c85(0x20d,0x1c4)]};for(let _0x89e758=0x0;_0x89e758<_0x3d203e['u'][_0x265c56(0x445,0x40a)][_0x265c56(0x41e,0x463)];_0x89e758++){_0x2f34c0['array'][_0x89e758]=Math['sqrt'](_0x3d203e['u'][_0x265c56(0x445,0x48d)][_0x89e758]*_0x3d203e['u'][_0x265c56(0x445,0x4a3)][_0x89e758]+_0x3d203e['v']['array'][_0x89e758]*_0x3d203e['v'][_0x265c56(0x445,0x3c7)][_0x89e758]),_0x2f34c0['array'][_0x89e758]!==0x0&&(_0x2f34c0[_0x308c85(0x258,0x225)]=Math[_0x308c85(0x292,0x225)](_0x2f34c0['min'],_0x2f34c0['array'][_0x89e758]),_0x2f34c0['max']=Math['max'](_0x2f34c0['max'],_0x2f34c0[_0x308c85(0x1b4,0x17d)][_0x89e758]));}_0x3d203e['speed']=_0x2f34c0;}return _0x3d203e;}['updateViewerParameters'](){var _0xea4984;const _0x4652b3=this['scene'],_0x585d1f=_0x4652b3[_0x353bca(0x189,0x157)],_0x39909e={};_0x39909e['x']=0x0,_0x39909e['y']=0x0;function _0x283274(_0x457af3,_0x25ab14){return _0x48c643(_0x25ab14-0x396,_0x457af3);}const _0x541ebf={};_0x541ebf['x']=0x0,_0x541ebf['y']=_0x585d1f[_0x283274(0x198,0x1d4)];const _0x3aa061={};_0x3aa061['x']=_0x585d1f['clientWidth'],_0x3aa061['y']=0x0;const _0x122962={};function _0x353bca(_0x2eb0da,_0x5ad8e8){return _0x48c643(_0x2eb0da-0x399,_0x5ad8e8);}_0x122962['x']=_0x585d1f[_0x353bca(0x208,0x1c7)],_0x122962['y']=_0x585d1f['clientHeight'];const _0x35ad72=[_0x39909e,_0x541ebf,_0x3aa061,_0x122962];let _0x143324=0xb4,_0x145ecb=-0xb4,_0x2ea36f=0x5a,_0xf4f020=-0x5a,_0x190b96=![];for(const _0x46da1e of _0x35ad72){const _0x4d6b20=_0x4652b3['camera']['pickEllipsoid'](new Cesium$1[(_0x283274(0x202,0x18f))](_0x46da1e['x'],_0x46da1e['y']),_0x4652b3[_0x283274(0x1ce,0x173)]['ellipsoid']);if(!_0x4d6b20){_0x190b96=!![];break;}const _0x886cd8=_0x4652b3['globe'][_0x353bca(0x1d9,0x1a0)][_0x353bca(0x233,0x1d7)](_0x4d6b20),_0x4229f9=Cesium$1[_0x283274(0x17b,0x1c2)]['toDegrees'](_0x886cd8['longitude']),_0x58c40d=Cesium$1['Math']['toDegrees'](_0x886cd8['latitude']);_0x143324=Math[_0x353bca(0x22e,0x2a9)](_0x143324,_0x4229f9),_0x145ecb=Math[_0x283274(0x1e4,0x1c3)](_0x145ecb,_0x4229f9),_0x2ea36f=Math[_0x283274(0x224,0x22b)](_0x2ea36f,_0x58c40d),_0xf4f020=Math[_0x283274(0x197,0x1c3)](_0xf4f020,_0x58c40d);}if(!_0x190b96){const _0x1780fa=new Cesium$1[(_0x283274(0x193,0x18f))](Math['max'](this[_0x283274(0x1e3,0x1fc)]['bounds']['west'],_0x143324),Math[_0x353bca(0x22e,0x2a1)](this['windData'][_0x353bca(0x184,0x1d4)]['east'],_0x145ecb)),_0x3e2a37=new Cesium$1[(_0x283274(0x1d0,0x18f))](Math[_0x283274(0x155,0x1c3)](this['windData'][_0x353bca(0x184,0x156)][_0x353bca(0x1fd,0x1ed)],_0x2ea36f),Math['min'](this['windData'][_0x283274(0x15c,0x181)][_0x283274(0x166,0x19e)],_0xf4f020)),_0x1ae9ff=(_0x1780fa['y']-_0x1780fa['x'])*0.05,_0x5d9c2a=(_0x3e2a37['y']-_0x3e2a37['x'])*0.05;_0x1780fa['x']=Math[_0x283274(0x13e,0x1c3)](this[_0x283274(0x1e8,0x1fc)][_0x283274(0x177,0x181)]['west'],_0x1780fa['x']-_0x1ae9ff),_0x1780fa['y']=Math['min'](this['windData']['bounds']['east'],_0x1780fa['y']+_0x1ae9ff),_0x3e2a37['x']=Math[_0x283274(0x1e7,0x1c3)](this['windData'][_0x353bca(0x184,0x137)]['south'],_0x3e2a37['x']-_0x5d9c2a),_0x3e2a37['y']=Math['min'](this['windData'][_0x283274(0xf5,0x181)]['north'],_0x3e2a37['y']+_0x5d9c2a),this['viewerParameters']['lonRange']=_0x1780fa,this[_0x353bca(0x168,0x141)]['latRange']=_0x3e2a37;const _0x343367=this[_0x353bca(0x1ff,0x275)]['bounds'][_0x283274(0x1e1,0x191)]-this['windData']['bounds'][_0x353bca(0x24f,0x2da)],_0x24bb5d=this[_0x283274(0x282,0x1fc)]['bounds']['north']-this['windData'][_0x353bca(0x184,0x11c)]['south'],_0x190f78=(_0x1780fa['y']-_0x1780fa['x'])/_0x343367,_0x146437=(_0x3e2a37['y']-_0x3e2a37['x'])/_0x24bb5d,_0x3202e7=Math['min'](_0x190f78,_0x146437),_0x1d84a2=0x3e8*_0x3202e7;_0x1d84a2>0x0&&(this[_0x353bca(0x168,0xeb)][_0x283274(0x1be,0x172)]=Math['max'](0x0,Math['min'](0x3e8,_0x1d84a2)));}this['viewerParameters']['sceneMode']=this['scene'][_0x283274(0x297,0x21e)],(_0xea4984=this['particleSystem'])===null||_0xea4984===void 0x0||_0xea4984[_0x353bca(0x224,0x230)](this['viewerParameters']);}['getDataAtLonLat'](_0x143d50,_0xc29c55){const {bounds:_0x2f5a52,width:_0x2a6c8b,height:_0x31e740,u:_0x415814,v:_0x35d400,speed:_0x56d3cc}=this['windData'],{flipY:_0xfb2d22}=this['options'];if(_0x143d50<_0x2f5a52['west']||_0x143d50>_0x2f5a52[_0x1930cc(0x4a6,0x42e)]||_0xc29c55<_0x2f5a52['south']||_0xc29c55>_0x2f5a52[_0x1930cc(0x4b3,0x48d)])return null;const _0x461b13=(_0x143d50-_0x2f5a52[_0x1930cc(0x561,0x5d7)])/(_0x2f5a52['east']-_0x2f5a52[_0x1930cc(0x561,0x5c2)])*(_0x2a6c8b-0x1);let _0x1eb1fb=(_0xc29c55-_0x2f5a52['south'])/(_0x2f5a52['north']-_0x2f5a52[_0x24ddf4(0x2c0,0x27e)])*(_0x31e740-0x1);_0xfb2d22&&(_0x1eb1fb=_0x31e740-0x1-_0x1eb1fb);const _0x164f07=Math['floor'](_0x461b13),_0x19fd11=Math[_0x1930cc(0x530,0x4d4)](_0x1eb1fb),_0x25c467=Math['floor'](_0x461b13),_0x3862d0=Math['min'](_0x25c467+0x1,_0x2a6c8b-0x1),_0x279d6f=Math['floor'](_0x1eb1fb),_0x583d54=Math['min'](_0x279d6f+0x1,_0x31e740-0x1),_0x211244=_0x461b13-_0x25c467,_0x421bba=_0x1eb1fb-_0x279d6f,_0xc65b02=_0x19fd11*_0x2a6c8b+_0x164f07,_0x320041=_0x279d6f*_0x2a6c8b+_0x25c467,_0x2a44b6=_0x279d6f*_0x2a6c8b+_0x3862d0,_0x25b1e2=_0x583d54*_0x2a6c8b+_0x25c467,_0x5a486b=_0x583d54*_0x2a6c8b+_0x3862d0,_0x54a785=_0x415814[_0x24ddf4(0x249,0x299)][_0x320041],_0x419db8=_0x415814[_0x1930cc(0x498,0x4c0)][_0x2a44b6],_0x19dee5=_0x415814['array'][_0x25b1e2],_0x45d6ec=_0x415814['array'][_0x5a486b];function _0x24ddf4(_0x342c4e,_0x36a09b){return _0x419219(_0x36a09b,_0x342c4e-0x369);}const _0x1219a3=(0x1-_0x211244)*(0x1-_0x421bba)*_0x54a785+_0x211244*(0x1-_0x421bba)*_0x419db8+(0x1-_0x211244)*_0x421bba*_0x19dee5+_0x211244*_0x421bba*_0x45d6ec,_0x44363e=_0x35d400[_0x24ddf4(0x249,0x1d3)][_0x320041],_0x3de3ec=_0x35d400[_0x1930cc(0x498,0x4cf)][_0x2a44b6],_0x57b264=_0x35d400['array'][_0x25b1e2],_0x5b5046=_0x35d400['array'][_0x5a486b],_0x3d1c5c=(0x1-_0x211244)*(0x1-_0x421bba)*_0x44363e+_0x211244*(0x1-_0x421bba)*_0x3de3ec+(0x1-_0x211244)*_0x421bba*_0x57b264+_0x211244*_0x421bba*_0x5b5046,_0x35fd7a=Math['sqrt'](_0x1219a3*_0x1219a3+_0x3d1c5c*_0x3d1c5c),_0x3cc5e9={};_0x3cc5e9['u']=_0x415814[_0x1930cc(0x498,0x511)][_0xc65b02],_0x3cc5e9['v']=_0x35d400['array'][_0xc65b02],_0x3cc5e9[_0x1930cc(0x4ed,0x525)]=_0x56d3cc[_0x1930cc(0x498,0x4e4)][_0xc65b02];const _0x285f87={};_0x285f87['u']=_0x1219a3,_0x285f87['v']=_0x3d1c5c,_0x285f87['speed']=_0x35fd7a;function _0x1930cc(_0x45e8a0,_0x2e9f78){return _0x48c643(_0x45e8a0-0x6ab,_0x2e9f78);}const _0x3e7094={};return _0x3e7094['original']=_0x3cc5e9,_0x3e7094['interpolated']=_0x285f87,_0x3e7094;}}mars3d__namespace[_0x48c643(-0x17d,-0x154)][_0x48c643(-0x17e,-0x1f5)]('wind',WindLayer),mars3d__namespace['layer'][_0x419219(-0x16a,-0x15b)]=WindLayer;function _0x419219(_0x407bb0,_0x49b379){return _0x5224(_0x49b379- -0x29f,_0x407bb0);}class CanvasParticle{constructor(){this['lng']=null;function _0x76308a(_0x15fe58,_0x36dcf0){return _0x48c643(_0x15fe58-0x2ff,_0x36dcf0);}this['lat']=null,this['tlng']=null,this[_0x76308a(0x173,0x13c)]=null,this['age']=null,this['speed']=null;}['destroy'](){for(const _0x5f010d in this){delete this[_0x5f010d];}}}class CanvasWindField{constructor(_0x5eeeb2){this['setOptions'](_0x5eeeb2);}get['speedRate'](){return this['_speedRate'];}set['speedRate'](_0x10ac97){function _0x5967ba(_0x1ca404,_0x1b66ce){return _0x48c643(_0x1ca404-0xa,_0x1b66ce);}this['_speedRate']=(0x64-(_0x10ac97>0x63?0x63:_0x10ac97))*0x64;function _0x5e7919(_0x4dd9fe,_0x473af4){return _0x419219(_0x4dd9fe,_0x473af4- -0xfd);}this['_calc_speedRate']=[(this[_0x5967ba(-0x1c1,-0x1df)]-this[_0x5e7919(-0x2cd,-0x259)])/this[_0x5e7919(-0x1ca,-0x16f)],(this['ymax']-this['ymin'])/this[_0x5e7919(-0x15c,-0x16f)]];}get[_0x48c643(-0x24b,-0x2b5)](){function _0xbc66e4(_0x126316,_0x1a3fb2){return _0x48c643(_0x126316- -0x48,_0x1a3fb2);}return this[_0xbc66e4(-0x26e,-0x24c)];}set[_0x419219(-0x17c,-0x158)](_0x2261d5){function _0x1c0ab3(_0x18252c,_0x5cb154){return _0x419219(_0x5cb154,_0x18252c-0x5a8);}this[_0x1c0ab3(0x475,0x409)]=_0x2261d5;}['setOptions'](_0x5992e4){function _0x2b5b00(_0x366d91,_0x5de315){return _0x419219(_0x366d91,_0x5de315-0x16c);}function _0xf1aac1(_0x4e5db9,_0x2cb3a0){return _0x48c643(_0x4e5db9-0x5db,_0x2cb3a0);}this['options']=_0x5992e4,this['maxAge']=_0x5992e4['maxAge']||0x78,this['speedRate']=_0x5992e4['speedRate']||0x32,this[_0x2b5b00(0x12d,0x114)]=[];const _0x334b18=_0x5992e4['particlesNumber']||0x1000;for(let _0x29d1ef=0x0;_0x29d1ef<_0x334b18;_0x29d1ef++){const _0x1420ad=this['_randomParticle'](new CanvasParticle());this['particles'][_0xf1aac1(0x3d7,0x444)](_0x1420ad);}}[_0x419219(-0xb9,-0x56)](_0xa37aec){this[_0x606514(-0x14e,-0x1a4)]=_0xa37aec['rows'],this['cols']=_0xa37aec['cols'],this['xmin']=_0xa37aec['xmin'],this[_0x3fe150(0x31d,0x371)]=_0xa37aec['xmax'],this[_0x606514(-0x1ce,-0x18c)]=_0xa37aec['ymin'],this['ymax']=_0xa37aec['ymax'],this[_0x606514(-0x12d,-0x13e)]=[];const _0x553eed=_0xa37aec['udata'],_0x46fc33=_0xa37aec[_0x606514(-0x17d,-0x15c)];let _0x953929=![];function _0x606514(_0x1a33ae,_0x255fdc){return _0x48c643(_0x1a33ae-0x8e,_0x255fdc);}_0x553eed['length']===this['rows']&&_0x553eed[0x0][_0x3fe150(0x2ae,0x2ea)]===this['cols']&&(_0x953929=!![]);let _0x58595e=0x0;function _0x3fe150(_0x59b8c1,_0x47f669){return _0x48c643(_0x59b8c1-0x4e8,_0x47f669);}let _0x19cd74=null,_0x1b0a88=null;for(let _0x16031b=0x0;_0x16031b<this[_0x3fe150(0x30c,0x34b)];_0x16031b++){_0x19cd74=[];for(let _0x465719=0x0;_0x465719<this['cols'];_0x465719++,_0x58595e++){_0x953929?_0x1b0a88=this[_0x3fe150(0x321,0x2ee)](_0x553eed[_0x16031b][_0x465719],_0x46fc33[_0x16031b][_0x465719]):_0x1b0a88=this['_calcUV'](_0x553eed[_0x58595e],_0x46fc33[_0x58595e]),_0x19cd74['push'](_0x1b0a88);}this['grid']['push'](_0x19cd74);}!this['options'][_0x606514(-0x1bf,-0x1f0)]&&this[_0x3fe150(0x32d,0x36b)]['reverse']();}['clear'](){delete this[_0x598100(0x459,0x44d)],delete this['cols'],delete this['xmin'],delete this['xmax'],delete this[_0x598100(0x3d9,0x395)];function _0x3d1f89(_0x42933b,_0x3b7e90){return _0x48c643(_0x42933b-0x2e8,_0x3b7e90);}delete this[_0x3d1f89(0xbf,0x35)],delete this[_0x3d1f89(0x12d,0x1b6)];function _0x598100(_0xe82ca,_0x50d555){return _0x419219(_0x50d555,_0xe82ca-0x542);}delete this['particles'];}['toGridXY'](_0x25ccce,_0x45f9cb){function _0x4a914a(_0x25addb,_0x390cf5){return _0x48c643(_0x390cf5-0x4e0,_0x25addb);}const _0x48b052=(_0x25ccce-this['xmin'])/(this['xmax']-this['xmin'])*(this[_0x11bd8f(-0x1dc,-0x179)]-0x1);function _0x11bd8f(_0x244650,_0x552bf7){return _0x419219(_0x552bf7,_0x244650- -0xa0);}const _0x12c8e0=(this[_0x11bd8f(-0x1d6,-0x1c1)]-_0x45f9cb)/(this[_0x4a914a(0x313,0x2b7)]-this['ymin'])*(this['rows']-0x1);return[_0x48b052,_0x12c8e0];}['getUVByXY'](_0x492153,_0x427b94){if(_0x492153<0x0||_0x492153>=this[_0x2176fd(-0x2e1,-0x27f)]||_0x427b94>=this['rows'])return[0x0,0x0,0x0];const _0x1c0e98=Math['floor'](_0x492153),_0x173b80=Math['floor'](_0x427b94);if(_0x1c0e98===_0x492153&&_0x173b80===_0x427b94)return this[_0x30009c(-0x1c,-0xa8)][_0x427b94][_0x492153];const _0x474b2e=_0x1c0e98+0x1,_0x4e135a=_0x173b80+0x1,_0x12db83=this[_0x30009c(-0x80,-0x29)](_0x1c0e98,_0x173b80),_0x4c48ef=this['getUVByXY'](_0x474b2e,_0x173b80);function _0x2176fd(_0x30aa77,_0x19f00e){return _0x419219(_0x30aa77,_0x19f00e- -0x143);}const _0x3b713b=this['getUVByXY'](_0x1c0e98,_0x4e135a),_0x2d028f=this['getUVByXY'](_0x474b2e,_0x4e135a);function _0x30009c(_0x177613,_0x587293){return _0x48c643(_0x177613-0x19f,_0x587293);}let _0x1396ac=null;try{_0x1396ac=this['_bilinearInterpolation'](_0x492153-_0x1c0e98,_0x427b94-_0x173b80,_0x12db83,_0x4c48ef,_0x3b713b,_0x2d028f);}catch(_0x310322){console['log'](_0x492153,_0x427b94);}return _0x1396ac;}['_bilinearInterpolation'](_0x393f1d,_0x3a2952,_0x47c366,_0xde8a8,_0x5bad94,_0x5b85df){const _0x4febbe=0x1-_0x393f1d,_0x380bb9=0x1-_0x3a2952,_0x59ff22=_0x4febbe*_0x380bb9,_0x40fe01=_0x393f1d*_0x380bb9,_0x21fc11=_0x4febbe*_0x3a2952,_0x1bd14d=_0x393f1d*_0x3a2952,_0x7f97c0=_0x47c366[0x0]*_0x59ff22+_0xde8a8[0x0]*_0x40fe01+_0x5bad94[0x0]*_0x21fc11+_0x5b85df[0x0]*_0x1bd14d,_0x2e8b6a=_0x47c366[0x1]*_0x59ff22+_0xde8a8[0x1]*_0x40fe01+_0x5bad94[0x1]*_0x21fc11+_0x5b85df[0x1]*_0x1bd14d;return this['_calcUV'](_0x7f97c0,_0x2e8b6a);}['_calcUV'](_0x38adef,_0x207f5c){return[+_0x38adef,+_0x207f5c,Math['sqrt'](_0x38adef*_0x38adef+_0x207f5c*_0x207f5c)];}[_0x48c643(-0x196,-0x14e)](_0x2d3b23,_0x5360b0){function _0x5a0941(_0x4b85f3,_0x3fe42b){return _0x48c643(_0x3fe42b-0x5e8,_0x4b85f3);}if(!this['isInExtent'](_0x2d3b23,_0x5360b0))return null;const _0x5d911c=this['toGridXY'](_0x2d3b23,_0x5360b0),_0x3d283a=this[_0x5a0941(0x3fc,0x3c9)](_0x5d911c[0x0],_0x5d911c[0x1]);return _0x3d283a;}['isInExtent'](_0x10c460,_0x22de91){return _0x10c460>=this['xmin']&&_0x10c460<=this['xmax']&&_0x22de91>=this['ymin']&&_0x22de91<=this['ymax']?!![]:![];}['getRandomLatLng'](){const _0x25cee1=fRandomByfloat(this['xmin'],this[_0x1f1dfa(0x342,0x36b)]),_0x2a3caa=fRandomByfloat(this['ymin'],this['ymax']),_0x47c7a9={};_0x47c7a9['lat']=_0x2a3caa;function _0x1f1dfa(_0x85f5fd,_0x39a74e){return _0x48c643(_0x85f5fd-0x50d,_0x39a74e);}return _0x47c7a9['lng']=_0x25cee1,_0x47c7a9;}['getParticles'](){let _0x5f3262,_0x4890c7,_0x186e1c;function _0x58d1d1(_0x2fabc8,_0x871ebb){return _0x419219(_0x2fabc8,_0x871ebb-0x40);}for(let _0x3df1f3=0x0,_0x11615c=this[_0x48163e(0x2ef,0x268)][_0x58d1d1(-0x12e,-0x107)];_0x3df1f3<_0x11615c;_0x3df1f3++){let _0x586945=this[_0x58d1d1(0x6a,-0x18)][_0x3df1f3];_0x586945['age']<=0x0&&(_0x586945=this['_randomParticle'](_0x586945));if(_0x586945[_0x58d1d1(0x18,-0x68)]>0x0){const _0x5bc0ad=_0x586945['tlng'],_0x14ee32=_0x586945['tlat'];_0x186e1c=this['getUVByPoint'](_0x5bc0ad,_0x14ee32),_0x186e1c?(_0x5f3262=_0x5bc0ad+this[_0x48163e(0x228,0x1ed)][0x0]*_0x186e1c[0x0],_0x4890c7=_0x14ee32+this['_calc_speedRate'][0x1]*_0x186e1c[0x1],_0x586945[_0x58d1d1(-0xa1,-0x62)]=_0x5bc0ad,_0x586945[_0x58d1d1(-0x153,-0x127)]=_0x14ee32,_0x586945[_0x48163e(0x271,0x27b)]=_0x5f3262,_0x586945[_0x58d1d1(-0x7b,-0x59)]=_0x4890c7,_0x586945[_0x48163e(0x27c,0x2b1)]=_0x186e1c[0x2],_0x586945['age']--):_0x586945['age']=0x0;}}function _0x48163e(_0xd84fa,_0x5df5bf){return _0x48c643(_0xd84fa-0x43a,_0x5df5bf);}return this['particles'];}[_0x48c643(-0x252,-0x22d)](_0x36b0c8){let _0x52ef34,_0x249b80;for(let _0x4a88e0=0x0;_0x4a88e0<0x1e;_0x4a88e0++){_0x52ef34=this['getRandomLatLng'](),_0x249b80=this[_0x59f359(-0x147,-0x177)](_0x52ef34['lng'],_0x52ef34[_0x56ee69(0x2d,-0x5e)]);if(_0x249b80&&_0x249b80[0x2]>0x0)break;}if(!_0x249b80)return _0x36b0c8;const _0x57511f=_0x52ef34['lng']+this[_0x56ee69(-0xf,-0x16)][0x0]*_0x249b80[0x0],_0x554934=_0x52ef34['lat']+this['_calc_speedRate'][0x1]*_0x249b80[0x1];_0x36b0c8[_0x59f359(-0x146,-0x117)]=_0x52ef34['lng'];function _0x59f359(_0x1077bb,_0x1b142b){return _0x419219(_0x1b142b,_0x1077bb- -0xa4);}_0x36b0c8['lat']=_0x52ef34[_0x59f359(-0x20b,-0x276)],_0x36b0c8['tlng']=_0x57511f,_0x36b0c8['tlat']=_0x554934,_0x36b0c8['age']=Math['round'](0xa+Math[_0x59f359(-0x174,-0x1b4)]()*this['maxAge']),_0x36b0c8['speed']=_0x249b80[0x2];function _0x56ee69(_0x43f8fe,_0x17ffc4){return _0x48c643(_0x17ffc4-0x1fc,_0x43f8fe);}return _0x36b0c8;}['destroy'](){for(const _0x21d043 in this){delete this[_0x21d043];}}}function fRandomByfloat(_0x91c658,_0x2a1570){return _0x91c658+Math['random']()*(_0x2a1570-_0x91c658);}const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace['layer'][_0x48c643(-0x17a,-0x12f)];class CanvasWindLayer extends BaseLayer{constructor(_0x1dd100={}){function _0x319d90(_0x4686c3,_0x143e04){return _0x48c643(_0x143e04-0x425,_0x4686c3);}function _0x593d0f(_0x573702,_0xb2f7a){return _0x419219(_0x573702,_0xb2f7a- -0x50);}super(_0x1dd100),this['_setOptionsHook'](_0x1dd100),this[_0x319d90(0x29b,0x215)]=null,_0x1dd100['colors']&&_0x1dd100['steps']&&(this['_colorRamp']=new mars3d__namespace[(_0x593d0f(-0x111,-0x184))](_0x1dd100));}['_setOptionsHook'](_0x44b9ba,_0x418a6d){function _0x37ad40(_0x3572fc,_0x484796){return _0x48c643(_0x3572fc-0x46e,_0x484796);}this['frameTime']=0x3e8/(_0x44b9ba['frameRate']||0xa),this['_pointerEvents']=this['options']['pointerEvents']??![],this[_0x44238c(-0x26a,-0x1e4)]=_0x44b9ba[_0x37ad40(0x252,0x22c)]||'#ffffff',this[_0x44238c(-0x295,-0x2e5)]=_0x44b9ba['lineWidth']||0x1,this[_0x37ad40(0x25f,0x236)]=_0x44b9ba[_0x37ad40(0x25f,0x2ea)]??0x0,this[_0x44238c(-0x29b,-0x2d5)]=_0x44b9ba[_0x37ad40(0x221,0x1f2)]??![];function _0x44238c(_0x15951b,_0x720cc2){return _0x419219(_0x720cc2,_0x15951b- -0x141);}this['windField']&&this['windField'][_0x44238c(-0x220,-0x23f)](_0x44b9ba);}get[_0x48c643(-0x206,-0x23f)](){function _0x437097(_0x550d1e,_0x152370){return _0x48c643(_0x152370-0x172,_0x550d1e);}return this[_0x437097(-0x7b,-0x9e)];}get['canvasWidth'](){function _0x531525(_0x1e527b,_0x3a64cb){return _0x48c643(_0x1e527b-0x65b,_0x3a64cb);}function _0x4bd525(_0x5d4162,_0x513747){return _0x419219(_0x513747,_0x5d4162- -0xe);}return this[_0x4bd525(-0x6f,-0x35)][_0x531525(0x452,0x46c)]['canvas'][_0x531525(0x4ca,0x4e2)];}get['canvasHeight'](){function _0x21df2a(_0x2ac75c,_0x902561){return _0x419219(_0x902561,_0x2ac75c- -0xe0);}return this['_map']['scene']['canvas'][_0x21df2a(-0x1af,-0x1cd)];}get['pointerEvents'](){return this['_pointerEvents'];}set[_0x48c643(-0x214,-0x296)](_0x32f68f){function _0x1f7eb6(_0x41d549,_0x55eb19){return _0x48c643(_0x41d549-0x2f0,_0x55eb19);}function _0xd47181(_0x32f309,_0x2dcf75){return _0x419219(_0x2dcf75,_0x32f309-0x1ee);}this[_0xd47181(0xa6,0xcb)]=_0x32f68f;if(!this[_0xd47181(0xd1,0x11d)])return;_0x32f68f?this['canvas'][_0x1f7eb6(0x13b,0xe7)]['pointer-events']=_0xd47181(0x174,0x161):this['canvas']['style']['pointer-events']=_0x1f7eb6(0x145,0x18e);}get['particlesNumber'](){function _0x4bdd04(_0x7dc72,_0x3d46d0){return _0x419219(_0x3d46d0,_0x7dc72-0x29c);}return this['options'][_0x4bdd04(0x1b1,0x14f)];}set['particlesNumber'](_0x1e2dec){this[_0x195389(-0x80,-0x69)]['particlesNumber']=_0x1e2dec,clearTimeout(this['_canrefresh']);function _0x195389(_0x471bac,_0x29a6ea){return _0x419219(_0x29a6ea,_0x471bac-0x88);}this['_canrefresh']=setTimeout(()=>{function _0x22a7bc(_0x3afd2d,_0x304e7f){return _0x195389(_0x3afd2d- -0x7d,_0x304e7f);}this[_0x22a7bc(-0x66,-0x3d)]();},0x1f4);}get['speedRate'](){return this['options']['speedRate'];}set['speedRate'](_0x50931e){this['options']['speedRate']=_0x50931e,this['windField']&&(this['windField']['speedRate']=_0x50931e);}get['maxAge'](){return this['options']['maxAge'];}set[_0x48c643(-0x24b,-0x283)](_0x418cd9){function _0x377f11(_0x38e3c2,_0x502f80){return _0x48c643(_0x38e3c2-0xcc,_0x502f80);}function _0x4ace19(_0xe4ce86,_0x415fab){return _0x419219(_0xe4ce86,_0x415fab-0x46e);}this[_0x4ace19(0x3d9,0x366)]['maxAge']=_0x418cd9,this[_0x4ace19(0x331,0x325)]&&(this[_0x4ace19(0x38b,0x325)][_0x377f11(-0x17f,-0x116)]=_0x418cd9);}get[_0x419219(-0x6e,-0xc3)](){function _0x1dd7f0(_0x2fd6cc,_0x5e2332){return _0x48c643(_0x2fd6cc-0x56f,_0x5e2332);}return this[_0x1dd7f0(0x3d5,0x349)];}set['data'](_0x318d27){function _0x2a0e3d(_0x42beee,_0x2ceae7){return _0x419219(_0x42beee,_0x2ceae7- -0x10a);}this[_0x2a0e3d(-0x25b,-0x268)](_0x318d27);}get[_0x48c643(-0x218,-0x233)](){let _0x5d4633=this[_0x19bb79(0x30a,0x2ef)]['xmin'],_0x557527=this['windData']['xmax'],_0x1645ce=this['windData'][_0x3be418(0xf1,0x17b)],_0x1fd1b9=this[_0x3be418(0x1b3,0x1b0)][_0x3be418(0x124,0x186)];function _0x19bb79(_0x7bce2d,_0x5684e5){return _0x419219(_0x7bce2d,_0x5684e5-0x396);}_0x557527>=0x167&&_0x5d4633===0x0&&(_0x5d4633=-0xb4,_0x557527=0xb4);_0x5d4633=Math['max'](_0x5d4633,-0xb4);function _0x3be418(_0x20d8f6,_0x29f09b){return _0x419219(_0x29f09b,_0x20d8f6-0x25a);}return _0x557527=Math['min'](_0x557527,0xb4),_0x1645ce=Math[_0x19bb79(0x280,0x2b6)](_0x1645ce,-0x5a),_0x1fd1b9=Math[_0x3be418(0x1e2,0x177)](_0x1fd1b9,0x5a),Cesium['Rectangle'][_0x19bb79(0x363,0x2e6)](_0x5d4633,_0x1645ce,_0x557527,_0x1fd1b9);}['_showHook'](_0x137e22){function _0x240022(_0x2af68f,_0x124eab){return _0x419219(_0x2af68f,_0x124eab- -0x1c);}function _0x3d896b(_0x422ac4,_0x35d16c){return _0x48c643(_0x35d16c-0x1d5,_0x422ac4);}_0x137e22?this[_0x3d896b(-0x13,0x7a)]():(this['windData']&&(this['options'][_0x240022(-0xad,-0xdf)]=this['windData']),this[_0x3d896b(-0xc6,-0x74)]());}['_mountedHook'](){function _0x5384af(_0x1058d8,_0x4879d7){return _0x48c643(_0x1058d8-0x116,_0x4879d7);}function _0x26c4f1(_0x84be19,_0x3d7d8e){return _0x419219(_0x84be19,_0x3d7d8e-0x1f3);}this['options']['worker']?this[_0x5384af(-0x82,-0xe8)]():this[_0x26c4f1(0x24,0xaa)]=new CanvasWindField(this['options']);}['_addedHook'](){this[_0x3e8d1e(-0x170,-0x16b)]=this['_createCanvas']();function _0x4a578a(_0x35d974,_0x3be660){return _0x48c643(_0x35d974-0x6ff,_0x3be660);}function _0x3e8d1e(_0x4bac28,_0x1b5aa2){return _0x48c643(_0x4bac28-0xa0,_0x1b5aa2);}const _0x3bd1f8={};_0x3bd1f8['willReadFrequently']=!![],this['canvasContext']=this[_0x4a578a(0x4ef,0x4ac)]['getContext']('2d',_0x3bd1f8),this[_0x3e8d1e(-0x1b6,-0x1aa)](),this[_0x4a578a(0x504,0x50e)][_0x3e8d1e(-0x116,-0xa7)]&&this[_0x3e8d1e(-0x1b1,-0x181)](this['options'][_0x4a578a(0x549,0x562)]);}['_removedHook'](){function _0x20b4ef(_0x552fbc,_0x2485f7){return _0x419219(_0x2485f7,_0x552fbc-0x519);}this['clear'](),this['unbindEvent']();function _0x2fba32(_0x47c397,_0x2df088){return _0x419219(_0x47c397,_0x2df088- -0xc);}this['canvas']&&(this[_0x20b4ef(0x4b8,0x46f)][_0x2fba32(-0xc4,-0x9d)]['removeChild'](this[_0x2fba32(-0x169,-0x129)]),delete this['canvas']);}['_createCanvas'](){const _0x4862e0=mars3d__namespace[_0x1f41e4(0x57a,0x5a7)]['create']('canvas','mars3d-canvasWind',this['_map'][_0x304da5(0xbb,0x121)]);_0x4862e0[_0x1f41e4(0x59e,0x525)]['position']='absolute';function _0x304da5(_0x3c8a72,_0x258993){return _0x419219(_0x258993,_0x3c8a72-0x14c);}_0x4862e0['style']['top']='0px',_0x4862e0['style']['left']='0px',_0x4862e0['style']['width']=this['_map'][_0x1f41e4(0x54a,0x569)][_0x304da5(0x2f,0x5e)][_0x304da5(0xae,0x103)]+'px',_0x4862e0['style']['height']=this[_0x304da5(0xeb,0x117)]['scene'][_0x1f41e4(0x543,0x4df)]['clientHeight']+'px',_0x4862e0[_0x304da5(0x8a,0xde)]['pointerEvents']=this[_0x1f41e4(0x518,0x585)]?_0x1f41e4(0x51a,0x4cf):'none',_0x4862e0[_0x304da5(0x8a,0xfa)][_0x304da5(-0x23,-0x4)]=this['options'][_0x304da5(-0x23,-0x89)]??0x9,_0x4862e0['width']=this['_map']['scene']['canvas']['clientWidth'];function _0x1f41e4(_0x148c2a,_0x548ffc){return _0x48c643(_0x148c2a-0x753,_0x548ffc);}return _0x4862e0[_0x1f41e4(0x59f,0x5da)]=this[_0x304da5(0xeb,0x171)]['scene']['canvas'][_0x304da5(0x7d,-0x5)],_0x4862e0;}['resize'](){function _0x492a74(_0x28d61b,_0x1f400c){return _0x419219(_0x1f400c,_0x28d61b-0x218);}function _0x358cdf(_0x1f5471,_0x583ede){return _0x48c643(_0x1f5471-0x46f,_0x583ede);}this['canvas']&&(this[_0x358cdf(0x25f,0x1e2)][_0x492a74(0x156,0x11d)]['width']=this[_0x492a74(0x1b7,0x235)]['scene']['canvas'][_0x492a74(0x17a,0x1aa)]+'px',this[_0x358cdf(0x25f,0x263)]['style']['height']=this['_map'][_0x492a74(0x102,0x127)][_0x492a74(0xfb,0xf5)]['clientHeight']+'px',this['canvas']['width']=this['_map']['scene']['canvas']['clientWidth'],this[_0x358cdf(0x25f,0x2d7)]['height']=this['_map']['scene'][_0x358cdf(0x25f,0x22f)][_0x358cdf(0x2ad,0x334)]);}['bindEvent'](){const _0x2eeaeb=this;let _0x45cf82=Date[_0x41aac7(0x2f,-0x12)]();function _0x32819a(_0x2895b0,_0x5876ab){return _0x48c643(_0x2895b0-0x57a,_0x5876ab);}(function _0x567180(){function _0x1ca93d(_0x5a0b62,_0xb0e75b){return _0x41aac7(_0xb0e75b,_0x5a0b62-0x19b);}if(_0x2eeaeb['isDestroy'])return;_0x2eeaeb[_0xb0483d(0x83,0x54)]=window[_0x1ca93d(0x1de,0x22d)](_0x567180);function _0xb0483d(_0x42f9fd,_0x25d490){return _0x41aac7(_0x25d490,_0x42f9fd-0xf6);}if(_0x2eeaeb['show']&&_0x2eeaeb['windField']){const _0x596fd3=Date[_0xb0483d(0xe4,0x162)](),_0x1e2764=_0x596fd3-_0x45cf82;_0x1e2764>_0x2eeaeb['frameTime']&&(_0x45cf82=_0x596fd3-_0x1e2764%_0x2eeaeb['frameTime'],_0x2eeaeb['update']());}}(),window[_0x41aac7(0xab,0x6a)]('resize',this['resize'][_0x41aac7(-0x73,-0x3f)](this),![]),this[_0x32819a(0x38d,0x40f)]=![],this['mouse_move']=![]);function _0x41aac7(_0x5a88bb,_0x50b1e8){return _0x48c643(_0x50b1e8-0x1cb,_0x5a88bb);}this[_0x41aac7(0x50,-0x30)]['mouseHidden']&&(this['_map']['on'](mars3d__namespace['EventType']['wheel'],this['_onMapWhellEvent'],this),this[_0x41aac7(-0x7,0x77)]['on'](mars3d__namespace[_0x32819a(0x42c,0x489)][_0x32819a(0x3fa,0x478)],this[_0x32819a(0x34f,0x3d1)],this),this[_0x41aac7(0x22,0x77)]['on'](mars3d__namespace['EventType'][_0x41aac7(0x3e,-0x5)],this['_onMouseUpEvent'],this));}[_0x48c643(-0x177,-0xfa)](){window['cancelAnimationFrame'](this['_animateFrame']);function _0x40bec9(_0x1f4414,_0x323c9b){return _0x48c643(_0x1f4414-0x66,_0x323c9b);}function _0x22b739(_0x1c7e5a,_0xb76bf){return _0x419219(_0xb76bf,_0x1c7e5a-0x529);}delete this[_0x40bec9(-0x1d8,-0x228)],window[_0x22b739(0x3f0,0x3f0)](_0x22b739(0x3ea,0x3d2),this['resize']),this['options']['mouseHidden']&&(this[_0x40bec9(-0xee,-0x91)]['off'](mars3d__namespace[_0x22b739(0x4ce,0x4b9)]['wheel'],this['_onMapWhellEvent'],this),this['_map'][_0x40bec9(-0x1ea,-0x235)](mars3d__namespace['EventType']['mouseDown'],this['_onMouseDownEvent'],this),this['_map'][_0x22b739(0x3cc,0x3a0)](mars3d__namespace['EventType']['mouseUp'],this[_0x40bec9(-0x160,-0x11a)],this),this['_map']['off'](mars3d__namespace['EventType']['mouseMove'],this[_0x22b739(0x41f,0x443)],this));}[_0x48c643(-0x1a2,-0x12e)](_0x95a9ff){clearTimeout(this['refreshTimer']);if(!this['show']||!this['canvas'])return;this['canvas']['style']['visibility']=_0x1ea81f(0x1d8,0x210);function _0x1ea81f(_0x125574,_0x3cc681){return _0x48c643(_0x3cc681-0x46e,_0x125574);}this['refreshTimer']=setTimeout(()=>{if(!this['show'])return;this[_0x25cdb1(0x94,0x16)]();function _0x25cdb1(_0x5e8a10,_0x2581fe){return _0x1ea81f(_0x2581fe,_0x5e8a10- -0x276);}function _0x3bccf9(_0x32314c,_0x375992){return _0x1ea81f(_0x32314c,_0x375992- -0x20f);}this['canvas']['style'][_0x25cdb1(0x5a,0x31)]='visible';},0xc8);}['_onMouseDownEvent'](_0x3f3fc0){function _0x53ac43(_0x2f3be9,_0x48bf01){return _0x419219(_0x48bf01,_0x2f3be9-0x2ae);}function _0x1a5e89(_0x490882,_0x1e084e){return _0x48c643(_0x1e084e-0xe9,_0x490882);}this['mouse_down']=!![],this['_map']['off'](mars3d__namespace[_0x1a5e89(-0xe8,-0x65)]['mouseMove'],this['_onMouseMoveEvent'],this),this['_map']['on'](mars3d__namespace['EventType']['mouseMove'],this[_0x53ac43(0x1a4,0x190)],this);}[_0x419219(-0xce,-0x10a)](_0x3a9434){if(!this[_0x14023f(0x1b7,0x15a)]||!this['canvas'])return;function _0x28013d(_0x58b29,_0x485f13){return _0x419219(_0x485f13,_0x58b29- -0x11f);}function _0x14023f(_0x28b3de,_0x61f55){return _0x48c643(_0x28b3de-0x3f6,_0x61f55);}this['mouse_down']&&(this[_0x14023f(0x1e6,0x1d0)]['style'][_0x14023f(0x258,0x242)]='hidden',this[_0x28013d(-0x194,-0x182)]=!![]);}['_onMouseUpEvent'](_0x4b7a02){if(!this['show']||!this['canvas'])return;this['_map'][_0xb45341(-0x35,-0x96)](mars3d__namespace['EventType']['mouseMove'],this[_0x2e2f65(0x496,0x50d)],this);function _0xb45341(_0x394a9f,_0x523b34){return _0x48c643(_0x523b34-0x1ba,_0x394a9f);}this[_0x2e2f65(0x4a6,0x4f2)]&&this[_0x2e2f65(0x52b,0x4b3)]&&this['redraw']();function _0x2e2f65(_0x1b4349,_0x8424e7){return _0x419219(_0x8424e7,_0x1b4349-0x5a0);}this['canvas'][_0x2e2f65(0x4de,0x517)]['visibility']='visible',this['mouse_down']=![],this[_0x2e2f65(0x52b,0x4ab)]=![];}['setData'](_0x1ef015){this['clear'](),this['windData']=_0x1ef015;function _0x1f9463(_0x405d40,_0x1a788b){return _0x419219(_0x1a788b,_0x405d40-0x2d1);}function _0x52dbf8(_0x440e4c,_0x122469){return _0x48c643(_0x440e4c-0x652,_0x122469);}this[_0x1f9463(0x188,0x1a5)]['setDate'](_0x1ef015),this[_0x52dbf8(0x4ee,0x57b)]();}['redraw'](){if(!this['show'])return;function _0x28af05(_0x182163,_0x1bfe79){return _0x48c643(_0x182163-0x4b6,_0x1bfe79);}function _0x49b71b(_0x36b4fa,_0x4f1e37){return _0x48c643(_0x36b4fa-0x6b8,_0x4f1e37);}this['windField'][_0x49b71b(0x4e6,0x4ed)](this[_0x49b71b(0x4bd,0x437)]),this['update']();}[_0x48c643(-0x25b,-0x247)](){if(this[_0x2e9593(0x414,0x44c)])return;this[_0x31f1b6(-0x1ce,-0x228)]=!![];if(this['worker'])this[_0x31f1b6(-0x21a,-0x228)][_0x31f1b6(-0x239,-0x251)]();else{const _0x537d56=this['windField'][_0x31f1b6(-0x186,-0x118)]();this[_0x31f1b6(-0x198,-0x128)](_0x537d56);}function _0x2e9593(_0x4d61e8,_0x234418){return _0x48c643(_0x4d61e8-0x604,_0x234418);}function _0x31f1b6(_0x193650,_0x1fb239){return _0x419219(_0x1fb239,_0x193650- -0xd1);}this[_0x31f1b6(-0x1ce,-0x24f)]=![];}['_drawLines'](_0x318f20){this[_0x5e70b6(-0x56,-0x87)]=_0x318f20,this[_0x5e70b6(-0x21,-0x1c)][_0x5e8a4a(0x31b,0x2d2)]=_0x5e8a4a(0x330,0x2bc);function _0x5e70b6(_0x2ea424,_0x482503){return _0x419219(_0x2ea424,_0x482503-0x78);}this[_0x5e70b6(0x54,-0x1c)][_0x5e70b6(-0x4a,-0x52)](0x0,0x0,this['canvasWidth'],this[_0x5e8a4a(0x338,0x30a)]);function _0x5e8a4a(_0x54691b,_0x242c9d){return _0x419219(_0x242c9d,_0x54691b-0x3b6);}this['canvasContext']['globalCompositeOperation']='lighter',this['canvasContext'][_0x5e8a4a(0x351,0x365)]=0.9;const _0x51f8fb=this['_map'][_0x5e70b6(-0xa8,-0x9e)]['mode']!==Cesium['SceneMode'][_0x5e8a4a(0x252,0x288)],_0x14b712=this['canvasWidth']*0.25;if(this[_0x5e8a4a(0x32d,0x39c)])for(let _0x46e967=0x0,_0x41f9c5=_0x318f20[_0x5e8a4a(0x26f,0x2db)];_0x46e967<_0x41f9c5;_0x46e967++){const _0x2220e5=_0x318f20[_0x46e967],_0x27c27=this[_0x5e8a4a(0x288,0x282)](_0x2220e5,_0x2220e5[_0x5e70b6(-0x4,-0x2a)],_0x2220e5['lat'],_0x2220e5['alt']),_0x29b4f1=this[_0x5e70b6(-0x136,-0xb6)](_0x2220e5,_0x2220e5[_0x5e70b6(0x1c,-0x5e)],_0x2220e5['tlat'],_0x2220e5[_0x5e8a4a(0x2fb,0x294)]);if(!_0x27c27||!_0x29b4f1)continue;if(_0x51f8fb&&Math[_0x5e8a4a(0x250,0x25b)](_0x27c27[0x0]-_0x29b4f1[0x0])>=_0x14b712)continue;this['canvasContext']['beginPath'](),this['canvasContext']['lineWidth']=this['lineWidth'],this['canvasContext']['strokeStyle']=this['_colorRamp']['getColor'](_0x2220e5[_0x5e70b6(-0xa6,-0x53)]),this[_0x5e8a4a(0x322,0x2e3)]['moveTo'](_0x27c27[0x0],_0x27c27[0x1]),this[_0x5e8a4a(0x322,0x2c3)][_0x5e70b6(0x28,-0x4c)](_0x29b4f1[0x0],_0x29b4f1[0x1]),this['canvasContext']['stroke']();}else{this['canvasContext']['beginPath'](),this[_0x5e8a4a(0x322,0x304)]['lineWidth']=this['lineWidth'],this[_0x5e70b6(-0x33,-0x1c)][_0x5e70b6(-0x2c,-0x56)]=this['color'];for(let _0x540899=0x0,_0x439700=_0x318f20['length'];_0x540899<_0x439700;_0x540899++){const _0x39e0b9=_0x318f20[_0x540899],_0x4f3337=this['_tomap'](_0x39e0b9,_0x39e0b9['lng'],_0x39e0b9['lat'],_0x39e0b9[_0x5e70b6(0x15,-0x8)]),_0x2f543e=this['_tomap'](_0x39e0b9,_0x39e0b9['tlng'],_0x39e0b9['tlat'],_0x39e0b9['talt']);if(!_0x4f3337||!_0x2f543e)continue;if(_0x51f8fb&&Math['abs'](_0x4f3337[0x0]-_0x2f543e[0x0])>=_0x14b712)continue;this[_0x5e70b6(-0x32,-0x1c)][_0x5e70b6(-0x68,0x2)](_0x4f3337[0x0],_0x4f3337[0x1]),this[_0x5e70b6(-0x6f,-0x1c)][_0x5e8a4a(0x2f2,0x2e7)](_0x2f543e[0x0],_0x2f543e[0x1]);}this[_0x5e8a4a(0x322,0x303)]['stroke']();}}['_tomap'](_0x3ed5b0,_0x3316ac,_0x443058,_0x5d7d6a){const _0x3a5041=Cesium[_0x323768(0x445,0x47e)]['fromDegrees'](_0x3316ac,_0x443058,_0x5d7d6a??this[_0x323768(0x499,0x468)]),_0x2dc303=this['_map']['scene'];if(_0x2dc303['mode']===Cesium['SceneMode']['SCENE3D']){const _0x5125bb=new Cesium['EllipsoidalOccluder'](_0x2dc303['globe']['ellipsoid'],_0x2dc303['camera']['positionWC']),_0x3a7bd2=_0x5125bb['isPointVisible'](_0x3a5041);if(!_0x3a7bd2)return _0x3ed5b0['age']=0x0,null;}const _0x344e46=mars3d__namespace[_0xe13844(0x19c,0x150)]['toWindowCoordinates'](this['_map'][_0xe13844(0x17b,0x1cd)],_0x3a5041);function _0xe13844(_0x3a046d,_0x1f4fd6){return _0x419219(_0x1f4fd6,_0x3a046d-0x291);}function _0x323768(_0x269d08,_0x34c2ea){return _0x48c643(_0x34c2ea-0x677,_0x269d08);}return _0x344e46?[_0x344e46['x'],_0x344e46['y']]:null;}['clear'](){this[_0x2437b2(0x51c,0x4f1)][_0x335e01(0x47d,0x4a9)]();function _0x335e01(_0x29fab3,_0x36355d){return _0x419219(_0x36355d,_0x29fab3-0x554);}function _0x2437b2(_0x17d392,_0x3880be){return _0x48c643(_0x17d392-0x758,_0x3880be);}delete this['windData'];}['initWorker'](){function _0x31f596(_0x530ca2,_0x4dc7a2){return _0x419219(_0x530ca2,_0x4dc7a2-0x1aa);}this[_0x31f596(0x45,0xa9)]=new Worker(this[_0x42e45d(0x3c9,0x385)]['worker']);function _0x42e45d(_0x33f7f8,_0x14fecf){return _0x48c643(_0x33f7f8-0x5c4,_0x14fecf);}this['worker'][_0x42e45d(0x3d5,0x44d)]=_0x356791=>{function _0x4f43f9(_0x2cdfef,_0x376809){return _0x42e45d(_0x2cdfef- -0x379,_0x376809);}this['_drawLines'](_0x356791[_0x4f43f9(0x95,0x1d)]['particles']);function _0x9c83e(_0x2f8f1c,_0x38c17f){return _0x42e45d(_0x38c17f- -0x69,_0x2f8f1c);}this[_0x9c83e(0x347,0x3a9)]=![];},this['windField']={'init':_0x2ebd53=>{const _0x34717b={};_0x34717b['type']='init',_0x34717b['options']=_0x2ebd53,this['worker']['postMessage'](_0x34717b);},'setOptions':_0x5d9c69=>{const _0x41382e={};_0x41382e['type']='setOptions',_0x41382e['options']=_0x5d9c69,this['worker']['postMessage'](_0x41382e);},'setDate':_0x3723db=>{const _0x1d270d={};_0x1d270d['type']='setDate',_0x1d270d['data']=_0x3723db,this['worker']['postMessage'](_0x1d270d);},'update':()=>{if(this[_0xe1b149(0x202,0x1fb)])return;function _0xe1b149(_0x160bdd,_0xbb3cff){return _0x31f596(_0x160bdd,_0xbb3cff-0x110);}function _0x276fb7(_0x220cad,_0x208674){return _0x42e45d(_0x208674- -0x50e,_0x220cad);}this['_updateIng2']=!![];const _0x4d538d={};_0x4d538d['type']=_0x276fb7(-0x1ca,-0x1a5),this[_0xe1b149(0x1b9,0x1b9)]['postMessage'](_0x4d538d);},'clear':()=>{const _0x24c15c={};_0x24c15c[_0x88f0ec(0xd5,0x100)]='clear';function _0x88f0ec(_0x27534c,_0x54b6f4){return _0x31f596(_0x54b6f4,_0x27534c- -0x2f);}this['worker']['postMessage'](_0x24c15c);}},this['windField'][_0x42e45d(0x387,0x36e)](this['options']);}}mars3d__namespace[_0x419219(-0xc5,-0x8a)]['register']('canvasWind',CanvasWindLayer),mars3d__namespace[_0x419219(-0x8c,-0x113)]['CanvasWindLayer']=CanvasWindLayer,mars3d__namespace[_0x48c643(-0x234,-0x24e)]=CanvasWindField,mars3d__namespace[_0x48c643(-0x1ec,-0x1a9)]=WindUtil,exports['CanvasWindField']=CanvasWindField,exports['CanvasWindLayer']=CanvasWindLayer,exports['WindLayer']=WindLayer,exports[_0x419219(-0xf1,-0xf9)]=WindUtil;const _0x49809f={};_0x49809f['value']=!![],Object[_0x419219(-0xdc,-0xe2)](exports,_0x419219(-0x192,-0x160),_0x49809f);
}));
