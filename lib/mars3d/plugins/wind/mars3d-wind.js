/**
 * Mars3D平台插件,支持气象 风向图 功能插件  mars3d-wind
 *
 * 版本信息：v3.7.18
 * 编译日期：2024-06-17 11:56:34
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2024-01-15
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-wind"] = {}, global.mars3d));
})(this, (function (exports, mars3d) { 
'use strict';(function(_0x59f894,_0x45d261){const _0x35e90c=_0x59f894();function _0x5db877(_0xf4e5d9,_0x20738b){return _0x51a7(_0x20738b- -0x3cb,_0xf4e5d9);}function _0x24c794(_0x230de9,_0x3f6371){return _0x51a7(_0x230de9-0x2d8,_0x3f6371);}while(!![]){try{const _0x16ee20=parseInt(_0x24c794(0x59a,0x530))/0x1+-parseInt(_0x24c794(0x597,0x5da))/0x2+parseInt(_0x5db877(-0xc8,-0x148))/0x3+parseInt(_0x24c794(0x53b,0x5be))/0x4*(parseInt(_0x5db877(-0x137,-0x102))/0x5)+parseInt(_0x5db877(-0xdc,-0x140))/0x6+parseInt(_0x24c794(0x4e6,0x475))/0x7+parseInt(_0x5db877(-0x265,-0x1e6))/0x8*(-parseInt(_0x24c794(0x4a2,0x4b3))/0x9);if(_0x16ee20===_0x45d261)break;else _0x35e90c['push'](_0x35e90c['shift']());}catch(_0x2b4d65){_0x35e90c['push'](_0x35e90c['shift']());}}}(_0x295d,0x45449));function _0x47128b(_0x7a8722,_0x2669bf){return _0x51a7(_0x2669bf- -0x1e3,_0x7a8722);}function _interopNamespace(_0x4339a7){if(_0x4339a7&&_0x4339a7['__esModule'])return _0x4339a7;var _0x39e896=Object[_0x5c9faa(0x2d6,0x2e8)](null);function _0x5c9faa(_0x264219,_0x168b35){return _0x51a7(_0x168b35-0xf6,_0x264219);}return _0x4339a7&&Object['keys'](_0x4339a7)['forEach'](function(_0x2d1d5c){function _0x353cf6(_0x403595,_0x4335fb){return _0x5c9faa(_0x403595,_0x4335fb- -0x395);}function _0x4b8d01(_0x1d9597,_0x446c47){return _0x5c9faa(_0x1d9597,_0x446c47- -0x412);}if(_0x2d1d5c!==_0x353cf6(-0x57,-0x9a)){var _0xd4b542=Object['getOwnPropertyDescriptor'](_0x4339a7,_0x2d1d5c);Object['defineProperty'](_0x39e896,_0x2d1d5c,_0xd4b542[_0x4b8d01(-0x196,-0x148)]?_0xd4b542:{'enumerable':!![],'get':function(){return _0x4339a7[_0x2d1d5c];}});}}),_0x39e896['default']=_0x4339a7,_0x39e896;}var mars3d__namespace=_interopNamespace(mars3d);const Cesium$7=mars3d__namespace[_0x58f7a9(0x13b,0x117)];function getU(_0x58c3fe,_0x3e5222){const _0x579027=_0x58c3fe*Math['cos'](Cesium$7['Math']['toRadians'](_0x3e5222));return _0x579027;}function getV(_0x14372c,_0x3487a6){function _0x51146c(_0x250465,_0x3f3b34){return _0x58f7a9(_0x250465,_0x3f3b34-0x1dd);}const _0x4273aa=_0x14372c*Math[_0x51146c(0x2da,0x2ca)](Cesium$7['Math']['toRadians'](_0x3487a6));return _0x4273aa;}function getSpeed(_0x3ee00b,_0xcb74ac){const _0x1e470b=Math['sqrt'](Math[_0x3def7d(0x56f,0x5c9)](_0x3ee00b,0x2)+Math['pow'](_0xcb74ac,0x2));function _0x3def7d(_0x5a527d,_0x362aed){return _0x58f7a9(_0x5a527d,_0x362aed-0x46d);}return _0x1e470b;}function getDirection(_0x480221,_0x3083c7){let _0x3ebdf2=Cesium$7['Math']['toDegrees'](Math['atan2'](_0x3083c7,_0x480221));return _0x3ebdf2+=_0x3ebdf2<0x0?0x168:0x0,_0x3ebdf2;}const _0x3bfb95={};_0x3bfb95[_0x58f7a9(0xd8,0x100)]=null,_0x3bfb95['getU']=getU,_0x3bfb95['getV']=getV,_0x3bfb95['getSpeed']=getSpeed,_0x3bfb95[_0x58f7a9(0xbe,0x51)]=getDirection;var WindUtil=_0x3bfb95;const Cesium$6=mars3d__namespace[_0x58f7a9(0x17f,0x117)];class CustomPrimitive{constructor(_0x18e4c0){function _0x1f6ff1(_0x5b69d1,_0x5e6040){return _0x58f7a9(_0x5e6040,_0x5b69d1- -0x133);}this['commandType']=_0x18e4c0['commandType'],this['geometry']=_0x18e4c0[_0x1f6ff1(-0x8a,-0x48)],this[_0x7bdaaa(0x515,0x511)]=_0x18e4c0[_0x1f6ff1(-0xc0,-0xf2)],this[_0x1f6ff1(-0x40,-0x6e)]=_0x18e4c0[_0x7bdaaa(0x595,0x607)],this['uniformMap']=_0x18e4c0[_0x7bdaaa(0x52e,0x5b7)],this['vertexShaderSource']=_0x18e4c0['vertexShaderSource'],this['fragmentShaderSource']=_0x18e4c0[_0x1f6ff1(-0x6b,-0x6e)],this['rawRenderState']=_0x18e4c0['rawRenderState'],this['framebuffer']=_0x18e4c0['framebuffer'],this['outputTexture']=_0x18e4c0['outputTexture'],this['autoClear']=_0x18e4c0[_0x7bdaaa(0x5d3,0x5b5)]??![],this[_0x7bdaaa(0x524,0x52b)]=_0x18e4c0['preExecute'],this['show']=!![];function _0x7bdaaa(_0x58e226,_0x4f12d3){return _0x47128b(_0x4f12d3,_0x58e226-0x516);}this[_0x7bdaaa(0x5bc,0x5c1)]=undefined,this[_0x7bdaaa(0x5cb,0x613)]=undefined,this[_0x7bdaaa(0x5d3,0x5ed)]&&(this['clearCommand']=new Cesium$6['ClearCommand']({'color':new Cesium$6['Color'](0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':this['framebuffer'],'pass':Cesium$6['Pass']['OPAQUE']}));}['createCommand'](_0x4c1728){function _0xc070b(_0x10dd49,_0x31711e){return _0x47128b(_0x31711e,_0x10dd49-0x200);}function _0x58e715(_0x357335,_0x454c78){return _0x58f7a9(_0x454c78,_0x357335-0x1a2);}switch(this['commandType']){case'Draw':{const _0x29fa1d=Cesium$6['VertexArray'][_0xc070b(0x1fe,0x253)]({'context':_0x4c1728,'geometry':this['geometry'],'attributeLocations':this[_0x58e715(0x215,0x21e)],'bufferUsage':Cesium$6['BufferUsage'][_0xc070b(0x2cd,0x311)]}),_0x3845ea={};_0x3845ea[_0x58e715(0x232,0x27c)]=_0x4c1728,_0x3845ea[_0x58e715(0x215,0x1ab)]=this['attributeLocations'],_0x3845ea['vertexShaderSource']=this['vertexShaderSource'],_0x3845ea['fragmentShaderSource']=this['fragmentShaderSource'];const _0x9ce2aa=Cesium$6['ShaderProgram']['fromCache'](_0x3845ea),_0x3295b5=Cesium$6[_0xc070b(0x297,0x231)]['fromCache'](this[_0xc070b(0x1f2,0x25c)]);return new Cesium$6[(_0x58e715(0x1f9,0x19c))]({'primitiveType':this['primitiveType'],'shaderProgram':_0x9ce2aa,'vertexArray':_0x29fa1d,'modelMatrix':Cesium$6[_0xc070b(0x211,0x207)][_0xc070b(0x2db,0x2a8)],'renderState':_0x3295b5,'uniformMap':this['uniformMap'],'castShadows':![],'receiveShadows':![],'framebuffer':this['framebuffer'],'pass':Cesium$6[_0x58e715(0x27a,0x223)]['OPAQUE'],'pickOnly':!![],'owner':this});}case'Compute':{const _0x20dcab={};return _0x20dcab[_0xc070b(0x221,0x22c)]=this,_0x20dcab['fragmentShaderSource']=this['fragmentShaderSource'],_0x20dcab['uniformMap']=this['uniformMap'],_0x20dcab[_0x58e715(0x229,0x255)]=this['outputTexture'],_0x20dcab[_0xc070b(0x24b,0x217)]=!![],new Cesium$6['ComputeCommand'](_0x20dcab);}}}[_0x58f7a9(0x99,0x8b)](_0x4cec7e,_0x181e75){this[_0x49e925(0x2eb,0x2ce)]=_0x181e75;const _0x1f0308=Cesium$6['VertexArray'][_0x49e925(0x2b4,0x2d2)]({'context':_0x4cec7e,'geometry':this['geometry'],'attributeLocations':this['attributeLocations'],'bufferUsage':Cesium$6['BufferUsage']['STATIC_DRAW']});function _0x551a11(_0x17e438,_0xa28d73){return _0x58f7a9(_0xa28d73,_0x17e438-0x50a);}function _0x49e925(_0x5ebead,_0x1070fb){return _0x58f7a9(_0x1070fb,_0x5ebead-0x242);}this[_0x551a11(0x624,0x5a2)]['vertexArray']=_0x1f0308;}['update'](_0x2e4077){if(!this['show'])return;if(_0x2e4077[_0x2a1308(0xc8,0xd5)]!==Cesium$6[_0x2a1308(0x119,0x11c)][_0x2a1308(0x146,0xf0)])return;function _0x2a1308(_0x219e9d,_0x4bce38){return _0x58f7a9(_0x219e9d,_0x4bce38- -0x4b);}!Cesium$6['defined'](this[_0x554f60(0x22a,0x1a4)])&&(this[_0x554f60(0x197,0x1a4)]=this['createCommand'](_0x2e4077[_0x554f60(0xde,0x11a)]));Cesium$6[_0x554f60(0x19a,0x172)](this['preExecute'])&&this[_0x2a1308(0xac,0x37)]();function _0x554f60(_0x4bfdc1,_0x23e1d3){return _0x58f7a9(_0x4bfdc1,_0x23e1d3-0x8a);}Cesium$6['defined'](this[_0x554f60(0x210,0x1b3)])&&_0x2e4077['commandList'][_0x2a1308(0x9c,0x18)](this['clearCommand']),_0x2e4077['commandList']['push'](this['commandToExecute']);}['isDestroyed'](){return![];}['destroy'](){if(this[_0x3f9d02(0x58d,0x5f4)]){var _0x3d8eb2,_0x578951;(_0x3d8eb2=this[_0xf8c8db(0x99,0xfd)])!==null&&_0x3d8eb2!==void 0x0&&_0x3d8eb2['vertexArray']&&this['clearCommand']['vertexArray'][_0x3f9d02(0x606,0x5c8)](),(_0x578951=this[_0x3f9d02(0x58b,0x5f4)])!==null&&_0x578951!==void 0x0&&_0x578951['shaderProgram']&&this['clearCommand']['shaderProgram'][_0xf8c8db(0x6d,-0x20)](),delete this[_0xf8c8db(0x99,0x10e)];}this[_0x3f9d02(0x5a1,0x5e5)]&&(this[_0xf8c8db(0x8a,0x107)]['vertexArray']&&this['commandToExecute']['vertexArray'][_0xf8c8db(0x6d,0x42)](),this['commandToExecute'][_0x3f9d02(0x5bd,0x572)]&&this['commandToExecute']['shaderProgram'][_0x3f9d02(0x592,0x5c8)](),delete this[_0x3f9d02(0x55d,0x5e5)]);function _0xf8c8db(_0x327b92,_0x30ae97){return _0x47128b(_0x30ae97,_0x327b92- -0x1c);}function _0x3f9d02(_0x3e1e41,_0x174007){return _0x47128b(_0x3e1e41,_0x174007-0x53f);}return Cesium$6[_0x3f9d02(0x680,0x5fb)](this);}}const Cesium$5=mars3d__namespace[_0x47128b(0x38,0xa3)],Util=(function(){const _0x33b3fd=function(){function _0x57a520(_0x386671,_0x34eef9){return _0x51a7(_0x34eef9- -0xe,_0x386671);}function _0xc37456(_0x604fc3,_0x2547e7){return _0x51a7(_0x2547e7- -0x3cb,_0x604fc3);}const _0x46d624=new Cesium$5['Geometry']({'attributes':new Cesium$5[(_0xc37456(-0x1a8,-0x1a7))]({'position':new Cesium$5[(_0xc37456(-0x172,-0x149))]({'componentDatatype':Cesium$5[_0xc37456(-0x14b,-0x171)]['FLOAT'],'componentsPerAttribute':0x3,'values':new Float32Array([-0x1,-0x1,0x0,0x1,-0x1,0x0,0x1,0x1,0x0,-0x1,0x1,0x0])}),'st':new Cesium$5[(_0x57a520(0x208,0x274))]({'componentDatatype':Cesium$5['ComponentDatatype']['FLOAT'],'componentsPerAttribute':0x2,'values':new Float32Array([0x0,0x0,0x1,0x0,0x1,0x1,0x0,0x1])})}),'indices':new Uint32Array([0x3,0x2,0x0,0x0,0x2,0x1])});return _0x46d624;},_0x58a69b=function(_0x11803f,_0x40880f){if(Cesium$5['defined'](_0x40880f)){const _0x5e5d12={};_0x5e5d12['arrayBufferView']=_0x40880f,_0x11803f['source']=_0x5e5d12;}const _0x3c4d6f=new Cesium$5['Texture'](_0x11803f);return _0x3c4d6f;},_0x2fcb6b=function(_0x509415,_0x5cecc6,_0x684db5){const _0x2fa4da={};_0x2fa4da['context']=_0x509415,_0x2fa4da['colorTextures']=[_0x5cecc6],_0x2fa4da['depthTexture']=_0x684db5;const _0x4cc240=new Cesium$5['Framebuffer'](_0x2fa4da);return _0x4cc240;},_0x491323=function(_0x29223e){const _0x41c336=!![],_0x4b6ffb=![],_0x29ae8d={};function _0x3d9126(_0x363fe2,_0x59dc68){return _0x51a7(_0x59dc68-0x354,_0x363fe2);}_0x29ae8d['viewport']=_0x29223e['viewport'],_0x29ae8d['depthTest']=_0x29223e[_0x3d9126(0x5ca,0x5d0)],_0x29ae8d['depthMask']=_0x29223e['depthMask'],_0x29ae8d['blending']=_0x29223e['blending'];const _0x16fedc=_0x29ae8d,_0x352e17=Cesium$5['Appearance']['getDefaultRenderState'](_0x41c336,_0x4b6ffb,_0x16fedc);return _0x352e17;},_0x2debc0=function(_0x5ed6f0){const _0x22ceeb={},_0xec2606=Cesium$5['Math'][_0x4e8673(0x5b9,0x599)](_0x5ed6f0[_0x4e8673(0x5b1,0x5f1)],Cesium$5[_0x4e8673(0x5a2,0x596)]['TWO_PI']),_0x1c5bae=Cesium$5[_0x4e8673(0x5a2,0x622)]['mod'](_0x5ed6f0['east'],Cesium$5['Math']['TWO_PI']),_0x4c00e0=_0x5ed6f0['width'];let _0xf097fd,_0x145caf;_0x4c00e0>Cesium$5['Math'][_0x4e8673(0x59c,0x5fd)]?(_0xf097fd=0x0,_0x145caf=Cesium$5[_0x5d5d32(0x5e5,0x59a)]['TWO_PI']):_0x1c5bae-_0xec2606<_0x4c00e0?(_0xf097fd=_0xec2606,_0x145caf=_0xec2606+_0x4c00e0):(_0xf097fd=_0xec2606,_0x145caf=_0x1c5bae);_0x22ceeb['lon']={'min':Cesium$5['Math']['toDegrees'](_0xf097fd),'max':Cesium$5['Math']['toDegrees'](_0x145caf)};const _0x35d624=_0x5ed6f0['south'],_0x451997=_0x5ed6f0[_0x5d5d32(0x5f7,0x5b0)],_0x1c2e7a=_0x5ed6f0[_0x4e8673(0x56b,0x582)];function _0x5d5d32(_0x343b02,_0x220ac0){return _0x51a7(_0x220ac0-0x339,_0x343b02);}const _0x15cf99=_0x1c2e7a>Cesium$5['Math']['PI']/0xc?_0x1c2e7a/0x2:0x0;function _0x4e8673(_0x4ec13a,_0x423a62){return _0x51a7(_0x4ec13a-0x341,_0x423a62);}let _0x4bac4b=Cesium$5['Math']['clampToLatitudeRange'](_0x35d624-_0x15cf99),_0x5cc11a=Cesium$5[_0x4e8673(0x5a2,0x53f)][_0x5d5d32(0x51d,0x54d)](_0x451997+_0x15cf99);return _0x4bac4b<-Cesium$5[_0x5d5d32(0x548,0x59a)][_0x5d5d32(0x5d8,0x5d2)]&&(_0x4bac4b=-Cesium$5['Math']['PI_OVER_TWO']),_0x5cc11a>Cesium$5['Math'][_0x4e8673(0x5da,0x60e)]&&(_0x5cc11a=Cesium$5[_0x5d5d32(0x524,0x59a)]['PI_OVER_TWO']),_0x22ceeb[_0x5d5d32(0x5cf,0x56d)]={'min':Cesium$5['Math']['toDegrees'](_0x4bac4b),'max':Cesium$5[_0x5d5d32(0x5ef,0x59a)][_0x5d5d32(0x5f9,0x574)](_0x5cc11a)},_0x22ceeb;},_0x417ce4={};_0x417ce4[_0x5353a4(0x1e0,0x1a3)]=_0x33b3fd;function _0x5353a4(_0x3adc93,_0x1b021d){return _0x47128b(_0x1b021d,_0x3adc93-0x1b1);}return _0x417ce4['createTexture']=_0x58a69b,_0x417ce4['createFramebuffer']=_0x2fcb6b,_0x417ce4['createRawRenderState']=_0x491323,_0x417ce4['viewRectangleToLonLatRange']=_0x2debc0,_0x417ce4;}());var segmentDraw_vert='in\x20vec2\x20st;\x0a//\x20it\x20is\x20not\x20normal\x20itself,\x20but\x20used\x20to\x20control\x20normal\x0ain\x20vec3\x20normal;\x20//\x20(point\x20to\x20use,\x20offset\x20sign,\x20not\x20used\x20component)\x0a\x0auniform\x20sampler2D\x20currentParticlesPosition;\x0auniform\x20sampler2D\x20postProcessingPosition;\x0auniform\x20sampler2D\x20postProcessingSpeed;\x0a\x0auniform\x20float\x20particleHeight;\x0a\x0auniform\x20float\x20aspect;\x0auniform\x20float\x20pixelSize;\x0auniform\x20float\x20lineWidth;\x0a\x0aout\x20float\x20speedNormalization;\x0a\x0avec3\x20convertCoordinate(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20WGS84\x20(lon,\x20lat,\x20lev)\x20->\x20ECEF\x20(x,\x20y,\x20z)\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Geographic_coordinate_conversion#From_geodetic_to_ECEF_coordinates\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20WGS\x2084\x20geometric\x20constants\x0a\x20\x20\x20\x20float\x20a\x20=\x206378137.0;\x20//\x20Semi-major\x20axis\x0a\x20\x20\x20\x20float\x20b\x20=\x206356752.3142;\x20//\x20Semi-minor\x20axis\x0a\x20\x20\x20\x20float\x20e2\x20=\x206.69437999014e-3;\x20//\x20First\x20eccentricity\x20squared\x0a\x0a\x20\x20\x20\x20float\x20latitude\x20=\x20radians(lonLatLev.y);\x0a\x20\x20\x20\x20float\x20longitude\x20=\x20radians(lonLatLev.x);\x0a\x0a\x20\x20\x20\x20float\x20cosLat\x20=\x20cos(latitude);\x0a\x20\x20\x20\x20float\x20sinLat\x20=\x20sin(latitude);\x0a\x20\x20\x20\x20float\x20cosLon\x20=\x20cos(longitude);\x0a\x20\x20\x20\x20float\x20sinLon\x20=\x20sin(longitude);\x0a\x0a\x20\x20\x20\x20float\x20N_Phi\x20=\x20a\x20/\x20sqrt(1.0\x20-\x20e2\x20*\x20sinLat\x20*\x20sinLat);\x0a\x20\x20\x20\x20float\x20h\x20=\x20particleHeight;\x20//\x20it\x20should\x20be\x20high\x20enough\x20otherwise\x20the\x20particle\x20may\x20not\x20pass\x20the\x20terrain\x20depth\x20test\x0a\x0a\x20\x20\x20\x20vec3\x20cartesian\x20=\x20vec3(0.0);\x0a\x20\x20\x20\x20cartesian.x\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20cosLon;\x0a\x20\x20\x20\x20cartesian.y\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20sinLon;\x0a\x20\x20\x20\x20cartesian.z\x20=\x20((b\x20*\x20b)\x20/\x20(a\x20*\x20a)\x20*\x20N_Phi\x20+\x20h)\x20*\x20sinLat;\x0a\x20\x20\x20\x20return\x20cartesian;\x0a}\x0a\x0avec4\x20calcProjectedCoordinate(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20the\x20range\x20of\x20longitude\x20in\x20Cesium\x20is\x20[-180,\x20180]\x20but\x20the\x20range\x20of\x20longitude\x20in\x20the\x20NetCDF\x20file\x20is\x20[0,\x20360]\x0a\x20\x20\x20\x20//\x20[0,\x20180]\x20is\x20corresponding\x20to\x20[0,\x20180]\x20and\x20[180,\x20360]\x20is\x20corresponding\x20to\x20[-180,\x200]\x0a\x20\x20\x20\x20lonLatLev.x\x20=\x20mod(lonLatLev.x\x20+\x20180.0,\x20360.0)\x20-\x20180.0;\x0a\x20\x20\x20\x20vec3\x20particlePosition\x20=\x20convertCoordinate(lonLatLev);\x0a\x20\x20\x20\x20vec4\x20projectedCoordinate\x20=\x20czm_modelViewProjection\x20*\x20vec4(particlePosition,\x201.0);\x0a\x20\x20\x20\x20return\x20projectedCoordinate;\x0a}\x0a\x0avec4\x20calcOffset(vec4\x20currentProjectedCoordinate,\x20vec4\x20nextProjectedCoordinate,\x20float\x20offsetSign)\x20{\x0a\x20\x20\x20\x20vec2\x20aspectVec2\x20=\x20vec2(aspect,\x201.0);\x0a\x20\x20\x20\x20vec2\x20currentXY\x20=\x20(currentProjectedCoordinate.xy\x20/\x20currentProjectedCoordinate.w)\x20*\x20aspectVec2;\x0a\x20\x20\x20\x20vec2\x20nextXY\x20=\x20(nextProjectedCoordinate.xy\x20/\x20nextProjectedCoordinate.w)\x20*\x20aspectVec2;\x0a\x0a\x20\x20\x20\x20float\x20offsetLength\x20=\x20lineWidth\x20/\x202.0;\x0a\x20\x20\x20\x20vec2\x20direction\x20=\x20normalize(nextXY\x20-\x20currentXY);\x0a\x20\x20\x20\x20vec2\x20normalVector\x20=\x20vec2(-direction.y,\x20direction.x);\x0a\x20\x20\x20\x20normalVector.x\x20=\x20normalVector.x\x20/\x20aspect;\x0a\x20\x20\x20\x20normalVector\x20=\x20offsetLength\x20*\x20normalVector;\x0a\x0a\x20\x20\x20\x20vec4\x20offset\x20=\x20vec4(offsetSign\x20*\x20normalVector,\x200.0,\x200.0);\x0a\x20\x20\x20\x20return\x20offset;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec2\x20particleIndex\x20=\x20st;\x0a\x0a\x20\x20\x20\x20vec3\x20currentPosition\x20=\x20texture(currentParticlesPosition,\x20particleIndex).rgb;\x0a\x20\x20\x20\x20vec4\x20nextPosition\x20=\x20texture(postProcessingPosition,\x20particleIndex);\x0a\x0a\x20\x20\x20\x20vec4\x20currentProjectedCoordinate\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20vec4\x20nextProjectedCoordinate\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20if\x20(nextPosition.w\x20>\x200.0)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20currentProjectedCoordinate\x20=\x20calcProjectedCoordinate(currentPosition);\x0a\x20\x20\x20\x20\x20\x20\x20\x20nextProjectedCoordinate\x20=\x20calcProjectedCoordinate(currentPosition);\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20currentProjectedCoordinate\x20=\x20calcProjectedCoordinate(currentPosition);\x0a\x20\x20\x20\x20\x20\x20\x20\x20nextProjectedCoordinate\x20=\x20calcProjectedCoordinate(nextPosition.xyz);\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20float\x20pointToUse\x20=\x20normal.x;\x20//\x20-1\x20is\x20currentProjectedCoordinate\x20and\x20+1\x20is\x20nextProjectedCoordinate\x0a\x20\x20\x20\x20float\x20offsetSign\x20=\x20normal.y;\x0a\x0a\x20\x20\x20\x20vec4\x20offset\x20=\x20pixelSize\x20*\x20calcOffset(currentProjectedCoordinate,\x20nextProjectedCoordinate,\x20offsetSign);\x0a\x20\x20\x20\x20if\x20(pointToUse\x20<\x200.0)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20gl_Position\x20=\x20currentProjectedCoordinate\x20+\x20offset;\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20gl_Position\x20=\x20nextProjectedCoordinate\x20+\x20offset;\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20speedNormalization\x20=\x20texture(postProcessingSpeed,\x20particleIndex).a;\x0a}\x0a',segmentDraw_frag='uniform\x20sampler2D\x20colorTable;\x0a\x0ain\x20float\x20speedNormalization;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20out_FragColor\x20=\x20texture(colorTable,\x20vec2(speedNormalization,\x200.0));\x0a}\x0a',fullscreen_vert=_0x47128b(-0x29,-0x17),trailDraw_frag='uniform\x20sampler2D\x20segmentsColorTexture;\x0auniform\x20sampler2D\x20segmentsDepthTexture;\x0a\x0auniform\x20sampler2D\x20currentTrailsColor;\x0auniform\x20sampler2D\x20trailsDepthTexture;\x0a\x0auniform\x20float\x20fadeOpacity;\x0a\x0ain\x20vec2\x20textureCoordinate;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec4\x20pointsColor\x20=\x20texture(segmentsColorTexture,\x20textureCoordinate);\x0a\x20\x20\x20\x20vec4\x20trailsColor\x20=\x20texture(currentTrailsColor,\x20textureCoordinate);\x0a\x0a\x20\x20\x20\x20trailsColor\x20=\x20floor(fadeOpacity\x20*\x20255.0\x20*\x20trailsColor)\x20/\x20255.0;\x20//\x20make\x20sure\x20the\x20trailsColor\x20will\x20be\x20strictly\x20decreased\x0a\x0a\x20\x20\x20\x20float\x20pointsDepth\x20=\x20texture(segmentsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20\x20\x20float\x20trailsDepth\x20=\x20texture(trailsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20\x20\x20float\x20globeDepth\x20=\x20czm_unpackDepth(texture(czm_globeDepthTexture,\x20textureCoordinate));\x0a\x0a\x20\x20\x20\x20out_FragColor\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20if\x20(pointsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20out_FragColor\x20+\x20pointsColor;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20if\x20(trailsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20out_FragColor\x20+\x20trailsColor;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20gl_FragDepth\x20=\x20min(pointsDepth,\x20trailsDepth);\x0a}\x0a',screenDraw_frag=_0x47128b(0x4c,0x12);const Cesium$4=mars3d__namespace['Cesium'];class ParticlesRendering{constructor(_0x52f3a8,_0x12ae48,_0xa01464,_0x54ed37,_0x3da9e8){function _0x4e0c01(_0x3586ff,_0x3e8166){return _0x47128b(_0x3586ff,_0x3e8166- -0x111);}function _0x314edc(_0x25d4ed,_0x263e6c){return _0x58f7a9(_0x25d4ed,_0x263e6c-0x2e0);}this['createRenderingTextures'](_0x52f3a8,_0x12ae48,_0xa01464[_0x314edc(0x2f4,0x364)]),this[_0x314edc(0x352,0x32e)](_0x52f3a8),this[_0x4e0c01(-0x182,-0x12b)](_0x52f3a8,_0xa01464,_0x54ed37,_0x3da9e8);}[_0x58f7a9(0x96,0x4b)](_0x529ea3,_0x4cce9b,_0x2834e1){const _0x3fe015={};_0x3fe015['context']=_0x529ea3,_0x3fe015['width']=_0x529ea3[_0x3a63e7(-0x12,-0x6d)];function _0x3a63e7(_0x5a7dfb,_0x33cd6a){return _0x58f7a9(_0x33cd6a,_0x5a7dfb- -0xd9);}_0x3fe015[_0x3d09c6(0x365,0x361)]=_0x529ea3[_0x3d09c6(0x3c2,0x3c7)],_0x3fe015['pixelFormat']=Cesium$4['PixelFormat'][_0x3d09c6(0x3ec,0x391)],_0x3fe015['pixelDatatype']=Cesium$4[_0x3d09c6(0x36a,0x2de)][_0x3a63e7(-0x5d,-0x92)];const _0x5b4e7f=_0x3fe015,_0x25b23f={};_0x25b23f[_0x3a63e7(-0x49,0x3c)]=_0x529ea3,_0x25b23f['width']=_0x529ea3['drawingBufferWidth'],_0x25b23f['height']=_0x529ea3['drawingBufferHeight'],_0x25b23f[_0x3a63e7(-0x21,0x61)]=Cesium$4['PixelFormat']['DEPTH_COMPONENT'],_0x25b23f['pixelDatatype']=Cesium$4['PixelDatatype']['UNSIGNED_INT'];const _0x47f3d0=_0x25b23f,_0x1e67c7=_0x2834e1[_0x3a63e7(-0x3b,-0x72)];function _0x3d09c6(_0x55d988,_0x3d0457){return _0x47128b(_0x3d0457,_0x55d988-0x31e);}const _0xa61142=new Float32Array(_0x1e67c7*0x3);for(let _0x5379f0=0x0;_0x5379f0<_0x1e67c7;_0x5379f0++){const _0xe3040a=Cesium$4['Color'][_0x3d09c6(0x3c0,0x35b)](_0x2834e1[_0x5379f0]);_0xa61142[0x3*_0x5379f0]=_0xe3040a['red'],_0xa61142[0x3*_0x5379f0+0x1]=_0xe3040a[_0x3d09c6(0x380,0x3ff)],_0xa61142[0x3*_0x5379f0+0x2]=_0xe3040a['blue'];}const _0xc82ea0={'context':_0x529ea3,'width':_0x1e67c7,'height':0x1,'pixelFormat':Cesium$4['PixelFormat']['RGB'],'pixelDatatype':Cesium$4[_0x3a63e7(-0x19,0x3a)][_0x3a63e7(-0x3f,0x42)],'sampler':new Cesium$4['Sampler']({'minificationFilter':Cesium$4['TextureMinificationFilter'][_0x3d09c6(0x3d5,0x38b)],'magnificationFilter':Cesium$4['TextureMagnificationFilter'][_0x3a63e7(0x52,0x3d)]})};this['textures']={'segmentsColor':Util[_0x3a63e7(0x5f,-0x12)](_0x5b4e7f),'segmentsDepth':Util[_0x3d09c6(0x3e2,0x3b2)](_0x47f3d0),'currentTrailsColor':Util[_0x3d09c6(0x3e2,0x3b0)](_0x5b4e7f),'currentTrailsDepth':Util['createTexture'](_0x47f3d0),'nextTrailsColor':Util['createTexture'](_0x5b4e7f),'nextTrailsDepth':Util['createTexture'](_0x47f3d0),'colorTable':Util[_0x3d09c6(0x3e2,0x414)](_0xc82ea0,_0xa61142)};}['createRenderingFramebuffers'](_0x582125){function _0x49f437(_0x996d2f,_0xdd2dea){return _0x47128b(_0x996d2f,_0xdd2dea- -0x15);}function _0x277478(_0x23a2f3,_0x5800d8){return _0x58f7a9(_0x23a2f3,_0x5800d8- -0xc4);}this['framebuffers']={'segments':Util['createFramebuffer'](_0x582125,this['textures']['segmentsColor'],this['textures'][_0x49f437(0x4e,0x49)]),'currentTrails':Util['createFramebuffer'](_0x582125,this[_0x49f437(0x10c,0x7d)]['currentTrailsColor'],this['textures'][_0x277478(-0x61,-0x46)]),'nextTrails':Util[_0x49f437(0xb8,0xcd)](_0x582125,this['textures']['nextTrailsColor'],this[_0x277478(0x4f,0x42)]['nextTrailsDepth'])};}['createSegmentsGeometry'](_0x55eca4){const _0x1bd425=0x4;let _0x2b19de=[];for(let _0x19b1f0=0x0;_0x19b1f0<_0x55eca4[_0x513415(0x14e,0x140)];_0x19b1f0++){for(let _0x4778d9=0x0;_0x4778d9<_0x55eca4['particlesTextureSize'];_0x4778d9++){for(let _0x4557a0=0x0;_0x4557a0<_0x1bd425;_0x4557a0++){_0x2b19de['push'](_0x19b1f0/_0x55eca4['particlesTextureSize']),_0x2b19de['push'](_0x4778d9/_0x55eca4['particlesTextureSize']);}}}_0x2b19de=new Float32Array(_0x2b19de);let _0x1317b8=[];const _0x3afdc4=[-0x1,0x1],_0x4f2d42=[-0x1,0x1];for(let _0x495b47=0x0;_0x495b47<_0x55eca4['maxParticles'];_0x495b47++){for(let _0x5f5ab4=0x0;_0x5f5ab4<_0x1bd425/0x2;_0x5f5ab4++){for(let _0x185500=0x0;_0x185500<_0x1bd425/0x2;_0x185500++){_0x1317b8['push'](_0x3afdc4[_0x5f5ab4]),_0x1317b8[_0x513415(0x10f,0xe2)](_0x4f2d42[_0x185500]),_0x1317b8[_0x513415(0x10f,0xf5)](0x0);}}}_0x1317b8=new Float32Array(_0x1317b8);const _0x3c7c86=0x6*_0x55eca4['maxParticles'],_0x58c3d3=new Uint32Array(_0x3c7c86);for(let _0x3c2586=0x0,_0xe5e0d5=0x0,_0x34f2e1=0x0;_0x3c2586<_0x55eca4['maxParticles'];_0x3c2586++){_0x58c3d3[_0xe5e0d5++]=_0x34f2e1+0x0,_0x58c3d3[_0xe5e0d5++]=_0x34f2e1+0x1,_0x58c3d3[_0xe5e0d5++]=_0x34f2e1+0x2,_0x58c3d3[_0xe5e0d5++]=_0x34f2e1+0x2,_0x58c3d3[_0xe5e0d5++]=_0x34f2e1+0x1,_0x58c3d3[_0xe5e0d5++]=_0x34f2e1+0x3,_0x34f2e1+=0x4;}function _0xf859fc(_0x8d23bf,_0x6c659c){return _0x47128b(_0x6c659c,_0x8d23bf-0x4a1);}function _0x513415(_0x11c6ef,_0x281faa){return _0x47128b(_0x281faa,_0x11c6ef-0x120);}const _0x2713f6=new Cesium$4['Geometry']({'attributes':new Cesium$4['GeometryAttributes']({'st':new Cesium$4[(_0xf859fc(0x540,0x599))]({'componentDatatype':Cesium$4[_0x513415(0x197,0x18f)]['FLOAT'],'componentsPerAttribute':0x2,'values':_0x2b19de}),'normal':new Cesium$4[(_0xf859fc(0x540,0x53f))]({'componentDatatype':Cesium$4['ComponentDatatype']['FLOAT'],'componentsPerAttribute':0x3,'values':_0x1317b8})}),'indices':_0x58c3d3});return _0x2713f6;}['createRenderingPrimitives'](_0x2f86dc,_0x158c4e,_0x40ab24,_0x44f48a){const _0xdb9349=this,_0x451f5c={};_0x451f5c['st']=0x0,_0x451f5c['normal']=0x1;const _0x4531e6={};_0x4531e6[_0x308e24(0x1c8,0x15d)]=[segmentDraw_vert];const _0x6e9b04={};_0x6e9b04[_0x55efec(-0xd5,-0x7c)]=[segmentDraw_frag];const _0x9a8e56={};_0x9a8e56[_0x55efec(0x9,0x0)]=!![];const _0x1b3ad9={};function _0x55efec(_0x58997a,_0xa00802){return _0x47128b(_0xa00802,_0x58997a- -0xcb);}_0x1b3ad9['viewport']=undefined,_0x1b3ad9[_0x308e24(0x26b,0x24b)]=_0x9a8e56,_0x1b3ad9['depthMask']=!![];function _0x308e24(_0x10f1a2,_0x598720){return _0x47128b(_0x598720,_0x10f1a2-0x1d2);}const _0x2833a0={};_0x2833a0['position']=0x0,_0x2833a0['st']=0x1;const _0x167f74={};_0x167f74['defines']=['DISABLE_GL_POSITION_LOG_DEPTH'],_0x167f74[_0x55efec(-0xd5,-0x8a)]=[fullscreen_vert];const _0x357951={};_0x357951[_0x55efec(-0x40,-0xbf)]=['DISABLE_LOG_DEPTH_FRAGMENT_WRITE'],_0x357951['sources']=[trailDraw_frag];const _0x3c92b9={};_0x3c92b9[_0x55efec(-0x68,-0xaa)]=0x0,_0x3c92b9['st']=0x1;const _0x3f93cd={};_0x3f93cd[_0x55efec(-0x40,-0xc6)]=['DISABLE_GL_POSITION_LOG_DEPTH'],_0x3f93cd[_0x55efec(-0xd5,-0x102)]=[fullscreen_vert];const _0xb4fd14={};_0xb4fd14[_0x55efec(-0x40,-0x7e)]=[_0x55efec(-0x49,-0xad)],_0xb4fd14[_0x308e24(0x1c8,0x13b)]=[screenDraw_frag];const _0x27cdc2={};_0x27cdc2[_0x308e24(0x2a6,0x317)]=![];const _0x223113={};_0x223113['enabled']=!![],this['primitives']={'segments':new CustomPrimitive({'commandType':_0x308e24(0x1ec,0x17f),'attributeLocations':_0x451f5c,'geometry':this['createSegmentsGeometry'](_0x158c4e),'primitiveType':Cesium$4['PrimitiveType']['TRIANGLES'],'uniformMap':{'currentParticlesPosition':function(){return _0x44f48a['particlesTextures']['currentParticlesPosition'];},'postProcessingPosition':function(){function _0x56e2d3(_0x77b984,_0x2c50e7){return _0x308e24(_0x2c50e7- -0x330,_0x77b984);}return _0x44f48a['particlesTextures'][_0x56e2d3(-0x1d6,-0x162)];},'postProcessingSpeed':function(){function _0x43d840(_0x1bf422,_0x365130){return _0x55efec(_0x365130-0x44a,_0x1bf422);}return _0x44f48a[_0x43d840(0x33d,0x373)]['postProcessingSpeed'];},'colorTable':function(){function _0xaeecf(_0xb4896d,_0x1ed41f){return _0x55efec(_0x1ed41f-0x541,_0xb4896d);}function _0x22db72(_0x2bf5ca,_0x4fca01){return _0x55efec(_0x2bf5ca- -0xee,_0x4fca01);}return _0xdb9349[_0x22db72(-0x127,-0xba)][_0xaeecf(0x541,0x560)];},'aspect':function(){function _0xcdb2f0(_0x26a82d,_0x65b265){return _0x55efec(_0x65b265-0x317,_0x26a82d);}return _0x2f86dc['drawingBufferWidth']/_0x2f86dc[_0xcdb2f0(0x362,0x2f0)];},'pixelSize':function(){function _0x500092(_0x174be2,_0x3c0aaf){return _0x308e24(_0x3c0aaf-0x1bf,_0x174be2);}return _0x40ab24[_0x500092(0x4ee,0x47a)];},'lineWidth':function(){return _0x158c4e['lineWidth'];},'particleHeight':function(){return _0x158c4e['particleHeight'];}},'vertexShaderSource':new Cesium$4['ShaderSource'](_0x4531e6),'fragmentShaderSource':new Cesium$4['ShaderSource'](_0x6e9b04),'rawRenderState':Util['createRawRenderState'](_0x1b3ad9),'framebuffer':this[_0x55efec(0x24,0x54)][_0x55efec(-0xc4,-0x105)],'autoClear':!![]}),'trails':new CustomPrimitive({'commandType':_0x55efec(-0xb1,-0x115),'attributeLocations':_0x2833a0,'geometry':Util[_0x308e24(0x201,0x18b)](),'primitiveType':Cesium$4['PrimitiveType']['TRIANGLES'],'uniformMap':{'segmentsColorTexture':function(){function _0x1c51c9(_0x559ed8,_0x5b5463){return _0x308e24(_0x5b5463-0x150,_0x559ed8);}function _0x37af39(_0x58be59,_0x43667a){return _0x308e24(_0x43667a- -0x35f,_0x58be59);}return _0xdb9349[_0x1c51c9(0x437,0x3b4)][_0x1c51c9(0x36c,0x367)];},'segmentsDepthTexture':function(){return _0xdb9349['textures']['segmentsDepth'];},'currentTrailsColor':function(){function _0x2060ff(_0x501fd5,_0x5e8c59){return _0x55efec(_0x501fd5-0x559,_0x5e8c59);}function _0x1b9115(_0x3d778a,_0x1d43fd){return _0x55efec(_0x3d778a-0x5bb,_0x1d43fd);}return _0xdb9349[_0x1b9115(0x5df,0x5b1)][_0x2060ff(0x575,0x594)]['getColorTexture'](0x0);},'trailsDepthTexture':function(){function _0x142976(_0x1dfe8d,_0x1c7c95){return _0x55efec(_0x1dfe8d-0x170,_0x1c7c95);}return _0xdb9349[_0x142976(0x194,0x106)]['currentTrails']['depthTexture'];},'fadeOpacity':function(){return _0x158c4e['fadeOpacity'];}},'vertexShaderSource':new Cesium$4['ShaderSource'](_0x167f74),'fragmentShaderSource':new Cesium$4['ShaderSource'](_0x357951),'rawRenderState':Util['createRawRenderState']({'viewport':undefined,'depthTest':{'enabled':!![],'func':Cesium$4['DepthFunction']['ALWAYS']},'depthMask':!![]}),'framebuffer':this['framebuffers'][_0x55efec(0x25,0x73)],'autoClear':!![],'preExecute':function(){function _0xa713a7(_0x37bcf9,_0x43aa3b){return _0x308e24(_0x43aa3b- -0x257,_0x37bcf9);}const _0x3efeb8=_0xdb9349['framebuffers'][_0xa713a7(0x48,0x62)];function _0x517226(_0x22bb90,_0x743daa){return _0x308e24(_0x22bb90- -0x279,_0x743daa);}_0xdb9349['framebuffers'][_0xa713a7(0xec,0x62)]=_0xdb9349['framebuffers']['nextTrails'],_0xdb9349['framebuffers']['nextTrails']=_0x3efeb8,_0xdb9349[_0x517226(0x3a,0x55)][_0x517226(0x9,-0x2b)][_0x517226(-0x1,0x27)]['framebuffer']=_0xdb9349['framebuffers']['nextTrails'],_0xdb9349['primitives'][_0x517226(0x9,0x81)]['clearCommand'][_0xa713a7(-0x3a,-0x33)]=_0xdb9349['framebuffers'][_0xa713a7(0x38,0x6b)];}}),'screen':new CustomPrimitive({'commandType':'Draw','attributeLocations':_0x3c92b9,'geometry':Util['getFullscreenQuad'](),'primitiveType':Cesium$4['PrimitiveType']['TRIANGLES'],'uniformMap':{'trailsColorTexture':function(){return _0xdb9349['framebuffers']['nextTrails']['getColorTexture'](0x0);},'trailsDepthTexture':function(){function _0x41b387(_0x3f2a9b,_0x310ff6){return _0x55efec(_0x3f2a9b-0x1e2,_0x310ff6);}return _0xdb9349['framebuffers']['nextTrails'][_0x41b387(0x15d,0x173)];}},'vertexShaderSource':new Cesium$4['ShaderSource'](_0x3f93cd),'fragmentShaderSource':new Cesium$4[(_0x308e24(0x1f7,0x1fc))](_0xb4fd14),'rawRenderState':Util['createRawRenderState']({'viewport':undefined,'depthTest':_0x27cdc2,'depthMask':!![],'blending':_0x223113}),'framebuffer':undefined})};}}var getWind_frag='//\x20the\x20size\x20of\x20UV\x20textures:\x20width\x20=\x20lon,\x20height\x20=\x20lat*lev\x0auniform\x20sampler2D\x20U;\x20//\x20eastward\x20wind\x0auniform\x20sampler2D\x20V;\x20//\x20northward\x20wind\x0a\x0auniform\x20sampler2D\x20currentParticlesPosition;\x20//\x20(lon,\x20lat,\x20lev)\x0a\x0auniform\x20vec3\x20dimension;\x20//\x20(lon,\x20lat,\x20lev)\x0auniform\x20vec3\x20minimum;\x20//\x20minimum\x20of\x20each\x20dimension\x0auniform\x20vec3\x20maximum;\x20//\x20maximum\x20of\x20each\x20dimension\x0auniform\x20vec3\x20interval;\x20//\x20interval\x20of\x20each\x20dimension\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avec2\x20mapPositionToNormalizedIndex2D(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20ensure\x20the\x20range\x20of\x20longitude\x20and\x20latitude\x0a\x20\x20\x20\x20lonLatLev.x\x20=\x20mod(lonLatLev.x,\x20360.0);\x0a\x20\x20\x20\x20lonLatLev.y\x20=\x20clamp(lonLatLev.y,\x20-90.0,\x2090.0);\x0a\x0a\x20\x20\x20\x20vec3\x20index3D\x20=\x20vec3(0.0);\x0a\x20\x20\x20\x20index3D.x\x20=\x20(lonLatLev.x\x20-\x20minimum.x)\x20/\x20interval.x;\x0a\x20\x20\x20\x20index3D.y\x20=\x20(lonLatLev.y\x20-\x20minimum.y)\x20/\x20interval.y;\x0a\x20\x20\x20\x20index3D.z\x20=\x20(lonLatLev.z\x20-\x20minimum.z)\x20/\x20interval.z;\x0a\x0a\x20\x20\x20\x20//\x20the\x20st\x20texture\x20coordinate\x20corresponding\x20to\x20(col,\x20row)\x20index\x0a\x20\x20\x20\x20//\x20example\x0a\x20\x20\x20\x20//\x20data\x20array\x20is\x20[0,\x201,\x202,\x203,\x204,\x205],\x20width\x20=\x203,\x20height\x20=\x202\x0a\x20\x20\x20\x20//\x20the\x20content\x20of\x20texture\x20will\x20be\x0a\x20\x20\x20\x20//\x20t\x201.0\x0a\x20\x20\x20\x20//\x20\x20\x20\x20|\x20\x203\x204\x205\x0a\x20\x20\x20\x20//\x20\x20\x20\x20|\x0a\x20\x20\x20\x20//\x20\x20\x20\x20|\x20\x200\x201\x202\x0a\x20\x20\x20\x20//\x20\x20\x200.0------1.0\x20s\x0a\x0a\x20\x20\x20\x20vec2\x20index2D\x20=\x20vec2(index3D.x,\x20index3D.z\x20*\x20dimension.y\x20+\x20index3D.y);\x0a\x20\x20\x20\x20vec2\x20normalizedIndex2D\x20=\x20vec2(index2D.x\x20/\x20dimension.x,\x20index2D.y\x20/\x20(dimension.y\x20*\x20dimension.z));\x0a\x20\x20\x20\x20return\x20normalizedIndex2D;\x0a}\x0a\x0afloat\x20getWind(sampler2D\x20windTexture,\x20vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20vec2\x20normalizedIndex2D\x20=\x20mapPositionToNormalizedIndex2D(lonLatLev);\x0a\x20\x20\x20\x20float\x20result\x20=\x20texture(windTexture,\x20normalizedIndex2D).r;\x0a\x20\x20\x20\x20return\x20result;\x0a}\x0a\x0aconst\x20mat4\x20kernelMatrix\x20=\x20mat4(\x0a\x20\x20\x20\x200.0,\x20-1.0,\x202.0,\x20-1.0,\x20//\x20first\x20column\x0a\x20\x20\x20\x202.0,\x200.0,\x20-5.0,\x203.0,\x20//\x20second\x20column\x0a\x20\x20\x20\x200.0,\x201.0,\x204.0,\x20-3.0,\x20//\x20third\x20column\x0a\x20\x20\x20\x200.0,\x200.0,\x20-1.0,\x201.0\x20//\x20fourth\x20column\x0a);\x0afloat\x20oneDimensionInterpolation(float\x20t,\x20float\x20p0,\x20float\x20p1,\x20float\x20p2,\x20float\x20p3)\x20{\x0a\x20\x20\x20\x20vec4\x20tVec4\x20=\x20vec4(1.0,\x20t,\x20t\x20*\x20t,\x20t\x20*\x20t\x20*\x20t);\x0a\x20\x20\x20\x20tVec4\x20=\x20tVec4\x20/\x202.0;\x0a\x20\x20\x20\x20vec4\x20pVec4\x20=\x20vec4(p0,\x20p1,\x20p2,\x20p3);\x0a\x20\x20\x20\x20return\x20dot((tVec4\x20*\x20kernelMatrix),\x20pVec4);\x0a}\x0a\x0afloat\x20calculateB(sampler2D\x20windTexture,\x20float\x20t,\x20float\x20lon,\x20float\x20lat,\x20float\x20lev)\x20{\x0a\x20\x20\x20\x20float\x20lon0\x20=\x20floor(lon)\x20-\x201.0\x20*\x20interval.x;\x0a\x20\x20\x20\x20float\x20lon1\x20=\x20floor(lon);\x0a\x20\x20\x20\x20float\x20lon2\x20=\x20floor(lon)\x20+\x201.0\x20*\x20interval.x;\x0a\x20\x20\x20\x20float\x20lon3\x20=\x20floor(lon)\x20+\x202.0\x20*\x20interval.x;\x0a\x0a\x20\x20\x20\x20float\x20p0\x20=\x20getWind(windTexture,\x20vec3(lon0,\x20lat,\x20lev));\x0a\x20\x20\x20\x20float\x20p1\x20=\x20getWind(windTexture,\x20vec3(lon1,\x20lat,\x20lev));\x0a\x20\x20\x20\x20float\x20p2\x20=\x20getWind(windTexture,\x20vec3(lon2,\x20lat,\x20lev));\x0a\x20\x20\x20\x20float\x20p3\x20=\x20getWind(windTexture,\x20vec3(lon3,\x20lat,\x20lev));\x0a\x0a\x20\x20\x20\x20return\x20oneDimensionInterpolation(t,\x20p0,\x20p1,\x20p2,\x20p3);\x0a}\x0a\x0afloat\x20interpolateOneTexture(sampler2D\x20windTexture,\x20vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20float\x20lon\x20=\x20lonLatLev.x;\x0a\x20\x20\x20\x20float\x20lat\x20=\x20lonLatLev.y;\x0a\x20\x20\x20\x20float\x20lev\x20=\x20lonLatLev.z;\x0a\x0a\x20\x20\x20\x20float\x20lat0\x20=\x20floor(lat)\x20-\x201.0\x20*\x20interval.y;\x0a\x20\x20\x20\x20float\x20lat1\x20=\x20floor(lat);\x0a\x20\x20\x20\x20float\x20lat2\x20=\x20floor(lat)\x20+\x201.0\x20*\x20interval.y;\x0a\x20\x20\x20\x20float\x20lat3\x20=\x20floor(lat)\x20+\x202.0\x20*\x20interval.y;\x0a\x0a\x20\x20\x20\x20vec2\x20coefficient\x20=\x20lonLatLev.xy\x20-\x20floor(lonLatLev.xy);\x0a\x20\x20\x20\x20float\x20b0\x20=\x20calculateB(windTexture,\x20coefficient.x,\x20lon,\x20lat0,\x20lev);\x0a\x20\x20\x20\x20float\x20b1\x20=\x20calculateB(windTexture,\x20coefficient.x,\x20lon,\x20lat1,\x20lev);\x0a\x20\x20\x20\x20float\x20b2\x20=\x20calculateB(windTexture,\x20coefficient.x,\x20lon,\x20lat2,\x20lev);\x0a\x20\x20\x20\x20float\x20b3\x20=\x20calculateB(windTexture,\x20coefficient.x,\x20lon,\x20lat3,\x20lev);\x0a\x0a\x20\x20\x20\x20return\x20oneDimensionInterpolation(coefficient.y,\x20b0,\x20b1,\x20b2,\x20b3);\x0a}\x0a\x0avec3\x20bicubic(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20https://en.wikipedia.org/wiki/Bicubic_interpolation#Bicubic_convolution_algorithm\x0a\x20\x20\x20\x20float\x20u\x20=\x20interpolateOneTexture(U,\x20lonLatLev);\x0a\x20\x20\x20\x20float\x20v\x20=\x20interpolateOneTexture(V,\x20lonLatLev);\x0a\x20\x20\x20\x20float\x20w\x20=\x200.0;\x0a\x20\x20\x20\x20return\x20vec3(u,\x20v,\x20w);\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20\x20\x20vec3\x20lonLatLev\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rgb;\x0a\x20\x20\x20\x20vec3\x20windVector\x20=\x20bicubic(lonLatLev);\x0a\x20\x20\x20\x20out_FragColor\x20=\x20vec4(windVector,\x200.0);\x0a}\x0a',updateSpeed_frag=_0x47128b(0xed,0x90),updatePosition_frag=_0x58f7a9(0xe6,0x6d),postProcessingPosition_frag='uniform\x20sampler2D\x20nextParticlesPosition;\x0auniform\x20sampler2D\x20nextParticlesSpeed;\x20//\x20(u,\x20v,\x20w,\x20normalization)\x0a\x0a//\x20range\x20(min,\x20max)\x0auniform\x20vec2\x20lonRange;\x0auniform\x20vec2\x20latRange;\x0a\x0auniform\x20float\x20randomCoefficient;\x20//\x20use\x20to\x20improve\x20the\x20pseudo-random\x20generator\x0auniform\x20float\x20dropRate;\x20//\x20drop\x20rate\x20is\x20a\x20chance\x20a\x20particle\x20will\x20restart\x20at\x20random\x20position\x20to\x20avoid\x20degeneration\x0auniform\x20float\x20dropRateBump;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0a//\x20pseudo-random\x20generator\x0aconst\x20vec3\x20randomConstants\x20=\x20vec3(12.9898,\x2078.233,\x204375.85453);\x0aconst\x20vec2\x20normalRange\x20=\x20vec2(0.0,\x201.0);\x0afloat\x20rand(vec2\x20seed,\x20vec2\x20range)\x20{\x0a\x20\x20\x20\x20vec2\x20randomSeed\x20=\x20randomCoefficient\x20*\x20seed;\x0a\x20\x20\x20\x20float\x20temp\x20=\x20dot(randomConstants.xy,\x20randomSeed);\x0a\x20\x20\x20\x20temp\x20=\x20fract(sin(temp)\x20*\x20(randomConstants.z\x20+\x20temp));\x0a\x20\x20\x20\x20return\x20temp\x20*\x20(range.y\x20-\x20range.x)\x20+\x20range.x;\x0a}\x0a\x0avec3\x20generateRandomParticle(vec2\x20seed,\x20float\x20lev)\x20{\x0a\x20\x20\x20\x20//\x20ensure\x20the\x20longitude\x20is\x20in\x20[0,\x20360]\x0a\x20\x20\x20\x20float\x20randomLon\x20=\x20mod(rand(seed,\x20lonRange),\x20360.0);\x0a\x20\x20\x20\x20float\x20randomLat\x20=\x20rand(-seed,\x20latRange);\x0a\x0a\x20\x20\x20\x20return\x20vec3(randomLon,\x20randomLat,\x20lev);\x0a}\x0a\x0abool\x20particleOutbound(vec3\x20particle)\x20{\x0a\x20\x20\x20\x20return\x20particle.y\x20<\x20-90.0\x20||\x20particle.y\x20>\x2090.0;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec3\x20nextParticle\x20=\x20texture(nextParticlesPosition,\x20v_textureCoordinates).rgb;\x0a\x20\x20\x20\x20vec4\x20nextSpeed\x20=\x20texture(nextParticlesSpeed,\x20v_textureCoordinates);\x0a\x20\x20\x20\x20float\x20particleDropRate\x20=\x20dropRate\x20+\x20dropRateBump\x20*\x20nextSpeed.a;\x0a\x0a\x20\x20\x20\x20vec2\x20seed1\x20=\x20nextParticle.xy\x20+\x20v_textureCoordinates;\x0a\x20\x20\x20\x20vec2\x20seed2\x20=\x20nextSpeed.xy\x20+\x20v_textureCoordinates;\x0a\x20\x20\x20\x20vec3\x20randomParticle\x20=\x20generateRandomParticle(seed1,\x20nextParticle.z);\x0a\x20\x20\x20\x20float\x20randomNumber\x20=\x20rand(seed2,\x20normalRange);\x0a\x0a\x20\x20\x20\x20if\x20(randomNumber\x20<\x20particleDropRate\x20||\x20particleOutbound(nextParticle))\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20vec4(randomParticle,\x201.0);\x20//\x201.0\x20means\x20this\x20is\x20a\x20random\x20particle\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20vec4(nextParticle,\x200.0);\x0a\x20\x20\x20\x20}\x0a}\x0a',postProcessingSpeed_frag='uniform\x20sampler2D\x20postProcessingPosition;\x0auniform\x20sampler2D\x20nextParticlesSpeed;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec4\x20randomParticle\x20=\x20texture(postProcessingPosition,\x20v_textureCoordinates);\x0a\x20\x20\x20\x20vec4\x20particleSpeed\x20=\x20texture(nextParticlesSpeed,\x20v_textureCoordinates);\x0a\x0a\x20\x20\x20\x20if\x20(randomParticle.a\x20>\x200.0)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20particleSpeed;\x0a\x20\x20\x20\x20}\x0a}\x0a';const Cesium$3=mars3d__namespace[_0x58f7a9(0x155,0x117)];class ParticlesComputing{constructor(_0x52f2d3,_0x40af63,_0x5ddbb5,_0x7f924c){this['data']=_0x40af63,this['createWindTextures'](_0x52f2d3,_0x40af63),this['createParticlesTextures'](_0x52f2d3,_0x5ddbb5,_0x7f924c),this['createComputingPrimitives'](_0x40af63,_0x5ddbb5,_0x7f924c);}['createWindTextures'](_0x49da5b,_0x246505){function _0x4aeeea(_0x38801f,_0x1c420a){return _0x58f7a9(_0x38801f,_0x1c420a-0x2dd);}function _0x6fc0e4(_0x39e026,_0x1af503){return _0x58f7a9(_0x1af503,_0x39e026-0x1e1);}const _0x1cc926={'context':_0x49da5b,'width':_0x246505[_0x4aeeea(0x390,0x3e2)][_0x6fc0e4(0x2c1,0x289)],'height':_0x246505[_0x4aeeea(0x3d6,0x3e2)]['lat']*(_0x246505['dimensions'][_0x6fc0e4(0x2bb,0x2f9)]||0x1),'pixelFormat':Cesium$3[_0x6fc0e4(0x341,0x3a5)]['LUMINANCE'],'pixelDatatype':Cesium$3[_0x4aeeea(0x38c,0x39d)][_0x4aeeea(0x345,0x377)],'flipY':![],'sampler':new Cesium$3[(_0x6fc0e4(0x325,0x2ef))]({'minificationFilter':Cesium$3['TextureMinificationFilter'][_0x4aeeea(0x387,0x3a8)],'magnificationFilter':Cesium$3[_0x4aeeea(0x331,0x37d)][_0x6fc0e4(0x2ac,0x311)]})};this['windTextures']={'U':Util['createTexture'](_0x1cc926,_0x246505['U']['array']),'V':Util['createTexture'](_0x1cc926,_0x246505['V'][_0x6fc0e4(0x309,0x2cc)])};}['createParticlesTextures'](_0x5c9b5d,_0x3ff262,_0x2ccc14){const _0x243605={'context':_0x5c9b5d,'width':_0x3ff262['particlesTextureSize'],'height':_0x3ff262[_0x96aa7d(0x517,0x534)],'pixelFormat':Cesium$3[_0x96aa7d(0x59c,0x5f2)]['RGBA'],'pixelDatatype':Cesium$3[_0x2fedef(0x252,0x236)][_0x2fedef(0x1bc,0x210)],'flipY':![],'sampler':new Cesium$3['Sampler']({'minificationFilter':Cesium$3['TextureMinificationFilter'][_0x2fedef(0x1e1,0x241)],'magnificationFilter':Cesium$3['TextureMagnificationFilter'][_0x96aa7d(0x594,0x55d)]})},_0x1f9c91=this[_0x2fedef(0x236,0x257)](_0x3ff262[_0x96aa7d(0x585,0x5dd)],_0x2ccc14);function _0x2fedef(_0x36b0f,_0x3bfd9f){return _0x58f7a9(_0x36b0f,_0x3bfd9f-0x176);}const _0x3953e8=new Float32Array(0x4*_0x3ff262[_0x96aa7d(0x5d9,0x5dd)])[_0x2fedef(0x300,0x298)](0x0);function _0x96aa7d(_0x3780ac,_0x2eca86){return _0x47128b(_0x3780ac,_0x2eca86-0x506);}this['particlesTextures']={'particlesWind':Util[_0x2fedef(0x2ac,0x2ae)](_0x243605),'currentParticlesPosition':Util['createTexture'](_0x243605,_0x1f9c91),'nextParticlesPosition':Util[_0x2fedef(0x285,0x2ae)](_0x243605,_0x1f9c91),'currentParticlesSpeed':Util['createTexture'](_0x243605,_0x3953e8),'nextParticlesSpeed':Util['createTexture'](_0x243605,_0x3953e8),'postProcessingPosition':Util['createTexture'](_0x243605,_0x1f9c91),'postProcessingSpeed':Util['createTexture'](_0x243605,_0x3953e8)};}[_0x47128b(0x87,0x6d)](_0xc3a362,_0x5c490a){const _0x3f9a51=new Float32Array(0x4*_0xc3a362);function _0x54a5ea(_0x3ea51f,_0x464015){return _0x47128b(_0x3ea51f,_0x464015-0xe5);}for(let _0x45972f=0x0;_0x45972f<_0xc3a362;_0x45972f++){_0x3f9a51[0x4*_0x45972f]=Cesium$3['Math']['randomBetween'](_0x5c490a[_0x5f3285(0x319,0x363)]['x'],_0x5c490a['lonRange']['y']),_0x3f9a51[0x4*_0x45972f+0x1]=Cesium$3[_0x54a5ea(0x1e4,0x163)]['randomBetween'](_0x5c490a['latRange']['x'],_0x5c490a['latRange']['y']),_0x3f9a51[0x4*_0x45972f+0x2]=Cesium$3['Math']['randomBetween'](this[_0x54a5ea(0xce,0xe0)]['lev']['min'],this[_0x5f3285(0x2c5,0x237)][_0x5f3285(0x330,0x2ab)]['max']),_0x3f9a51[0x4*_0x45972f+0x3]=0x0;}function _0x5f3285(_0x5f3bb7,_0x5cbe87){return _0x47128b(_0x5cbe87,_0x5f3bb7-0x2ca);}return _0x3f9a51;}['destroyParticlesTextures'](){function _0x36fcd3(_0x5832bd,_0x597476){return _0x58f7a9(_0x5832bd,_0x597476-0x5b);}function _0x1a01a3(_0x4cc8af,_0x5da90b){return _0x58f7a9(_0x4cc8af,_0x5da90b-0x42b);}Object[_0x1a01a3(0x52f,0x544)](this[_0x1a01a3(0x40a,0x493)])[_0x1a01a3(0x54c,0x569)](_0x3144eb=>{this['particlesTextures'][_0x3144eb]['destroy']();});}[_0x58f7a9(0x1c1,0x168)](_0x1d7782,_0x5c0af7,_0x273bfc){function _0x398815(_0x130f3d,_0x3559a4){return _0x58f7a9(_0x3559a4,_0x130f3d-0xe9);}const _0xc047d8=new Cesium$3['Cartesian3'](_0x1d7782['dimensions'][_0x398815(0x1c9,0x22a)],_0x1d7782['dimensions']['lat'],_0x1d7782['dimensions']['lev']),_0xf6a061=new Cesium$3['Cartesian3'](_0x1d7782['lon']['min'],_0x1d7782[_0x197223(0x1f0,0x26e)][_0x197223(0x30d,0x2a4)],_0x1d7782[_0x197223(0x2fb,0x283)]['min']),_0x30df08=new Cesium$3['Cartesian3'](_0x1d7782['lon'][_0x197223(0x255,0x260)],_0x1d7782[_0x197223(0x28a,0x26e)][_0x197223(0x2a9,0x260)],_0x1d7782[_0x398815(0x1c3,0x18b)]['max']),_0x71af71=new Cesium$3['Cartesian3']((_0x30df08['x']-_0xf6a061['x'])/(_0xc047d8['x']-0x1),(_0x30df08['y']-_0xf6a061['y'])/(_0xc047d8['y']-0x1),_0xc047d8['z']>0x1?(_0x30df08['z']-_0xf6a061['z'])/(_0xc047d8['z']-0x1):0x1);function _0x197223(_0x5e9015,_0x992fb9){return _0x47128b(_0x5e9015,_0x992fb9-0x21d);}const _0x36916d=new Cesium$3['Cartesian2'](_0x1d7782['U'][_0x398815(0x1e4,0x25c)],_0x1d7782['U'][_0x398815(0x1a0,0x15f)]),_0x4846ac=new Cesium$3['Cartesian2'](_0x1d7782['V']['min'],_0x1d7782['V']['max']),_0x19c7fa=this,_0x2cb243={};_0x2cb243['U']=function(){return _0x19c7fa['windTextures']['U'];},_0x2cb243['V']=function(){return _0x19c7fa['windTextures']['V'];},_0x2cb243[_0x197223(0x322,0x2d6)]=function(){return _0x19c7fa['particlesTextures']['currentParticlesPosition'];},_0x2cb243[_0x197223(0x29f,0x2dd)]=function(){return _0xc047d8;},_0x2cb243['minimum']=function(){return _0xf6a061;},_0x2cb243['maximum']=function(){return _0x30df08;},_0x2cb243[_0x398815(0x222,0x25a)]=function(){return _0x71af71;};const _0x285edf={};_0x285edf[_0x197223(0x208,0x213)]=[getWind_frag];const _0x145178={};_0x145178[_0x197223(0x1ef,0x213)]=[updateSpeed_frag];const _0x54c93d={};_0x54c93d[_0x398815(0x153,0x137)]=[updatePosition_frag];const _0x15e96a={};_0x15e96a['sources']=[postProcessingPosition_frag];const _0x5679e0={};_0x5679e0[_0x197223(0x1ce,0x213)]=[postProcessingSpeed_frag],this[_0x398815(0x23e,0x235)]={'getWind':new CustomPrimitive({'commandType':'Compute','uniformMap':_0x2cb243,'fragmentShaderSource':new Cesium$3[(_0x197223(0x1f7,0x242))](_0x285edf),'outputTexture':this['particlesTextures']['particlesWind'],'preExecute':function(){function _0x10d275(_0x4995fe,_0xabf49d){return _0x197223(_0x4995fe,_0xabf49d-0x4e);}function _0x487837(_0x44296b,_0x1f6494){return _0x197223(_0x44296b,_0x1f6494-0x162);}_0x19c7fa[_0x10d275(0x363,0x34c)][_0x487837(0x3f8,0x39a)][_0x487837(0x471,0x425)]['outputTexture']=_0x19c7fa['particlesTextures']['particlesWind'];}}),'updateSpeed':new CustomPrimitive({'commandType':'Compute','uniformMap':{'currentParticlesSpeed':function(){return _0x19c7fa['particlesTextures']['currentParticlesSpeed'];},'particlesWind':function(){return _0x19c7fa['particlesTextures']['particlesWind'];},'uSpeedRange':function(){return _0x36916d;},'vSpeedRange':function(){return _0x4846ac;},'pixelSize':function(){function _0x5becf7(_0x2e7deb,_0x49745c){return _0x398815(_0x2e7deb-0x17a,_0x49745c);}return _0x273bfc[_0x5becf7(0x3c0,0x41e)];},'speedFactor':function(){function _0x2eb196(_0x5999ac,_0x4c50b9){return _0x398815(_0x4c50b9-0x36d,_0x5999ac);}return _0x5c0af7[_0x2eb196(0x59d,0x596)];}},'fragmentShaderSource':new Cesium$3['ShaderSource'](_0x145178),'outputTexture':this['particlesTextures']['nextParticlesSpeed'],'preExecute':function(){const _0x44860a=_0x19c7fa['particlesTextures']['currentParticlesSpeed'];_0x19c7fa['particlesTextures'][_0x98c1ea(0x231,0x2a4)]=_0x19c7fa['particlesTextures']['postProcessingSpeed'];function _0x98c1ea(_0x1e1d1b,_0x315178){return _0x398815(_0x1e1d1b-0x92,_0x315178);}function _0x2a60ba(_0x4e7471,_0x330d76){return _0x197223(_0x330d76,_0x4e7471-0x182);}_0x19c7fa['particlesTextures'][_0x98c1ea(0x275,0x2fd)]=_0x44860a,_0x19c7fa['primitives']['updateSpeed'][_0x2a60ba(0x445,0x44f)]['outputTexture']=_0x19c7fa[_0x98c1ea(0x1e3,0x228)]['nextParticlesSpeed'];}}),'updatePosition':new CustomPrimitive({'commandType':_0x398815(0x17a,0x137),'uniformMap':{'currentParticlesPosition':function(){return _0x19c7fa['particlesTextures']['currentParticlesPosition'];},'currentParticlesSpeed':function(){function _0x2f300c(_0x3cf363,_0x347950){return _0x197223(_0x3cf363,_0x347950- -0x1dc);}return _0x19c7fa['particlesTextures'][_0x2f300c(0x31,0x83)];}},'fragmentShaderSource':new Cesium$3[(_0x398815(0x182,0x1f1))](_0x54c93d),'outputTexture':this['particlesTextures'][_0x197223(0x27f,0x2d8)],'preExecute':function(){function _0x598433(_0x4a67d6,_0xb415e9){return _0x197223(_0x4a67d6,_0xb415e9-0x49);}const _0x160c8d=_0x19c7fa['particlesTextures']['currentParticlesPosition'];_0x19c7fa['particlesTextures']['currentParticlesPosition']=_0x19c7fa['particlesTextures'][_0x4c59e5(0x22a,0x226)],_0x19c7fa['particlesTextures'][_0x598433(0x21c,0x262)]=_0x160c8d;function _0x4c59e5(_0x405a26,_0x596b97){return _0x197223(_0x596b97,_0x405a26-0x11);}_0x19c7fa[_0x598433(0x31f,0x347)]['updatePosition']['commandToExecute']['outputTexture']=_0x19c7fa[_0x598433(0x2e9,0x25a)]['nextParticlesPosition'];}}),'postProcessingPosition':new CustomPrimitive({'commandType':'Compute','uniformMap':{'nextParticlesPosition':function(){function _0xcbf59a(_0x422fba,_0x4149dd){return _0x398815(_0x4149dd-0xbe,_0x422fba);}return _0x19c7fa['particlesTextures'][_0xcbf59a(0x332,0x2d6)];},'nextParticlesSpeed':function(){return _0x19c7fa['particlesTextures']['nextParticlesSpeed'];},'lonRange':function(){function _0x3b10f3(_0x139b5a,_0x4bdd8f){return _0x398815(_0x139b5a-0x40c,_0x4bdd8f);}return _0x273bfc[_0x3b10f3(0x5b8,0x605)];},'latRange':function(){return _0x273bfc['latRange'];},'randomCoefficient':function(){const _0x38104d=Math['random']();return _0x38104d;},'dropRate':function(){return _0x5c0af7['dropRate'];},'dropRateBump':function(){function _0x225eea(_0x577071,_0x59a03e){return _0x398815(_0x59a03e-0x133,_0x577071);}return _0x5c0af7[_0x225eea(0x36c,0x2f7)];}},'fragmentShaderSource':new Cesium$3['ShaderSource'](_0x15e96a),'outputTexture':this[_0x398815(0x151,0x18c)]['postProcessingPosition'],'preExecute':function(){function _0x3d45b3(_0x125472,_0x4cab33){return _0x197223(_0x125472,_0x4cab33-0x354);}function _0x3eadfe(_0x577b49,_0x2f54b0){return _0x398815(_0x577b49- -0x1fe,_0x2f54b0);}_0x19c7fa[_0x3d45b3(0x651,0x652)][_0x3eadfe(-0xa5,-0xaa)]['commandToExecute']['outputTexture']=_0x19c7fa['particlesTextures'][_0x3d45b3(0x52f,0x56d)];}}),'postProcessingSpeed':new CustomPrimitive({'commandType':'Compute','uniformMap':{'postProcessingPosition':function(){return _0x19c7fa['particlesTextures']['postProcessingPosition'];},'nextParticlesSpeed':function(){function _0x518ee1(_0x246093,_0x234bc3){return _0x398815(_0x246093- -0x103,_0x234bc3);}return _0x19c7fa['particlesTextures'][_0x518ee1(0x148,0x1c5)];}},'fragmentShaderSource':new Cesium$3[(_0x197223(0x1d2,0x242))](_0x5679e0),'outputTexture':this[_0x197223(0x28c,0x211)][_0x197223(0x272,0x2a3)],'preExecute':function(){function _0x502d40(_0x372185,_0x3cb9b7){return _0x197223(_0x3cb9b7,_0x372185- -0x337);}function _0x5b79a4(_0x4ca9c7,_0xcaa601){return _0x197223(_0xcaa601,_0x4ca9c7-0x1d6);}_0x19c7fa['primitives']['postProcessingSpeed']['commandToExecute']['outputTexture']=_0x19c7fa[_0x502d40(-0x126,-0x11a)][_0x502d40(-0x94,-0xae)];}})};}}const Cesium$2=mars3d__namespace[_0x47128b(0xfb,0xa3)];class ParticleSystem{constructor(_0x2af812,_0x460d73,_0x22b655,_0x1d3a63){this[_0x195b6e(0x271,0x233)]=_0x2af812,_0x460d73={..._0x460d73};_0x460d73['udata']&&_0x460d73['vdata']&&(_0x460d73[_0x195b6e(0x22c,0x2a8)]={},_0x460d73['dimensions'][_0x1293b6(0x625,0x5e3)]=_0x460d73['cols'],_0x460d73[_0x1293b6(0x671,0x608)]['lat']=_0x460d73['rows'],_0x460d73['dimensions']['lev']=_0x460d73['lev']||0x1,_0x460d73['lon']={},_0x460d73[_0x195b6e(0x24a,0x283)]['min']=_0x460d73['xmin'],_0x460d73[_0x1293b6(0x56e,0x5e3)]['max']=_0x460d73[_0x1293b6(0x603,0x655)],_0x460d73['lat']={},_0x460d73['lat'][_0x1293b6(0x611,0x5fe)]=_0x460d73[_0x1293b6(0x6aa,0x64a)],_0x460d73['lat'][_0x195b6e(0x1f6,0x25a)]=_0x460d73[_0x195b6e(0x305,0x308)],_0x460d73['lev']={},_0x460d73['lev']['min']=_0x460d73['levmin']??0x1,_0x460d73['lev']['max']=_0x460d73[_0x195b6e(0x2be,0x2d9)]??0x1,_0x460d73['U']={},_0x460d73['U']['array']=new Float32Array(_0x460d73[_0x1293b6(0x5f2,0x5a4)]),_0x460d73['U'][_0x1293b6(0x66b,0x5fe)]=_0x460d73[_0x1293b6(0x4fd,0x57d)]??Math[_0x195b6e(0x23e,0x29e)](..._0x460d73['udata']),_0x460d73['U']['max']=_0x460d73[_0x195b6e(0x238,0x23a)]??Math['max'](..._0x460d73['udata']),_0x460d73['V']={},_0x460d73['V'][_0x1293b6(0x694,0x62b)]=new Float32Array(_0x460d73['vdata']),_0x460d73['V'][_0x1293b6(0x62f,0x5fe)]=_0x460d73['vmin']??Math[_0x195b6e(0x2e0,0x29e)](..._0x460d73[_0x1293b6(0x649,0x64f)]),_0x460d73['V']['max']=_0x460d73[_0x1293b6(0x529,0x56c)]??Math[_0x195b6e(0x279,0x25a)](..._0x460d73[_0x1293b6(0x5ca,0x64f)]));this[_0x195b6e(0x1ce,0x212)]=_0x460d73;function _0x195b6e(_0x5340da,_0x3fc58a){return _0x58f7a9(_0x5340da,_0x3fc58a-0x1a3);}this['options']=_0x22b655,this['viewerParameters']=_0x1d3a63;function _0x1293b6(_0x2865f0,_0x5ae1f1){return _0x47128b(_0x2865f0,_0x5ae1f1-0x577);}this['particlesComputing']=new ParticlesComputing(this['context'],this[_0x1293b6(0x5a4,0x572)],this[_0x1293b6(0x5d4,0x5ab)],this[_0x195b6e(0x1ec,0x205)]),this['particlesRendering']=new ParticlesRendering(this['context'],this[_0x1293b6(0x5fd,0x572)],this[_0x195b6e(0x213,0x24b)],this[_0x1293b6(0x55f,0x565)],this[_0x1293b6(0x5dc,0x552)]);}[_0x47128b(0x5c,0x76)](_0x361a04){this['particlesComputing']['destroyParticlesTextures'](),Object['keys'](this['particlesComputing'][_0x5d2079(0x15b,0x1bb)])['forEach'](_0x259a60=>{function _0x2625ff(_0x12c8d1,_0x9629e1){return _0x5d2079(_0x9629e1,_0x12c8d1-0x333);}this['particlesComputing'][_0x2625ff(0x4ee,0x54c)][_0x259a60]['destroy']();}),this['particlesRendering'][_0x32bfd9(0x50b,0x4c1)][_0x5d2079(0x22e,0x1e7)]['destroy'](),Object[_0x5d2079(0x1d0,0x1a2)](this['particlesRendering'][_0x32bfd9(0x533,0x51e)])['forEach'](_0x343828=>{function _0x5deab0(_0x35d09f,_0x20b52c){return _0x32bfd9(_0x35d09f,_0x20b52c- -0x4cf);}this['particlesRendering'][_0x5deab0(0x15,0x4f)][_0x343828]['destroy']();}),this['context']=_0x361a04;function _0x5d2079(_0x3fe769,_0x338957){return _0x47128b(_0x3fe769,_0x338957-0xfd);}function _0x32bfd9(_0x36e99d,_0x13431e){return _0x58f7a9(_0x36e99d,_0x13431e-0x3bb);}this['particlesComputing']=new ParticlesComputing(this[_0x32bfd9(0x3bc,0x44b)],this[_0x32bfd9(0x401,0x42a)],this['options'],this['viewerParameters']),this[_0x32bfd9(0x459,0x453)]=new ParticlesRendering(this[_0x32bfd9(0x456,0x44b)],this['data'],this['options'],this[_0x5d2079(0x16a,0xeb)],this['particlesComputing']);}['clearFramebuffers'](){const _0x190bbd=new Cesium$2[(_0x26b02a(0x272,0x1ee))]({'color':new Cesium$2[(_0x26b02a(0x20e,0x257))](0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':undefined,'pass':Cesium$2[_0x26b02a(0x215,0x25b)][_0x3c2a57(0x3be,0x34b)]});function _0x26b02a(_0x330413,_0x42e2dc){return _0x58f7a9(_0x330413,_0x42e2dc-0x183);}function _0x3c2a57(_0x825125,_0x15826a){return _0x47128b(_0x825125,_0x15826a-0x324);}Object[_0x3c2a57(0x420,0x3c9)](this[_0x3c2a57(0x2e8,0x348)]['framebuffers'])[_0x26b02a(0x2d4,0x2c1)](_0x4e86dc=>{_0x190bbd['framebuffer']=this['particlesRendering']['framebuffers'][_0x4e86dc],_0x190bbd['execute'](this['context']);});}['refreshParticles'](_0x540f23){this[_0x2d55db(0x5f7,0x587)](),this[_0x5dd78f(-0x271,-0x22a)]['destroyParticlesTextures']();function _0x2d55db(_0x2ec99f,_0x1598b){return _0x58f7a9(_0x1598b,_0x2ec99f-0x4e8);}function _0x5dd78f(_0x41bdb7,_0x33d747){return _0x47128b(_0x41bdb7,_0x33d747- -0x205);}this['particlesComputing'][_0x2d55db(0x593,0x537)](this[_0x2d55db(0x578,0x55f)],this['options'],this[_0x5dd78f(-0x1b2,-0x217)]);if(_0x540f23){var _0x478790;const _0xb8a40c=this['particlesRendering']['createSegmentsGeometry'](this['options']);this['particlesRendering']['primitives'][_0x2d55db(0x563,0x53a)][_0x5dd78f(-0x210,-0x1d0)]=_0xb8a40c;const _0x4ceed0=Cesium$2[_0x5dd78f(-0x10e,-0x146)][_0x2d55db(0x55a,0x59b)]({'context':this[_0x2d55db(0x578,0x4f8)],'geometry':_0xb8a40c,'attributeLocations':this[_0x2d55db(0x580,0x4f4)][_0x5dd78f(-0x183,-0x124)][_0x2d55db(0x563,0x56f)]['attributeLocations'],'bufferUsage':Cesium$2['BufferUsage']['STATIC_DRAW']});(_0x478790=this[_0x5dd78f(-0x255,-0x1e1)]['primitives'])!==null&&_0x478790!==void 0x0&&(_0x478790=_0x478790[_0x2d55db(0x563,0x5d6)])!==null&&_0x478790!==void 0x0&&_0x478790['commandToExecute']&&(this[_0x5dd78f(-0x165,-0x1e1)]['primitives'][_0x5dd78f(-0x1ce,-0x1fe)]['commandToExecute'][_0x2d55db(0x597,0x58c)]=_0x4ceed0);}}['setOptions'](_0x27ef2f){let _0x5d5063=![];function _0xcf9e33(_0x409bcb,_0x157f63){return _0x58f7a9(_0x157f63,_0x409bcb- -0x8c);}this[_0xcf9e33(0x1c,0x56)][_0xcf9e33(0xbf,0xf7)]!==_0x27ef2f['maxParticles']&&(_0x5d5063=!![]);Object['keys'](_0x27ef2f)['forEach'](_0xff0628=>{this['options'][_0xff0628]=_0x27ef2f[_0xff0628];});function _0x161651(_0x175337,_0x1b0e6a){return _0x58f7a9(_0x1b0e6a,_0x175337- -0xb7);}this[_0xcf9e33(0x86,0x103)](_0x5d5063);}['applyViewerParameters'](_0x254bdd){Object['keys'](_0x254bdd)[_0x54a659(0x1aa,0x198)](_0x4b2fed=>{this['viewerParameters'][_0x4b2fed]=_0x254bdd[_0x4b2fed];});function _0x54a659(_0x3b9848,_0x537147){return _0x58f7a9(_0x537147,_0x3b9848-0x6c);}function _0x1c5a12(_0x292454,_0x2fc042){return _0x47128b(_0x2fc042,_0x292454-0x1b0);}this[_0x1c5a12(0x24e,0x213)](![]);}['destroy'](){function _0x3684db(_0x592d52,_0x14541e){return _0x58f7a9(_0x14541e,_0x592d52- -0xbc);}clearTimeout(this['canrefresh']),this[_0x3684db(-0x6d,-0x37)][_0xafd697(0x69,0x1)](),Object[_0x3684db(0x5d,0xe1)](this['particlesComputing']['windTextures'])[_0x3684db(0x82,0xb1)](_0x1aaae1=>{function _0x59066f(_0x49d5e8,_0xbc4789){return _0x3684db(_0x49d5e8-0x244,_0xbc4789);}this['particlesComputing'][_0x59066f(0x2ba,0x257)][_0x1aaae1]['destroy']();}),this['particlesRendering']['textures']['colorTable']['destroy'](),Object[_0x3684db(0x5d,-0x13)](this[_0xafd697(0x45,0xd0)]['framebuffers'])['forEach'](_0x3f89b4=>{this['particlesRendering']['framebuffers'][_0x3f89b4]['destroy']();});function _0xafd697(_0xd5bf05,_0xebc82){return _0x58f7a9(_0xebc82,_0xd5bf05- -0x53);}for(const _0x1f6bb7 in this){delete this[_0x1f6bb7];}}}const Cesium$1=mars3d__namespace['Cesium'],BaseLayer$1=mars3d__namespace['layer']['BaseLayer'],_0x4dbe1a={};_0x4dbe1a['particlesNumber']=0x1000,_0x4dbe1a[_0x47128b(0x63,0x59)]=0x0,_0x4dbe1a[_0x58f7a9(0x12d,0xa6)]=0.996,_0x4dbe1a['dropRate']=0.003,_0x4dbe1a[_0x47128b(0x50,0x67)]=0.01,_0x4dbe1a[_0x47128b(0xb0,0xcc)]=0.5,_0x4dbe1a['lineWidth']=0x2,_0x4dbe1a['colors']=[_0x47128b(0x126,0xc6)];const DEF_OPTIONS=_0x4dbe1a;class WindLayer extends BaseLayer$1{constructor(_0x214325={}){_0x214325={...DEF_OPTIONS,..._0x214325};function _0xd5cb56(_0x422cc8,_0x13e3f6){return _0x47128b(_0x422cc8,_0x13e3f6-0x33a);}super(_0x214325),this[_0xd5cb56(0x469,0x3e1)](_0x214325);}get['layer'](){function _0x4feb93(_0x53d607,_0x5900aa){return _0x47128b(_0x53d607,_0x5900aa-0x199);}return this[_0x4feb93(0x264,0x27a)];}get['data'](){function _0x59c097(_0x200191,_0x2979a8){return _0x58f7a9(_0x2979a8,_0x200191- -0x1d1);}return this[_0x59c097(-0xec,-0xa2)];}set[_0x58f7a9(0xd6,0x6f)](_0x3f2833){this['setData'](_0x3f2833);}get['colors'](){function _0x47ab20(_0x51bd67,_0x1850b9){return _0x47128b(_0x1850b9,_0x51bd67-0x4);}return this[_0x47ab20(0x38,0x72)]['colors'];}set['colors'](_0xbf34db){this['options'][_0x2729b0(-0x1ad,-0x15f)]=_0xbf34db;function _0x4c7929(_0x2afbc8,_0x115820){return _0x47128b(_0x115820,_0x2afbc8-0x56a);}if(this[_0x4c7929(0x589,0x5d6)]){const _0x27aa09={};_0x27aa09[_0x2729b0(-0x16c,-0x15f)]=_0xbf34db,this[_0x4c7929(0x589,0x60e)]['setOptions'](_0x27aa09);}function _0x2729b0(_0x37267e,_0x427cfb){return _0x47128b(_0x37267e,_0x427cfb- -0x16f);}this['resize']();}[_0x47128b(0x8f,0xed)](){}['_addedHook'](){this[_0x51ca69(0x4d,0x70)]=this['_map'][_0x5be545(0x28c,0x2ac)],this['camera']=this[_0x51ca69(-0x77,-0xe3)][_0x51ca69(-0xac,-0xe0)];function _0x5be545(_0x625fce,_0x159555){return _0x58f7a9(_0x625fce,_0x159555-0x15f);}function _0x51ca69(_0x298c0d,_0x76f757){return _0x47128b(_0x76f757,_0x298c0d- -0x8c);}this['primitives']=new Cesium$1[(_0x51ca69(0x1f,0xab))](),this['_map']['scene'][_0x5be545(0x24d,0x2b4)][_0x5be545(0x1da,0x248)](this['primitives']),this['viewerParameters']={'lonRange':new Cesium$1['Cartesian2'](),'latRange':new Cesium$1[(_0x51ca69(-0x9c,-0xfe))](),'pixelSize':0x0},this[_0x51ca69(-0xab,-0x11d)]=new Cesium$1[(_0x51ca69(-0x81,-0x67))](Cesium$1[_0x51ca69(-0x4f,0x25)][_0x51ca69(-0x92,-0xcf)],0.99*0x615299),this['updateViewerParameters'](),window['addEventListener']('resize',this['resize']['bind'](this),![]),this[_0x51ca69(-0x2,-0x68)]=![],this['mouse_move']=![],this['_map']['on'](mars3d__namespace['EventType']['wheel'],this['_onMapWhellEvent'],this),this['_map']['on'](mars3d__namespace['EventType']['mouseDown'],this['_onMouseDownEvent'],this),this[_0x51ca69(-0x77,-0x61)]['on'](mars3d__namespace[_0x5be545(0x250,0x2a9)]['mouseUp'],this[_0x5be545(0x298,0x256)],this),this['_map']['on'](mars3d__namespace['EventType']['mouseMove'],this[_0x5be545(0x22b,0x280)],this),this['_data']&&this['setData'](this['_data']);}[_0x58f7a9(0x117,0xbd)](){window['removeEventListener']('resize',this[_0x2b81ee(0x50f,0x4b7)]),this['_map'][_0x38df75(0x86,0x13)](mars3d__namespace['EventType'][_0x38df75(0xbf,0x119)],this[_0x2b81ee(0x4bc,0x4ac)],this),this[_0x2b81ee(0x483,0x4d8)]['off'](mars3d__namespace[_0x38df75(0x159,0x133)][_0x38df75(0xa1,0x54)],this['_onMapWhellEvent'],this),this[_0x2b81ee(0x483,0x4fb)]['off'](mars3d__namespace[_0x38df75(0x159,0x169)][_0x2b81ee(0x4eb,0x505)],this[_0x38df75(0x158,0x159)],this),this[_0x38df75(0x98,0x36)]['off'](mars3d__namespace['EventType']['mouseUp'],this['_onMouseUpEvent'],this),this['_map']['off'](mars3d__namespace['EventType']['mouseMove'],this[_0x2b81ee(0x51b,0x5a3)],this),this['primitives'][_0x38df75(0x132,0x144)]();function _0x38df75(_0x151594,_0x5da1e5){return _0x58f7a9(_0x5da1e5,_0x151594-0xf);}function _0x2b81ee(_0x4f7f70,_0x52a736){return _0x47128b(_0x52a736,_0x4f7f70-0x46e);}this['_map'][_0x2b81ee(0x547,0x4f1)][_0x2b81ee(0x54f,0x4c3)]['remove'](this[_0x38df75(0x164,0x1d7)]);}['resize'](){if(!this[_0x3990aa(0x4ce,0x476)]||!this[_0x265840(0x5c7,0x541)])return;function _0x265840(_0x5df7dc,_0x4c64b5){return _0x47128b(_0x5df7dc,_0x4c64b5-0x522);}this['primitives']['show']=![];function _0x3990aa(_0x9a0608,_0x3f1da3){return _0x58f7a9(_0x3f1da3,_0x9a0608-0x3c2);}this['primitives'][_0x3990aa(0x4e5,0x457)](),this[_0x3990aa(0x44b,0x3de)]['once'](mars3d__namespace['EventType'][_0x265840(0x56d,0x55e)],this['_onMap_preRenderEvent'],this);}[_0x47128b(0xa4,0x4e)](_0x20c13d){function _0x56bfd2(_0x5d3094,_0x1603b3){return _0x47128b(_0x5d3094,_0x1603b3-0x2e6);}this['particleSystem'][_0x56bfd2(0x345,0x35c)](this['scene']['context']),this['addPrimitives'](),this['primitives']['show']=!![];}[_0x58f7a9(0x13e,0x15f)](_0x805a2f){clearTimeout(this['refreshTimer']);function _0x4e1403(_0x5d353f,_0x2b4903){return _0x58f7a9(_0x2b4903,_0x5d353f-0x249);}if(!this['show']||!this['particleSystem'])return;this['primitives'][_0x21f760(0x2d7,0x314)]=![];function _0x21f760(_0x5eaa32,_0x389f60){return _0x58f7a9(_0x5eaa32,_0x389f60-0x208);}this[_0x4e1403(0x2d6,0x2bd)]=setTimeout(()=>{function _0x45db46(_0x2d9ce1,_0x4a1f56){return _0x21f760(_0x4a1f56,_0x2d9ce1-0x2c7);}if(!this[_0x45db46(0x5db,0x604)])return;function _0x36b67c(_0x3a1a4d,_0x400e8a){return _0x21f760(_0x3a1a4d,_0x400e8a- -0x2cf);}this[_0x45db46(0x606,0x665)]();},0xc8);}['_onMouseDownEvent'](_0x5f1515){this['mouse_down']=!![];}['_onMouseMoveEvent'](_0x22f0c4){function _0x41b348(_0x1b40bc,_0x433da6){return _0x47128b(_0x1b40bc,_0x433da6-0x50);}function _0x3bfc4a(_0x261f3d,_0x550764){return _0x47128b(_0x550764,_0x261f3d-0x34d);}if(!this['show']||!this['particleSystem'])return;this[_0x3bfc4a(0x3d7,0x3aa)]&&(this['primitives'][_0x3bfc4a(0x3e5,0x368)]=![],this[_0x3bfc4a(0x387,0x3c8)]=!![]);}[_0x58f7a9(0xf9,0xf7)](_0x4030e2){if(!this[_0x36049c(-0xe7,-0xbf)]||!this['particleSystem'])return;this[_0x36049c(-0xf5,-0xb6)]&&this[_0x2c6967(-0x16f,-0x196)]&&this['redraw']();function _0x2c6967(_0x2bc8e3,_0x4c2bca){return _0x47128b(_0x4c2bca,_0x2bc8e3- -0x1a9);}this['primitives'][_0x2c6967(-0x111,-0x92)]=!![],this[_0x36049c(-0xf5,-0xff)]=![];function _0x36049c(_0x4edd66,_0x26b16c){return _0x47128b(_0x26b16c,_0x4edd66- -0x17f);}this['mouse_move']=![];}['redraw'](){function _0x3fc745(_0x76a319,_0x512101){return _0x47128b(_0x76a319,_0x512101-0x43c);}if(!this['_map']||!this[_0x1114c2(0x19e,0x1e8)])return;this[_0x3fc745(0x40e,0x415)]();function _0x1114c2(_0x30641f,_0x26aa3b){return _0x58f7a9(_0x30641f,_0x26aa3b-0xdc);}this['particleSystem']['applyViewerParameters'](this['viewerParameters']),this['primitives'][_0x3fc745(0x4a7,0x4d4)]=!![];}['setData'](_0x22e206){function _0x9892da(_0x1a41f5,_0x2b3dfb){return _0x58f7a9(_0x2b3dfb,_0x1a41f5- -0x75);}this['_data']=_0x22e206;function _0x447813(_0x496159,_0x21f34a){return _0x58f7a9(_0x21f34a,_0x496159-0x37b);}this['particleSystem']&&this[_0x9892da(0x1e,0x8f)]['destroy'](),this['particleSystem']=new ParticleSystem(this['scene'][_0x9892da(0x1b,0xaa)],_0x22e206,this['getOptions'](),this['viewerParameters']),this['addPrimitives']();}[_0x47128b(0xee,0xa7)](_0x4867ff,_0x344b4b){if(_0x4867ff)for(const _0xa7dea9 in _0x4867ff){this[_0xa7dea9]=_0x4867ff[_0xa7dea9];}this['particleSystem']&&this['particleSystem']['setOptions'](this['getOptions']());}['getOptions'](){const _0x2d5d63=Math['ceil'](Math['sqrt'](this['particlesNumber']));this[_0x340c0b(-0x5a,0x1d)]=_0x2d5d63*_0x2d5d63;const _0xf6c49e={};_0xf6c49e['particlesTextureSize']=_0x2d5d63,_0xf6c49e['maxParticles']=this['particlesNumber'],_0xf6c49e['particleHeight']=this['fixedHeight'],_0xf6c49e['fadeOpacity']=this[_0x340c0b(-0x67,-0x95)];function _0x340c0b(_0x34b8a3,_0x21c02a){return _0x47128b(_0x34b8a3,_0x21c02a- -0xc7);}_0xf6c49e['dropRate']=this[_0x59cdf3(0x2a9,0x30c)],_0xf6c49e[_0x340c0b(-0xe5,-0x60)]=this[_0x340c0b(-0x92,-0x60)],_0xf6c49e[_0x340c0b(0x28,0x5)]=this['speedFactor'],_0xf6c49e['lineWidth']=this['lineWidth'];function _0x59cdf3(_0x2073ee,_0x3f66b0){return _0x58f7a9(_0x3f66b0,_0x2073ee-0x1e0);}return _0xf6c49e['colors']=this['colors'],_0xf6c49e;}['addPrimitives'](){function _0xf0a55a(_0x5013c7,_0x39be76){return _0x58f7a9(_0x5013c7,_0x39be76-0xe9);}this['primitives'][_0xf0a55a(0x157,0x1d2)](this['particleSystem'][_0xf0a55a(0x125,0x138)][_0xf0a55a(0x226,0x23e)]['getWind']),this[_0xf0a55a(0x215,0x23e)][_0xf0a55a(0x1ec,0x1d2)](this['particleSystem']['particlesComputing']['primitives']['updateSpeed']),this['primitives']['add'](this[_0x14969e(0x15,0x80)]['particlesComputing'][_0x14969e(0xd7,0xdd)][_0xf0a55a(0x203,0x1be)]);function _0x14969e(_0x1a3a29,_0x1d40df){return _0x58f7a9(_0x1d40df,_0x1a3a29- -0x7e);}this['primitives']['add'](this['particleSystem'][_0xf0a55a(0x117,0x138)]['primitives'][_0xf0a55a(0x109,0x159)]),this[_0x14969e(0xd7,0x124)][_0xf0a55a(0x17d,0x1d2)](this['particleSystem'][_0x14969e(-0x2f,0x1e)]['primitives']['postProcessingSpeed']),this['primitives']['add'](this[_0x14969e(0x15,0x88)]['particlesRendering'][_0x14969e(0xd7,0x15b)]['segments']),this['primitives']['add'](this['particleSystem'][_0xf0a55a(0x1bc,0x181)][_0xf0a55a(0x29e,0x23e)]['trails']),this['primitives']['add'](this[_0xf0a55a(0x16c,0x17c)]['particlesRendering']['primitives']['screen']);}['updateViewerParameters'](){let _0x1a0b2f=this['camera'][_0x3fb5fa(0x542,0x4cc)](this['scene']['globe']['ellipsoid']);if(!_0x1a0b2f){const _0x4ca189=this['_map'][_0x3fb5fa(0x512,0x579)]();_0x1a0b2f=Cesium$1[_0x3fb5fa(0x5db,0x599)]['fromDegrees'](_0x4ca189[_0x3fb5fa(0x567,0x4f3)],_0x4ca189['ymin'],_0x4ca189[_0x3fb5fa(0x5f8,0x62c)],_0x4ca189['ymax']);}const _0x28c561=Util[_0x3fb5fa(0x5ec,0x58d)](_0x1a0b2f);this[_0x4f2f71(0x18,-0x2b)]['lonRange']['x']=_0x28c561['lon'][_0x4f2f71(0xa3,0x6e)],this[_0x4f2f71(-0x17,-0x2b)]['lonRange']['y']=_0x28c561['lon'][_0x3fb5fa(0x55d,0x598)];function _0x4f2f71(_0x3ed9a3,_0x1b83cf){return _0x47128b(_0x3ed9a3,_0x1b83cf- -0x19);}function _0x3fb5fa(_0x291f60,_0x2458f7){return _0x47128b(_0x2458f7,_0x291f60-0x51a);}this['viewerParameters'][_0x3fb5fa(0x4f6,0x4c6)]['x']=_0x28c561['lat']['min'],this[_0x3fb5fa(0x508,0x49e)][_0x3fb5fa(0x4f6,0x513)]['y']=_0x28c561[_0x3fb5fa(0x56b,0x51f)][_0x4f2f71(0x40,0x2a)];const _0x4ad0ee=this['camera'][_0x3fb5fa(0x5e5,0x556)](this['globeBoundingSphere'],this[_0x3fb5fa(0x5f3,0x60f)]['drawingBufferWidth'],this['scene']['drawingBufferHeight']);_0x4ad0ee>0x0&&(this[_0x4f2f71(-0x80,-0x2b)][_0x4f2f71(0x135,0xd0)]=_0x4ad0ee);}}mars3d__namespace[_0x47128b(-0x3f,0x40)]['register']('wind',WindLayer),mars3d__namespace['layer']['WindLayer']=WindLayer;class CanvasParticle{constructor(){this[_0x363fb2(-0x133,-0x103)]=null;function _0x478415(_0x3a7882,_0x5b299a){return _0x58f7a9(_0x3a7882,_0x5b299a-0x33c);}this[_0x478415(0x3b2,0x401)]=null,this[_0x363fb2(-0x1af,-0x1b9)]=null,this[_0x363fb2(-0xd3,-0x7b)]=null,this[_0x363fb2(-0x1d0,-0x255)]=null;function _0x363fb2(_0x4629da,_0xe799){return _0x58f7a9(_0xe799,_0x4629da- -0x22c);}this['speed']=null;}['destroy'](){for(const _0x30e554 in this){delete this[_0x30e554];}}}function _0x295d(){const _0x2aff05=['LINEAR','reverseY','currentParticlesPosition','clientHeight','nextParticlesPosition','destroyObject','autoClear','windTextures','VertexArray','dimension','Rectangle','levmax','redraw','createTexture','interval','rgb(206,255,255)','SCENE3D','speedRate','_canrefresh','forEach','getPixelSize','speedFactor','STATIC_DRAW','RGBA','width','Sampler','getRandomLatLng','viewRectangleToLonLatRange','ymin','enabled','_onMouseDownEvent','EventType','maxParticles','vdata','scene','setOptions','IDENTITY','772212BBPoyi','mouseHidden','xmax','15374KukcSg','_maxAge','primitives','createFramebuffer','maxAge','particlesNumber','tlat','1204405BRBOfF','currentTrails','pow','pixelSize','colorTable','_onMapWhellEvent','PixelFormat','_mountedHook','nextParticlesSpeed','framebuffers','nextTrails','ymax','getParticles','SceneMode','createComputingPrimitives','_drawLines','createRenderingTextures','_colorRamp','updateViewerParameters','createRenderingFramebuffers','particlesComputing','latRange','getDirection','particles','_randomParticle','camera','globeBoundingSphere','speed','DrawCommand','_createCanvas','frameTime','createRenderingPrimitives','9LduHuJ','age','in\x20vec3\x20position;\x0ain\x20vec2\x20st;\x0a\x0aout\x20vec2\x20textureCoordinate;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20textureCoordinate\x20=\x20st;\x0a\x20\x20\x20\x20gl_Position\x20=\x20vec4(position,\x201.0);\x0a}\x0a','postMessage','WindUtil','ColorRamp','clientWidth','viewerParameters','push','Cartesian2','get','rawRenderState','rows','particlesTextures','vmax','sources','ClearCommand','getExtent','uniform\x20sampler2D\x20currentParticlesPosition;\x20//\x20(lon,\x20lat,\x20lev)\x0auniform\x20sampler2D\x20currentParticlesSpeed;\x20//\x20(u,\x20v,\x20w,\x20normalization)\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avec2\x20lengthOfLonLat(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20unit\x20conversion:\x20meters\x20->\x20longitude\x20latitude\x20degrees\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Geographic_coordinate_system#Length_of_a_degree\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20the\x20length\x20of\x20a\x20degree\x20of\x20latitude\x20and\x20longitude\x20in\x20meters\x0a\x20\x20\x20\x20float\x20latitude\x20=\x20radians(lonLatLev.y);\x0a\x0a\x20\x20\x20\x20float\x20term1\x20=\x20111132.92;\x0a\x20\x20\x20\x20float\x20term2\x20=\x20559.82\x20*\x20cos(2.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20term3\x20=\x201.175\x20*\x20cos(4.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20term4\x20=\x200.0023\x20*\x20cos(6.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20latLength\x20=\x20term1\x20-\x20term2\x20+\x20term3\x20-\x20term4;\x0a\x0a\x20\x20\x20\x20float\x20term5\x20=\x20111412.84\x20*\x20cos(latitude);\x0a\x20\x20\x20\x20float\x20term6\x20=\x2093.5\x20*\x20cos(3.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20term7\x20=\x200.118\x20*\x20cos(5.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20longLength\x20=\x20term5\x20-\x20term6\x20+\x20term7;\x0a\x0a\x20\x20\x20\x20return\x20vec2(longLength,\x20latLength);\x0a}\x0a\x0avoid\x20updatePosition(vec3\x20lonLatLev,\x20vec3\x20speed)\x20{\x0a\x20\x20\x20\x20vec2\x20lonLatLength\x20=\x20lengthOfLonLat(lonLatLev);\x0a\x20\x20\x20\x20float\x20u\x20=\x20speed.x\x20/\x20lonLatLength.x;\x0a\x20\x20\x20\x20float\x20v\x20=\x20speed.y\x20/\x20lonLatLength.y;\x0a\x20\x20\x20\x20float\x20w\x20=\x200.0;\x0a\x20\x20\x20\x20vec3\x20windVectorInLonLatLev\x20=\x20vec3(u,\x20v,\x20w);\x0a\x0a\x20\x20\x20\x20vec3\x20nextParticle\x20=\x20lonLatLev\x20+\x20windVectorInLonLatLev;\x0a\x0a\x20\x20\x20\x20out_FragColor\x20=\x20vec4(nextParticle,\x200.0);\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20\x20\x20vec3\x20lonLatLev\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rgb;\x0a\x20\x20\x20\x20vec3\x20speed\x20=\x20texture(currentParticlesSpeed,\x20v_textureCoordinates).rgb;\x0a\x0a\x20\x20\x20\x20updatePosition(lonLatLev,\x20speed);\x0a}\x0a','ZERO','data','postProcessingPosition','ellipsoid','fromGeometry','attributeLocations','CanvasWindField','EllipsoidalOccluder','3518776qLeQVO','off','initWorker','hidden','umin','segments','UNSIGNED_BYTE','tlng','currentTrailsDepth','BoundingSphere','zIndex','canvasContext','preExecute','create','colors','Matrix4','uniform\x20sampler2D\x20trailsColorTexture;\x0auniform\x20sampler2D\x20trailsDepthTexture;\x0a\x0ain\x20vec2\x20textureCoordinate;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec4\x20trailsColor\x20=\x20texture(trailsColorTexture,\x20textureCoordinate);\x0a\x20\x20\x20\x20float\x20trailsDepth\x20=\x20texture(trailsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20\x20\x20float\x20globeDepth\x20=\x20czm_unpackDepth(texture(czm_globeDepthTexture,\x20textureCoordinate));\x0a\x0a\x20\x20\x20\x20if\x20(trailsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20trailsColor;\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20}\x0a}\x0a','outputTexture','lineWidth','_map','layer','setGeometry','uniformMap','refreshTimer','Draw','getWind','context','Compute','wheel','particleSystem','style','owner','default','umax','particlesRendering','ShaderSource','FLOAT','OPAQUE','computeViewRectangle','mouseUp','length','3649737Olbjpc','TextureMagnificationFilter','udata','particlesTextureSize','getFullscreenQuad','container','clampToLatitudeRange','fadeOpacity','shaderProgram','options','geometry','round','createParticlesTextures','_updateIng2','mouseMove','mouse_move','vertexArray','preRender','Cartesian3','setDate','init','LayerUtil','GeometryAttributes','currentParticlesSpeed','max','pixelFormat','segmentsColor','depthTexture','height','destroyParticlesTextures','_removedHook','windField','persists','PixelDatatype','xmin','_onMap_preRenderEvent','lonRange','all','lat','framebuffer','drawingBufferWidth','fragmentShaderSource','dropRate','isInExtent','NEAREST','toDegrees','fixedHeight','abs','_updateIng','grid','now','segmentsDepth','setData','Color','updatePosition','green','position','Pass','type','lev','dropRateBump','willReadFrequently','globalAlpha','random','clear','lon','randomizeParticles','canvas','getUVByPoint','_tomap','_data','cols','_calcUV','defined','add','canvasResize','ComponentDatatype','THREE_PI_OVER_TWO','sin','lighter','canvasWidth','isPointVisible','mouseDown','Math','primitiveType','4OKGJxq','strokeStyle','DISABLE_LOG_DEPTH_FRAGMENT_WRITE','_onMouseUpEvent','color','lng','postProcessingSpeed','min','getColor','destroy','mouse_down','defines','__proto__','west','getUVByXY','CanvasWindLayer','uniform\x20sampler2D\x20currentParticlesSpeed;\x20//\x20(u,\x20v,\x20w,\x20normalization)\x0auniform\x20sampler2D\x20particlesWind;\x0a\x0a//\x20used\x20to\x20calculate\x20the\x20wind\x20norm\x0auniform\x20vec2\x20uSpeedRange;\x20//\x20(min,\x20max);\x0auniform\x20vec2\x20vSpeedRange;\x0auniform\x20float\x20pixelSize;\x0auniform\x20float\x20speedFactor;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0afloat\x20calculateWindNorm(vec3\x20speed)\x20{\x0a\x20\x20\x20\x20vec3\x20percent\x20=\x20vec3(0.0);\x0a\x20\x20\x20\x20percent.x\x20=\x20(speed.x\x20-\x20uSpeedRange.x)\x20/\x20(uSpeedRange.y\x20-\x20uSpeedRange.x);\x0a\x20\x20\x20\x20percent.y\x20=\x20(speed.y\x20-\x20vSpeedRange.x)\x20/\x20(vSpeedRange.y\x20-\x20vSpeedRange.x);\x0a\x20\x20\x20\x20float\x20normalization\x20=\x20length(percent);\x0a\x0a\x20\x20\x20\x20return\x20normalization;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20\x20\x20//\x20vec3\x20currentSpeed\x20=\x20texture(currentParticlesSpeed,\x20v_textureCoordinates).rgb;\x0a\x20\x20\x20\x20vec3\x20windVector\x20=\x20texture(particlesWind,\x20v_textureCoordinates).rgb;\x0a\x0a\x20\x20\x20\x20vec4\x20nextSpeed\x20=\x20vec4(speedFactor\x20*\x20pixelSize\x20*\x20windVector,\x20calculateWindNorm(windVector));\x0a\x20\x20\x20\x20out_FragColor\x20=\x20nextSpeed;\x0a}\x0a','dimensions','textures','__esModule','north','mod','moveTo','RenderState','show','depthTest','toGridXY','clearFramebuffers','bindEvent','_speedRate','refreshParticles','GeometryAttribute','569547rmSrTz','resize','fromCssColorString','Cesium','drawingBufferHeight','keys','commandToExecute','_setOptionsHook','853074dvmyLV','windData','_pointerEvents','PrimitiveCollection','mode','_onMouseMoveEvent','fill','removeAll','trails','pointer-events','worker','absolute','array','clearCommand','PI_OVER_THREE'];_0x295d=function(){return _0x2aff05;};return _0x295d();}class CanvasWindField{constructor(_0xeceea8){function _0x18026d(_0x207f5f,_0x68c114){return _0x58f7a9(_0x207f5f,_0x68c114-0x190);}this[_0x18026d(0x361,0x2de)](_0xeceea8);}get['speedRate'](){function _0x4198b3(_0x46caf2,_0x58857f){return _0x47128b(_0x58857f,_0x46caf2- -0x1ac);}return this[_0x4198b3(-0x10f,-0x119)];}set['speedRate'](_0x4bfd96){function _0x3c2d16(_0x207be3,_0x564200){return _0x47128b(_0x207be3,_0x564200-0x49f);}this['_speedRate']=(0x64-(_0x4bfd96>0x63?0x63:_0x4bfd96))*0x64;function _0x308ee1(_0x147e45,_0x5c4a22){return _0x47128b(_0x5c4a22,_0x147e45-0x53d);}this['_calc_speedRate']=[(this[_0x308ee1(0x61b,0x5c4)]-this['xmin'])/this[_0x3c2d16(0x4d6,0x53c)],(this[_0x3c2d16(0x532,0x590)]-this['ymin'])/this['_speedRate']];}get['maxAge'](){return this['_maxAge'];}set['maxAge'](_0x4be549){function _0x3c119c(_0x5589a5,_0x54425f){return _0x47128b(_0x54425f,_0x5589a5- -0x7e);}this[_0x3c119c(0x62,0xd9)]=_0x4be549;}[_0x47128b(0x90,0xda)](_0x1d1eec){this['options']=_0x1d1eec;function _0x1822de(_0x50d081,_0x8f6d20){return _0x58f7a9(_0x8f6d20,_0x50d081-0x15b);}this['maxAge']=_0x1d1eec[_0x42459c(0x24d,0x26a)]||0x78;function _0x42459c(_0x58ae12,_0x549461){return _0x58f7a9(_0x58ae12,_0x549461-0x113);}this[_0x42459c(0x2b2,0x24f)]=_0x1d1eec[_0x1822de(0x297,0x2a8)]||0x32,this['particles']=[];const _0x47f04d=_0x1d1eec[_0x42459c(0x2be,0x26b)]||0x1000;for(let _0xae1f7b=0x0;_0xae1f7b<_0x47f04d;_0xae1f7b++){const _0x474362=this['_randomParticle'](new CanvasParticle());this['particles'][_0x42459c(0x169,0x176)](_0x474362);}}[_0x58f7a9(0x111,0xb2)](_0x4115f0){this['rows']=_0x4115f0['rows'];function _0x11bb91(_0x93e32f,_0x2a05b7){return _0x47128b(_0x93e32f,_0x2a05b7-0x3e1);}this['cols']=_0x4115f0['cols'],this[_0x3445f3(0x1e5,0x227)]=_0x4115f0[_0x3445f3(0x27f,0x227)],this[_0x3445f3(0x2b5,0x2b8)]=_0x4115f0['xmax'],this['ymin']=_0x4115f0[_0x3445f3(0x336,0x2ad)],this['ymax']=_0x4115f0['ymax'],this['grid']=[];const _0x3ca338=_0x4115f0['udata'],_0x1b032d=_0x4115f0['vdata'];let _0x908447=![];_0x3ca338['length']===this['rows']&&_0x3ca338[0x0]['length']===this[_0x3445f3(0x217,0x24c)]&&(_0x908447=!![]);let _0x3b06a9=0x0,_0x3e78c7=null,_0xc5cb4d=null;function _0x3445f3(_0x3d3655,_0x2a2951){return _0x47128b(_0x3d3655,_0x2a2951-0x1da);}for(let _0x82df94=0x0;_0x82df94<this[_0x11bb91(0x405,0x3d4)];_0x82df94++){_0x3e78c7=[];for(let _0x348732=0x0;_0x348732<this['cols'];_0x348732++,_0x3b06a9++){_0x908447?_0xc5cb4d=this[_0x3445f3(0x1ce,0x24d)](_0x3ca338[_0x82df94][_0x348732],_0x1b032d[_0x82df94][_0x348732]):_0xc5cb4d=this[_0x3445f3(0x254,0x24d)](_0x3ca338[_0x3b06a9],_0x1b032d[_0x3b06a9]),_0x3e78c7['push'](_0xc5cb4d);}this['grid'][_0x3445f3(0x19d,0x1c9)](_0x3e78c7);}this['options']['reverseY']&&this['grid']['reverse']();}['clear'](){function _0x527a92(_0x508690,_0x3ed81d){return _0x47128b(_0x3ed81d,_0x508690-0x45f);}delete this['rows'];function _0x29b697(_0x1f2b40,_0x9d1e05){return _0x58f7a9(_0x1f2b40,_0x9d1e05- -0xa1);}delete this[_0x29b697(0xc2,0x45)],delete this['xmin'],delete this['xmax'],delete this[_0x527a92(0x532,0x5ae)],delete this[_0x527a92(0x550,0x5b5)],delete this['grid'],delete this['particles'];}[_0x58f7a9(0x116,0x10e)](_0x66f8eb,_0xe14020){const _0xab9d4e=(_0x66f8eb-this['xmin'])/(this['xmax']-this['xmin'])*(this['cols']-0x1),_0x471cb3=(this[_0x56203b(0x2e8,0x2cc)]-_0xe14020)/(this[_0x3f5cf7(0xea,0xdd)]-this[_0x3f5cf7(0xcc,0x73)])*(this['rows']-0x1);function _0x3f5cf7(_0x4b404e,_0x2fa1bd){return _0x47128b(_0x2fa1bd,_0x4b404e- -0x7);}function _0x56203b(_0x555cb4,_0x5ee54a){return _0x47128b(_0x5ee54a,_0x555cb4-0x1f7);}return[_0xab9d4e,_0x471cb3];}['getUVByXY'](_0x37f1e7,_0x4125ee){if(_0x37f1e7<0x0||_0x37f1e7>=this['cols']||_0x4125ee>=this['rows'])return[0x0,0x0,0x0];const _0xa10d50=Math['floor'](_0x37f1e7),_0x123c4a=Math['floor'](_0x4125ee);if(_0xa10d50===_0x37f1e7&&_0x123c4a===_0x4125ee)return this[_0x5e300c(0xfe,0x146)][_0x4125ee][_0x37f1e7];const _0x70f7d1=_0xa10d50+0x1,_0x189c58=_0x123c4a+0x1;function _0xeaeb97(_0x536aef,_0x44aaab){return _0x58f7a9(_0x536aef,_0x44aaab- -0xf3);}const _0x473c7f=this['getUVByXY'](_0xa10d50,_0x123c4a),_0x1d3b9d=this[_0xeaeb97(-0x61,0xf)](_0x70f7d1,_0x123c4a),_0x29b0da=this['getUVByXY'](_0xa10d50,_0x189c58),_0x4e6b4d=this[_0xeaeb97(-0x13,0xf)](_0x70f7d1,_0x189c58);let _0xc56583=null;try{_0xc56583=this['_bilinearInterpolation'](_0x37f1e7-_0xa10d50,_0x4125ee-_0x123c4a,_0x473c7f,_0x1d3b9d,_0x29b0da,_0x4e6b4d);}catch(_0x3dd269){console['log'](_0x37f1e7,_0x4125ee);}function _0x5e300c(_0x4e74d5,_0x35bf15){return _0x58f7a9(_0x4e74d5,_0x35bf15-0x76);}return _0xc56583;}['_bilinearInterpolation'](_0x9ab5e1,_0x1484e9,_0x52f90a,_0x402e5f,_0x186a17,_0x162222){const _0x2fda87=0x1-_0x9ab5e1,_0x95ea8b=0x1-_0x1484e9,_0x427f54=_0x2fda87*_0x95ea8b,_0x5e2eac=_0x9ab5e1*_0x95ea8b,_0x186a4c=_0x2fda87*_0x1484e9,_0x3c241d=_0x9ab5e1*_0x1484e9,_0x153a26=_0x52f90a[0x0]*_0x427f54+_0x402e5f[0x0]*_0x5e2eac+_0x186a17[0x0]*_0x186a4c+_0x162222[0x0]*_0x3c241d,_0x43c1fb=_0x52f90a[0x1]*_0x427f54+_0x402e5f[0x1]*_0x5e2eac+_0x186a17[0x1]*_0x186a4c+_0x162222[0x1]*_0x3c241d;return this['_calcUV'](_0x153a26,_0x43c1fb);}['_calcUV'](_0x14d5f7,_0x337470){return[+_0x14d5f7,+_0x337470,Math['sqrt'](_0x14d5f7*_0x14d5f7+_0x337470*_0x337470)];}[_0x58f7a9(0xd0,0xe3)](_0x179c39,_0x2dd839){if(!this['isInExtent'](_0x179c39,_0x2dd839))return null;function _0x363f53(_0x1209e3,_0x33b74a){return _0x58f7a9(_0x33b74a,_0x1209e3- -0x1cb);}const _0x3da611=this[_0x363f53(-0xbd,-0x35)](_0x179c39,_0x2dd839),_0x3baaa9=this['getUVByXY'](_0x3da611[0x0],_0x3da611[0x1]);return _0x3baaa9;}[_0x47128b(0x5e,0x56)](_0x3457da,_0x3e09d5){function _0x7001b6(_0x2b1b20,_0x3a1ebd){return _0x58f7a9(_0x2b1b20,_0x3a1ebd-0x21e);}return _0x3457da>=this['xmin']&&_0x3457da<=this[_0x7001b6(0x350,0x370)]&&_0x3e09d5>=this['ymin']&&_0x3e09d5<=this['ymax']?!![]:![];}['getRandomLatLng'](){const _0x182cf3=fRandomByfloat(this['xmin'],this[_0x36d360(-0x58,-0x7)]);function _0x36d360(_0x8b13d9,_0x577311){return _0x58f7a9(_0x8b13d9,_0x577311- -0x159);}const _0x300fb3=fRandomByfloat(this[_0x36d360(0x6b,-0x12)],this['ymax']),_0x1044db={};function _0x586441(_0x299e86,_0x24bd61){return _0x58f7a9(_0x24bd61,_0x299e86-0x15b);}return _0x1044db[_0x586441(0x220,0x1ef)]=_0x300fb3,_0x1044db['lng']=_0x182cf3,_0x1044db;}[_0x47128b(0x8c,0xf2)](){let _0x5b9e34,_0x20bace,_0x223f6d;function _0x3fecec(_0x1a7656,_0x2bab17){return _0x47128b(_0x1a7656,_0x2bab17-0x27a);}function _0xa99b45(_0x83d373,_0x267d9f){return _0x47128b(_0x267d9f,_0x83d373-0xed);}for(let _0x3d89e5=0x0,_0x533851=this[_0xa99b45(0xcb,0x146)]['length'];_0x3d89e5<_0x533851;_0x3d89e5++){let _0x2ab58d=this[_0xa99b45(0xcb,0x53)][_0x3d89e5];_0x2ab58d[_0x3fecec(0x1d8,0x262)]<=0x0&&(_0x2ab58d=this[_0xa99b45(0xcc,0xf7)](_0x2ab58d));if(_0x2ab58d[_0xa99b45(0xd5,0x58)]>0x0){const _0x372f50=_0x2ab58d[_0x3fecec(0x27f,0x283)],_0x236e3a=_0x2ab58d['tlat'];_0x223f6d=this['getUVByPoint'](_0x372f50,_0x236e3a),_0x223f6d?(_0x5b9e34=_0x372f50+this['_calc_speedRate'][0x0]*_0x223f6d[0x0],_0x20bace=_0x236e3a+this['_calc_speedRate'][0x1]*_0x223f6d[0x1],_0x2ab58d[_0x3fecec(0x2ed,0x2ff)]=_0x372f50,_0x2ab58d[_0x3fecec(0x2e2,0x2cb)]=_0x236e3a,_0x2ab58d['tlng']=_0x5b9e34,_0x2ab58d['tlat']=_0x20bace,_0x2ab58d['speed']=_0x223f6d[0x2],_0x2ab58d['age']--):_0x2ab58d[_0x3fecec(0x1ec,0x262)]=0x0;}}return this[_0x3fecec(0x29b,0x258)];}[_0x58f7a9(-0x1d,0x53)](_0x4c4bbd){let _0x4ee722,_0x405c63;for(let _0x3c7889=0x0;_0x3c7889<0x1e;_0x3c7889++){_0x4ee722=this[_0x2f4144(0x2c7,0x26b)](),_0x405c63=this[_0x1d1093(0x511,0x491)](_0x4ee722['lng'],_0x4ee722['lat']);if(_0x405c63&&_0x405c63[0x2]>0x0)break;}if(!_0x405c63)return _0x4c4bbd;const _0x58ad97=_0x4ee722['lng']+this['_calc_speedRate'][0x0]*_0x405c63[0x0],_0x58afdf=_0x4ee722[_0x1d1093(0x4f3,0x478)]+this['_calc_speedRate'][0x1]*_0x405c63[0x1];_0x4c4bbd['lng']=_0x4ee722[_0x2f4144(0x27b,0x2cc)],_0x4c4bbd['lat']=_0x4ee722[_0x1d1093(0x4f3,0x542)],_0x4c4bbd[_0x2f4144(0x1ff,0x183)]=_0x58ad97,_0x4c4bbd[_0x2f4144(0x2db,0x2b4)]=_0x58afdf;function _0x1d1093(_0x668f25,_0x56fa47){return _0x47128b(_0x56fa47,_0x668f25-0x4a2);}function _0x2f4144(_0x98adb5,_0x293b55){return _0x47128b(_0x293b55,_0x98adb5-0x1f6);}return _0x4c4bbd[_0x2f4144(0x1de,0x23e)]=Math[_0x2f4144(0x22c,0x282)](Math['random']()*this[_0x1d1093(0x585,0x539)]),_0x4c4bbd[_0x1d1093(0x484,0x411)]=_0x405c63[0x2],_0x4c4bbd;}['destroy'](){for(const _0xfad3b7 in this){delete this[_0xfad3b7];}}}function fRandomByfloat(_0x21e5a1,_0x1e2f84){function _0x1a6cf2(_0x423690,_0x13139e){return _0x58f7a9(_0x13139e,_0x423690- -0xb6);}return _0x21e5a1+Math[_0x1a6cf2(0x28,0x22)]()*(_0x1e2f84-_0x21e5a1);}function _0x58f7a9(_0xd29e24,_0x32d155){return _0x51a7(_0x32d155- -0x16f,_0xd29e24);}const Cesium=mars3d__namespace[_0x47128b(0x24,0xa3)],BaseLayer=mars3d__namespace[_0x58f7a9(0xce,0x8a)]['BaseLayer'];function _0x51a7(_0x57a056,_0x397654){const _0x295dab=_0x295d();return _0x51a7=function(_0x51a77f,_0xf92fd2){_0x51a77f=_0x51a77f-0x1ba;let _0x108e60=_0x295dab[_0x51a77f];return _0x108e60;},_0x51a7(_0x57a056,_0x397654);}class CanvasWindLayer extends BaseLayer{constructor(_0x58f401={}){function _0x36f831(_0x2e8269,_0x157746){return _0x47128b(_0x2e8269,_0x157746-0x4e4);}super(_0x58f401);function _0x59df69(_0x26676c,_0x6651d4){return _0x58f7a9(_0x26676c,_0x6651d4-0x4d4);}this['_setOptionsHook'](_0x58f401),this[_0x36f831(0x4d5,0x552)]=null,_0x58f401['colors']&&_0x58f401['steps']&&(this['_colorRamp']=new mars3d__namespace[(_0x59df69(0x4ba,0x534))](_0x58f401));}['_setOptionsHook'](_0x2f7314,_0x5d9984){this[_0x4e423c(0x9f,0xca)]=0x3e8/(_0x2f7314['frameRate']||0xa);function _0xba192b(_0x1faaa8,_0xa4e4f6){return _0x47128b(_0xa4e4f6,_0x1faaa8-0x29e);}this['_pointerEvents']=this[_0xba192b(0x2d2,0x350)]['pointerEvents']??![],this[_0xba192b(0x322,0x325)]=_0x2f7314['color']||'#ffffff',this['lineWidth']=_0x2f7314['lineWidth']||0x1,this[_0x4e423c(0x113,0x198)]=_0x2f7314['fixedHeight']??0x0;function _0x4e423c(_0x3a90e3,_0x5c4ad6){return _0x58f7a9(_0x5c4ad6,_0x3a90e3-0x46);}this[_0xba192b(0x356,0x319)]=_0x2f7314[_0x4e423c(0x172,0x1fd)]??![],this['windField']&&this['windField']['setOptions'](_0x2f7314);}get['layer'](){function _0x5ad234(_0x48dc55,_0x1d559b){return _0x58f7a9(_0x1d559b,_0x48dc55-0x105);}return this[_0x5ad234(0x1e7,0x20f)];}get['canvasWidth'](){function _0x4445d8(_0x41e836,_0x4de194){return _0x47128b(_0x41e836,_0x4de194-0x345);}function _0x5363e9(_0x34d55b,_0x2d0c0a){return _0x47128b(_0x34d55b,_0x2d0c0a-0x82);}return this[_0x4445d8(0x327,0x35a)][_0x5363e9(0x171,0x15b)][_0x5363e9(0x146,0xf0)][_0x4445d8(0x2f8,0x332)];}get['canvasHeight'](){function _0x1cfd83(_0x5454c8,_0x5b06fe){return _0x58f7a9(_0x5454c8,_0x5b06fe- -0x1e3);}function _0x20e85e(_0x4c6a80,_0x43b06f){return _0x58f7a9(_0x43b06f,_0x4c6a80-0x3c4);}return this[_0x1cfd83(-0x1cf,-0x15a)]['scene'][_0x1cfd83(-0x90,-0x101)]['clientHeight'];}get['pointerEvents'](){function _0x200612(_0x2c0632,_0x29ebe2){return _0x47128b(_0x2c0632,_0x29ebe2- -0x74);}return this[_0x200612(0x4,0x36)];}set['pointerEvents'](_0x4ae492){function _0x3c296a(_0x561535,_0x43b74e){return _0x47128b(_0x561535,_0x43b74e- -0x1ea);}this['_pointerEvents']=_0x4ae492;if(!this['canvas'])return;function _0x213240(_0x220d08,_0x14f2e8){return _0x47128b(_0x220d08,_0x14f2e8-0x172);}_0x4ae492?this['canvas'][_0x3c296a(-0x152,-0x1ca)][_0x3c296a(-0x1c4,-0x139)]=_0x213240(0x1ea,0x1c2):this[_0x3c296a(-0x15c,-0x17c)]['style']['pointer-events']='none';}get[_0x47128b(0x146,0xe4)](){function _0x7fef78(_0x12b0bf,_0x2540f2){return _0x47128b(_0x2540f2,_0x12b0bf-0x2ae);}return this[_0x7fef78(0x2e2,0x33c)]['particlesNumber'];}set[_0x47128b(0x131,0xe4)](_0x58d434){this[_0x2f8f16(0x5d7,0x570)]['particlesNumber']=_0x58d434;function _0x59cd98(_0x2a6a89,_0x4e3195){return _0x47128b(_0x4e3195,_0x2a6a89-0xfc);}clearTimeout(this['_canrefresh']);function _0x2f8f16(_0x5f0fda,_0x38abd6){return _0x58f7a9(_0x38abd6,_0x5f0fda-0x52f);}this[_0x2f8f16(0x66c,0x68b)]=setTimeout(()=>{this['redraw']();},0x1f4);}get['speedRate'](){function _0x10bfe1(_0x2980fb,_0x25f7b5){return _0x47128b(_0x25f7b5,_0x2980fb-0x32);}return this['options'][_0x10bfe1(0xfa,0x17f)];}set['speedRate'](_0x15001f){this['options'][_0x6264cf(0x25e,0x22c)]=_0x15001f;function _0x6264cf(_0x5bac71,_0x5c7f33){return _0x58f7a9(_0x5bac71,_0x5c7f33-0xf0);}this['windField']&&(this['windField']['speedRate']=_0x15001f);}get['maxAge'](){function _0x22d85d(_0x361b3b,_0x4e9876){return _0x47128b(_0x4e9876,_0x361b3b-0x52c);}return this['options'][_0x22d85d(0x60f,0x682)];}set['maxAge'](_0x27d898){function _0x4f677b(_0x5efdf3,_0x4230ff){return _0x58f7a9(_0x5efdf3,_0x4230ff-0x448);}this['options'][_0x4f677b(0x5fc,0x59f)]=_0x27d898;function _0x43192a(_0x4e5043,_0x55123b){return _0x58f7a9(_0x55123b,_0x4e5043- -0x24c);}this[_0x43192a(-0x18e,-0x1b5)]&&(this['windField']['maxAge']=_0x27d898);}get['data'](){function _0x4ca412(_0x1e9178,_0x21702b){return _0x47128b(_0x1e9178,_0x21702b- -0x7f);}return this[_0x4ca412(0x13,0x2a)];}set[_0x58f7a9(0x19,0x6f)](_0x41145d){this['setData'](_0x41145d);}['_showHook'](_0x316982){function _0x11c407(_0x19c177,_0x15abe5){return _0x58f7a9(_0x15abe5,_0x19c177- -0x214);}function _0x3b18dc(_0x4aa37,_0x9f6b59){return _0x47128b(_0x9f6b59,_0x4aa37- -0x9a);}_0x316982?this['_addedHook']():(this[_0x11c407(-0xf7,-0xed)]&&(this['options']['data']=this[_0x11c407(-0xf7,-0xa8)]),this[_0x3b18dc(-0x51,-0x2)]());}['_mountedHook'](){function _0x5d5802(_0xe3295b,_0xdee66d){return _0x47128b(_0xdee66d,_0xe3295b- -0x110);}function _0x27523d(_0x532a6d,_0x22281e){return _0x47128b(_0x22281e,_0x532a6d-0x3b5);}this['options'][_0x27523d(0x467,0x459)]?this['initWorker']():this['windField']=new CanvasWindField(this[_0x5d5802(-0xdc,-0x71)]);}['_addedHook'](){function _0x4af4cb(_0x28cbfd,_0x753478){return _0x47128b(_0x753478,_0x28cbfd-0x1cd);}this['canvas']=this[_0x366a2b(0x269,0x2c8)]();const _0x52dcf5={};_0x52dcf5[_0x366a2b(0x30a,0x34c)]=!![],this['canvasContext']=this['canvas']['getContext']('2d',_0x52dcf5),this[_0x366a2b(0x333,0x380)]();function _0x366a2b(_0x405dc2,_0x19ec17){return _0x58f7a9(_0x405dc2,_0x19ec17-0x270);}this['options'][_0x4af4cb(0x1c8,0x1b3)]&&this[_0x366a2b(0x348,0x343)](this[_0x366a2b(0x393,0x318)]['data']);}['_removedHook'](){function _0xdbaae5(_0xed0f37,_0x5d4f09){return _0x47128b(_0xed0f37,_0x5d4f09-0x587);}this['clear']();function _0x3e2697(_0x1e1060,_0x58acc8){return _0x58f7a9(_0x1e1060,_0x58acc8-0x80);}this['unbindEvent'](),this[_0x3e2697(0x18d,0x162)]&&(this['_map']['container']['removeChild'](this[_0x3e2697(0xd5,0x162)]),delete this['canvas']);}[_0x47128b(-0x4d,-0x1c)](){const _0x1f8f94=mars3d__namespace['DomUtil'][_0xd84903(0x254,0x288)](_0x585b47(0x37b,0x313),'mars3d-canvasWind',this['_map'][_0x585b47(0x33d,0x37d)]);_0x1f8f94[_0x585b47(0x32d,0x35d)][_0x585b47(0x370,0x396)]=_0xd84903(0x2f8,0x2ed),_0x1f8f94['style']['top']='0px',_0x1f8f94[_0x585b47(0x32d,0x371)]['left']='0px',_0x1f8f94[_0x585b47(0x32d,0x32d)][_0xd84903(0x314,0x330)]=this[_0xd84903(0x25a,0x2e5)]['scene']['canvas']['clientWidth']+'px',_0x1f8f94['style']['height']=this['_map']['scene']['canvas'][_0xd84903(0x2ff,0x34c)]+'px',_0x1f8f94['style']['pointerEvents']=this['_pointerEvents']?'auto':'none';function _0xd84903(_0x11750d,_0x2ac6ff){return _0x58f7a9(_0x2ac6ff,_0x11750d-0x1d1);}_0x1f8f94['style'][_0xd84903(0x251,0x2c2)]=this[_0x585b47(0x341,0x2d6)]['zIndex']??0x9,_0x1f8f94[_0x585b47(0x3dc,0x40a)]=this[_0x585b47(0x322,0x31d)]['scene']['canvas']['clientWidth'];function _0x585b47(_0x4679d3,_0xd3b62d){return _0x58f7a9(_0xd3b62d,_0x4679d3-0x299);}return _0x1f8f94['height']=this['_map'][_0xd84903(0x31e,0x327)][_0xd84903(0x2b3,0x280)]['clientHeight'],_0x1f8f94;}[_0x47128b(0x79,0xa1)](){function _0x21d79e(_0x5c7861,_0x3f2c5e){return _0x47128b(_0x3f2c5e,_0x5c7861-0x44e);}function _0x3cffd3(_0x14b35b,_0x24f9b8){return _0x58f7a9(_0x14b35b,_0x24f9b8-0x38c);}this[_0x21d79e(0x4bc,0x460)]&&(this[_0x3cffd3(0x4d2,0x46e)][_0x21d79e(0x46e,0x465)]['width']=this[_0x3cffd3(0x485,0x415)][_0x3cffd3(0x4e7,0x4d9)][_0x3cffd3(0x45b,0x46e)][_0x3cffd3(0x3fc,0x3ed)]+'px',this['canvas']['style']['height']=this['_map']['scene']['canvas']['clientHeight']+'px',this['canvas'][_0x3cffd3(0x46f,0x4cf)]=this['_map']['scene']['canvas']['clientWidth'],this['canvas']['height']=this[_0x3cffd3(0x3da,0x415)]['scene']['canvas']['clientHeight']);}[_0x58f7a9(0x198,0x110)](){function _0x2dc447(_0xbff54a,_0x5811b6){return _0x58f7a9(_0xbff54a,_0x5811b6- -0x4e);}const _0x509b97=this;let _0x5a28d6=Date[_0x12e42f(-0x70,0xa)]();function _0x12e42f(_0x2f3498,_0x510f44){return _0x58f7a9(_0x2f3498,_0x510f44- -0xc7);}(function _0x37f40a(){function _0x395188(_0x76abb9,_0x1b0db1){return _0x12e42f(_0x76abb9,_0x1b0db1-0x20d);}function _0x1df2d0(_0x1135d7,_0x15b6f6){return _0x12e42f(_0x1135d7,_0x15b6f6-0x5ba);}_0x509b97['_animateFrame']=window['requestAnimationFrame'](_0x37f40a);if(_0x509b97[_0x395188(0x2d6,0x252)]&&_0x509b97['windField']){const _0xad8785=Date['now'](),_0x58c961=_0xad8785-_0x5a28d6;_0x58c961>_0x509b97[_0x1df2d0(0x558,0x54c)]&&(_0x5a28d6=_0xad8785-_0x58c961%_0x509b97[_0x1df2d0(0x5d5,0x54c)],_0x509b97['update']());}}(),window['addEventListener']('resize',this['resize']['bind'](this),![]),this['mouse_down']=![],this[_0x12e42f(-0x5c,-0x19)]=![],this['options']['mouseHidden']&&(this['_map']['on'](mars3d__namespace[_0x2dc447(0x8f,0xfc)]['wheel'],this[_0x2dc447(0x10a,0x111)],this),this[_0x2dc447(-0x25,0x3b)]['on'](mars3d__namespace[_0x12e42f(0xbd,0x83)][_0x12e42f(-0x3b,0x2a)],this['_onMouseDownEvent'],this),this[_0x12e42f(-0x9b,-0x3e)]['on'](mars3d__namespace['EventType'][_0x2dc447(0xbd,0x4f)],this['_onMouseUpEvent'],this)));}['unbindEvent'](){function _0x1bebfd(_0x1a39bd,_0x30f084){return _0x58f7a9(_0x1a39bd,_0x30f084-0x189);}window['cancelAnimationFrame'](this['_animateFrame']),delete this['_animateFrame'],window['removeEventListener']('resize',this[_0x1bebfd(0x305,0x29e)]);function _0x52479c(_0x50ae05,_0x4de4b8){return _0x58f7a9(_0x4de4b8,_0x50ae05-0x2c1);}this['options'][_0x1bebfd(0x328,0x2da)]&&(this['_map']['off'](mars3d__namespace['EventType']['wheel'],this['_onMapWhellEvent'],this),this['_map'][_0x1bebfd(0x26c,0x200)](mars3d__namespace['EventType'][_0x52479c(0x3b2,0x3b8)],this[_0x1bebfd(0x334,0x2d2)],this),this[_0x1bebfd(0x25d,0x212)]['off'](mars3d__namespace[_0x1bebfd(0x2a3,0x2d3)][_0x1bebfd(0x27b,0x226)],this[_0x52479c(0x3b8,0x392)],this),this['_map'][_0x1bebfd(0x277,0x200)](mars3d__namespace[_0x1bebfd(0x32d,0x2d3)]['mouseMove'],this[_0x52479c(0x3e2,0x437)],this));}[_0x47128b(0x125,0xeb)](_0xc586f2){clearTimeout(this[_0x2ddb8d(-0x13c,-0x1bd)]);if(!this['show']||!this[_0x2ddb8d(-0x19b,-0x168)])return;this['canvas']['style']['visibility']=_0x2ddb8d(-0x160,-0x1d1);function _0x364358(_0x1572d6,_0x9dcd8b){return _0x47128b(_0x1572d6,_0x9dcd8b- -0x7f);}function _0x2ddb8d(_0x4335a7,_0x556baf){return _0x58f7a9(_0x4335a7,_0x556baf- -0x24a);}this['refreshTimer']=setTimeout(()=>{if(!this['show'])return;this['redraw'](),this['canvas']['style']['visibility']='visible';},0xc8);}['_onMouseDownEvent'](_0x455612){function _0x30b0c6(_0x542f2c,_0x13617b){return _0x58f7a9(_0x542f2c,_0x13617b-0x13d);}this['mouse_down']=!![],this['_map']['off'](mars3d__namespace[_0x30b0c6(0x20d,0x287)][_0x146dee(0x357,0x2fd)],this['_onMouseMoveEvent'],this);function _0x146dee(_0x1aba4c,_0x15a5ca){return _0x47128b(_0x15a5ca,_0x1aba4c-0x31e);}this[_0x30b0c6(0x22c,0x1c6)]['on'](mars3d__namespace['EventType'][_0x146dee(0x357,0x2e1)],this[_0x30b0c6(0x1f9,0x25e)],this);}['_onMouseMoveEvent'](_0x54fefb){function _0x1f0a31(_0x17637f,_0x4a453c){return _0x47128b(_0x17637f,_0x4a453c- -0x16);}function _0x407d88(_0x5bf458,_0x3b87fd){return _0x58f7a9(_0x5bf458,_0x3b87fd-0xaf);}if(!this['show']||!this[_0x1f0a31(0xa6,0x58)])return;this['mouse_down']&&(this['canvas']['style']['visibility']=_0x1f0a31(-0x25,-0x11),this[_0x407d88(0x1ad,0x15d)]=!![]);}['_onMouseUpEvent'](_0x184f4f){if(!this['show']||!this[_0x5007da(0xcf,0xd2)])return;function _0x5007da(_0x462a2f,_0x39ce7c){return _0x47128b(_0x39ce7c,_0x462a2f-0x61);}this['_map'][_0x5007da(0x64,0xce)](mars3d__namespace['EventType'][_0x5007da(0x9a,0x90)],this['_onMouseMoveEvent'],this);this['mouse_down']&&this[_0x5007da(0x9b,0xd9)]&&this['redraw']();this['canvas']['style']['visibility']='visible',this['mouse_down']=![];function _0x52d7df(_0x2b2006,_0x2d30d3){return _0x58f7a9(_0x2b2006,_0x2d30d3-0x2d8);}this['mouse_move']=![];}[_0x47128b(0xb2,0x5f)](_0x3dff27){this['clear'](),this[_0x5dc4d6(0x64e,0x6be)]=_0x3dff27,this['windField']['setDate'](_0x3dff27);function _0x5dc4d6(_0xdc3fc2,_0xc163a7){return _0x58f7a9(_0xc163a7,_0xdc3fc2-0x531);}this['redraw']();}[_0x47128b(0x136,0xc3)](){function _0x44a555(_0x2fb957,_0x3409c9){return _0x58f7a9(_0x2fb957,_0x3409c9-0x228);}if(!this[_0x413544(-0x51,-0x73)])return;this['windField'][_0x44a555(0x329,0x376)](this['options']);function _0x413544(_0x5285bd,_0x5832a6){return _0x58f7a9(_0x5832a6,_0x5285bd- -0x15d);}this['update']();}['update'](){if(this[_0x42d9b5(0x3ba,0x3cc)])return;function _0x1c26db(_0x5029ca,_0x4efbee){return _0x47128b(_0x5029ca,_0x4efbee-0x562);}this[_0x42d9b5(0x358,0x3cc)]=!![];if(this['worker'])this['windField']['update']();else{const _0x2cdb72=this[_0x1c26db(0x58d,0x5ac)][_0x1c26db(0x5d7,0x654)]();this[_0x42d9b5(0x473,0x466)](_0x2cdb72);}function _0x42d9b5(_0x1b7e53,_0x38fbda){return _0x47128b(_0x1b7e53,_0x38fbda-0x371);}this['_updateIng']=![];}['_drawLines'](_0x6260a9){function _0x24142d(_0x594fab,_0x1caea2){return _0x58f7a9(_0x1caea2,_0x594fab- -0x233);}this['canvasContext']['globalCompositeOperation']='destination-in',this[_0x173d8e(0x2bc,0x340)]['fillRect'](0x0,0x0,this['canvasWidth'],this['canvasHeight']),this['canvasContext']['globalCompositeOperation']=_0x173d8e(0x329,0x346),this[_0x24142d(-0x1b2,-0x1f5)][_0x24142d(-0x156,-0x181)]=0.9;const _0x315232=this[_0x173d8e(0x2c4,0x25d)]['scene']['mode']!==Cesium[_0x173d8e(0x3a2,0x3eb)]['SCENE3D'],_0x2b7f6f=this[_0x173d8e(0x32a,0x2ec)]*0.25;function _0x173d8e(_0x16d801,_0x313fb1){return _0x58f7a9(_0x313fb1,_0x16d801-0x23b);}if(this[_0x173d8e(0x287,0x2f1)])for(let _0x9a1524=0x0,_0x446d35=_0x6260a9['length'];_0x9a1524<_0x446d35;_0x9a1524++){const _0x187b30=_0x6260a9[_0x9a1524],_0x37ea59=this['_tomap'](_0x187b30[_0x173d8e(0x334,0x340)],_0x187b30['lat'],_0x187b30),_0x4db4b0=this[_0x24142d(-0x14f,-0xc1)](_0x187b30['tlng'],_0x187b30[_0x173d8e(0x394,0x308)],_0x187b30);if(!_0x37ea59||!_0x4db4b0)continue;if(_0x315232&&Math['abs'](_0x37ea59[0x0]-_0x4db4b0[0x0])>=_0x2b7f6f)continue;this['canvasContext']['beginPath'](),this[_0x173d8e(0x2bc,0x34b)][_0x24142d(-0x1ab,-0x1b3)]=this['lineWidth'],this[_0x173d8e(0x2bc,0x293)][_0x173d8e(0x330,0x35d)]=this[_0x173d8e(0x287,0x2c9)][_0x24142d(-0x137,-0x132)](_0x187b30[_0x24142d(-0x1dd,-0x18d)]),this[_0x173d8e(0x2bc,0x2de)][_0x173d8e(0x345,0x2fd)](_0x37ea59[0x0],_0x37ea59[0x1]),this[_0x24142d(-0x1b2,-0x1cb)]['lineTo'](_0x4db4b0[0x0],_0x4db4b0[0x1]),this[_0x24142d(-0x1b2,-0x23e)]['stroke']();}else{this[_0x24142d(-0x1b2,-0x1b0)]['beginPath'](),this['canvasContext'][_0x173d8e(0x2c3,0x239)]=this['lineWidth'],this['canvasContext'][_0x173d8e(0x330,0x2e9)]=this['color'];for(let _0x57b613=0x0,_0x45bfd9=_0x6260a9['length'];_0x57b613<_0x45bfd9;_0x57b613++){const _0x3cdc40=_0x6260a9[_0x57b613],_0x22b186=this['_tomap'](_0x3cdc40[_0x24142d(-0x13a,-0x188)],_0x3cdc40['lat'],_0x3cdc40),_0x7ddd2f=this['_tomap'](_0x3cdc40[_0x24142d(-0x1b6,-0x233)],_0x3cdc40['tlat'],_0x3cdc40);if(!_0x22b186||!_0x7ddd2f)continue;if(_0x315232&&Math[_0x173d8e(0x309,0x2fb)](_0x22b186[0x0]-_0x7ddd2f[0x0])>=_0x2b7f6f)continue;this[_0x24142d(-0x1b2,-0x181)][_0x173d8e(0x345,0x2d6)](_0x22b186[0x0],_0x22b186[0x1]),this[_0x24142d(-0x1b2,-0x199)]['lineTo'](_0x7ddd2f[0x0],_0x7ddd2f[0x1]);}this['canvasContext']['stroke']();}}[_0x58f7a9(0x84,0xe4)](_0x11cbdc,_0x65d806,_0x4d962e){function _0x313fde(_0x70bf13,_0x98da16){return _0x58f7a9(_0x70bf13,_0x98da16-0x20f);}const _0x5c7b46=Cesium['Cartesian3']['fromDegrees'](_0x11cbdc,_0x65d806,this[_0x335662(0x3b8,0x361)]),_0x478d5d=this['_map'][_0x335662(0x438,0x3b5)];function _0x335662(_0x438e03,_0x13fd4e){return _0x58f7a9(_0x13fd4e,_0x438e03-0x2eb);}if(_0x478d5d['mode']===Cesium['SceneMode']['SCENE3D']){const _0x1207bd=new Cesium[(_0x335662(0x360,0x39c))](_0x478d5d['globe'][_0x313fde(0x278,0x280)],_0x478d5d['camera']['positionWC']),_0x2ad8f8=_0x1207bd[_0x335662(0x3db,0x38b)](_0x5c7b46);if(!_0x2ad8f8)return _0x4d962e['age']=0x0,null;}const _0x13513b=Cesium['SceneTransforms']['wgs84ToWindowCoordinates'](this['_map']['scene'],_0x5c7b46);return _0x13513b?[_0x13513b['x'],_0x13513b['y']]:null;}[_0x47128b(0x37,0x6b)](){this['windField'][_0x47d379(0x61f,0x5cb)]();function _0x47d379(_0x336fe5,_0x4a36d5){return _0x47128b(_0x4a36d5,_0x336fe5-0x5b4);}delete this['windData'];}[_0x47128b(-0x40,0x4)](){function _0x23758b(_0x58ff22,_0x242642){return _0x58f7a9(_0x242642,_0x58ff22-0x27b);}function _0x50c6eb(_0x4a67b0,_0x4d7444){return _0x47128b(_0x4a67b0,_0x4d7444-0x296);}this[_0x23758b(0x3a1,0x3e2)]=new Worker(this['options']['worker']),this[_0x50c6eb(0x358,0x348)]['onmessage']=_0x3ff07e=>{this['_drawLines'](_0x3ff07e['data']['particles']),this['_updateIng2']=![];},this['windField']={'init':_0x2d127d=>{const _0x16af88={};function _0x331036(_0x6486dd,_0x394816){return _0x23758b(_0x6486dd- -0x368,_0x394816);}_0x16af88[_0x331036(-0x14,0x66)]=_0x44bf97(0x10c,0xf4),_0x16af88['options']=_0x2d127d;function _0x44bf97(_0x2680b4,_0x1d19d1){return _0x23758b(_0x2680b4- -0x222,_0x1d19d1);}this[_0x331036(0x39,0x98)]['postMessage'](_0x16af88);},'setOptions':_0x423313=>{function _0x4e6c26(_0xda4032,_0x1a81ea){return _0x50c6eb(_0xda4032,_0x1a81ea-0x26d);}const _0x42b387={};function _0x25daba(_0x12f0bc,_0x3317fa){return _0x50c6eb(_0x12f0bc,_0x3317fa- -0x276);}_0x42b387['type']=_0x4e6c26(0x557,0x5dd),_0x42b387[_0x25daba(0x76,0x54)]=_0x423313,this['worker']['postMessage'](_0x42b387);},'setDate':_0x3ab000=>{const _0x21f690={};_0x21f690[_0x5b34e8(0x21,0x2b)]=_0x5b34e8(-0x6,-0xd);function _0x3c8270(_0x78ed38,_0x423af7){return _0x50c6eb(_0x423af7,_0x78ed38- -0x17b);}function _0x5b34e8(_0x545e49,_0x596d57){return _0x50c6eb(_0x596d57,_0x545e49- -0x2da);}_0x21f690[_0x3c8270(0x116,0x136)]=_0x3ab000,this['worker']['postMessage'](_0x21f690);},'update':()=>{if(this['_updateIng2'])return;this[_0x5bd866(0x34b,0x2da)]=!![];function _0x11be27(_0x1cd6f9,_0x473f0f){return _0x50c6eb(_0x1cd6f9,_0x473f0f-0x1d0);}function _0x5bd866(_0x4af89e,_0x46483c){return _0x50c6eb(_0x46483c,_0x4af89e-0x7d);}const _0x3d7ba7={};_0x3d7ba7['type']='update',this['worker'][_0x5bd866(0x2fd,0x321)](_0x3d7ba7);},'clear':()=>{const _0x283de2={};function _0x8bfbed(_0x988181,_0x4c353d){return _0x23758b(_0x4c353d-0x84,_0x988181);}function _0x3fa662(_0x576cbe,_0x2120ba){return _0x50c6eb(_0x576cbe,_0x2120ba- -0x132);}_0x283de2[_0x3fa662(0x15f,0x1c9)]=_0x3fa662(0x1fd,0x1cf),this['worker']['postMessage'](_0x283de2);}},this[_0x23758b(0x339,0x375)][_0x23758b(0x32e,0x2a6)](this[_0x23758b(0x323,0x396)]);}}mars3d__namespace['LayerUtil']['register']('canvasWind',CanvasWindLayer),mars3d__namespace['layer']['CanvasWindLayer']=CanvasWindLayer,mars3d__namespace[_0x47128b(-0x22,0x0)]=CanvasWindField,mars3d__namespace[_0x58f7a9(0xd7,0x5f)]=WindUtil,exports[_0x58f7a9(0x70,0x74)]=CanvasWindField,exports[_0x58f7a9(0x147,0x103)]=CanvasWindLayer,exports['WindLayer']=WindLayer,exports['WindUtil']=WindUtil;const _0x89fbc2={};_0x89fbc2['value']=!![],Object['defineProperty'](exports,_0x58f7a9(0xa2,0x107),_0x89fbc2);
}));
