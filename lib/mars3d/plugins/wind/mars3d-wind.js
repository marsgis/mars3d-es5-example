/**
 * Mars3D平台插件,支持气象 风向图 功能插件  mars3d-wind
 *
 * 版本信息：v3.7.13
 * 编译日期：2024-05-14 21:04:09
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2024-01-15
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-wind"] = {}, global.mars3d));
})(this, (function (exports, mars3d) { 
'use strict';(function(_0x593240,_0x9af582){function _0x301171(_0x2adb86,_0x3a01e1){return _0x1637(_0x2adb86- -0x16c,_0x3a01e1);}const _0x4d531d=_0x593240();function _0x162082(_0x2d0505,_0x3e3137){return _0x1637(_0x3e3137-0x1f4,_0x2d0505);}while(!![]){try{const _0x4db7d4=parseInt(_0x301171(0x134,0x1c8))/0x1*(parseInt(_0x301171(0x6b,0x4e))/0x2)+-parseInt(_0x301171(0x118,0xcc))/0x3+parseInt(_0x301171(0x87,0x20))/0x4+parseInt(_0x301171(0xb2,0x145))/0x5+-parseInt(_0x301171(0xc5,0x47))/0x6+-parseInt(_0x301171(0x10a,0x131))/0x7+-parseInt(_0x301171(0x9a,0xcb))/0x8*(parseInt(_0x301171(0x167,0x11e))/0x9);if(_0x4db7d4===_0x9af582)break;else _0x4d531d['push'](_0x4d531d['shift']());}catch(_0x10b36b){_0x4d531d['push'](_0x4d531d['shift']());}}}(_0x59fb,0xb64b7));function _interopNamespace(_0x310772){if(_0x310772&&_0x310772['__esModule'])return _0x310772;var _0x2d15d7=Object['create'](null);return _0x310772&&Object['keys'](_0x310772)['forEach'](function(_0x275f4b){function _0x575261(_0x423017,_0x14bcfb){return _0x1637(_0x423017- -0x390,_0x14bcfb);}if(_0x275f4b!==_0x575261(-0x174,-0x1d9)){var _0x1fbe21=Object['getOwnPropertyDescriptor'](_0x310772,_0x275f4b);Object['defineProperty'](_0x2d15d7,_0x275f4b,_0x1fbe21['get']?_0x1fbe21:{'enumerable':!![],'get':function(){return _0x310772[_0x275f4b];}});}}),_0x2d15d7['default']=_0x310772,_0x2d15d7;}var mars3d__namespace=_interopNamespace(mars3d);const Cesium$7=mars3d__namespace['Cesium'];function getU(_0x583efb,_0x5b9dbb){function _0x2ebdac(_0x16a7d2,_0x27a9ed){return _0x1637(_0x27a9ed-0x390,_0x16a7d2);}function _0x13701a(_0x445ec2,_0x353c62){return _0x1637(_0x445ec2- -0x5d,_0x353c62);}const _0x475aee=_0x583efb*Math[_0x2ebdac(0x5e7,0x563)](Cesium$7[_0x2ebdac(0x609,0x59f)]['toRadians'](_0x5b9dbb));return _0x475aee;}function getV(_0x2167c6,_0x2dfcbb){function _0xe3886c(_0x514868,_0x44821c){return _0x1637(_0x44821c- -0x205,_0x514868);}function _0x36fc6e(_0x4ff636,_0x3d1fba){return _0x1637(_0x3d1fba-0x153,_0x4ff636);}const _0x2ac236=_0x2167c6*Math[_0x36fc6e(0x2d6,0x328)](Cesium$7['Math'][_0xe3886c(0x38,0x0)](_0x2dfcbb));return _0x2ac236;}function getSpeed(_0x558bf4,_0x330ac6){const _0x3c7e72=Math['sqrt'](Math['pow'](_0x558bf4,0x2)+Math['pow'](_0x330ac6,0x2));return _0x3c7e72;}function getDirection(_0x3da403,_0x1b5caa){let _0x22f66e=Cesium$7[_0x3cbfaf(0xc9,0xe9)][_0x3cbfaf(0x158,0xfe)](Math['atan2'](_0x1b5caa,_0x3da403));_0x22f66e+=_0x22f66e<0x0?0x168:0x0;function _0x247f46(_0xcb5d7,_0xcfa41a){return _0x1637(_0xcfa41a-0x3d7,_0xcb5d7);}function _0x3cbfaf(_0x7a7527,_0xca8ceb){return _0x1637(_0x7a7527- -0x146,_0xca8ceb);}return _0x22f66e;}const _0x580ae3={};_0x580ae3[_0x4c9e73(0x4ee,0x4c6)]=null,_0x580ae3[_0x2b892e(0x4b3,0x46f)]=getU,_0x580ae3[_0x2b892e(0x469,0x40b)]=getV,_0x580ae3[_0x2b892e(0x4d3,0x455)]=getSpeed,_0x580ae3['getDirection']=getDirection;var WindUtil=_0x580ae3;const Cesium$6=mars3d__namespace[_0x2b892e(0x4ad,0x44c)];class CustomPrimitive{constructor(_0x4959d8){this['commandType']=_0x4959d8[_0x2ff346(-0xd2,-0x157)];function _0x2ff346(_0x5933bf,_0x5954a2){return _0x4c9e73(_0x5954a2,_0x5933bf- -0x5f0);}this['geometry']=_0x4959d8[_0x214f42(0x28e,0x22b)],this['attributeLocations']=_0x4959d8[_0x214f42(0x341,0x3d1)],this['primitiveType']=_0x4959d8['primitiveType'],this['uniformMap']=_0x4959d8[_0x2ff346(-0x159,-0x111)],this['vertexShaderSource']=_0x4959d8['vertexShaderSource'],this['fragmentShaderSource']=_0x4959d8['fragmentShaderSource'],this['rawRenderState']=_0x4959d8['rawRenderState'],this['framebuffer']=_0x4959d8['framebuffer'],this[_0x2ff346(-0x10b,-0xca)]=_0x4959d8[_0x214f42(0x30d,0x2a8)];function _0x214f42(_0xf651ea,_0x26919d){return _0x2b892e(_0x26919d,_0xf651ea- -0xc6);}this['autoClear']=_0x4959d8[_0x2ff346(-0x7a,-0x96)]??![],this['preExecute']=_0x4959d8['preExecute'],this['show']=!![],this['commandToExecute']=undefined,this['clearCommand']=undefined,this[_0x214f42(0x39e,0x3b1)]&&(this[_0x2ff346(-0xad,-0xc8)]=new Cesium$6[(_0x214f42(0x2b8,0x298))]({'color':new Cesium$6[(_0x214f42(0x2fd,0x2b0))](0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':this[_0x214f42(0x2a7,0x2f2)],'pass':Cesium$6['Pass']['OPAQUE']}));}['createCommand'](_0x5ccdba){function _0x48b531(_0xb668c6,_0x40cffa){return _0x2b892e(_0x40cffa,_0xb668c6- -0x70);}function _0x46b97a(_0x52aab7,_0x451d08){return _0x2b892e(_0x52aab7,_0x451d08- -0x4cf);}switch(this['commandType']){case'Draw':{const _0x81a59a=Cesium$6[_0x48b531(0x3ef,0x3b0)][_0x48b531(0x3a5,0x310)]({'context':_0x5ccdba,'geometry':this['geometry'],'attributeLocations':this[_0x48b531(0x397,0x3f8)],'bufferUsage':Cesium$6['BufferUsage'][_0x46b97a(-0xf7,-0x79)]}),_0x4d05b4={};_0x4d05b4['context']=_0x5ccdba,_0x4d05b4['attributeLocations']=this['attributeLocations'],_0x4d05b4[_0x46b97a(-0x1ca,-0x15f)]=this['vertexShaderSource'],_0x4d05b4['fragmentShaderSource']=this['fragmentShaderSource'];const _0x25e139=Cesium$6['ShaderProgram']['fromCache'](_0x4d05b4),_0x17cf29=Cesium$6['RenderState']['fromCache'](this['rawRenderState']);return new Cesium$6['DrawCommand']({'primitiveType':this['primitiveType'],'shaderProgram':_0x25e139,'vertexArray':_0x81a59a,'modelMatrix':Cesium$6[_0x48b531(0x2da,0x268)][_0x46b97a(-0x157,-0xfa)],'renderState':_0x17cf29,'uniformMap':this['uniformMap'],'castShadows':![],'receiveShadows':![],'framebuffer':this['framebuffer'],'pass':Cesium$6[_0x48b531(0x38c,0x39a)]['OPAQUE'],'pickOnly':!![],'owner':this});}case'Compute':{const _0x396820={};return _0x396820[_0x48b531(0x3d0,0x436)]=this,_0x396820[_0x46b97a(-0xb3,-0x93)]=this['fragmentShaderSource'],_0x396820['uniformMap']=this['uniformMap'],_0x396820['outputTexture']=this[_0x46b97a(-0xc8,-0xfc)],_0x396820[_0x48b531(0x3bf,0x412)]=!![],new Cesium$6['ComputeCommand'](_0x396820);}}}[_0x4c9e73(0x4bf,0x4fe)](_0x1303b0,_0x5edee6){function _0xb8e256(_0x307414,_0x50e73f){return _0x4c9e73(_0x50e73f,_0x307414- -0x141);}this[_0xb8e256(0x325,0x39f)]=_0x5edee6;const _0x4c306b=Cesium$6['VertexArray']['fromGeometry']({'context':_0x1303b0,'geometry':this[_0xb8e256(0x325,0x2d5)],'attributeLocations':this[_0xb8e256(0x3d8,0x38b)],'bufferUsage':Cesium$6['BufferUsage'][_0xb8e256(0x427,0x3c2)]});function _0x119a37(_0x3e4184,_0x73bb7b){return _0x4c9e73(_0x3e4184,_0x73bb7b- -0x2c9);}this[_0xb8e256(0x40a,0x3ac)][_0x119a37(0x169,0x1c6)]=_0x4c306b;}['update'](_0x4ec0f0){function _0x4c3126(_0x20cffd,_0xa931f2){return _0x4c9e73(_0xa931f2,_0x20cffd- -0x1b5);}if(!this[_0x1ae01d(0x2e7,0x30e)])return;if(_0x4ec0f0['mode']!==Cesium$6['SceneMode']['SCENE3D'])return;function _0x1ae01d(_0x1ed42d,_0x1d1b7a){return _0x4c9e73(_0x1d1b7a,_0x1ed42d- -0x19e);}!Cesium$6[_0x4c3126(0x365,0x3f2)](this[_0x4c3126(0x396,0x391)])&&(this[_0x1ae01d(0x3ad,0x3f9)]=this['createCommand'](_0x4ec0f0['context'])),Cesium$6['defined'](this['preExecute'])&&this[_0x4c3126(0x3b0,0x370)](),Cesium$6['defined'](this[_0x1ae01d(0x3a5,0x35e)])&&_0x4ec0f0[_0x4c3126(0x393,0x34e)]['push'](this['clearCommand']),_0x4ec0f0['commandList']['push'](this['commandToExecute']);}['isDestroyed'](){return![];}['destroy'](){function _0x2ebbdd(_0x50a80a,_0xeb4e7e){return _0x4c9e73(_0xeb4e7e,_0x50a80a- -0x29b);}function _0x3dafbb(_0x1f266d,_0x1030aa){return _0x4c9e73(_0x1030aa,_0x1f266d- -0x15c);}if(this['clearCommand']){var _0x598393,_0x27ffdb;(_0x598393=this['clearCommand'])!==null&&_0x598393!==void 0x0&&_0x598393[_0x2ebbdd(0x1f4,0x243)]&&this[_0x3dafbb(0x3e7,0x35a)][_0x2ebbdd(0x1f4,0x280)]['destroy'](),(_0x27ffdb=this['clearCommand'])!==null&&_0x27ffdb!==void 0x0&&_0x27ffdb[_0x3dafbb(0x313,0x37f)]&&this[_0x3dafbb(0x3e7,0x397)][_0x2ebbdd(0x1d4,0x1a0)]['destroy'](),delete this['clearCommand'];}return this[_0x2ebbdd(0x2b0,0x258)]&&(this['commandToExecute']['vertexArray']&&this['commandToExecute'][_0x3dafbb(0x333,0x361)]['destroy'](),this['commandToExecute']['shaderProgram']&&this[_0x2ebbdd(0x2b0,0x2d5)]['shaderProgram']['destroy'](),delete this['commandToExecute']),Cesium$6[_0x2ebbdd(0x1c2,0x18a)](this);}}const Cesium$5=mars3d__namespace[_0x2b892e(0x48f,0x44c)],Util=(function(){const _0x178ef1=function(){function _0x4f60d7(_0xa054c0,_0x27572e){return _0x1637(_0xa054c0- -0x3a5,_0x27572e);}function _0x31542c(_0x19bf11,_0x39494b){return _0x1637(_0x39494b-0x23e,_0x19bf11);}const _0x30494b=new Cesium$5['Geometry']({'attributes':new Cesium$5[(_0x4f60d7(-0x110,-0xd9))]({'position':new Cesium$5['GeometryAttribute']({'componentDatatype':Cesium$5['ComponentDatatype']['FLOAT'],'componentsPerAttribute':0x3,'values':new Float32Array([-0x1,-0x1,0x0,0x1,-0x1,0x0,0x1,0x1,0x0,-0x1,0x1,0x0])}),'st':new Cesium$5['GeometryAttribute']({'componentDatatype':Cesium$5[_0x31542c(0x46c,0x4c6)][_0x4f60d7(-0xe1,-0x9e)],'componentsPerAttribute':0x2,'values':new Float32Array([0x0,0x0,0x1,0x0,0x1,0x1,0x0,0x1])})}),'indices':new Uint32Array([0x3,0x2,0x0,0x0,0x2,0x1])});return _0x30494b;},_0x7c6009=function(_0x5064ad,_0x166860){if(Cesium$5['defined'](_0x166860)){const _0x29365e={};_0x29365e['arrayBufferView']=_0x166860,_0x5064ad[_0xec36f6(0x558,0x56a)]=_0x29365e;}function _0xec36f6(_0x54e69d,_0x391787){return _0x1637(_0x54e69d-0x2d3,_0x391787);}const _0x18016d=new Cesium$5['Texture'](_0x5064ad);return _0x18016d;},_0x502491=function(_0x45ab5e,_0x5e5b53,_0x4cc3d0){const _0x24385d={};_0x24385d['context']=_0x45ab5e,_0x24385d['colorTextures']=[_0x5e5b53],_0x24385d['depthTexture']=_0x4cc3d0;const _0x27badd=new Cesium$5['Framebuffer'](_0x24385d);return _0x27badd;},_0x2c1a83=function(_0x119d01){const _0x5318aa=!![],_0x3b845e=![],_0x2c1c71={};_0x2c1c71[_0x3fba6d(0x4db,0x4c1)]=_0x119d01['viewport'],_0x2c1c71['depthTest']=_0x119d01[_0x3fba6d(0x4f0,0x582)],_0x2c1c71['depthMask']=_0x119d01[_0x2cfbfa(0x3f3,0x465)],_0x2c1c71['blending']=_0x119d01['blending'];function _0x2cfbfa(_0x5e2cd9,_0x37dede){return _0x1637(_0x5e2cd9-0x1a6,_0x37dede);}function _0x3fba6d(_0x5d540e,_0x220794){return _0x1637(_0x5d540e-0x329,_0x220794);}const _0x405486=_0x2c1c71,_0x1ebc88=Cesium$5['Appearance']['getDefaultRenderState'](_0x5318aa,_0x3b845e,_0x405486);return _0x1ebc88;},_0x10e574=function(_0x188422){const _0x1504a5={},_0x332cb1=Cesium$5['Math']['mod'](_0x188422['west'],Cesium$5[_0x59ba37(-0x43,0x45)]['TWO_PI']),_0x344743=Cesium$5['Math']['mod'](_0x188422['east'],Cesium$5[_0x3273c9(0x19c,0x122)]['TWO_PI']),_0x1ac9e8=_0x188422[_0x59ba37(0xa3,0x98)];let _0x1d0cf3,_0x4ab6ec;_0x1ac9e8>Cesium$5['Math'][_0x59ba37(0xb7,0x5c)]?(_0x1d0cf3=0x0,_0x4ab6ec=Cesium$5['Math']['TWO_PI']):_0x344743-_0x332cb1<_0x1ac9e8?(_0x1d0cf3=_0x332cb1,_0x4ab6ec=_0x332cb1+_0x1ac9e8):(_0x1d0cf3=_0x332cb1,_0x4ab6ec=_0x344743);_0x1504a5['lon']={'min':Cesium$5['Math'][_0x59ba37(0x95,0xd4)](_0x1d0cf3),'max':Cesium$5['Math']['toDegrees'](_0x4ab6ec)};function _0x59ba37(_0x18decf,_0xd09889){return _0x1637(_0xd09889- -0x1ca,_0x18decf);}const _0x4e0509=_0x188422['south'],_0x121615=_0x188422[_0x3273c9(0x156,0x150)],_0x409536=_0x188422[_0x3273c9(0x1de,0x177)],_0x1a693e=_0x409536>Cesium$5['Math']['PI']/0xc?_0x409536/0x2:0x0;let _0x2fc42c=Cesium$5['Math']['clampToLatitudeRange'](_0x4e0509-_0x1a693e),_0x375b8e=Cesium$5['Math'][_0x59ba37(0x9e,0x2f)](_0x121615+_0x1a693e);function _0x3273c9(_0x55ff60,_0x366442){return _0x1637(_0x366442- -0xed,_0x55ff60);}return _0x2fc42c<-Cesium$5['Math']['PI_OVER_THREE']&&(_0x2fc42c=-Cesium$5[_0x59ba37(0xa3,0x45)]['PI_OVER_TWO']),_0x375b8e>Cesium$5['Math'][_0x3273c9(0x176,0x155)]&&(_0x375b8e=Cesium$5[_0x59ba37(0xba,0x45)][_0x59ba37(0x46,-0xd)]),_0x1504a5[_0x59ba37(0x6d,0x4f)]={'min':Cesium$5[_0x59ba37(0x9,0x45)]['toDegrees'](_0x2fc42c),'max':Cesium$5[_0x59ba37(0x7,0x45)]['toDegrees'](_0x375b8e)},_0x1504a5;},_0x72a4ad={};function _0x429d7b(_0x4ce20c,_0x14e128){return _0x2b892e(_0x4ce20c,_0x14e128-0x121);}_0x72a4ad[_0x429d7b(0x479,0x4b2)]=_0x178ef1,_0x72a4ad[_0x429d7b(0x587,0x57a)]=_0x7c6009;function _0xc8cfff(_0x585c4a,_0x14ac2f){return _0x2b892e(_0x585c4a,_0x14ac2f- -0x101);}return _0x72a4ad[_0xc8cfff(0x2bf,0x280)]=_0x502491,_0x72a4ad[_0x429d7b(0x4f1,0x4f5)]=_0x2c1a83,_0x72a4ad[_0x429d7b(0x5b3,0x52a)]=_0x10e574,_0x72a4ad;}());var segmentDraw_vert='in\x20vec2\x20st;\x0a//\x20it\x20is\x20not\x20normal\x20itself,\x20but\x20used\x20to\x20control\x20normal\x0ain\x20vec3\x20normal;\x20//\x20(point\x20to\x20use,\x20offset\x20sign,\x20not\x20used\x20component)\x0a\x0auniform\x20sampler2D\x20currentParticlesPosition;\x0auniform\x20sampler2D\x20postProcessingPosition;\x0auniform\x20sampler2D\x20postProcessingSpeed;\x0a\x0auniform\x20float\x20particleHeight;\x0a\x0auniform\x20float\x20aspect;\x0auniform\x20float\x20pixelSize;\x0auniform\x20float\x20lineWidth;\x0a\x0aout\x20float\x20speedNormalization;\x0a\x0avec3\x20convertCoordinate(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20WGS84\x20(lon,\x20lat,\x20lev)\x20->\x20ECEF\x20(x,\x20y,\x20z)\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Geographic_coordinate_conversion#From_geodetic_to_ECEF_coordinates\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20WGS\x2084\x20geometric\x20constants\x0a\x20\x20\x20\x20float\x20a\x20=\x206378137.0;\x20//\x20Semi-major\x20axis\x0a\x20\x20\x20\x20float\x20b\x20=\x206356752.3142;\x20//\x20Semi-minor\x20axis\x0a\x20\x20\x20\x20float\x20e2\x20=\x206.69437999014e-3;\x20//\x20First\x20eccentricity\x20squared\x0a\x0a\x20\x20\x20\x20float\x20latitude\x20=\x20radians(lonLatLev.y);\x0a\x20\x20\x20\x20float\x20longitude\x20=\x20radians(lonLatLev.x);\x0a\x0a\x20\x20\x20\x20float\x20cosLat\x20=\x20cos(latitude);\x0a\x20\x20\x20\x20float\x20sinLat\x20=\x20sin(latitude);\x0a\x20\x20\x20\x20float\x20cosLon\x20=\x20cos(longitude);\x0a\x20\x20\x20\x20float\x20sinLon\x20=\x20sin(longitude);\x0a\x0a\x20\x20\x20\x20float\x20N_Phi\x20=\x20a\x20/\x20sqrt(1.0\x20-\x20e2\x20*\x20sinLat\x20*\x20sinLat);\x0a\x20\x20\x20\x20float\x20h\x20=\x20particleHeight;\x20//\x20it\x20should\x20be\x20high\x20enough\x20otherwise\x20the\x20particle\x20may\x20not\x20pass\x20the\x20terrain\x20depth\x20test\x0a\x0a\x20\x20\x20\x20vec3\x20cartesian\x20=\x20vec3(0.0);\x0a\x20\x20\x20\x20cartesian.x\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20cosLon;\x0a\x20\x20\x20\x20cartesian.y\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20sinLon;\x0a\x20\x20\x20\x20cartesian.z\x20=\x20((b\x20*\x20b)\x20/\x20(a\x20*\x20a)\x20*\x20N_Phi\x20+\x20h)\x20*\x20sinLat;\x0a\x20\x20\x20\x20return\x20cartesian;\x0a}\x0a\x0avec4\x20calcProjectedCoordinate(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20the\x20range\x20of\x20longitude\x20in\x20Cesium\x20is\x20[-180,\x20180]\x20but\x20the\x20range\x20of\x20longitude\x20in\x20the\x20NetCDF\x20file\x20is\x20[0,\x20360]\x0a\x20\x20\x20\x20//\x20[0,\x20180]\x20is\x20corresponding\x20to\x20[0,\x20180]\x20and\x20[180,\x20360]\x20is\x20corresponding\x20to\x20[-180,\x200]\x0a\x20\x20\x20\x20lonLatLev.x\x20=\x20mod(lonLatLev.x\x20+\x20180.0,\x20360.0)\x20-\x20180.0;\x0a\x20\x20\x20\x20vec3\x20particlePosition\x20=\x20convertCoordinate(lonLatLev);\x0a\x20\x20\x20\x20vec4\x20projectedCoordinate\x20=\x20czm_modelViewProjection\x20*\x20vec4(particlePosition,\x201.0);\x0a\x20\x20\x20\x20return\x20projectedCoordinate;\x0a}\x0a\x0avec4\x20calcOffset(vec4\x20currentProjectedCoordinate,\x20vec4\x20nextProjectedCoordinate,\x20float\x20offsetSign)\x20{\x0a\x20\x20\x20\x20vec2\x20aspectVec2\x20=\x20vec2(aspect,\x201.0);\x0a\x20\x20\x20\x20vec2\x20currentXY\x20=\x20(currentProjectedCoordinate.xy\x20/\x20currentProjectedCoordinate.w)\x20*\x20aspectVec2;\x0a\x20\x20\x20\x20vec2\x20nextXY\x20=\x20(nextProjectedCoordinate.xy\x20/\x20nextProjectedCoordinate.w)\x20*\x20aspectVec2;\x0a\x0a\x20\x20\x20\x20float\x20offsetLength\x20=\x20lineWidth\x20/\x202.0;\x0a\x20\x20\x20\x20vec2\x20direction\x20=\x20normalize(nextXY\x20-\x20currentXY);\x0a\x20\x20\x20\x20vec2\x20normalVector\x20=\x20vec2(-direction.y,\x20direction.x);\x0a\x20\x20\x20\x20normalVector.x\x20=\x20normalVector.x\x20/\x20aspect;\x0a\x20\x20\x20\x20normalVector\x20=\x20offsetLength\x20*\x20normalVector;\x0a\x0a\x20\x20\x20\x20vec4\x20offset\x20=\x20vec4(offsetSign\x20*\x20normalVector,\x200.0,\x200.0);\x0a\x20\x20\x20\x20return\x20offset;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec2\x20particleIndex\x20=\x20st;\x0a\x0a\x20\x20\x20\x20vec3\x20currentPosition\x20=\x20texture(currentParticlesPosition,\x20particleIndex).rgb;\x0a\x20\x20\x20\x20vec4\x20nextPosition\x20=\x20texture(postProcessingPosition,\x20particleIndex);\x0a\x0a\x20\x20\x20\x20vec4\x20currentProjectedCoordinate\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20vec4\x20nextProjectedCoordinate\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20if\x20(nextPosition.w\x20>\x200.0)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20currentProjectedCoordinate\x20=\x20calcProjectedCoordinate(currentPosition);\x0a\x20\x20\x20\x20\x20\x20\x20\x20nextProjectedCoordinate\x20=\x20calcProjectedCoordinate(currentPosition);\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20currentProjectedCoordinate\x20=\x20calcProjectedCoordinate(currentPosition);\x0a\x20\x20\x20\x20\x20\x20\x20\x20nextProjectedCoordinate\x20=\x20calcProjectedCoordinate(nextPosition.xyz);\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20float\x20pointToUse\x20=\x20normal.x;\x20//\x20-1\x20is\x20currentProjectedCoordinate\x20and\x20+1\x20is\x20nextProjectedCoordinate\x0a\x20\x20\x20\x20float\x20offsetSign\x20=\x20normal.y;\x0a\x0a\x20\x20\x20\x20vec4\x20offset\x20=\x20pixelSize\x20*\x20calcOffset(currentProjectedCoordinate,\x20nextProjectedCoordinate,\x20offsetSign);\x0a\x20\x20\x20\x20if\x20(pointToUse\x20<\x200.0)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20gl_Position\x20=\x20currentProjectedCoordinate\x20+\x20offset;\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20gl_Position\x20=\x20nextProjectedCoordinate\x20+\x20offset;\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20speedNormalization\x20=\x20texture(postProcessingSpeed,\x20particleIndex).a;\x0a}\x0a',segmentDraw_frag=_0x2b892e(0x30f,0x37b),fullscreen_vert=_0x2b892e(0x2de,0x365),trailDraw_frag=_0x4c9e73(0x535,0x53f),screenDraw_frag='uniform\x20sampler2D\x20trailsColorTexture;\x0auniform\x20sampler2D\x20trailsDepthTexture;\x0a\x0ain\x20vec2\x20textureCoordinate;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec4\x20trailsColor\x20=\x20texture(trailsColorTexture,\x20textureCoordinate);\x0a\x20\x20\x20\x20float\x20trailsDepth\x20=\x20texture(trailsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20\x20\x20float\x20globeDepth\x20=\x20czm_unpackDepth(texture(czm_globeDepthTexture,\x20textureCoordinate));\x0a\x0a\x20\x20\x20\x20if\x20(trailsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20trailsColor;\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20}\x0a}\x0a';const Cesium$4=mars3d__namespace['Cesium'];class ParticlesRendering{constructor(_0x55f48f,_0x3a401c,_0x4ca71f,_0xaf367f,_0x12bdaf){this['createRenderingTextures'](_0x55f48f,_0x3a401c,_0x4ca71f['colors']),this['createRenderingFramebuffers'](_0x55f48f);function _0xfc0ee6(_0xc40bb8,_0x2d7856){return _0x2b892e(_0xc40bb8,_0x2d7856- -0x1a1);}this[_0xfc0ee6(0x242,0x248)](_0x55f48f,_0x4ca71f,_0xaf367f,_0x12bdaf);}['createRenderingTextures'](_0x4f2ffe,_0x4d6bd6,_0x20495f){const _0x13daf5={};_0x13daf5['context']=_0x4f2ffe,_0x13daf5['width']=_0x4f2ffe['drawingBufferWidth'],_0x13daf5['height']=_0x4f2ffe[_0x3d7908(0x1c9,0x218)],_0x13daf5[_0x1d8756(0x4f2,0x50d)]=Cesium$4['PixelFormat'][_0x1d8756(0x532,0x4cd)];function _0x3d7908(_0x38791d,_0x4fa3ae){return _0x4c9e73(_0x38791d,_0x4fa3ae- -0x280);}_0x13daf5[_0x3d7908(0x300,0x290)]=Cesium$4[_0x1d8756(0x45d,0x409)]['UNSIGNED_BYTE'];const _0x458fd1=_0x13daf5,_0x55c9ed={};_0x55c9ed[_0x1d8756(0x400,0x451)]=_0x4f2ffe,_0x55c9ed[_0x3d7908(0x2d4,0x288)]=_0x4f2ffe['drawingBufferWidth'],_0x55c9ed['height']=_0x4f2ffe['drawingBufferHeight'],_0x55c9ed[_0x3d7908(0x330,0x2e4)]=Cesium$4['PixelFormat'][_0x1d8756(0x497,0x419)],_0x55c9ed['pixelDatatype']=Cesium$4[_0x1d8756(0x3b2,0x409)]['UNSIGNED_INT'];const _0x26e0bf=_0x55c9ed,_0x17959f=_0x20495f['length'];function _0x1d8756(_0x2bb6b4,_0x40655c){return _0x2b892e(_0x2bb6b4,_0x40655c-0xbb);}const _0x5d5370=new Float32Array(_0x17959f*0x3);for(let _0x324962=0x0;_0x324962<_0x17959f;_0x324962++){const _0x2e53fa=Cesium$4['Color']['fromCssColorString'](_0x20495f[_0x324962]);_0x5d5370[0x3*_0x324962]=_0x2e53fa[_0x3d7908(0x2d6,0x250)],_0x5d5370[0x3*_0x324962+0x1]=_0x2e53fa['green'],_0x5d5370[0x3*_0x324962+0x2]=_0x2e53fa[_0x1d8756(0x4d5,0x4b8)];}const _0x111c4e={'context':_0x4f2ffe,'width':_0x17959f,'height':0x1,'pixelFormat':Cesium$4[_0x3d7908(0x1f2,0x208)][_0x3d7908(0x2a2,0x2b2)],'pixelDatatype':Cesium$4['PixelDatatype'][_0x1d8756(0x4b4,0x513)],'sampler':new Cesium$4[(_0x3d7908(0x28b,0x220))]({'minificationFilter':Cesium$4['TextureMinificationFilter'][_0x3d7908(0x2ae,0x2a6)],'magnificationFilter':Cesium$4['TextureMagnificationFilter']['LINEAR']})};this['textures']={'segmentsColor':Util[_0x3d7908(0x320,0x2eb)](_0x458fd1),'segmentsDepth':Util['createTexture'](_0x26e0bf),'currentTrailsColor':Util['createTexture'](_0x458fd1),'currentTrailsDepth':Util[_0x1d8756(0x553,0x514)](_0x26e0bf),'nextTrailsColor':Util['createTexture'](_0x458fd1),'nextTrailsDepth':Util[_0x3d7908(0x294,0x2eb)](_0x26e0bf),'colorTable':Util[_0x1d8756(0x576,0x514)](_0x111c4e,_0x5d5370)};}[_0x2b892e(0x453,0x3f7)](_0x7b88aa){function _0x41efb4(_0x11930e,_0x1e65b8){return _0x2b892e(_0x11930e,_0x1e65b8-0x115);}function _0x20d984(_0x41305e,_0x240c14){return _0x4c9e73(_0x41305e,_0x240c14- -0x49);}this['framebuffers']={'segments':Util[_0x41efb4(0x51a,0x496)](_0x7b88aa,this['textures'][_0x41efb4(0x5db,0x575)],this['textures']['segmentsDepth']),'currentTrails':Util['createFramebuffer'](_0x7b88aa,this['textures'][_0x20d984(0x578,0x4f5)],this['textures'][_0x20d984(0x4a2,0x440)]),'nextTrails':Util[_0x41efb4(0x4d4,0x496)](_0x7b88aa,this[_0x41efb4(0x544,0x4d7)]['nextTrailsColor'],this['textures'][_0x41efb4(0x518,0x4d5)])};}['createSegmentsGeometry'](_0x1722c9){const _0x56698c=0x4;let _0xd90d97=[];function _0x4492ee(_0x5cf1d4,_0x5ab7ca){return _0x2b892e(_0x5ab7ca,_0x5cf1d4- -0x55b);}for(let _0x5f4d7a=0x0;_0x5f4d7a<_0x1722c9[_0x2f2143(0x57b,0x4fc)];_0x5f4d7a++){for(let _0x3f8e77=0x0;_0x3f8e77<_0x1722c9['particlesTextureSize'];_0x3f8e77++){for(let _0x18628b=0x0;_0x18628b<_0x56698c;_0x18628b++){_0xd90d97['push'](_0x5f4d7a/_0x1722c9['particlesTextureSize']),_0xd90d97[_0x4492ee(-0x20f,-0x1f7)](_0x3f8e77/_0x1722c9['particlesTextureSize']);}}}_0xd90d97=new Float32Array(_0xd90d97);let _0x5af3cf=[];const _0x4e088e=[-0x1,0x1],_0x17635f=[-0x1,0x1];for(let _0x40b84d=0x0;_0x40b84d<_0x1722c9[_0x4492ee(-0x17f,-0x18b)];_0x40b84d++){for(let _0x429a88=0x0;_0x429a88<_0x56698c/0x2;_0x429a88++){for(let _0x565de4=0x0;_0x565de4<_0x56698c/0x2;_0x565de4++){_0x5af3cf[_0x4492ee(-0x20f,-0x29d)](_0x4e088e[_0x429a88]),_0x5af3cf[_0x4492ee(-0x20f,-0x26d)](_0x17635f[_0x565de4]),_0x5af3cf['push'](0x0);}}}_0x5af3cf=new Float32Array(_0x5af3cf);function _0x2f2143(_0x3755b3,_0x334f0c){return _0x2b892e(_0x3755b3,_0x334f0c-0x1b3);}const _0x3461ef=0x6*_0x1722c9['maxParticles'],_0xc32f4e=new Uint32Array(_0x3461ef);for(let _0x2a05d0=0x0,_0x3e6fc6=0x0,_0x3b3c8e=0x0;_0x2a05d0<_0x1722c9['maxParticles'];_0x2a05d0++){_0xc32f4e[_0x3e6fc6++]=_0x3b3c8e+0x0,_0xc32f4e[_0x3e6fc6++]=_0x3b3c8e+0x1,_0xc32f4e[_0x3e6fc6++]=_0x3b3c8e+0x2,_0xc32f4e[_0x3e6fc6++]=_0x3b3c8e+0x2,_0xc32f4e[_0x3e6fc6++]=_0x3b3c8e+0x1,_0xc32f4e[_0x3e6fc6++]=_0x3b3c8e+0x3,_0x3b3c8e+=0x4;}const _0x54ddc3=new Cesium$4['Geometry']({'attributes':new Cesium$4['GeometryAttributes']({'st':new Cesium$4['GeometryAttribute']({'componentDatatype':Cesium$4['ComponentDatatype']['FLOAT'],'componentsPerAttribute':0x2,'values':_0xd90d97}),'normal':new Cesium$4['GeometryAttribute']({'componentDatatype':Cesium$4['ComponentDatatype']['FLOAT'],'componentsPerAttribute':0x3,'values':_0x5af3cf})}),'indices':_0xc32f4e});return _0x54ddc3;}[_0x4c9e73(0x4e3,0x4fb)](_0x3516d9,_0x3bf568,_0x5cf623,_0x4346bd){const _0x15d5e5=this,_0xa05f9e={};_0xa05f9e['st']=0x0,_0xa05f9e['normal']=0x1;function _0x4c024a(_0xeea833,_0x12cf03){return _0x2b892e(_0x12cf03,_0xeea833-0x99);}const _0x57f5c1={};_0x57f5c1[_0x5265cb(0x1c8,0x153)]=[segmentDraw_vert];const _0x286e61={};_0x286e61['sources']=[segmentDraw_frag];const _0x20463e={};_0x20463e['enabled']=!![];const _0x15997d={};_0x15997d['viewport']=undefined,_0x15997d[_0x4c024a(0x3f4,0x433)]=_0x20463e,_0x15997d['depthMask']=!![];const _0x4213b1={};_0x4213b1[_0x5265cb(0x139,0xe2)]=0x0,_0x4213b1['st']=0x1;const _0x344e7a={};_0x344e7a['defines']=['DISABLE_GL_POSITION_LOG_DEPTH'],_0x344e7a[_0x4c024a(0x489,0x421)]=[fullscreen_vert];const _0x3bb59f={};_0x3bb59f['defines']=['DISABLE_LOG_DEPTH_FRAGMENT_WRITE'],_0x3bb59f['sources']=[trailDraw_frag];const _0x49735d={};_0x49735d['position']=0x0,_0x49735d['st']=0x1;const _0x1f158e={};_0x1f158e[_0x4c024a(0x3f5,0x383)]=['DISABLE_GL_POSITION_LOG_DEPTH'],_0x1f158e['sources']=[fullscreen_vert];const _0xbb2180={};function _0x5265cb(_0x5b3c5b,_0x19bf6d){return _0x4c9e73(_0x19bf6d,_0x5b3c5b- -0x33a);}_0xbb2180[_0x4c024a(0x3f5,0x486)]=[_0x4c024a(0x4fb,0x4be)],_0xbb2180['sources']=[screenDraw_frag];const _0x5c80ae={};_0x5c80ae['enabled']=![];const _0x24bee0={};_0x24bee0['enabled']=!![],this[_0x4c024a(0x4ac,0x459)]={'segments':new CustomPrimitive({'commandType':'Draw','attributeLocations':_0xa05f9e,'geometry':this[_0x5265cb(0x212,0x1d1)](_0x3bf568),'primitiveType':Cesium$4['PrimitiveType'][_0x4c024a(0x440,0x4bc)],'uniformMap':{'currentParticlesPosition':function(){return _0x4346bd['particlesTextures']['currentParticlesPosition'];},'postProcessingPosition':function(){return _0x4346bd['particlesTextures']['postProcessingPosition'];},'postProcessingSpeed':function(){function _0x5ea790(_0x33089d,_0x2c973e){return _0x4c024a(_0x33089d-0xf8,_0x2c973e);}return _0x4346bd['particlesTextures'][_0x5ea790(0x55b,0x4fb)];},'colorTable':function(){function _0x5d9516(_0x15e276,_0x34bcad){return _0x5265cb(_0x15e276- -0x2bc,_0x34bcad);}function _0x1e2a1e(_0x24fb9b,_0x48f83c){return _0x4c024a(_0x48f83c- -0x5cd,_0x24fb9b);}return _0x15d5e5[_0x1e2a1e(-0x149,-0x172)][_0x1e2a1e(-0x196,-0x185)];},'aspect':function(){return _0x3516d9['drawingBufferWidth']/_0x3516d9['drawingBufferHeight'];},'pixelSize':function(){return _0x5cf623['pixelSize'];},'lineWidth':function(){return _0x3bf568['lineWidth'];},'particleHeight':function(){function _0x31a5da(_0x4022f3,_0x2c7272){return _0x4c024a(_0x2c7272- -0x4e6,_0x4022f3);}return _0x3bf568[_0x31a5da(-0xd4,-0x59)];}},'vertexShaderSource':new Cesium$4[(_0x4c024a(0x462,0x435))](_0x57f5c1),'fragmentShaderSource':new Cesium$4['ShaderSource'](_0x286e61),'rawRenderState':Util[_0x5265cb(0x1ac,0x1c8)](_0x15997d),'framebuffer':this[_0x4c024a(0x4ed,0x49b)][_0x4c024a(0x45f,0x455)],'autoClear':!![]}),'trails':new CustomPrimitive({'commandType':'Draw','attributeLocations':_0x4213b1,'geometry':Util['getFullscreenQuad'](),'primitiveType':Cesium$4[_0x5265cb(0x150,0x1b4)]['TRIANGLES'],'uniformMap':{'segmentsColorTexture':function(){return _0x15d5e5['textures']['segmentsColor'];},'segmentsDepthTexture':function(){function _0x23a26c(_0x5be866,_0x3aa3c7){return _0x5265cb(_0x3aa3c7- -0xa4,_0x5be866);}return _0x15d5e5[_0x23a26c(0x76,0xf6)]['segmentsDepth'];},'currentTrailsColor':function(){function _0x5abf28(_0x5182f4,_0x11455d){return _0x5265cb(_0x5182f4-0x358,_0x11455d);}function _0x5ff707(_0x3c6406,_0x56c1c2){return _0x5265cb(_0x3c6406-0xbf,_0x56c1c2);}return _0x15d5e5['framebuffers'][_0x5abf28(0x535,0x4fd)][_0x5abf28(0x596,0x50e)](0x0);},'trailsDepthTexture':function(){return _0x15d5e5['framebuffers']['currentTrails']['depthTexture'];},'fadeOpacity':function(){return _0x3bf568['fadeOpacity'];}},'vertexShaderSource':new Cesium$4[(_0x4c024a(0x462,0x4e4))](_0x344e7a),'fragmentShaderSource':new Cesium$4['ShaderSource'](_0x3bb59f),'rawRenderState':Util[_0x4c024a(0x46d,0x40e)]({'viewport':undefined,'depthTest':{'enabled':!![],'func':Cesium$4['DepthFunction'][_0x5265cb(0x16f,0x17c)]},'depthMask':!![]}),'framebuffer':this['framebuffers']['nextTrails'],'autoClear':!![],'preExecute':function(){const _0x2140cd=_0x15d5e5['framebuffers']['currentTrails'];function _0x27b5b4(_0x7fc9b7,_0x51264f){return _0x4c024a(_0x7fc9b7- -0x19a,_0x51264f);}_0x15d5e5['framebuffers']['currentTrails']=_0x15d5e5[_0x36c422(0x32c,0x394)]['nextTrails'];function _0x36c422(_0x1f0e0d,_0x3bfc01){return _0x4c024a(_0x1f0e0d- -0x1c1,_0x3bfc01);}_0x15d5e5[_0x36c422(0x32c,0x30d)][_0x27b5b4(0x30d,0x360)]=_0x2140cd,_0x15d5e5[_0x36c422(0x2eb,0x37d)][_0x36c422(0x225,0x257)]['commandToExecute'][_0x36c422(0x245,0x2a6)]=_0x15d5e5[_0x27b5b4(0x353,0x2e0)]['nextTrails'],_0x15d5e5['primitives'][_0x36c422(0x225,0x1fd)][_0x27b5b4(0x330,0x345)]['framebuffer']=_0x15d5e5['framebuffers']['nextTrails'];}}),'screen':new CustomPrimitive({'commandType':_0x5265cb(0x12d,0xea),'attributeLocations':_0x49735d,'geometry':Util['getFullscreenQuad'](),'primitiveType':Cesium$4['PrimitiveType']['TRIANGLES'],'uniformMap':{'trailsColorTexture':function(){function _0x3a5847(_0x39d6e5,_0x3aa020){return _0x5265cb(_0x3aa020- -0x1f7,_0x39d6e5);}function _0x21d929(_0x581097,_0x131191){return _0x5265cb(_0x581097- -0x206,_0x131191);}return _0x15d5e5[_0x3a5847(0x94,0x35)]['nextTrails'][_0x3a5847(0x83,0x47)](0x0);},'trailsDepthTexture':function(){function _0x10375f(_0x762630,_0x41b6fe){return _0x4c024a(_0x41b6fe- -0x73,_0x762630);}return _0x15d5e5['framebuffers'][_0x10375f(0x468,0x434)]['depthTexture'];}},'vertexShaderSource':new Cesium$4[(_0x5265cb(0x1a1,0x190))](_0x1f158e),'fragmentShaderSource':new Cesium$4[(_0x5265cb(0x1a1,0x1f8))](_0xbb2180),'rawRenderState':Util[_0x4c024a(0x46d,0x3f7)]({'viewport':undefined,'depthTest':_0x5c80ae,'depthMask':!![],'blending':_0x24bee0}),'framebuffer':undefined})};}}var getWind_frag=_0x4c9e73(0x4f3,0x49c),updateSpeed_frag=_0x2b892e(0x356,0x375),updatePosition_frag=_0x2b892e(0x3c9,0x39f),postProcessingPosition_frag=_0x4c9e73(0x4ca,0x4e1),postProcessingSpeed_frag=_0x4c9e73(0x463,0x464);const Cesium$3=mars3d__namespace[_0x4c9e73(0x5ba,0x55e)];class ParticlesComputing{constructor(_0x288dae,_0x5a77d1,_0x2c12b0,_0x24d1f9){this['data']=_0x5a77d1;function _0x4ca1dc(_0x208187,_0x3548da){return _0x4c9e73(_0x3548da,_0x208187- -0x184);}this['createWindTextures'](_0x288dae,_0x5a77d1),this['createParticlesTextures'](_0x288dae,_0x2c12b0,_0x24d1f9),this[_0x4ca1dc(0x376,0x3f1)](_0x5a77d1,_0x2c12b0,_0x24d1f9);}['createWindTextures'](_0x54774e,_0x25defd){function _0x41344c(_0x4b18f5,_0x1ab6ee){return _0x4c9e73(_0x4b18f5,_0x1ab6ee-0x2c);}function _0x5db5ca(_0x2a9e86,_0x45c547){return _0x2b892e(_0x2a9e86,_0x45c547- -0x236);}const _0x593830={'context':_0x54774e,'width':_0x25defd['dimensions'][_0x41344c(0x468,0x4c6)],'height':_0x25defd['dimensions'][_0x5db5ca(0x1d6,0x177)]*(_0x25defd['dimensions']['lev']||0x1),'pixelFormat':Cesium$3['PixelFormat']['LUMINANCE'],'pixelDatatype':Cesium$3['PixelDatatype']['FLOAT'],'flipY':![],'sampler':new Cesium$3[(_0x5db5ca(0x14f,0x158))]({'minificationFilter':Cesium$3['TextureMinificationFilter'][_0x5db5ca(0x129,0x1b8)],'magnificationFilter':Cesium$3[_0x41344c(0x5e0,0x5a1)]['NEAREST']})};this['windTextures']={'U':Util[_0x41344c(0x56c,0x597)](_0x593830,_0x25defd['U']['array']),'V':Util[_0x5db5ca(0x25b,0x223)](_0x593830,_0x25defd['V']['array'])};}[_0x4c9e73(0x52f,0x57b)](_0x1021a7,_0x5a1cfa,_0x36c59d){function _0xf33a81(_0x15bef4,_0x28e316){return _0x4c9e73(_0x28e316,_0x15bef4-0xfd);}const _0x686cd={'context':_0x1021a7,'width':_0x5a1cfa['particlesTextureSize'],'height':_0x5a1cfa['particlesTextureSize'],'pixelFormat':Cesium$3['PixelFormat'][_0xf33a81(0x621,0x68f)],'pixelDatatype':Cesium$3['PixelDatatype']['FLOAT'],'flipY':![],'sampler':new Cesium$3['Sampler']({'minificationFilter':Cesium$3['TextureMinificationFilter'][_0xf33a81(0x5fd,0x5e2)],'magnificationFilter':Cesium$3['TextureMagnificationFilter']['NEAREST']})},_0xd57563=this['randomizeParticles'](_0x5a1cfa[_0xf33a81(0x5eb,0x5d2)],_0x36c59d);function _0x2986d1(_0x2244ef,_0xf57c29){return _0x4c9e73(_0x2244ef,_0xf57c29- -0xec);}const _0xc69ddb=new Float32Array(0x4*_0x5a1cfa['maxParticles'])[_0xf33a81(0x635,0x668)](0x0);this[_0x2986d1(0x460,0x400)]={'particlesWind':Util['createTexture'](_0x686cd),'currentParticlesPosition':Util['createTexture'](_0x686cd,_0xd57563),'nextParticlesPosition':Util[_0x2986d1(0x4c2,0x47f)](_0x686cd,_0xd57563),'currentParticlesSpeed':Util[_0x2986d1(0x50f,0x47f)](_0x686cd,_0xc69ddb),'nextParticlesSpeed':Util['createTexture'](_0x686cd,_0xc69ddb),'postProcessingPosition':Util['createTexture'](_0x686cd,_0xd57563),'postProcessingSpeed':Util['createTexture'](_0x686cd,_0xc69ddb)};}['randomizeParticles'](_0x4242bd,_0x348bee){function _0x450ccb(_0x142682,_0x3d4a75){return _0x4c9e73(_0x142682,_0x3d4a75- -0x196);}const _0x19f0d4=new Float32Array(0x4*_0x4242bd);for(let _0x2f1f18=0x0;_0x2f1f18<_0x4242bd;_0x2f1f18++){_0x19f0d4[0x4*_0x2f1f18]=Cesium$3['Math']['randomBetween'](_0x348bee['lonRange']['x'],_0x348bee[_0x450ccb(0x3be,0x3b9)]['y']),_0x19f0d4[0x4*_0x2f1f18+0x1]=Cesium$3[_0x391b10(0x3aa,0x3c6)][_0x450ccb(0x30d,0x2ea)](_0x348bee['latRange']['x'],_0x348bee[_0x450ccb(0x355,0x367)]['y']),_0x19f0d4[0x4*_0x2f1f18+0x2]=Cesium$3['Math'][_0x450ccb(0x336,0x2ea)](this['data']['lev']['min'],this[_0x391b10(0x436,0x3a7)]['lev']['max']),_0x19f0d4[0x4*_0x2f1f18+0x3]=0x0;}function _0x391b10(_0x11b3e1,_0x275993){return _0x4c9e73(_0x11b3e1,_0x275993- -0xef);}return _0x19f0d4;}['destroyParticlesTextures'](){function _0x21bd66(_0x4111ca,_0x30cdcf){return _0x2b892e(_0x30cdcf,_0x4111ca-0x22c);}Object['keys'](this[_0x21bd66(0x606,0x5df)])['forEach'](_0x4de0a8=>{function _0x2ec078(_0xd19c13,_0x5932d8){return _0x21bd66(_0xd19c13- -0xe7,_0x5932d8);}this[_0x2ec078(0x51f,0x574)][_0x4de0a8]['destroy']();});}[_0x4c9e73(0x58f,0x4fa)](_0x3e0276,_0x4e7b4a,_0x32f687){const _0x2b94c6=new Cesium$3[(_0x1f4daf(0x4dc,0x467))](_0x3e0276['dimensions'][_0x4e8d4a(-0x17b,-0x128)],_0x3e0276[_0x4e8d4a(-0x1b2,-0x125)][_0x1f4daf(0x497,0x444)],_0x3e0276[_0x1f4daf(0x48b,0x422)][_0x1f4daf(0x53f,0x4df)]),_0x40e545=new Cesium$3['Cartesian3'](_0x3e0276['lon']['min'],_0x3e0276[_0x4e8d4a(-0x8f,-0x103)]['min'],_0x3e0276[_0x4e8d4a(-0x16,-0x68)][_0x4e8d4a(-0x3b,-0x4f)]),_0x42d893=new Cesium$3[(_0x4e8d4a(-0x7d,-0xe0))](_0x3e0276[_0x1f4daf(0x4af,0x41f)]['max'],_0x3e0276['lat']['max'],_0x3e0276['lev'][_0x1f4daf(0x52a,0x4d2)]),_0x31d5de=new Cesium$3[(_0x1f4daf(0x403,0x467))]((_0x42d893['x']-_0x40e545['x'])/(_0x2b94c6['x']-0x1),(_0x42d893['y']-_0x40e545['y'])/(_0x2b94c6['y']-0x1),_0x2b94c6['z']>0x1?(_0x42d893['z']-_0x40e545['z'])/(_0x2b94c6['z']-0x1):0x1),_0x59bffb=new Cesium$3['Cartesian2'](_0x3e0276['U']['min'],_0x3e0276['U']['max']),_0x5abc05=new Cesium$3['Cartesian2'](_0x3e0276['V'][_0x4e8d4a(-0xb3,-0x4f)],_0x3e0276['V'][_0x4e8d4a(-0x8b,-0x75)]),_0x4a3c84=this;function _0x4e8d4a(_0x2c54dc,_0x54791b){return _0x4c9e73(_0x2c54dc,_0x54791b- -0x5c2);}const _0x1f2336={};_0x1f2336['U']=function(){return _0x4a3c84['windTextures']['U'];},_0x1f2336['V']=function(){function _0xc5b2af(_0x2cc20d,_0x47b0fd){return _0x1f4daf(_0x47b0fd,_0x2cc20d-0x77);}return _0x4a3c84[_0xc5b2af(0x4e6,0x461)]['V'];},_0x1f2336['currentParticlesPosition']=function(){return _0x4a3c84['particlesTextures']['currentParticlesPosition'];},_0x1f2336['dimension']=function(){return _0x2b94c6;},_0x1f2336['minimum']=function(){return _0x40e545;},_0x1f2336['maximum']=function(){return _0x42d893;},_0x1f2336['interval']=function(){return _0x31d5de;};const _0x342c45={};_0x342c45[_0x1f4daf(0x436,0x487)]=[getWind_frag];const _0x5c3c2c={};function _0x1f4daf(_0x1c07d9,_0x4e2e5a){return _0x2b892e(_0x1c07d9,_0x4e2e5a-0x97);}_0x5c3c2c['sources']=[updateSpeed_frag];const _0x157f23={};_0x157f23[_0x1f4daf(0x4af,0x487)]=[updatePosition_frag];const _0x5b64fc={};_0x5b64fc['sources']=[postProcessingPosition_frag];const _0xc3ff6={};_0xc3ff6['sources']=[postProcessingSpeed_frag],this['primitives']={'getWind':new CustomPrimitive({'commandType':'Compute','uniformMap':_0x1f2336,'fragmentShaderSource':new Cesium$3[(_0x1f4daf(0x450,0x460))](_0x342c45),'outputTexture':this['particlesTextures'][_0x1f4daf(0x421,0x42c)],'preExecute':function(){_0x4a3c84['primitives']['getWind']['commandToExecute']['outputTexture']=_0x4a3c84['particlesTextures']['particlesWind'];}}),'updateSpeed':new CustomPrimitive({'commandType':_0x1f4daf(0x475,0x43f),'uniformMap':{'currentParticlesSpeed':function(){function _0x45fbb4(_0x598f05,_0x54edca){return _0x4e8d4a(_0x598f05,_0x54edca- -0x84);}return _0x4a3c84['particlesTextures'][_0x45fbb4(-0x103,-0x159)];},'particlesWind':function(){return _0x4a3c84['particlesTextures']['particlesWind'];},'uSpeedRange':function(){return _0x59bffb;},'vSpeedRange':function(){return _0x5abc05;},'pixelSize':function(){return _0x32f687['pixelSize'];},'speedFactor':function(){return _0x4e7b4a['speedFactor'];}},'fragmentShaderSource':new Cesium$3[(_0x1f4daf(0x4ca,0x460))](_0x5c3c2c),'outputTexture':this['particlesTextures'][_0x4e8d4a(-0x1da,-0x160)],'preExecute':function(){function _0x1d8134(_0x3fe370,_0x28f060){return _0x4e8d4a(_0x3fe370,_0x28f060- -0xb7);}const _0xbaf4c2=_0x4a3c84['particlesTextures']['currentParticlesSpeed'];_0x4a3c84['particlesTextures']['currentParticlesSpeed']=_0x4a3c84['particlesTextures']['postProcessingSpeed'],_0x4a3c84['particlesTextures']['postProcessingSpeed']=_0xbaf4c2,_0x4a3c84['primitives'][_0x1d8134(-0x9d,-0x10b)]['commandToExecute']['outputTexture']=_0x4a3c84['particlesTextures']['nextParticlesSpeed'];}}),'updatePosition':new CustomPrimitive({'commandType':'Compute','uniformMap':{'currentParticlesPosition':function(){function _0x2c55ff(_0x10c5f0,_0x47cb44){return _0x1f4daf(_0x10c5f0,_0x47cb44- -0x4e1);}function _0x1f64cb(_0x1b9887,_0x654f3e){return _0x4e8d4a(_0x1b9887,_0x654f3e-0x632);}return _0x4a3c84[_0x2c55ff(-0xdf,-0x70)][_0x1f64cb(0x52f,0x564)];},'currentParticlesSpeed':function(){function _0x5140f9(_0x561864,_0x14cc0c){return _0x4e8d4a(_0x561864,_0x14cc0c-0x91);}return _0x4a3c84['particlesTextures'][_0x5140f9(-0x36,-0x44)];}},'fragmentShaderSource':new Cesium$3['ShaderSource'](_0x157f23),'outputTexture':this['particlesTextures']['nextParticlesPosition'],'preExecute':function(){function _0x101873(_0x5262cb,_0x19c2f8){return _0x4e8d4a(_0x5262cb,_0x19c2f8-0x551);}const _0x30c829=_0x4a3c84[_0x101873(0x4bc,0x47b)]['currentParticlesPosition'];function _0x3cff61(_0x20a2b9,_0x5150b9){return _0x1f4daf(_0x20a2b9,_0x5150b9-0x19f);}_0x4a3c84['particlesTextures'][_0x3cff61(0x64f,0x618)]=_0x4a3c84['particlesTextures'][_0x3cff61(0x6ba,0x627)],_0x4a3c84['particlesTextures'][_0x3cff61(0x5b4,0x627)]=_0x30c829,_0x4a3c84['primitives']['updatePosition'][_0x101873(0x45c,0x4da)][_0x3cff61(0x65a,0x609)]=_0x4a3c84['particlesTextures']['nextParticlesPosition'];}}),'postProcessingPosition':new CustomPrimitive({'commandType':'Compute','uniformMap':{'nextParticlesPosition':function(){function _0x490184(_0x1b105b,_0x22be70){return _0x1f4daf(_0x1b105b,_0x22be70- -0xd3);}function _0x55228a(_0x1851a5,_0x48e76a){return _0x1f4daf(_0x1851a5,_0x48e76a- -0x28b);}return _0x4a3c84[_0x490184(0x401,0x39e)][_0x490184(0x313,0x346)];},'nextParticlesSpeed':function(){return _0x4a3c84['particlesTextures']['nextParticlesSpeed'];},'lonRange':function(){function _0x2ab4cd(_0x129fed,_0x5d7172){return _0x4e8d4a(_0x5d7172,_0x129fed-0x62e);}return _0x32f687[_0x2ab4cd(0x5bb,0x53a)];},'latRange':function(){return _0x32f687['latRange'];},'randomCoefficient':function(){const _0x2a1eb4=Math['random']();return _0x2a1eb4;},'dropRate':function(){return _0x4e7b4a['dropRate'];},'dropRateBump':function(){return _0x4e7b4a['dropRateBump'];}},'fragmentShaderSource':new Cesium$3[(_0x1f4daf(0x41d,0x460))](_0x5b64fc),'outputTexture':this['particlesTextures'][_0x1f4daf(0x40e,0x488)],'preExecute':function(){function _0x561735(_0x451464,_0x2d8c91){return _0x1f4daf(_0x2d8c91,_0x451464- -0x22d);}function _0x4d9bb1(_0x288d46,_0x5ae419){return _0x1f4daf(_0x5ae419,_0x288d46- -0x3f9);}_0x4a3c84[_0x4d9bb1(0xb1,0x4a)]['postProcessingPosition']['commandToExecute']['outputTexture']=_0x4a3c84[_0x4d9bb1(0x78,0x9)]['postProcessingPosition'];}}),'postProcessingSpeed':new CustomPrimitive({'commandType':'Compute','uniformMap':{'postProcessingPosition':function(){function _0x2b70a7(_0xb25b9c,_0x3cab85){return _0x1f4daf(_0x3cab85,_0xb25b9c- -0x1f9);}return _0x4a3c84['particlesTextures'][_0x2b70a7(0x28f,0x2e1)];},'nextParticlesSpeed':function(){function _0x1de32f(_0x46d9af,_0x11c282){return _0x4e8d4a(_0x46d9af,_0x11c282-0x62f);}return _0x4a3c84['particlesTextures'][_0x1de32f(0x43e,0x4cf)];}},'fragmentShaderSource':new Cesium$3['ShaderSource'](_0xc3ff6),'outputTexture':this[_0x1f4daf(0x3e5,0x471)][_0x1f4daf(0x3f7,0x461)],'preExecute':function(){function _0x3699e1(_0xc2f797,_0x5a9ebe){return _0x4e8d4a(_0x5a9ebe,_0xc2f797- -0x91);}function _0x2e56f8(_0x1bcd2b,_0x551d2a){return _0x1f4daf(_0x1bcd2b,_0x551d2a- -0x285);}_0x4a3c84[_0x3699e1(-0x12e,-0x15b)]['postProcessingSpeed']['commandToExecute']['outputTexture']=_0x4a3c84[_0x2e56f8(0x270,0x1ec)][_0x2e56f8(0x148,0x1dc)];}})};}}const Cesium$2=mars3d__namespace['Cesium'];class ParticleSystem{constructor(_0x273747,_0x3baa49,_0x2fa6bb,_0x4b2f6d){function _0x58e938(_0x190794,_0x1b17e8){return _0x2b892e(_0x1b17e8,_0x190794- -0x430);}this[_0x58e938(-0x9a,-0x2e)]=_0x273747,_0x3baa49={..._0x3baa49};_0x3baa49['udata']&&_0x3baa49['vdata']&&(_0x3baa49['dimensions']={},_0x3baa49[_0x58e938(-0xa5,-0xe3)]['lon']=_0x3baa49['cols'],_0x3baa49[_0x58e938(-0xa5,-0x7f)][_0x58e938(-0x83,-0x34)]=_0x3baa49[_0x58e938(0x15,0x6b)],_0x3baa49['dimensions'][_0x58e938(0x18,-0x4b)]=_0x3baa49['lev']||0x1,_0x3baa49['lon']={},_0x3baa49[_0x429f6e(0x52e,0x52b)]['min']=_0x3baa49['xmin'],_0x3baa49[_0x429f6e(0x52e,0x58b)][_0x429f6e(0x5e1,0x5d2)]=_0x3baa49['xmax'],_0x3baa49['lat']={},_0x3baa49['lat']['min']=_0x3baa49[_0x58e938(-0x8e,-0x10d)],_0x3baa49[_0x429f6e(0x553,0x53b)]['max']=_0x3baa49['ymax'],_0x3baa49['lev']={},_0x3baa49['lev'][_0x58e938(0x31,0x97)]=_0x3baa49['levmin']??0x1,_0x3baa49[_0x58e938(0x18,0x1e)]['max']=_0x3baa49['levmax']??0x1,_0x3baa49['U']={},_0x3baa49['U']['array']=new Float32Array(_0x3baa49[_0x58e938(0x3,-0x86)]),_0x3baa49['U'][_0x429f6e(0x607,0x5b4)]=_0x3baa49['umin']??Math['min'](..._0x3baa49['udata']),_0x3baa49['U']['max']=_0x3baa49[_0x429f6e(0x563,0x5db)]??Math['max'](..._0x3baa49[_0x58e938(0x3,-0x91)]),_0x3baa49['V']={},_0x3baa49['V']['array']=new Float32Array(_0x3baa49[_0x429f6e(0x559,0x4da)]),_0x3baa49['V']['min']=_0x3baa49['vmin']??Math[_0x429f6e(0x607,0x67b)](..._0x3baa49[_0x429f6e(0x559,0x5d6)]),_0x3baa49['V'][_0x58e938(0xb,-0x6f)]=_0x3baa49[_0x429f6e(0x5f7,0x641)]??Math['max'](..._0x3baa49[_0x58e938(-0x7d,-0x62)]));this[_0x58e938(-0xac,-0x101)]=_0x3baa49,this['options']=_0x2fa6bb,this['viewerParameters']=_0x4b2f6d;function _0x429f6e(_0x2bfacf,_0x385b26){return _0x2b892e(_0x385b26,_0x2bfacf-0x1a6);}this['particlesComputing']=new ParticlesComputing(this[_0x429f6e(0x53c,0x5ba)],this['data'],this[_0x429f6e(0x51f,0x55e)],this[_0x58e938(-0x41,-0x55)]),this['particlesRendering']=new ParticlesRendering(this['context'],this['data'],this['options'],this['viewerParameters'],this['particlesComputing']);}[_0x2b892e(0x3f4,0x422)](_0x46862a){function _0x3bb0e8(_0xd328c4,_0x3eb790){return _0x2b892e(_0xd328c4,_0x3eb790- -0x416);}function _0x5584a8(_0x4e0acd,_0x5e9b1a){return _0x2b892e(_0x5e9b1a,_0x4e0acd-0x59);}this[_0x5584a8(0x3ca,0x445)]['destroyParticlesTextures'](),Object['keys'](this['particlesComputing']['windTextures'])['forEach'](_0x36fa69=>{function _0x26a3d6(_0x5d5960,_0x333a4e){return _0x5584a8(_0x5d5960- -0x66,_0x333a4e);}function _0x12e9ae(_0xf41b58,_0x545636){return _0x5584a8(_0x545636- -0x170,_0xf41b58);}this[_0x12e9ae(0x2ea,0x25a)][_0x12e9ae(0x23a,0x2c1)][_0x36fa69]['destroy']();}),this['particlesRendering'][_0x5584a8(0x41b,0x4a8)]['colorTable']['destroy'](),Object['keys'](this['particlesRendering']['framebuffers'])['forEach'](_0x6ff0fc=>{function _0x310600(_0x40f14f,_0x26681c){return _0x5584a8(_0x40f14f-0x92,_0x26681c);}function _0x496318(_0x146296,_0xa9072c){return _0x3bb0e8(_0x146296,_0xa9072c- -0x12f);}this[_0x310600(0x4de,0x523)]['framebuffers'][_0x6ff0fc][_0x310600(0x4c4,0x43b)]();}),this[_0x5584a8(0x3ef,0x367)]=_0x46862a,this[_0x5584a8(0x3ca,0x39f)]=new ParticlesComputing(this[_0x5584a8(0x3ef,0x40e)],this[_0x3bb0e8(-0x7c,-0x92)],this['options'],this['viewerParameters']),this[_0x3bb0e8(0x2e,-0x23)]=new ParticlesRendering(this[_0x3bb0e8(-0x6e,-0x80)],this['data'],this['options'],this['viewerParameters'],this['particlesComputing']);}[_0x2b892e(0x306,0x357)](){const _0x5ce50b=new Cesium$2['ClearCommand']({'color':new Cesium$2['Color'](0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':undefined,'pass':Cesium$2['Pass']['OPAQUE']});function _0x5d4263(_0x2458b9,_0x4ba13d){return _0x4c9e73(_0x4ba13d,_0x2458b9- -0x49);}function _0x4df275(_0x3302e4,_0x56ba4c){return _0x4c9e73(_0x56ba4c,_0x3302e4- -0x3c7);}Object[_0x4df275(0x14c,0x18c)](this[_0x5d4263(0x4bc,0x4e9)][_0x5d4263(0x51d,0x569)])['forEach'](_0x4a75d3=>{_0x5ce50b[_0x31ab2e(-0x1ae,-0x1e4)]=this[_0x31ab2e(-0x112,-0x15e)][_0x31ab2e(-0xda,-0xfd)][_0x4a75d3];function _0x31ab2e(_0x1c6092,_0x4076d4){return _0x4df275(_0x4076d4- -0x29c,_0x1c6092);}function _0x17ba81(_0xaa7d61,_0x560190){return _0x5d4263(_0x560190- -0x577,_0xaa7d61);}_0x5ce50b['execute'](this['context']);});}['refreshParticles'](_0x4dc5ed){function _0x26cb77(_0x387fed,_0x3b6a07){return _0x4c9e73(_0x387fed,_0x3b6a07- -0x5a0);}this[_0x26cb77(-0xbf,-0x137)](),this[_0x26cb77(-0x16b,-0x11d)][_0x26cb77(-0xda,-0xd2)]();function _0x310563(_0x463b16,_0x2afdcc){return _0x4c9e73(_0x2afdcc,_0x463b16-0x86);}this[_0x310563(0x509,0x51f)]['createParticlesTextures'](this['context'],this[_0x26cb77(-0x14d,-0x115)],this['viewerParameters']);if(_0x4dc5ed){var _0x207619;const _0x2e9f16=this['particlesRendering'][_0x26cb77(-0x6b,-0x54)](this['options']);this[_0x26cb77(-0xd,-0x9b)][_0x310563(0x5ab,0x57f)]['segments']['geometry']=_0x2e9f16;const _0x3e7ccb=Cesium$2['VertexArray']['fromGeometry']({'context':this['context'],'geometry':_0x2e9f16,'attributeLocations':this[_0x310563(0x58b,0x5ea)][_0x26cb77(-0x23,-0x7b)][_0x310563(0x55e,0x5b2)]['attributeLocations'],'bufferUsage':Cesium$2['BufferUsage'][_0x26cb77(-0x31,-0x38)]});(_0x207619=this['particlesRendering']['primitives'])!==null&&_0x207619!==void 0x0&&(_0x207619=_0x207619[_0x310563(0x55e,0x5bd)])!==null&&_0x207619!==void 0x0&&_0x207619['commandToExecute']&&(this['particlesRendering'][_0x310563(0x5ab,0x586)]['segments']['commandToExecute'][_0x26cb77(-0x154,-0x111)]=_0x3e7ccb);}}['setOptions'](_0x2fc510){function _0x4cde25(_0xd51b25,_0x4d64ec){return _0x2b892e(_0x4d64ec,_0xd51b25- -0x40e);}let _0x21d611=![];function _0x5b9dd4(_0x14f4a9,_0x219fcf){return _0x2b892e(_0x219fcf,_0x14f4a9- -0x2a3);}this[_0x4cde25(-0x95,-0xe)][_0x4cde25(-0x32,0x17)]!==_0x2fc510[_0x4cde25(-0x32,-0x3)]&&(_0x21d611=!![]),Object['keys'](_0x2fc510)['forEach'](_0x3bd67a=>{function _0x2f3354(_0x5a6245,_0x21fc2e){return _0x5b9dd4(_0x5a6245-0x3ba,_0x21fc2e);}this[_0x2f3354(0x490,0x44e)][_0x3bd67a]=_0x2fc510[_0x3bd67a];}),this['refreshParticles'](_0x21d611);}['applyViewerParameters'](_0x77cbb8){function _0x5563a5(_0x3f40da,_0x395803){return _0x2b892e(_0x395803,_0x3f40da- -0x18c);}function _0x5a0a83(_0x1ffb02,_0x347eaa){return _0x2b892e(_0x347eaa,_0x1ffb02-0x9e);}Object[_0x5a0a83(0x49f,0x48c)](_0x77cbb8)[_0x5563a5(0x1bb,0x1ba)](_0x27176a=>{function _0x584935(_0x2ca2de,_0x52bce2){return _0x5a0a83(_0x52bce2-0x45,_0x2ca2de);}this[_0x584935(0x496,0x4d2)][_0x27176a]=_0x77cbb8[_0x27176a];}),this[_0x5563a5(0x293,0x308)](![]);}[_0x2b892e(0x3f4,0x3d9)](){clearTimeout(this[_0xfa37c9(-0xc5,-0xfb)]),this['particlesComputing']['destroyParticlesTextures']();function _0xfa37c9(_0x25363f,_0x7a4688){return _0x4c9e73(_0x7a4688,_0x25363f- -0x53f);}Object['keys'](this[_0x1d7397(0xc,0x2e)][_0xfa37c9(-0x55,0xa)])[_0xfa37c9(-0xe6,-0x162)](_0x19f6bc=>{function _0x207e9c(_0x570818,_0x4fa376){return _0x1d7397(_0x570818,_0x4fa376-0xe9);}function _0x3fcd3d(_0x4f9444,_0x571ab2){return _0x1d7397(_0x571ab2,_0x4f9444-0x2d1);}this[_0x207e9c(0x185,0x117)][_0x207e9c(0x127,0x17e)][_0x19f6bc]['destroy']();});function _0x1d7397(_0x127617,_0x3d9841){return _0x4c9e73(_0x127617,_0x3d9841- -0x455);}this['particlesRendering'][_0x1d7397(0xe,0x7f)]['colorTable'][_0xfa37c9(-0x54,-0x4e)](),Object[_0xfa37c9(-0x2c,0x10)](this['particlesRendering'][_0x1d7397(0x19f,0x111)])[_0x1d7397(0xb,0x4)](_0x47a7d4=>{function _0x1a489c(_0x472025,_0x153be1){return _0xfa37c9(_0x472025-0x15f,_0x153be1);}function _0x5552db(_0x5427d3,_0x321406){return _0xfa37c9(_0x321406- -0x89,_0x5427d3);}this[_0x1a489c(0x125,0xda)]['framebuffers'][_0x47a7d4][_0x5552db(-0x170,-0xdd)]();});for(const _0x671a57 in this){delete this[_0x671a57];}}}const Cesium$1=mars3d__namespace['Cesium'],BaseLayer$1=mars3d__namespace[_0x4c9e73(0x562,0x53a)]['BaseLayer'],_0x3b32bc={};_0x3b32bc['particlesNumber']=0x1000,_0x3b32bc[_0x4c9e73(0x57f,0x540)]=0x0,_0x3b32bc['fadeOpacity']=0.996,_0x3b32bc['dropRate']=0.003,_0x3b32bc['dropRateBump']=0.01,_0x3b32bc[_0x2b892e(0x370,0x3e4)]=0.5,_0x3b32bc['lineWidth']=0x2,_0x3b32bc['colors']=['rgb(206,255,255)'];const DEF_OPTIONS=_0x3b32bc;class WindLayer extends BaseLayer$1{constructor(_0x4d0312={}){_0x4d0312={...DEF_OPTIONS,..._0x4d0312},super(_0x4d0312),this['_setOptionsHook'](_0x4d0312);}get['layer'](){function _0x206805(_0x59f9aa,_0x11ece4){return _0x2b892e(_0x59f9aa,_0x11ece4- -0x1e1);}return this[_0x206805(0x285,0x232)];}get[_0x4c9e73(0x458,0x496)](){function _0x1dbd60(_0x456172,_0x476ef2){return _0x2b892e(_0x456172,_0x476ef2-0x186);}return this[_0x1dbd60(0x536,0x4d5)];}set['data'](_0x39b2cd){this['setData'](_0x39b2cd);}get['colors'](){return this['options']['colors'];}set['colors'](_0x271b81){function _0x479975(_0x5e1958,_0x48dae){return _0x2b892e(_0x5e1958,_0x48dae-0x161);}this[_0x479975(0x54b,0x4da)][_0x225d5f(0x2b0,0x2fd)]=_0x271b81;function _0x225d5f(_0x980d3e,_0x334378){return _0x4c9e73(_0x334378,_0x980d3e- -0x21a);}if(this[_0x479975(0x4d0,0x52f)]){const _0x158f8c={};_0x158f8c['colors']=_0x271b81,this['particleSystem']['setOptions'](_0x158f8c);}this[_0x225d5f(0x28c,0x231)]();}[_0x4c9e73(0x4dc,0x528)](){}[_0x2b892e(0x3c5,0x37a)](){this['scene']=this['_map']['scene'],this['camera']=this['_map']['camera'],this[_0x564977(-0xd0,-0x11b)]=new Cesium$1['PrimitiveCollection'](),this['_map']['scene'][_0x1e78db(0x16c,0xf6)][_0x564977(-0x171,-0x14f)](this[_0x564977(-0x138,-0x11b)]),this['viewerParameters']={'lonRange':new Cesium$1['Cartesian2'](),'latRange':new Cesium$1[(_0x564977(-0x15a,-0x18a))](),'pixelSize':0x0},this['globeBoundingSphere']=new Cesium$1['BoundingSphere'](Cesium$1['Cartesian3']['ZERO'],0.99*0x615299);function _0x1e78db(_0x3db014,_0x5b1d8c){return _0x2b892e(_0x3db014,_0x5b1d8c- -0x31d);}this['updateViewerParameters'](),window[_0x564977(-0x97,-0x10d)](_0x564977(-0x12b,-0x19a),this[_0x564977(-0x131,-0x19a)][_0x1e78db(0x128,0xc8)](this),![]);function _0x564977(_0x4cc78e,_0x36c673){return _0x2b892e(_0x4cc78e,_0x36c673- -0x52e);}this['mouse_down']=![],this['mouse_move']=![],this['_map']['on'](mars3d__namespace['EventType'][_0x1e78db(0x13e,0x14e)],this[_0x1e78db(0x4e,0x80)],this),this['_map']['on'](mars3d__namespace['EventType']['mouseDown'],this['_onMouseDownEvent'],this),this['_map']['on'](mars3d__namespace[_0x1e78db(0x11a,0x121)][_0x1e78db(0xe4,0x72)],this[_0x1e78db(-0x57,0x3c)],this),this[_0x564977(-0x12c,-0x104)]['on'](mars3d__namespace[_0x1e78db(0xce,0x121)]['mouseMove'],this[_0x1e78db(0x84,0x83)],this),this['_data']&&this[_0x1e78db(-0x3d,0x4d)](this['_data']);}[_0x2b892e(0x3cd,0x35a)](){function _0x5093c5(_0x3e1e50,_0x5d0498){return _0x2b892e(_0x3e1e50,_0x5d0498- -0x163);}function _0x58ae66(_0x1c63f6,_0x584cd5){return _0x4c9e73(_0x1c63f6,_0x584cd5- -0x1c3);}window['removeEventListener'](_0x5093c5(0x1bf,0x231),this['resize']),this['_map']['off'](mars3d__namespace['EventType'][_0x58ae66(0x366,0x2d2)],this['_onMap_preRenderEvent'],this),this[_0x58ae66(0x3f1,0x379)]['off'](mars3d__namespace['EventType']['wheel'],this['_onMapWhellEvent'],this),this[_0x58ae66(0x3d7,0x379)][_0x5093c5(0x277,0x23e)](mars3d__namespace[_0x58ae66(0x3e4,0x38d)][_0x58ae66(0x34f,0x349)],this[_0x58ae66(0x2e4,0x374)],this),this['_map'][_0x5093c5(0x296,0x23e)](mars3d__namespace['EventType'][_0x58ae66(0x34c,0x2de)],this[_0x5093c5(0x1a1,0x1f6)],this),this['_map']['off'](mars3d__namespace['EventType'][_0x5093c5(0x240,0x26f)],this['_onMouseMoveEvent'],this),this[_0x58ae66(0x347,0x362)][_0x5093c5(0x1ec,0x201)](),this[_0x5093c5(0x30f,0x2c7)]['scene']['primitives'][_0x5093c5(0x342,0x2e4)](this['primitives']);}['resize'](){function _0x205cc(_0x233753,_0xc80a69){return _0x2b892e(_0xc80a69,_0x233753- -0x7e);}if(!this['show']||!this['particleSystem'])return;this[_0x14fd01(0x34c,0x3d0)]['show']=![];function _0x14fd01(_0xdf86c4,_0x50909d){return _0x2b892e(_0xdf86c4,_0x50909d- -0x43);}this[_0x205cc(0x395,0x3fd)]['removeAll'](),this[_0x14fd01(0x415,0x3e7)]['once'](mars3d__namespace['EventType']['preRender'],this['_onMap_preRenderEvent'],this);}[_0x2b892e(0x3eb,0x444)](_0x473c8d){function _0x1d4e9e(_0x51bbf2,_0x17b898){return _0x4c9e73(_0x51bbf2,_0x17b898-0x119);}this['particleSystem'][_0x2c65f3(0x661,0x5d9)](this[_0x2c65f3(0x641,0x650)]['context']),this[_0x2c65f3(0x626,0x5d7)]();function _0x2c65f3(_0x142a91,_0xdf9bd6){return _0x4c9e73(_0xdf9bd6,_0x142a91-0x12d);}this['primitives'][_0x1d4e9e(0x566,0x59e)]=!![];}[_0x4c9e73(0x4d1,0x4af)](_0x20d543){function _0x4e840b(_0x314686,_0xce606c){return _0x4c9e73(_0xce606c,_0x314686- -0x314);}clearTimeout(this[_0x4e840b(0x1e1,0x198)]);if(!this['show']||!this[_0x4e840b(0x1cc,0x13e)])return;this[_0x2ee220(0x68f,0x632)]['show']=![];function _0x2ee220(_0x29159a,_0x31d41a){return _0x4c9e73(_0x29159a,_0x31d41a-0x10d);}this['refreshTimer']=setTimeout(()=>{if(!this['show'])return;function _0x1f0575(_0x773725,_0x2a052e){return _0x4e840b(_0x773725-0x267,_0x2a052e);}this[_0x1f0575(0x4d1,0x460)]();},0xc8);}['_onMouseDownEvent'](_0xc72ce9){this['mouse_down']=!![];}['_onMouseMoveEvent'](_0x11e8e9){function _0x5a06e7(_0x49679d,_0x11f3cd){return _0x2b892e(_0x49679d,_0x11f3cd- -0x33b);}function _0x3c5161(_0x48a60a,_0x2140a5){return _0x4c9e73(_0x2140a5,_0x48a60a-0xd9);}if(!this[_0x5a06e7(0xa3,0x38)]||!this['particleSystem'])return;this['mouse_down']&&(this[_0x5a06e7(0xe0,0xd8)]['show']=![],this['mouse_move']=!![]);}['_onMouseUpEvent'](_0x17062e){function _0x315078(_0x2a95f2,_0x2566d9){return _0x4c9e73(_0x2566d9,_0x2a95f2-0xc5);}function _0x2f1e53(_0x58adf1,_0xc97e38){return _0x4c9e73(_0x58adf1,_0xc97e38- -0x35c);}if(!this['show']||!this['particleSystem'])return;this[_0x2f1e53(0x12d,0x1b5)]&&this[_0x315078(0x58e,0x5ea)]&&this['redraw'](),this['primitives']['show']=!![],this[_0x315078(0x5d6,0x558)]=![],this['mouse_move']=![];}[_0x2b892e(0x488,0x46c)](){function _0x366e5e(_0x37a750,_0x407a74){return _0x4c9e73(_0x37a750,_0x407a74- -0x62f);}if(!this['_map']||!this['show'])return;function _0x45c095(_0xa1b36c,_0x12ec8e){return _0x2b892e(_0x12ec8e,_0xa1b36c- -0x576);}this['updateViewerParameters'](),this['particleSystem'][_0x45c095(-0x17b,-0x209)](this['viewerParameters']),this[_0x45c095(-0x163,-0x194)]['show']=!![];}[_0x2b892e(0x31a,0x36a)](_0x5f10be){function _0x2ea4c4(_0x234840,_0x380c8f){return _0x4c9e73(_0x380c8f,_0x234840- -0x274);}this[_0x2ea4c4(0x1ed,0x24b)]=_0x5f10be;this['particleSystem']&&this['particleSystem']['destroy']();function _0x52afc3(_0x5dc410,_0x3e5651){return _0x2b892e(_0x5dc410,_0x3e5651-0xfb);}this['particleSystem']=new ParticleSystem(this[_0x52afc3(0x495,0x4fd)]['context'],_0x5f10be,this['getOptions'](),this['viewerParameters']),this['addPrimitives']();}['_setOptionsHook'](_0x2b7b06,_0x10915c){function _0x58e5a6(_0xaa8807,_0x212e7d){return _0x4c9e73(_0xaa8807,_0x212e7d- -0x7a);}if(_0x2b7b06)for(const _0x169aa0 in _0x2b7b06){this[_0x169aa0]=_0x2b7b06[_0x169aa0];}function _0x49d37f(_0x3d2e95,_0x54dae7){return _0x4c9e73(_0x54dae7,_0x3d2e95- -0x58d);}this['particleSystem']&&this['particleSystem'][_0x58e5a6(0x454,0x3dd)](this[_0x58e5a6(0x46f,0x418)]());}['getOptions'](){function _0x1d0108(_0x2600ae,_0x238574){return _0x4c9e73(_0x238574,_0x2600ae- -0x352);}const _0x1a6afe=Math[_0x1d0108(0x1e7,0x1b9)](Math[_0x4c0b5d(0x11d,0x89)](this[_0x4c0b5d(0xce,0x46)]));this[_0x1d0108(0x1da,0x244)]=_0x1a6afe*_0x1a6afe;const _0x20d699={};_0x20d699['particlesTextureSize']=_0x1a6afe,_0x20d699['maxParticles']=this[_0x4c0b5d(-0x42,0x46)],_0x20d699['particleHeight']=this['fixedHeight'],_0x20d699['fadeOpacity']=this['fadeOpacity'],_0x20d699[_0x4c0b5d(-0x2d,-0x7c)]=this['dropRate'];function _0x4c0b5d(_0x2ce6f5,_0x1d1480){return _0x2b892e(_0x2ce6f5,_0x1d1480- -0x3d4);}return _0x20d699['dropRateBump']=this['dropRateBump'],_0x20d699['speedFactor']=this[_0x4c0b5d(0x58,0x10)],_0x20d699[_0x4c0b5d(-0x45,-0x8c)]=this[_0x4c0b5d(-0x88,-0x8c)],_0x20d699['colors']=this[_0x1d0108(0x178,0x1d5)],_0x20d699;}[_0x4c9e73(0x4c8,0x4f9)](){this[_0x265159(0x9b,0xcb)][_0x300cea(0x27c,0x2cd)](this['particleSystem'][_0x265159(0x5f,0x29)]['primitives']['getWind']),this[_0x300cea(0x2b0,0x29e)]['add'](this['particleSystem']['particlesComputing']['primitives']['updateSpeed']),this['primitives']['add'](this['particleSystem'][_0x300cea(0x20e,0x1b7)][_0x265159(0x72,0xcb)][_0x300cea(0x2a1,0x216)]),this['primitives']['add'](this['particleSystem']['particlesComputing']['primitives']['postProcessingPosition']);function _0x265159(_0x4aa25f,_0x5dc0da){return _0x2b892e(_0x4aa25f,_0x5dc0da- -0x348);}function _0x300cea(_0x3f2d44,_0x24bb32){return _0x2b892e(_0x24bb32,_0x3f2d44- -0x163);}this[_0x265159(0xc1,0xcb)]['add'](this['particleSystem'][_0x300cea(0x20e,0x205)]['primitives']['postProcessingSpeed']),this[_0x300cea(0x2b0,0x333)]['add'](this[_0x300cea(0x26b,0x257)]['particlesRendering'][_0x265159(0xaf,0xcb)][_0x300cea(0x263,0x29f)]),this[_0x300cea(0x2b0,0x332)]['add'](this[_0x265159(0x27,0x86)]['particlesRendering'][_0x300cea(0x2b0,0x2cb)]['trails']),this[_0x265159(0x11f,0xcb)]['add'](this[_0x300cea(0x26b,0x282)]['particlesRendering'][_0x300cea(0x2b0,0x309)][_0x300cea(0x253,0x2db)]);}[_0x4c9e73(0x593,0x507)](){let _0x559615=this['camera'][_0x5018e3(0x4a1,0x484)](this[_0x5018e3(0x49d,0x4bc)][_0x1dadd4(0x348,0x332)]['ellipsoid']);if(!_0x559615){const _0xc1a94e=this['_map'][_0x5018e3(0x463,0x490)]();_0x559615=Cesium$1[_0x5018e3(0x40f,0x3df)][_0x1dadd4(0x2f2,0x30d)](_0xc1a94e['xmin'],_0xc1a94e['ymin'],_0xc1a94e['xmax'],_0xc1a94e['ymax']);}function _0x5018e3(_0x39e052,_0x2e4b98){return _0x4c9e73(_0x2e4b98,_0x39e052- -0x77);}const _0x5d5797=Util['viewRectangleToLonLatRange'](_0x559615);this[_0x1dadd4(0x351,0x36c)]['lonRange']['x']=_0x5d5797[_0x5018e3(0x423,0x443)][_0x1dadd4(0x3c3,0x39d)],this['viewerParameters']['lonRange']['y']=_0x5d5797[_0x5018e3(0x423,0x462)]['max'],this[_0x1dadd4(0x351,0x2fd)][_0x5018e3(0x486,0x426)]['x']=_0x5d5797['lat'][_0x1dadd4(0x3c3,0x3dd)];function _0x1dadd4(_0x3fb55c,_0x105a03){return _0x2b892e(_0x105a03,_0x3fb55c- -0x9e);}this[_0x1dadd4(0x351,0x2d8)][_0x1dadd4(0x34d,0x302)]['y']=_0x5d5797[_0x1dadd4(0x30f,0x2e9)][_0x1dadd4(0x39d,0x38d)];const _0x2b5c79=this['camera']['getPixelSize'](this['globeBoundingSphere'],this['scene']['drawingBufferWidth'],this['scene'][_0x5018e3(0x421,0x428)]);_0x2b5c79>0x0&&(this['viewerParameters']['pixelSize']=_0x2b5c79);}}mars3d__namespace[_0x4c9e73(0x580,0x53d)]['register']('wind',WindLayer),mars3d__namespace[_0x2b892e(0x492,0x428)]['WindLayer']=WindLayer;class CanvasParticle{constructor(){this['lng']=null,this[_0x152444(0x314,0x322)]=null,this['tlng']=null;function _0x152444(_0x1c9052,_0x3664ae){return _0x2b892e(_0x3664ae,_0x1c9052- -0x99);}function _0x51d95f(_0x1fdbe5,_0x3489ca){return _0x4c9e73(_0x3489ca,_0x1fdbe5- -0x67c);}this[_0x152444(0x305,0x2e3)]=null,this['age']=null,this['speed']=null;}[_0x2b892e(0x3c4,0x3d9)](){for(const _0xebcfc8 in this){delete this[_0xebcfc8];}}}class CanvasWindField{constructor(_0x5d6b28){this['setOptions'](_0x5d6b28);}get['speedRate'](){function _0x3846f3(_0x39b355,_0x13ec2a){return _0x2b892e(_0x39b355,_0x13ec2a- -0x31b);}return this[_0x3846f3(0x6c,0xe5)];}set[_0x4c9e73(0x4a0,0x4b8)](_0x5897ec){function _0x584da0(_0x46ee88,_0x28c2d6){return _0x4c9e73(_0x46ee88,_0x28c2d6- -0x61);}this[_0x584da0(0x48c,0x4b1)]=(0x64-(_0x5897ec>0x63?0x63:_0x5897ec))*0x64;function _0x249d74(_0x44841f,_0x2e08ae){return _0x2b892e(_0x44841f,_0x2e08ae-0x1ee);}this['_calc_speedRate']=[(this['xmax']-this['xmin'])/this['_speedRate'],(this[_0x249d74(0x6ba,0x658)]-this['ymin'])/this['_speedRate']];}get['maxAge'](){function _0x246158(_0x1654cb,_0x37a824){return _0x4c9e73(_0x1654cb,_0x37a824- -0x4de);}return this[_0x246158(0xe1,0x64)];}set[_0x4c9e73(0x558,0x570)](_0xe9f23e){this['_maxAge']=_0xe9f23e;}[_0x4c9e73(0x4a4,0x457)](_0x934551){this['options']=_0x934551,this['maxAge']=_0x934551['maxAge']||0x78,this['speedRate']=_0x934551['speedRate']||0x32;function _0x2b19a6(_0x449973,_0xc70a44){return _0x4c9e73(_0x449973,_0xc70a44-0x119);}function _0x322e2b(_0x25a51a,_0x1c022f){return _0x2b892e(_0x1c022f,_0x25a51a- -0x1d4);}this[_0x322e2b(0x19b,0x119)]=[];const _0x51e300=_0x934551[_0x2b19a6(0x677,0x645)]||0x1000;for(let _0xea5c89=0x0;_0xea5c89<_0x51e300;_0xea5c89++){const _0x4723d7=this[_0x322e2b(0x1ed,0x157)](new CanvasParticle());this['particles']['push'](_0x4723d7);}}['setDate'](_0x18ed9e){this['rows']=_0x18ed9e['rows'],this['cols']=_0x18ed9e[_0x211125(0x498,0x42d)];function _0x211125(_0x4d618f,_0x4e2948){return _0x4c9e73(_0x4e2948,_0x4d618f- -0xc9);}this['xmin']=_0x18ed9e[_0x211125(0x416,0x3fe)],this[_0x4e902b(0x63a,0x627)]=_0x18ed9e['xmax'],this['ymin']=_0x18ed9e['ymin'];function _0x4e902b(_0x5be30f,_0x56722e){return _0x2b892e(_0x56722e,_0x5be30f-0x223);}this['ymax']=_0x18ed9e['ymax'],this['grid']=[];const _0x41cdd9=_0x18ed9e[_0x4e902b(0x656,0x68e)],_0x7dc7b5=_0x18ed9e['vdata'];let _0x4513d6=![];_0x41cdd9[_0x4e902b(0x65b,0x5fd)]===this[_0x4e902b(0x668,0x6e0)]&&_0x41cdd9[0x0]['length']===this['cols']&&(_0x4513d6=!![]);let _0x1a369d=0x0,_0x46f122=null,_0x33125a=null;for(let _0x12c9c0=0x0;_0x12c9c0<this['rows'];_0x12c9c0++){_0x46f122=[];for(let _0x1731b6=0x0;_0x1731b6<this[_0x4e902b(0x672,0x66f)];_0x1731b6++,_0x1a369d++){_0x4513d6?_0x33125a=this['_calcUV'](_0x41cdd9[_0x12c9c0][_0x1731b6],_0x7dc7b5[_0x12c9c0][_0x1731b6]):_0x33125a=this[_0x211125(0x3a9,0x33b)](_0x41cdd9[_0x1a369d],_0x7dc7b5[_0x1a369d]),_0x46f122['push'](_0x33125a);}this[_0x4e902b(0x610,0x68a)]['push'](_0x46f122);}this[_0x4e902b(0x59c,0x5f7)][_0x211125(0x414,0x44b)]&&this[_0x4e902b(0x610,0x657)][_0x211125(0x3fe,0x391)]();}[_0x4c9e73(0x4a8,0x491)](){delete this['rows'],delete this[_0x3d38db(0x3b8,0x336)];function _0x3d38db(_0x2a2fe7,_0x10d025){return _0x2b892e(_0x2a2fe7,_0x10d025- -0x119);}delete this[_0x3d38db(0x222,0x2b4)];function _0x39b338(_0x32a275,_0x169a5e){return _0x2b892e(_0x32a275,_0x169a5e- -0xa3);}delete this[_0x39b338(0x336,0x374)],delete this['ymin'],delete this['ymax'],delete this[_0x3d38db(0x2f9,0x2d4)],delete this[_0x39b338(0x2de,0x2cc)];}['toGridXY'](_0x48c958,_0xcd0ea8){const _0x88161=(_0x48c958-this['xmin'])/(this['xmax']-this['xmin'])*(this['cols']-0x1);function _0x53a2b3(_0x343a86,_0x2d200d){return _0x4c9e73(_0x2d200d,_0x343a86- -0x4a1);}const _0x4eea85=(this['ymax']-_0xcd0ea8)/(this[_0x53a2b3(0xdb,0xf5)]-this[_0x1273e9(0x252,0x298)])*(this['rows']-0x1);function _0x1273e9(_0x20d549,_0x18ae9f){return _0x2b892e(_0x18ae9f,_0x20d549- -0x150);}return[_0x88161,_0x4eea85];}[_0x2b892e(0x3f3,0x3ae)](_0x12a837,_0xc0100d){if(_0x12a837<0x0||_0x12a837>=this['cols']||_0xc0100d>=this['rows'])return[0x0,0x0,0x0];const _0x3c346b=Math['floor'](_0x12a837),_0x54a615=Math['floor'](_0xc0100d);if(_0x3c346b===_0x12a837&&_0x54a615===_0xc0100d)return this[_0x435500(0x476,0x500)][_0xc0100d][_0x12a837];const _0x2ed386=_0x3c346b+0x1,_0x5efacb=_0x54a615+0x1,_0x58ef9f=this['getUVByXY'](_0x3c346b,_0x54a615),_0x9b0355=this[_0x435500(0x437,0x425)](_0x2ed386,_0x54a615),_0x243d38=this[_0x435500(0x437,0x482)](_0x3c346b,_0x5efacb);function _0x407dad(_0x2653c3,_0x191425){return _0x4c9e73(_0x191425,_0x2653c3- -0x49f);}function _0x435500(_0x5990db,_0x514a3c){return _0x2b892e(_0x514a3c,_0x5990db-0x89);}const _0x412b3c=this['getUVByXY'](_0x2ed386,_0x5efacb);let _0x961f63=null;try{_0x961f63=this[_0x407dad(0x1d,-0x76)](_0x12a837-_0x3c346b,_0xc0100d-_0x54a615,_0x58ef9f,_0x9b0355,_0x243d38,_0x412b3c);}catch(_0x55b1ce){console[_0x407dad(0xc3,0xfd)](_0x12a837,_0xc0100d);}return _0x961f63;}[_0x2b892e(0x327,0x3aa)](_0x3b2b80,_0x18eb6d,_0x38f989,_0x45e9b2,_0x48d82b,_0x42c10e){const _0x16e7f0=0x1-_0x3b2b80,_0x55190f=0x1-_0x18eb6d,_0x12ba54=_0x16e7f0*_0x55190f,_0x39ce4d=_0x3b2b80*_0x55190f,_0x4a4405=_0x16e7f0*_0x18eb6d,_0x2e3170=_0x3b2b80*_0x18eb6d,_0x254d9d=_0x38f989[0x0]*_0x12ba54+_0x45e9b2[0x0]*_0x39ce4d+_0x48d82b[0x0]*_0x4a4405+_0x42c10e[0x0]*_0x2e3170;function _0x5c4711(_0x302b67,_0xfd3691){return _0x4c9e73(_0x302b67,_0xfd3691- -0x339);}const _0xba69f8=_0x38f989[0x1]*_0x12ba54+_0x45e9b2[0x1]*_0x39ce4d+_0x48d82b[0x1]*_0x4a4405+_0x42c10e[0x1]*_0x2e3170;return this[_0x5c4711(0xfd,0x139)](_0x254d9d,_0xba69f8);}[_0x2b892e(0x35c,0x360)](_0x46e8b1,_0x5e0f6b){return[+_0x46e8b1,+_0x5e0f6b,Math['sqrt'](_0x46e8b1*_0x46e8b1+_0x5e0f6b*_0x5e0f6b)];}[_0x2b892e(0x387,0x37c)](_0x1c26e8,_0x4d1225){function _0x4450b2(_0x474955,_0x40989c){return _0x2b892e(_0x40989c,_0x474955- -0x36c);}if(!this[_0x4450b2(0xeb,0xde)](_0x1c26e8,_0x4d1225))return null;const _0x58473f=this[_0x4247e5(0x56e,0x5e8)](_0x1c26e8,_0x4d1225),_0x214bdf=this[_0x4247e5(0x589,0x5da)](_0x58473f[0x0],_0x58473f[0x1]);function _0x4247e5(_0x169c94,_0x135875){return _0x2b892e(_0x135875,_0x169c94-0x1db);}return _0x214bdf;}[_0x2b892e(0x408,0x457)](_0x328da1,_0x7eee74){function _0x697d98(_0x24ad38,_0x4c9219){return _0x4c9e73(_0x24ad38,_0x4c9219- -0x21);}return _0x328da1>=this['xmin']&&_0x328da1<=this['xmax']&&_0x7eee74>=this['ymin']&&_0x7eee74<=this[_0x697d98(0x534,0x55b)]?!![]:![];}[_0x2b892e(0x468,0x424)](){const _0x2507cf=fRandomByfloat(this[_0x1600f1(0x5a6,0x5a2)],this['xmax']);function _0x1600f1(_0x5b79b4,_0x179cc7){return _0x4c9e73(_0x5b79b4,_0x179cc7-0xc3);}const _0x2d0378=fRandomByfloat(this['ymin'],this['ymax']),_0x214ce7={};function _0x5ce9e5(_0x59fe9a,_0x1eb4c3){return _0x4c9e73(_0x59fe9a,_0x1eb4c3- -0x2f6);}return _0x214ce7['lat']=_0x2d0378,_0x214ce7[_0x1600f1(0x63a,0x5b2)]=_0x2507cf,_0x214ce7;}['getParticles'](){function _0x36dd72(_0xe0828f,_0x20dc75){return _0x2b892e(_0xe0828f,_0x20dc75- -0x382);}function _0x4e2ad0(_0x19404f,_0x5ad9a2){return _0x4c9e73(_0x5ad9a2,_0x19404f- -0x187);}let _0x2e0002,_0x193f8b,_0x4f0fbe;for(let _0x2a4ca7=0x0,_0x296d78=this['particles'][_0x4e2ad0(0x3c3,0x438)];_0x2a4ca7<_0x296d78;_0x2a4ca7++){let _0xc2aee1=this[_0x4e2ad0(0x2fa,0x373)][_0x2a4ca7];_0xc2aee1[_0x4e2ad0(0x3f8,0x363)]<=0x0&&(_0xc2aee1=this[_0x36dd72(0x6a,0x3f)](_0xc2aee1));if(_0xc2aee1['age']>0x0){const _0x2c8b7e=_0xc2aee1[_0x36dd72(-0x4,0x3d)],_0x4c3462=_0xc2aee1[_0x4e2ad0(0x329,0x3bd)];_0x4f0fbe=this['getUVByPoint'](_0x2c8b7e,_0x4c3462),_0x4f0fbe?(_0x2e0002=_0x2c8b7e+this[_0x36dd72(0x28,0xbd)][0x0]*_0x4f0fbe[0x0],_0x193f8b=_0x4c3462+this['_calc_speedRate'][0x1]*_0x4f0fbe[0x1],_0xc2aee1['lng']=_0x2c8b7e,_0xc2aee1[_0x36dd72(-0x69,0x2b)]=_0x4c3462,_0xc2aee1['tlng']=_0x2e0002,_0xc2aee1['tlat']=_0x193f8b,_0xc2aee1['speed']=_0x4f0fbe[0x2],_0xc2aee1[_0x4e2ad0(0x3f8,0x484)]--):_0xc2aee1['age']=0x0;}}return this['particles'];}['_randomParticle'](_0x5478f5){function _0x39d911(_0x4a9ab1,_0x1bd66b){return _0x4c9e73(_0x4a9ab1,_0x1bd66b-0x134);}let _0x461293,_0x3a5d53;for(let _0x6dd553=0x0;_0x6dd553<0x1e;_0x6dd553++){_0x461293=this['getRandomLatLng'](),_0x3a5d53=this['getUVByPoint'](_0x461293['lng'],_0x461293['lat']);if(_0x3a5d53&&_0x3a5d53[0x2]>0x0)break;}if(!_0x3a5d53)return _0x5478f5;const _0x433558=_0x461293[_0x39d911(0x5b0,0x623)]+this['_calc_speedRate'][0x0]*_0x3a5d53[0x0],_0x223be5=_0x461293['lat']+this['_calc_speedRate'][0x1]*_0x3a5d53[0x1];_0x5478f5[_0x39d911(0x5f4,0x623)]=_0x461293[_0x39d911(0x597,0x623)],_0x5478f5['lat']=_0x461293['lat'],_0x5478f5[_0xa280bd(0x474,0x4d6)]=_0x433558,_0x5478f5['tlat']=_0x223be5,_0x5478f5[_0xa280bd(0x522,0x5af)]=Math['round'](Math[_0xa280bd(0x51d,0x5a0)]()*this['maxAge']),_0x5478f5['speed']=_0x3a5d53[0x2];function _0xa280bd(_0x3cd8a1,_0x1c6044){return _0x4c9e73(_0x1c6044,_0x3cd8a1- -0x5d);}return _0x5478f5;}[_0x2b892e(0x42d,0x3d9)](){for(const _0x241843 in this){delete this[_0x241843];}}}function fRandomByfloat(_0x21c4aa,_0x9a397a){return _0x21c4aa+Math['random']()*(_0x9a397a-_0x21c4aa);}const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace[_0x2b892e(0x41e,0x428)]['BaseLayer'];class CanvasWindLayer extends BaseLayer{constructor(_0x38ea9b={}){super(_0x38ea9b),this['_setOptionsHook'](_0x38ea9b);function _0x471332(_0x1f9f45,_0x1f0cb4){return _0x4c9e73(_0x1f9f45,_0x1f0cb4- -0x10e);}this[_0x47d7cc(-0xe3,-0x106)]=null;function _0x47d7cc(_0x41edfc,_0x235c3f){return _0x4c9e73(_0x235c3f,_0x41edfc- -0x604);}_0x38ea9b['colors']&&_0x38ea9b[_0x471332(0x456,0x44e)]&&(this['_colorRamp']=new mars3d__namespace['ColorRamp'](_0x38ea9b));}['_setOptionsHook'](_0x152848,_0x1576f3){function _0x9c331(_0x20eb05,_0x48d7c6){return _0x4c9e73(_0x20eb05,_0x48d7c6- -0xce);}function _0x39484b(_0x2a1668,_0x3c6669){return _0x2b892e(_0x3c6669,_0x2a1668- -0x364);}this['frameTime']=0x3e8/(_0x152848[_0x39484b(0xe5,0x148)]||0xa),this[_0x39484b(0x68,0xdf)]=this['options']['pointerEvents']??![],this[_0x39484b(0x2,0x16)]=_0x152848['color']||_0x39484b(0x101,0x178),this['lineWidth']=_0x152848['lineWidth']||0x1,this['fixedHeight']=_0x152848['fixedHeight']??0x0,this['reverseY']=_0x152848['reverseY']??![],this['windField']&&this['windField']['setOptions'](_0x152848);}get[_0x4c9e73(0x5a9,0x53a)](){return this['canvas'];}get['canvasWidth'](){function _0x320bd6(_0x5dd07c,_0x4f2853){return _0x2b892e(_0x4f2853,_0x5dd07c- -0x1d5);}function _0x581b0e(_0x531ff1,_0x3f39c5){return _0x2b892e(_0x531ff1,_0x3f39c5- -0x1e2);}return this['_map']['scene'][_0x320bd6(0x23a,0x2c6)][_0x320bd6(0x248,0x242)];}get['canvasHeight'](){function _0x3f5258(_0x5a8d0e,_0x77a1f4){return _0x2b892e(_0x77a1f4,_0x5a8d0e- -0x1ad);}return this['_map']['scene'][_0x3f5258(0x262,0x29e)]['clientHeight'];}get['pointerEvents'](){return this['_pointerEvents'];}set['pointerEvents'](_0x110b15){function _0x595b4f(_0x537e99,_0x15ec15){return _0x4c9e73(_0x537e99,_0x15ec15- -0x1d5);}this['_pointerEvents']=_0x110b15;if(!this['canvas'])return;_0x110b15?this['canvas']['style'][_0x595b4f(0x31f,0x34e)]='all':this['canvas']['style']['pointer-events']='none';}get['particlesNumber'](){return this['options']['particlesNumber'];}set['particlesNumber'](_0x425f35){this['options']['particlesNumber']=_0x425f35;function _0x27a730(_0x23034f,_0x45c78f){return _0x4c9e73(_0x23034f,_0x45c78f- -0x591);}clearTimeout(this['_canrefresh']),this[_0x27a730(-0xf7,-0xa1)]=setTimeout(()=>{this['redraw']();},0x1f4);}get['speedRate'](){return this['options']['speedRate'];}set[_0x2b892e(0x426,0x3a6)](_0x4072d0){function _0x10636d(_0x249934,_0x4de2a6){return _0x4c9e73(_0x4de2a6,_0x249934- -0x3a9);}this['options'][_0x5a5843(0x525,0x4c2)]=_0x4072d0;function _0x5a5843(_0x33759d,_0x4d13b3){return _0x2b892e(_0x4d13b3,_0x33759d-0x17f);}this[_0x10636d(0xbc,0xa8)]&&(this['windField'][_0x5a5843(0x525,0x573)]=_0x4072d0);}get['maxAge'](){function _0x3b2f01(_0x5af417,_0x58c741){return _0x2b892e(_0x5af417,_0x58c741- -0x266);}return this['options'][_0x3b2f01(0x1b4,0x1f8)];}set['maxAge'](_0x170d92){function _0x5aa9eb(_0x7602cd,_0x24b18c){return _0x4c9e73(_0x7602cd,_0x24b18c- -0x12b);}this[_0x659558(0x3f3,0x488)][_0x659558(0x5ab,0x56d)]=_0x170d92;function _0x659558(_0x77b38b,_0x3b86d3){return _0x4c9e73(_0x77b38b,_0x3b86d3- -0x3);}this['windField']&&(this[_0x659558(0x3f7,0x462)][_0x659558(0x51c,0x56d)]=_0x170d92);}get['data'](){return this['windData'];}set['data'](_0x2a8442){this['setData'](_0x2a8442);}['_showHook'](_0xb6db4a){function _0x126b42(_0x497c78,_0x52cf9a){return _0x4c9e73(_0x52cf9a,_0x497c78-0x10d);}function _0x41dce8(_0x565f23,_0x11d22b){return _0x4c9e73(_0x565f23,_0x11d22b- -0x359);}_0xb6db4a?this['_addedHook']():(this[_0x41dce8(0x22d,0x1d4)]&&(this[_0x126b42(0x598,0x51a)][_0x126b42(0x5a3,0x5a1)]=this['windData']),this['_removedHook']());}[_0x2b892e(0x423,0x416)](){function _0x68e41b(_0xab7c4d,_0x26e4b4){return _0x4c9e73(_0xab7c4d,_0x26e4b4- -0x51e);}function _0x702375(_0x5552a5,_0x392cc3){return _0x2b892e(_0x392cc3,_0x5552a5- -0x4e9);}this['options']['worker']?this['initWorker']():this[_0x702375(-0x196,-0x1ae)]=new CanvasWindField(this[_0x68e41b(-0xda,-0x93)]);}['_addedHook'](){this['canvas']=this['_createCanvas']();function _0x25f046(_0x54aed5,_0xc4ba54){return _0x4c9e73(_0x54aed5,_0xc4ba54- -0x2f6);}const _0x1015cd={};_0x1015cd['willReadFrequently']=!![],this[_0x2abd95(0x32a,0x3a6)]=this[_0x25f046(0x1d0,0x22b)]['getContext']('2d',_0x1015cd),this['bindEvent']();function _0x2abd95(_0x1c9f55,_0x1c83ad){return _0x2b892e(_0x1c83ad,_0x1c9f55- -0x91);}this[_0x2abd95(0x2e8,0x275)]['data']&&this['setData'](this['options'][_0x25f046(0x19e,0x1a0)]);}['_removedHook'](){this['clear']();function _0x3be4f8(_0x2d37f1,_0x3a5d08){return _0x2b892e(_0x2d37f1,_0x3a5d08- -0x360);}function _0x4f514e(_0x6af10c,_0x393cdd){return _0x2b892e(_0x393cdd,_0x6af10c- -0x161);}this['unbindEvent'](),this[_0x4f514e(0x2ae,0x2ea)]&&(this['_map']['container']['removeChild'](this[_0x3be4f8(0x59,0xaf)]),delete this['canvas']);}[_0x4c9e73(0x4c2,0x547)](){const _0x57896e=mars3d__namespace[_0x1dc19f(0x4c9,0x459)][_0x5d7daf(0x2ae,0x31f)]('canvas','mars3d-canvasWind',this['_map'][_0x1dc19f(0x432,0x48b)]);_0x57896e['style']['position']=_0x5d7daf(0x399,0x39d);function _0x1dc19f(_0x221fcb,_0x282a){return _0x4c9e73(_0x221fcb,_0x282a- -0x5e);}_0x57896e['style'][_0x5d7daf(0x3d5,0x34e)]=_0x1dc19f(0x4e7,0x4f5);function _0x5d7daf(_0xa868ee,_0x5cbc5d){return _0x4c9e73(_0xa868ee,_0x5cbc5d- -0x15f);}return _0x57896e['style']['left']='0px',_0x57896e[_0x1dc19f(0x4cb,0x465)][_0x5d7daf(0x3a1,0x3a9)]=this['_map']['scene']['canvas']['clientWidth']+'px',_0x57896e['style'][_0x1dc19f(0x44e,0x4ac)]=this[_0x5d7daf(0x3f5,0x3dd)]['scene']['canvas'][_0x1dc19f(0x3cd,0x416)]+'px',_0x57896e['style']['pointerEvents']=this['_pointerEvents']?'auto':'none',_0x57896e[_0x1dc19f(0x4c8,0x465)][_0x1dc19f(0x490,0x4d2)]=this[_0x5d7daf(0x321,0x32c)]['zIndex']??0x9,_0x57896e['width']=this['_map']['scene'][_0x5d7daf(0x37c,0x3c2)]['clientWidth'],_0x57896e[_0x5d7daf(0x378,0x3ab)]=this['_map'][_0x1dc19f(0x4da,0x4b6)]['canvas']['clientHeight'],_0x57896e;}[_0x2b892e(0x3f7,0x394)](){function _0x586596(_0x363d47,_0x5b3156){return _0x2b892e(_0x5b3156,_0x363d47- -0x2a9);}function _0x4717dd(_0x2081d9,_0x44c015){return _0x4c9e73(_0x2081d9,_0x44c015- -0x1e9);}this['canvas']&&(this['canvas']['style']['width']=this['_map']['scene']['canvas'][_0x586596(0x174,0xe4)]+'px',this['canvas']['style']['height']=this['_map']['scene'][_0x4717dd(0x380,0x338)][_0x586596(0xb9,0xcb)]+'px',this['canvas']['width']=this['_map']['scene'][_0x586596(0x166,0x127)]['clientWidth'],this['canvas']['height']=this[_0x586596(0x181,0x16d)][_0x4717dd(0x2ce,0x32b)][_0x4717dd(0x2e8,0x338)]['clientHeight']);}['bindEvent'](){function _0x51e1cc(_0x3fccb8,_0x34964c){return _0x4c9e73(_0x3fccb8,_0x34964c- -0x5c8);}function _0x3eb7ac(_0x29c89a,_0x6801fb){return _0x2b892e(_0x29c89a,_0x6801fb- -0x54e);}const _0x187f5b=this;let _0x37f69=Date['now']();(function _0x20c71f(){_0x187f5b['animateFrame']=window['requestAnimationFrame'](_0x20c71f);function _0x16501b(_0x2d39f2,_0x19b086){return _0x1637(_0x19b086- -0x16c,_0x2d39f2);}function _0x110a52(_0x5aaf6c,_0x5597db){return _0x1637(_0x5597db-0x83,_0x5aaf6c);}if(_0x187f5b[_0x110a52(0x2c7,0x262)]&&_0x187f5b[_0x16501b(0x97,0x53)]){const _0x586aec=Date[_0x16501b(0x152,0x110)](),_0x526af7=_0x586aec-_0x37f69;_0x526af7>_0x187f5b[_0x16501b(0x17b,0x103)]&&(_0x37f69=_0x586aec-_0x526af7%_0x187f5b['frameTime'],_0x187f5b[_0x16501b(0x139,0xf9)]());}}(),window['addEventListener']('resize',this[_0x51e1cc(-0x178,-0x122)]['bind'](this),![]),this[_0x3eb7ac(-0x119,-0x14f)]=![],this[_0x51e1cc(-0x18b,-0xff)]=![],this[_0x51e1cc(-0x164,-0x13d)]['mouseHidden']&&(this[_0x3eb7ac(-0xb0,-0x124)]['on'](mars3d__namespace[_0x51e1cc(-0x50,-0x78)][_0x51e1cc(-0x75,-0x4b)],this[_0x3eb7ac(-0x179,-0x1b1)],this),this[_0x51e1cc(-0x67,-0x8c)]['on'](mars3d__namespace[_0x51e1cc(0x6,-0x78)]['mouseDown'],this[_0x3eb7ac(-0x1a4,-0x129)],this),this[_0x3eb7ac(-0xb8,-0x124)]['on'](mars3d__namespace['EventType'][_0x3eb7ac(-0x1a6,-0x1bf)],this['_onMouseUpEvent'],this)));}['unbindEvent'](){function _0xc268b8(_0x3ac4e6,_0x1d1d92){return _0x4c9e73(_0x3ac4e6,_0x1d1d92- -0x480);}window['cancelAnimationFrame'](this['animateFrame']),delete this[_0x3f5d7e(0x137,0x172)],window[_0xc268b8(0x85,0xc9)]('resize',this['resize']);function _0x3f5d7e(_0x2f20ee,_0x25489e){return _0x2b892e(_0x2f20ee,_0x25489e- -0x26e);}this['options'][_0xc268b8(0x3b,0x1b)]&&(this['_map'][_0xc268b8(-0x6,0x33)](mars3d__namespace['EventType']['wheel'],this['_onMapWhellEvent'],this),this['_map'][_0x3f5d7e(0xc7,0x133)](mars3d__namespace[_0xc268b8(0x10a,0xd0)]['mouseDown'],this['_onMouseDownEvent'],this),this[_0x3f5d7e(0x1ff,0x1bc)]['off'](mars3d__namespace[_0x3f5d7e(0x1af,0x1d0)]['mouseUp'],this[_0x3f5d7e(0x16b,0xeb)],this),this[_0xc268b8(0xf1,0xbc)]['off'](mars3d__namespace[_0xc268b8(0xe9,0xd0)]['mouseMove'],this[_0xc268b8(-0x21,0x32)],this));}[_0x2b892e(0x333,0x39d)](_0x3f5139){clearTimeout(this[_0x2e32a7(0x3d,-0x55)]);if(!this['show']||!this[_0x16af5b(-0x90,-0x2b)])return;this[_0x2e32a7(0x69,0x14)]['style'][_0x16af5b(0x93,0x34)]='hidden';function _0x16af5b(_0x5e7b6c,_0x495cbc){return _0x4c9e73(_0x5e7b6c,_0x495cbc- -0x54c);}function _0x2e32a7(_0x2a5c17,_0x3bc95d){return _0x2b892e(_0x3bc95d,_0x2a5c17- -0x3a6);}this['refreshTimer']=setTimeout(()=>{if(!this['show'])return;function _0xe06141(_0x1c6272,_0x39260c){return _0x16af5b(_0x39260c,_0x1c6272-0x1c6);}this['redraw'](),this['canvas']['style']['visibility']=_0xe06141(0xfe,0x113);},0xc8);}['_onMouseDownEvent'](_0x19a86b){function _0x1682ee(_0x41abda,_0x58aced){return _0x2b892e(_0x41abda,_0x58aced-0x17f);}this[_0x1682ee(0x57f,0x57e)]=!![];function _0x1faeb3(_0x583a77,_0x586a8f){return _0x4c9e73(_0x583a77,_0x586a8f- -0x253);}this['_map'][_0x1faeb3(0x25f,0x260)](mars3d__namespace['EventType']['mouseMove'],this['_onMouseMoveEvent'],this),this['_map']['on'](mars3d__namespace[_0x1faeb3(0x372,0x2fd)][_0x1682ee(0x567,0x551)],this['_onMouseMoveEvent'],this);}[_0x4c9e73(0x4f1,0x4b2)](_0x53f7b8){if(!this[_0x3641e0(-0x19b,-0x175)]||!this['canvas'])return;function _0x3641e0(_0x357d3e,_0x38091){return _0x4c9e73(_0x38091,_0x357d3e- -0x620);}this['mouse_down']&&(this['canvas']['style']['visibility']='hidden',this['mouse_move']=!![]);}[_0x4c9e73(0x3d9,0x46b)](_0x33f4c9){if(!this['show']||!this['canvas'])return;function _0x155fac(_0x2a4410,_0xb9329f){return _0x2b892e(_0x2a4410,_0xb9329f- -0x439);}function _0xb2804a(_0x34805c,_0x222dae){return _0x4c9e73(_0x222dae,_0x34805c- -0x521);}this['_map'][_0x155fac(-0x91,-0x98)](mars3d__namespace[_0xb2804a(0x2f,0xbd)]['mouseMove'],this[_0x155fac(-0x37,-0x99)],this),this['mouse_down']&&this[_0x155fac(-0x78,-0x82)]&&this['redraw'](),this['canvas']['style'][_0x155fac(0x49,0x35)]='visible',this['mouse_down']=![],this['mouse_move']=![];}['setData'](_0xba55ee){function _0x3866c6(_0x24d887,_0x3cbb74){return _0x4c9e73(_0x3cbb74,_0x24d887-0xd9);}this[_0x1c2108(-0x13f,-0x143)](),this['windData']=_0xba55ee,this['windField'][_0x3866c6(0x5b2,0x52f)](_0xba55ee);function _0x1c2108(_0xf41028,_0xda541c){return _0x4c9e73(_0xda541c,_0xf41028- -0x5d0);}this['redraw']();}['redraw'](){function _0x1db080(_0x500437,_0x4103ca){return _0x2b892e(_0x500437,_0x4103ca-0x11d);}if(!this['show'])return;this['windField']['setOptions'](this['options']),this[_0x1db080(0x541,0x516)]();}['update'](){function _0x194ce8(_0x57a3b8,_0x133053){return _0x4c9e73(_0x133053,_0x57a3b8- -0x677);}if(this['_updateIng'])return;this['_updateIng']=!![];if(this['worker'])this[_0x194ce8(-0x212,-0x1f0)]['update']();else{const _0x54d49d=this['windField'][_0x194ce8(-0x117,-0xb5)]();this[_0x194ce8(-0x118,-0x9f)](_0x54d49d);}function _0x59d36d(_0x25d953,_0x5c5181){return _0x4c9e73(_0x5c5181,_0x25d953- -0x4d5);}this['_updateIng']=![];}['_drawLines'](_0x334d02){this['canvasContext'][_0x8354fb(-0x4b,0x3e)]='destination-in',this['canvasContext']['fillRect'](0x0,0x0,this['canvasWidth'],this['canvasHeight']);function _0x8354fb(_0x30dd89,_0x1154c0){return _0x4c9e73(_0x1154c0,_0x30dd89- -0x516);}this['canvasContext'][_0x3d00d7(0x1b0,0x1a2)]=_0x8354fb(-0x59,0xc);function _0x3d00d7(_0x3bbb4d,_0xd143f9){return _0x4c9e73(_0x3bbb4d,_0xd143f9- -0x329);}this['canvasContext'][_0x8354fb(0x1f,0x14)]=0.9;const _0x561460=this[_0x3d00d7(0x1eb,0x213)][_0x8354fb(-0x2,-0x36)][_0x3d00d7(0x144,0x14c)]!==Cesium['SceneMode']['SCENE3D'],_0x45fb6c=this['canvasWidth']*0.25;if(this['_colorRamp'])for(let _0x1a8d1f=0x0,_0x2c9845=_0x334d02['length'];_0x1a8d1f<_0x2c9845;_0x1a8d1f++){const _0x203fc0=_0x334d02[_0x1a8d1f],_0x573a4d=this['_tomap'](_0x203fc0['lng'],_0x203fc0['lat'],_0x203fc0),_0x5b7c1e=this['_tomap'](_0x203fc0['tlng'],_0x203fc0[_0x8354fb(-0x66,0x20)],_0x203fc0);if(!_0x573a4d||!_0x5b7c1e)continue;if(_0x561460&&Math['abs'](_0x573a4d[0x0]-_0x5b7c1e[0x0])>=_0x45fb6c)continue;this['canvasContext']['beginPath'](),this[_0x3d00d7(0x134,0x1a4)][_0x3d00d7(0xd1,0x131)]=this[_0x8354fb(-0xbc,-0x130)],this['canvasContext']['strokeStyle']=this['_colorRamp'][_0x8354fb(-0x12,0x0)](_0x203fc0['speed']),this['canvasContext'][_0x8354fb(0x56,0x86)](_0x573a4d[0x0],_0x573a4d[0x1]),this[_0x8354fb(-0x49,-0x76)]['lineTo'](_0x5b7c1e[0x0],_0x5b7c1e[0x1]),this['canvasContext']['stroke']();}else{this[_0x8354fb(-0x49,-0x9b)]['beginPath'](),this[_0x3d00d7(0x12b,0x1a4)][_0x3d00d7(0xf8,0x131)]=this['lineWidth'],this[_0x8354fb(-0x49,-0x2d)]['strokeStyle']=this['color'];for(let _0x487294=0x0,_0x422563=_0x334d02[_0x8354fb(0x34,0xc9)];_0x487294<_0x422563;_0x487294++){const _0x39b829=_0x334d02[_0x487294],_0x308c83=this[_0x3d00d7(0x15f,0x175)](_0x39b829['lng'],_0x39b829[_0x8354fb(-0x57,-0x2e)],_0x39b829),_0x254f5a=this['_tomap'](_0x39b829[_0x3d00d7(0x1df,0x1a8)],_0x39b829[_0x3d00d7(0x1b5,0x187)],_0x39b829);if(!_0x308c83||!_0x254f5a)continue;if(_0x561460&&Math['abs'](_0x308c83[0x0]-_0x254f5a[0x0])>=_0x45fb6c)continue;this['canvasContext'][_0x3d00d7(0x2b0,0x243)](_0x308c83[0x0],_0x308c83[0x1]),this[_0x3d00d7(0x133,0x1a4)]['lineTo'](_0x254f5a[0x0],_0x254f5a[0x1]);}this[_0x8354fb(-0x49,-0xae)][_0x3d00d7(0x1b5,0x234)]();}}['_tomap'](_0x6c487c,_0x5d67a8,_0x598580){function _0xdabde1(_0x38e5d4,_0x9ad4e8){return _0x4c9e73(_0x38e5d4,_0x9ad4e8- -0x10a);}const _0x776f99=Cesium['Cartesian3'][_0xdabde1(0x378,0x398)](_0x6c487c,_0x5d67a8,this['fixedHeight']),_0x49c236=this['_map']['scene'];function _0x52fc44(_0x3b56fb,_0xb226cd){return _0x2b892e(_0xb226cd,_0x3b56fb- -0x17);}if(_0x49c236['mode']===Cesium['SceneMode']['SCENE3D']){const _0x428314=new Cesium['EllipsoidalOccluder'](_0x49c236['globe']['ellipsoid'],_0x49c236[_0x52fc44(0x385,0x340)][_0x52fc44(0x395,0x40b)]),_0x300ba5=_0x428314['isPointVisible'](_0x776f99);if(!_0x300ba5)return _0x598580[_0x52fc44(0x456,0x484)]=0x0,null;}const _0x1e3a7a=Cesium[_0xdabde1(0x440,0x3cc)][_0xdabde1(0x46f,0x44e)](this['_map']['scene'],_0x776f99);return _0x1e3a7a?[_0x1e3a7a['x'],_0x1e3a7a['y']]:null;}[_0x4c9e73(0x4b9,0x491)](){function _0x347356(_0x37c46b,_0x5334d9){return _0x2b892e(_0x37c46b,_0x5334d9- -0x2b1);}this['windField']['clear'](),delete this[_0x347356(0xf3,0x16a)];}['initWorker'](){this[_0x21221e(0x2fa,0x29b)]=new Worker(this['options'][_0x21221e(0x279,0x29b)]),this['worker'][_0x21221e(0x3b5,0x397)]=_0x5fe6ec=>{function _0x336cb4(_0x1dc3bf,_0x5ca428){return _0x21221e(_0x1dc3bf,_0x5ca428- -0x19);}function _0x48ec02(_0x2c2f73,_0x59458e){return _0x21221e(_0x59458e,_0x2c2f73- -0x2d);}this[_0x336cb4(0x346,0x370)](_0x5fe6ec[_0x336cb4(0x2b6,0x2a7)]['particles']),this[_0x336cb4(0x244,0x2b5)]=![];};function _0x21221e(_0x102f39,_0x316062){return _0x4c9e73(_0x102f39,_0x316062- -0x1d6);}function _0x1dd421(_0x50a55e,_0xd4c1eb){return _0x4c9e73(_0x50a55e,_0xd4c1eb- -0x382);}this[_0x1dd421(0x15c,0xe3)]={'init':_0x540cb9=>{function _0x115ac4(_0x53311b,_0x286054){return _0x1dd421(_0x286054,_0x53311b- -0x20f);}const _0x4f70f6={};_0x4f70f6['type']='init',_0x4f70f6['options']=_0x540cb9,this['worker'][_0x115ac4(-0x72,-0x19)](_0x4f70f6);},'setOptions':_0x384617=>{const _0x1b45b3={};_0x1b45b3['type']='setOptions',_0x1b45b3['options']=_0x384617,this['worker']['postMessage'](_0x1b45b3);},'setDate':_0x145ecd=>{const _0x87bc83={};function _0x44c852(_0x56a531,_0x3960ee){return _0x21221e(_0x3960ee,_0x56a531- -0x5a);}_0x87bc83['type']=_0x44c852(0x2a9,0x315),_0x87bc83['data']=_0x145ecd,this['worker']['postMessage'](_0x87bc83);},'update':()=>{if(this['_updateIng2'])return;this[_0x10c3d0(0x3bd,0x41f)]=!![];function _0x12159b(_0xbd7eee,_0x1d0f89){return _0x1dd421(_0xbd7eee,_0x1d0f89- -0x231);}const _0x1a957a={};function _0x10c3d0(_0xdef1fd,_0x2431ff){return _0x1dd421(_0x2431ff,_0xdef1fd-0x29b);}_0x1a957a['type']='update',this[_0x12159b(-0xd1,-0x142)]['postMessage'](_0x1a957a);},'clear':()=>{const _0x49c062={};_0x49c062['type']='clear',this['worker']['postMessage'](_0x49c062);}},this[_0x21221e(0x317,0x28f)][_0x21221e(0x40d,0x37f)](this[_0x1dd421(0xaf,0x109)]);}}function _0x1637(_0x2b6615,_0xfdba2f){const _0x59fba0=_0x59fb();return _0x1637=function(_0x1637a4,_0x165d63){_0x1637a4=_0x1637a4-0x1b1;let _0xc43523=_0x59fba0[_0x1637a4];return _0xc43523;},_0x1637(_0x2b6615,_0xfdba2f);}mars3d__namespace['LayerUtil'][_0x4c9e73(0x452,0x468)]('canvasWind',CanvasWindLayer),mars3d__namespace['layer']['CanvasWindLayer']=CanvasWindLayer,mars3d__namespace['CanvasWindField']=CanvasWindField;function _0x2b892e(_0x4b512e,_0x7a6aa9){return _0x1637(_0x7a6aa9-0x194,_0x4b512e);}mars3d__namespace[_0x2b892e(0x3ec,0x398)]=WindUtil;function _0x4c9e73(_0x1922ae,_0x54fb50){return _0x1637(_0x54fb50-0x2a6,_0x1922ae);}function _0x59fb(){const _0x39934e=['style','6214565kfXbWx','vdata','__proto__','reverse','screen','mouse_move','colors','globalCompositeOperation','THREE_PI_OVER_TWO','canvasContext','destroyParticlesTextures','umax','red','tlng','nextTrailsDepth','_randomParticle','textures','Color','SceneTransforms','73038OUVImT','segments','setDate','getExtent','ShaderSource','postProcessingSpeed','reverseY','_pointerEvents','xmin','particleSystem','uniform\x20sampler2D\x20nextParticlesPosition;\x0auniform\x20sampler2D\x20nextParticlesSpeed;\x20//\x20(u,\x20v,\x20w,\x20normalization)\x0a\x0a//\x20range\x20(min,\x20max)\x0auniform\x20vec2\x20lonRange;\x0auniform\x20vec2\x20latRange;\x0a\x0auniform\x20float\x20randomCoefficient;\x20//\x20use\x20to\x20improve\x20the\x20pseudo-random\x20generator\x0auniform\x20float\x20dropRate;\x20//\x20drop\x20rate\x20is\x20a\x20chance\x20a\x20particle\x20will\x20restart\x20at\x20random\x20position\x20to\x20avoid\x20degeneration\x0auniform\x20float\x20dropRateBump;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0a//\x20pseudo-random\x20generator\x0aconst\x20vec3\x20randomConstants\x20=\x20vec3(12.9898,\x2078.233,\x204375.85453);\x0aconst\x20vec2\x20normalRange\x20=\x20vec2(0.0,\x201.0);\x0afloat\x20rand(vec2\x20seed,\x20vec2\x20range)\x20{\x0a\x20\x20\x20\x20vec2\x20randomSeed\x20=\x20randomCoefficient\x20*\x20seed;\x0a\x20\x20\x20\x20float\x20temp\x20=\x20dot(randomConstants.xy,\x20randomSeed);\x0a\x20\x20\x20\x20temp\x20=\x20fract(sin(temp)\x20*\x20(randomConstants.z\x20+\x20temp));\x0a\x20\x20\x20\x20return\x20temp\x20*\x20(range.y\x20-\x20range.x)\x20+\x20range.x;\x0a}\x0a\x0avec3\x20generateRandomParticle(vec2\x20seed,\x20float\x20lev)\x20{\x0a\x20\x20\x20\x20//\x20ensure\x20the\x20longitude\x20is\x20in\x20[0,\x20360]\x0a\x20\x20\x20\x20float\x20randomLon\x20=\x20mod(rand(seed,\x20lonRange),\x20360.0);\x0a\x20\x20\x20\x20float\x20randomLat\x20=\x20rand(-seed,\x20latRange);\x0a\x0a\x20\x20\x20\x20return\x20vec3(randomLon,\x20randomLat,\x20lev);\x0a}\x0a\x0abool\x20particleOutbound(vec3\x20particle)\x20{\x0a\x20\x20\x20\x20return\x20particle.y\x20<\x20-90.0\x20||\x20particle.y\x20>\x2090.0;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec3\x20nextParticle\x20=\x20texture(nextParticlesPosition,\x20v_textureCoordinates).rgb;\x0a\x20\x20\x20\x20vec4\x20nextSpeed\x20=\x20texture(nextParticlesSpeed,\x20v_textureCoordinates);\x0a\x20\x20\x20\x20float\x20particleDropRate\x20=\x20dropRate\x20+\x20dropRateBump\x20*\x20nextSpeed.a;\x0a\x0a\x20\x20\x20\x20vec2\x20seed1\x20=\x20nextParticle.xy\x20+\x20v_textureCoordinates;\x0a\x20\x20\x20\x20vec2\x20seed2\x20=\x20nextSpeed.xy\x20+\x20v_textureCoordinates;\x0a\x20\x20\x20\x20vec3\x20randomParticle\x20=\x20generateRandomParticle(seed1,\x20nextParticle.z);\x0a\x20\x20\x20\x20float\x20randomNumber\x20=\x20rand(seed2,\x20normalRange);\x0a\x0a\x20\x20\x20\x20if\x20(randomNumber\x20<\x20particleDropRate\x20||\x20particleOutbound(nextParticle))\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20vec4(randomParticle,\x201.0);\x20//\x201.0\x20means\x20this\x20is\x20a\x20random\x20particle\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20vec4(nextParticle,\x200.0);\x0a\x20\x20\x20\x20}\x0a}\x0a','Cartesian3','north','mouseMove','outputTexture','createRawRenderState','IDENTITY','PI_OVER_THREE','container','windTextures','destroy','particlesTextures','currentParticlesSpeed','maxParticles','lng','_canrefresh','add','animateFrame','depthMask','currentParticlesPosition','refreshTimer','speedFactor','bind','globe','addPrimitives','createComputingPrimitives','createRenderingPrimitives','absolute','latRange','setGeometry','grid','NEAREST','viewerParameters','sources','postProcessingPosition','getColor','particlesRendering','particleHeight','updateViewerParameters','width','createRenderingFramebuffers','height','update','mouseDown','applyViewerParameters','Pass','blue','pixelDatatype','mouse_down','_speedRate','keys','scene','frameTime','updatePosition','currentTrails','computeViewRectangle','attributeLocations','defined','viewRectangleToLonLatRange','1890966HWAZuN','getV','commandType','postMessage','nextTrails','canvas','now','pointer-events','RGBA','primitives','LINEAR','fromGeometry','_mountedHook','xmax','2293293BWoNUO','source','particlesNumber','windData','ComponentDatatype','clientWidth','zIndex','refreshParticles','RGB','addEventListener','canvasResize','globalAlpha','getRandomLatLng','_onMouseDownEvent','fill','ceil','layer','GeometryAttributes','_map','LayerUtil','currentTrailsColor','uniform\x20sampler2D\x20segmentsColorTexture;\x0auniform\x20sampler2D\x20segmentsDepthTexture;\x0a\x0auniform\x20sampler2D\x20currentTrailsColor;\x0auniform\x20sampler2D\x20trailsDepthTexture;\x0a\x0auniform\x20float\x20fadeOpacity;\x0a\x0ain\x20vec2\x20textureCoordinate;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec4\x20pointsColor\x20=\x20texture(segmentsColorTexture,\x20textureCoordinate);\x0a\x20\x20\x20\x20vec4\x20trailsColor\x20=\x20texture(currentTrailsColor,\x20textureCoordinate);\x0a\x0a\x20\x20\x20\x20trailsColor\x20=\x20floor(fadeOpacity\x20*\x20255.0\x20*\x20trailsColor)\x20/\x20255.0;\x20//\x20make\x20sure\x20the\x20trailsColor\x20will\x20be\x20strictly\x20decreased\x0a\x0a\x20\x20\x20\x20float\x20pointsDepth\x20=\x20texture(segmentsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20\x20\x20float\x20trailsDepth\x20=\x20texture(trailsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20\x20\x20float\x20globeDepth\x20=\x20czm_unpackDepth(texture(czm_globeDepthTexture,\x20textureCoordinate));\x0a\x0a\x20\x20\x20\x20out_FragColor\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20if\x20(pointsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20out_FragColor\x20+\x20pointsColor;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20if\x20(trailsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20out_FragColor\x20+\x20trailsColor;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20gl_FragDepth\x20=\x20min(pointsDepth,\x20trailsDepth);\x0a}\x0a','fixedHeight','persists','_maxAge','clearCommand','toDegrees','udata','1756zTIkXc','_createCanvas','commandList','removeEventListener','length','commandToExecute','createSegmentsGeometry','max','fragmentShaderSource','lonRange','EventType','_calc_speedRate','owner','0px','WindLayer','init','_onMap_preRenderEvent','rows','wgs84ToWindowCoordinates','remove','lev','frameRate','steps','stroke','Cesium','_drawLines','getParticles','cols','log','vmax','pixelFormat','preExecute','framebuffers','getSpeed','STATIC_DRAW','isInExtent','FLOAT','createTexture','moveTo','onmessage','updateSpeed','sqrt','maxAge','VertexArray','segmentsColor','min','DISABLE_LOG_DEPTH_FRAGMENT_WRITE','TextureMagnificationFilter','autoClear','#ffffff','getColorTexture','7380909ISQZzx','random','createParticlesTextures','ymax','wheel','redraw','age','visibility','getU','setOptions','viewport','forEach','lineWidth','particlesTextureSize','Matrix4','destroyObject','push','trails','PixelDatatype','_data','nextParticlesSpeed','PI_OVER_TWO','uniform\x20sampler2D\x20postProcessingPosition;\x0auniform\x20sampler2D\x20nextParticlesSpeed;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec4\x20randomParticle\x20=\x20texture(postProcessingPosition,\x20v_textureCoordinates);\x0a\x20\x20\x20\x20vec4\x20particleSpeed\x20=\x20texture(nextParticlesSpeed,\x20v_textureCoordinates);\x0a\x0a\x20\x20\x20\x20if\x20(randomParticle.a\x20>\x200.0)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20particleSpeed;\x0a\x20\x20\x20\x20}\x0a}\x0a','windField','geometry','Draw','register','clearFramebuffers','dropRate','_onMouseUpEvent','_removedHook','depthTest','defines','shaderProgram','DEPTH_COMPONENT','worker','_calcUV','position','clientHeight','mode','removeAll','in\x20vec3\x20position;\x0ain\x20vec2\x20st;\x0a\x0aout\x20vec2\x20textureCoordinate;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20textureCoordinate\x20=\x20st;\x0a\x20\x20\x20\x20gl_Position\x20=\x20vec4(position,\x201.0);\x0a}\x0a','color','cos','canrefresh','sin','setData','168ghsQuY','create','framebuffer','randomBetween','particles','vertexShaderSource','particlesComputing','visible','show','Rectangle','uniform\x20sampler2D\x20currentParticlesSpeed;\x20//\x20(u,\x20v,\x20w,\x20normalization)\x0auniform\x20sampler2D\x20particlesWind;\x0a\x0a//\x20used\x20to\x20calculate\x20the\x20wind\x20norm\x0auniform\x20vec2\x20uSpeedRange;\x20//\x20(min,\x20max);\x0auniform\x20vec2\x20vSpeedRange;\x0auniform\x20float\x20pixelSize;\x0auniform\x20float\x20speedFactor;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0afloat\x20calculateWindNorm(vec3\x20speed)\x20{\x0a\x20\x20\x20\x20vec3\x20percent\x20=\x20vec3(0.0);\x0a\x20\x20\x20\x20percent.x\x20=\x20(speed.x\x20-\x20uSpeedRange.x)\x20/\x20(uSpeedRange.y\x20-\x20uSpeedRange.x);\x0a\x20\x20\x20\x20percent.y\x20=\x20(speed.y\x20-\x20vSpeedRange.x)\x20/\x20(vSpeedRange.y\x20-\x20vSpeedRange.x);\x0a\x20\x20\x20\x20float\x20normalization\x20=\x20length(percent);\x0a\x0a\x20\x20\x20\x20return\x20normalization;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20\x20\x20//\x20vec3\x20currentSpeed\x20=\x20texture(currentParticlesSpeed,\x20v_textureCoordinates).rgb;\x0a\x20\x20\x20\x20vec3\x20windVector\x20=\x20texture(particlesWind,\x20v_textureCoordinates).rgb;\x0a\x0a\x20\x20\x20\x20vec4\x20nextSpeed\x20=\x20vec4(speedFactor\x20*\x20pixelSize\x20*\x20windVector,\x20calculateWindNorm(windVector));\x0a\x20\x20\x20\x20out_FragColor\x20=\x20nextSpeed;\x0a}\x0a','PixelFormat','currentTrailsDepth','PrimitiveType','options','_addedHook','uniform\x20sampler2D\x20colorTable;\x0a\x0ain\x20float\x20speedNormalization;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20out_FragColor\x20=\x20texture(colorTable,\x20vec2(speedNormalization,\x200.0));\x0a}\x0a','getUVByPoint','vertexArray','ClearCommand','clear','getOptions','createFramebuffer','nextParticlesPosition','preRender','data','uniformMap','drawingBufferHeight','4892420AhELFH','lon','mouseHidden','//\x20the\x20size\x20of\x20UV\x20textures:\x20width\x20=\x20lon,\x20height\x20=\x20lat*lev\x0auniform\x20sampler2D\x20U;\x20//\x20eastward\x20wind\x0auniform\x20sampler2D\x20V;\x20//\x20northward\x20wind\x0a\x0auniform\x20sampler2D\x20currentParticlesPosition;\x20//\x20(lon,\x20lat,\x20lev)\x0a\x0auniform\x20vec3\x20dimension;\x20//\x20(lon,\x20lat,\x20lev)\x0auniform\x20vec3\x20minimum;\x20//\x20minimum\x20of\x20each\x20dimension\x0auniform\x20vec3\x20maximum;\x20//\x20maximum\x20of\x20each\x20dimension\x0auniform\x20vec3\x20interval;\x20//\x20interval\x20of\x20each\x20dimension\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avec2\x20mapPositionToNormalizedIndex2D(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20ensure\x20the\x20range\x20of\x20longitude\x20and\x20latitude\x0a\x20\x20\x20\x20lonLatLev.x\x20=\x20mod(lonLatLev.x,\x20360.0);\x0a\x20\x20\x20\x20lonLatLev.y\x20=\x20clamp(lonLatLev.y,\x20-90.0,\x2090.0);\x0a\x0a\x20\x20\x20\x20vec3\x20index3D\x20=\x20vec3(0.0);\x0a\x20\x20\x20\x20index3D.x\x20=\x20(lonLatLev.x\x20-\x20minimum.x)\x20/\x20interval.x;\x0a\x20\x20\x20\x20index3D.y\x20=\x20(lonLatLev.y\x20-\x20minimum.y)\x20/\x20interval.y;\x0a\x20\x20\x20\x20index3D.z\x20=\x20(lonLatLev.z\x20-\x20minimum.z)\x20/\x20interval.z;\x0a\x0a\x20\x20\x20\x20//\x20the\x20st\x20texture\x20coordinate\x20corresponding\x20to\x20(col,\x20row)\x20index\x0a\x20\x20\x20\x20//\x20example\x0a\x20\x20\x20\x20//\x20data\x20array\x20is\x20[0,\x201,\x202,\x203,\x204,\x205],\x20width\x20=\x203,\x20height\x20=\x202\x0a\x20\x20\x20\x20//\x20the\x20content\x20of\x20texture\x20will\x20be\x0a\x20\x20\x20\x20//\x20t\x201.0\x0a\x20\x20\x20\x20//\x20\x20\x20\x20|\x20\x203\x204\x205\x0a\x20\x20\x20\x20//\x20\x20\x20\x20|\x0a\x20\x20\x20\x20//\x20\x20\x20\x20|\x20\x200\x201\x202\x0a\x20\x20\x20\x20//\x20\x20\x200.0------1.0\x20s\x0a\x0a\x20\x20\x20\x20vec2\x20index2D\x20=\x20vec2(index3D.x,\x20index3D.z\x20*\x20dimension.y\x20+\x20index3D.y);\x0a\x20\x20\x20\x20vec2\x20normalizedIndex2D\x20=\x20vec2(index2D.x\x20/\x20dimension.x,\x20index2D.y\x20/\x20(dimension.y\x20*\x20dimension.z));\x0a\x20\x20\x20\x20return\x20normalizedIndex2D;\x0a}\x0a\x0afloat\x20getWind(sampler2D\x20windTexture,\x20vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20vec2\x20normalizedIndex2D\x20=\x20mapPositionToNormalizedIndex2D(lonLatLev);\x0a\x20\x20\x20\x20float\x20result\x20=\x20texture(windTexture,\x20normalizedIndex2D).r;\x0a\x20\x20\x20\x20return\x20result;\x0a}\x0a\x0aconst\x20mat4\x20kernelMatrix\x20=\x20mat4(\x0a\x20\x20\x20\x200.0,\x20-1.0,\x202.0,\x20-1.0,\x20//\x20first\x20column\x0a\x20\x20\x20\x202.0,\x200.0,\x20-5.0,\x203.0,\x20//\x20second\x20column\x0a\x20\x20\x20\x200.0,\x201.0,\x204.0,\x20-3.0,\x20//\x20third\x20column\x0a\x20\x20\x20\x200.0,\x200.0,\x20-1.0,\x201.0\x20//\x20fourth\x20column\x0a);\x0afloat\x20oneDimensionInterpolation(float\x20t,\x20float\x20p0,\x20float\x20p1,\x20float\x20p2,\x20float\x20p3)\x20{\x0a\x20\x20\x20\x20vec4\x20tVec4\x20=\x20vec4(1.0,\x20t,\x20t\x20*\x20t,\x20t\x20*\x20t\x20*\x20t);\x0a\x20\x20\x20\x20tVec4\x20=\x20tVec4\x20/\x202.0;\x0a\x20\x20\x20\x20vec4\x20pVec4\x20=\x20vec4(p0,\x20p1,\x20p2,\x20p3);\x0a\x20\x20\x20\x20return\x20dot((tVec4\x20*\x20kernelMatrix),\x20pVec4);\x0a}\x0a\x0afloat\x20calculateB(sampler2D\x20windTexture,\x20float\x20t,\x20float\x20lon,\x20float\x20lat,\x20float\x20lev)\x20{\x0a\x20\x20\x20\x20float\x20lon0\x20=\x20floor(lon)\x20-\x201.0\x20*\x20interval.x;\x0a\x20\x20\x20\x20float\x20lon1\x20=\x20floor(lon);\x0a\x20\x20\x20\x20float\x20lon2\x20=\x20floor(lon)\x20+\x201.0\x20*\x20interval.x;\x0a\x20\x20\x20\x20float\x20lon3\x20=\x20floor(lon)\x20+\x202.0\x20*\x20interval.x;\x0a\x0a\x20\x20\x20\x20float\x20p0\x20=\x20getWind(windTexture,\x20vec3(lon0,\x20lat,\x20lev));\x0a\x20\x20\x20\x20float\x20p1\x20=\x20getWind(windTexture,\x20vec3(lon1,\x20lat,\x20lev));\x0a\x20\x20\x20\x20float\x20p2\x20=\x20getWind(windTexture,\x20vec3(lon2,\x20lat,\x20lev));\x0a\x20\x20\x20\x20float\x20p3\x20=\x20getWind(windTexture,\x20vec3(lon3,\x20lat,\x20lev));\x0a\x0a\x20\x20\x20\x20return\x20oneDimensionInterpolation(t,\x20p0,\x20p1,\x20p2,\x20p3);\x0a}\x0a\x0afloat\x20interpolateOneTexture(sampler2D\x20windTexture,\x20vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20float\x20lon\x20=\x20lonLatLev.x;\x0a\x20\x20\x20\x20float\x20lat\x20=\x20lonLatLev.y;\x0a\x20\x20\x20\x20float\x20lev\x20=\x20lonLatLev.z;\x0a\x0a\x20\x20\x20\x20float\x20lat0\x20=\x20floor(lat)\x20-\x201.0\x20*\x20interval.y;\x0a\x20\x20\x20\x20float\x20lat1\x20=\x20floor(lat);\x0a\x20\x20\x20\x20float\x20lat2\x20=\x20floor(lat)\x20+\x201.0\x20*\x20interval.y;\x0a\x20\x20\x20\x20float\x20lat3\x20=\x20floor(lat)\x20+\x202.0\x20*\x20interval.y;\x0a\x0a\x20\x20\x20\x20vec2\x20coefficient\x20=\x20lonLatLev.xy\x20-\x20floor(lonLatLev.xy);\x0a\x20\x20\x20\x20float\x20b0\x20=\x20calculateB(windTexture,\x20coefficient.x,\x20lon,\x20lat0,\x20lev);\x0a\x20\x20\x20\x20float\x20b1\x20=\x20calculateB(windTexture,\x20coefficient.x,\x20lon,\x20lat1,\x20lev);\x0a\x20\x20\x20\x20float\x20b2\x20=\x20calculateB(windTexture,\x20coefficient.x,\x20lon,\x20lat2,\x20lev);\x0a\x20\x20\x20\x20float\x20b3\x20=\x20calculateB(windTexture,\x20coefficient.x,\x20lon,\x20lat3,\x20lev);\x0a\x0a\x20\x20\x20\x20return\x20oneDimensionInterpolation(coefficient.y,\x20b0,\x20b1,\x20b2,\x20b3);\x0a}\x0a\x0avec3\x20bicubic(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20https://en.wikipedia.org/wiki/Bicubic_interpolation#Bicubic_convolution_algorithm\x0a\x20\x20\x20\x20float\x20u\x20=\x20interpolateOneTexture(U,\x20lonLatLev);\x0a\x20\x20\x20\x20float\x20v\x20=\x20interpolateOneTexture(V,\x20lonLatLev);\x0a\x20\x20\x20\x20float\x20w\x20=\x200.0;\x0a\x20\x20\x20\x20return\x20vec3(u,\x20v,\x20w);\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20\x20\x20vec3\x20lonLatLev\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rgb;\x0a\x20\x20\x20\x20vec3\x20windVector\x20=\x20bicubic(lonLatLev);\x0a\x20\x20\x20\x20out_FragColor\x20=\x20vec4(windVector,\x200.0);\x0a}\x0a','dimensions','_tomap','clampToLatitudeRange','Sampler','mouseUp','fromDegrees','getFullscreenQuad','_updateIng2','toGridXY','resize','particlesWind','context','ALWAYS','WindUtil','toRadians','8ltERPy','top','camera','_onMapWhellEvent','tlat','uniform\x20sampler2D\x20currentParticlesPosition;\x20//\x20(lon,\x20lat,\x20lev)\x0auniform\x20sampler2D\x20currentParticlesSpeed;\x20//\x20(u,\x20v,\x20w,\x20normalization)\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avec2\x20lengthOfLonLat(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20unit\x20conversion:\x20meters\x20->\x20longitude\x20latitude\x20degrees\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Geographic_coordinate_system#Length_of_a_degree\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20the\x20length\x20of\x20a\x20degree\x20of\x20latitude\x20and\x20longitude\x20in\x20meters\x0a\x20\x20\x20\x20float\x20latitude\x20=\x20radians(lonLatLev.y);\x0a\x0a\x20\x20\x20\x20float\x20term1\x20=\x20111132.92;\x0a\x20\x20\x20\x20float\x20term2\x20=\x20559.82\x20*\x20cos(2.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20term3\x20=\x201.175\x20*\x20cos(4.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20term4\x20=\x200.0023\x20*\x20cos(6.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20latLength\x20=\x20term1\x20-\x20term2\x20+\x20term3\x20-\x20term4;\x0a\x0a\x20\x20\x20\x20float\x20term5\x20=\x20111412.84\x20*\x20cos(latitude);\x0a\x20\x20\x20\x20float\x20term6\x20=\x2093.5\x20*\x20cos(3.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20term7\x20=\x200.118\x20*\x20cos(5.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20longLength\x20=\x20term5\x20-\x20term6\x20+\x20term7;\x0a\x0a\x20\x20\x20\x20return\x20vec2(longLength,\x20latLength);\x0a}\x0a\x0avoid\x20updatePosition(vec3\x20lonLatLev,\x20vec3\x20speed)\x20{\x0a\x20\x20\x20\x20vec2\x20lonLatLength\x20=\x20lengthOfLonLat(lonLatLev);\x0a\x20\x20\x20\x20float\x20u\x20=\x20speed.x\x20/\x20lonLatLength.x;\x0a\x20\x20\x20\x20float\x20v\x20=\x20speed.y\x20/\x20lonLatLength.y;\x0a\x20\x20\x20\x20float\x20w\x20=\x200.0;\x0a\x20\x20\x20\x20vec3\x20windVectorInLonLatLev\x20=\x20vec3(u,\x20v,\x20w);\x0a\x0a\x20\x20\x20\x20vec3\x20nextParticle\x20=\x20lonLatLev\x20+\x20windVectorInLonLatLev;\x0a\x0a\x20\x20\x20\x20out_FragColor\x20=\x20vec4(nextParticle,\x200.0);\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20\x20\x20vec3\x20lonLatLev\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rgb;\x0a\x20\x20\x20\x20vec3\x20speed\x20=\x20texture(currentParticlesSpeed,\x20v_textureCoordinates).rgb;\x0a\x0a\x20\x20\x20\x20updatePosition(lonLatLev,\x20speed);\x0a}\x0a','_onMouseMoveEvent','off','ymin','Math','Cartesian2','DomUtil','speedRate','TRIANGLES','Compute','CanvasWindLayer','_bilinearInterpolation','lighter','positionWC','lat','getUVByXY','colorTable','default'];_0x59fb=function(){return _0x39934e;};return _0x59fb();}exports['CanvasWindField']=CanvasWindField,exports[_0x4c9e73(0x4a6,0x4bb)]=CanvasWindLayer,exports[_0x2b892e(0x449,0x442)]=WindLayer,exports['WindUtil']=WindUtil;const _0x20932={};_0x20932['value']=!![],Object['defineProperty'](exports,'__esModule',_0x20932);
}));
